const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/PerformanceMonitor-BvXMHQqb.js","assets/vendor-BKU87Gzz.js","assets/ui-BifNPMKY.js","assets/router-BFjZ0YpI.js"])))=>i.map(i=>d[i]);
var gm=Object.defineProperty;var ym=(s,e,t)=>e in s?gm(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var ur=(s,e,t)=>ym(s,typeof e!="symbol"?e+"":e,t);import{r as v,b as vm,a as Ce,g as xm,c as bm}from"./vendor-BKU87Gzz.js";import{u as Ve,a as $t,L as be,b as wm,R as jm,c as Le,N as Et,B as Sm}from"./router-BFjZ0YpI.js";import{G as Z,m as F,A as Se,u as Nm,a as mr}from"./ui-BifNPMKY.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();var yc={exports:{}},Cn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var km=v,Cm=Symbol.for("react.element"),Pm=Symbol.for("react.fragment"),Tm=Object.prototype.hasOwnProperty,Em=km.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Im={key:!0,ref:!0,__self:!0,__source:!0};function vc(s,e,t){var n,r={},a=null,o=null;t!==void 0&&(a=""+t),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Tm.call(e,n)&&!Im.hasOwnProperty(n)&&(r[n]=e[n]);if(s&&s.defaultProps)for(n in e=s.defaultProps,e)r[n]===void 0&&(r[n]=e[n]);return{$$typeof:Cm,type:s,key:a,ref:o,props:r,_owner:Em.current}}Cn.Fragment=Pm;Cn.jsx=vc;Cn.jsxs=vc;yc.exports=Cn;var i=yc.exports,xc,Lo=vm;xc=Lo.createRoot,Lo.hydrateRoot;var bc={exports:{}},wc={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wi=v;function _m(s,e){return s===e&&(s!==0||1/s===1/e)||s!==s&&e!==e}var Lm=typeof Object.is=="function"?Object.is:_m,Mm=wi.useSyncExternalStore,Rm=wi.useRef,Am=wi.useEffect,Om=wi.useMemo,Fm=wi.useDebugValue;wc.useSyncExternalStoreWithSelector=function(s,e,t,n,r){var a=Rm(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=Om(function(){function c(b){if(!h){if(h=!0,d=b,b=n(b),r!==void 0&&o.hasValue){var p=o.value;if(r(p,b))return m=p}return m=b}if(p=m,Lm(d,b))return p;var g=n(b);return r!==void 0&&r(p,g)?(d=b,p):(d=b,m=g)}var h=!1,d,m,x=t===void 0?null:t;return[function(){return c(e())},x===null?void 0:function(){return c(x())}]},[e,t,n,r]);var l=Mm(s,a[0],a[1]);return Am(function(){o.hasValue=!0,o.value=l},[l]),Fm(l),l};bc.exports=wc;var Bm=bc.exports;function Dm(s){s()}function $m(){let s=null,e=null;return{clear(){s=null,e=null},notify(){Dm(()=>{let t=s;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=s;for(;n;)t.push(n),n=n.next;return t},subscribe(t){let n=!0;const r=e={callback:t,next:null,prev:e};return r.prev?r.prev.next=r:s=r,function(){!n||s===null||(n=!1,r.next?r.next.prev=r.prev:e=r.prev,r.prev?r.prev.next=r.next:s=r.next)}}}}var Mo={notify(){},get:()=>[]};function zm(s,e){let t,n=Mo,r=0,a=!1;function o(g){d();const f=n.subscribe(g);let y=!1;return()=>{y||(y=!0,f(),m())}}function l(){n.notify()}function c(){p.onStateChange&&p.onStateChange()}function h(){return a}function d(){r++,t||(t=s.subscribe(c),n=$m())}function m(){r--,t&&r===0&&(t(),t=void 0,n.clear(),n=Mo)}function x(){a||(a=!0,d())}function b(){a&&(a=!1,m())}const p={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:h,trySubscribe:x,tryUnsubscribe:b,getListeners:()=>n};return p}var Um=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Wm=Um(),Vm=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Hm=Vm(),Ym=()=>Wm||Hm?v.useLayoutEffect:v.useEffect,qm=Ym(),fr=Symbol.for("react-redux-context"),pr=typeof globalThis<"u"?globalThis:{};function Gm(){if(!v.createContext)return{};const s=pr[fr]??(pr[fr]=new Map);let e=s.get(v.createContext);return e||(e=v.createContext(null),s.set(v.createContext,e)),e}var cn=Gm();function Qm(s){const{children:e,context:t,serverState:n,store:r}=s,a=v.useMemo(()=>{const c=zm(r);return{store:r,subscription:c,getServerState:n?()=>n:void 0}},[r,n]),o=v.useMemo(()=>r.getState(),[r]);qm(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==r.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,o]);const l=t||cn;return v.createElement(l.Provider,{value:a},e)}var Km=Qm;function jc(s=cn){return function(){return v.useContext(s)}}var Jm=jc(),Xm=(s,e)=>s===e;function Zm(s=cn){const e=s===cn?Jm:jc(s),t=(n,r={})=>{const{equalityFn:a=Xm}=typeof r=="function"?{equalityFn:r}:r,o=e(),{store:l,subscription:c,getServerState:h}=o;v.useRef(!0);const d=v.useCallback({[n.name](x){return n(x)}}[n.name],[n]),m=Bm.useSyncExternalStoreWithSelector(c.addNestedSub,l.getState,h||l.getState,d,a);return v.useDebugValue(m),m};return Object.assign(t,{withTypes:()=>t}),t}var Sc=Zm();function Ki(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ki=function(t){return typeof t}:Ki=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ki(s)}function ef(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function tf(s,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,n.key,n)}}function sf(s,e,t){return e&&tf(s.prototype,e),s}function nf(s,e){return e&&(Ki(e)==="object"||typeof e=="function")?e:Ji(s)}function la(s){return la=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},la(s)}function Ji(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function rf(s,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),e&&ca(s,e)}function ca(s,e){return ca=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n},ca(s,e)}function Xi(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var Nc=function(s){rf(e,s);function e(){var t,n;ef(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=nf(this,(t=la(e)).call.apply(t,[this].concat(a))),Xi(Ji(n),"state",{bootstrapped:!1}),Xi(Ji(n),"_unsubscribe",void 0),Xi(Ji(n),"handlePersistorState",function(){var l=n.props.persistor,c=l.getState(),h=c.bootstrapped;h&&(n.props.onBeforeLift?Promise.resolve(n.props.onBeforeLift()).finally(function(){return n.setState({bootstrapped:!0})}):n.setState({bootstrapped:!0}),n._unsubscribe&&n._unsubscribe())}),n}return sf(e,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),e}(v.PureComponent);Xi(Nc,"defaultProps",{children:null,loading:null});const af="modulepreload",of=function(s){return"/"+s},Ro={},lf=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(c=>{if(c=of(c),c in Ro)return;Ro[c]=!0;const h=c.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=h?"stylesheet":af,h||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),h)return new Promise((x,b)=>{m.addEventListener("load",x),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function kc(s){var e,t,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s))for(e=0;e<s.length;e++)s[e]&&(t=kc(s[e]))&&(n&&(n+=" "),n+=t);else for(e in s)s[e]&&(n&&(n+=" "),n+=e);return n}function Vt(){for(var s,e,t=0,n="";t<arguments.length;)(s=arguments[t++])&&(e=kc(s))&&(n&&(n+=" "),n+=e);return n}const ii=s=>typeof s=="number"&&!isNaN(s),ms=s=>typeof s=="string",nt=s=>typeof s=="function",Zi=s=>ms(s)||nt(s)?s:null,gr=s=>v.isValidElement(s)||ms(s)||nt(s)||ii(s);function cf(s,e,t){t===void 0&&(t=300);const{scrollHeight:n,style:r}=s;requestAnimationFrame(()=>{r.minHeight="initial",r.height=n+"px",r.transition=`all ${t}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(e,t)})})}function Pn(s){let{enter:e,exit:t,appendPosition:n=!1,collapse:r=!0,collapseDuration:a=300}=s;return function(o){let{children:l,position:c,preventExitTransition:h,done:d,nodeRef:m,isIn:x}=o;const b=n?`${e}--${c}`:e,p=n?`${t}--${c}`:t,g=v.useRef(0);return v.useLayoutEffect(()=>{const f=m.current,y=b.split(" "),S=k=>{k.target===m.current&&(f.dispatchEvent(new Event("d")),f.removeEventListener("animationend",S),f.removeEventListener("animationcancel",S),g.current===0&&k.type!=="animationcancel"&&f.classList.remove(...y))};f.classList.add(...y),f.addEventListener("animationend",S),f.addEventListener("animationcancel",S)},[]),v.useEffect(()=>{const f=m.current,y=()=>{f.removeEventListener("animationend",y),r?cf(f,d,a):d()};x||(h?y():(g.current=1,f.className+=` ${p}`,f.addEventListener("animationend",y)))},[x]),Ce.createElement(Ce.Fragment,null,l)}}function Ao(s,e){return s!=null?{content:s.content,containerId:s.props.containerId,id:s.props.toastId,theme:s.props.theme,type:s.props.type,data:s.props.data||{},isLoading:s.props.isLoading,icon:s.props.icon,status:e}:{}}const gt={list:new Map,emitQueue:new Map,on(s,e){return this.list.has(s)||this.list.set(s,[]),this.list.get(s).push(e),this},off(s,e){if(e){const t=this.list.get(s).filter(n=>n!==e);return this.list.set(s,t),this}return this.list.delete(s),this},cancelEmit(s){const e=this.emitQueue.get(s);return e&&(e.forEach(clearTimeout),this.emitQueue.delete(s)),this},emit(s){this.list.has(s)&&this.list.get(s).forEach(e=>{const t=setTimeout(()=>{e(...[].slice.call(arguments,1))},0);this.emitQueue.has(s)||this.emitQueue.set(s,[]),this.emitQueue.get(s).push(t)})}},Oi=s=>{let{theme:e,type:t,...n}=s;return Ce.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...n})},yr={info:function(s){return Ce.createElement(Oi,{...s},Ce.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(s){return Ce.createElement(Oi,{...s},Ce.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(s){return Ce.createElement(Oi,{...s},Ce.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(s){return Ce.createElement(Oi,{...s},Ce.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Ce.createElement("div",{className:"Toastify__spinner"})}};function hf(s){const[,e]=v.useReducer(b=>b+1,0),[t,n]=v.useState([]),r=v.useRef(null),a=v.useRef(new Map).current,o=b=>t.indexOf(b)!==-1,l=v.useRef({toastKey:1,displayedToast:0,count:0,queue:[],props:s,containerId:null,isToastActive:o,getToast:b=>a.get(b)}).current;function c(b){let{containerId:p}=b;const{limit:g}=l.props;!g||p&&l.containerId!==p||(l.count-=l.queue.length,l.queue=[])}function h(b){n(p=>b==null?[]:p.filter(g=>g!==b))}function d(){const{toastContent:b,toastProps:p,staleId:g}=l.queue.shift();x(b,p,g)}function m(b,p){let{delay:g,staleId:f,...y}=p;if(!gr(b)||function(B){return!r.current||l.props.enableMultiContainer&&B.containerId!==l.props.containerId||a.has(B.toastId)&&B.updateId==null}(y))return;const{toastId:S,updateId:k,data:C}=y,{props:N}=l,T=()=>h(S),I=k==null;I&&l.count++;const P={...N,style:N.toastStyle,key:l.toastKey++,...Object.fromEntries(Object.entries(y).filter(B=>{let[R,A]=B;return A!=null})),toastId:S,updateId:k,data:C,closeToast:T,isIn:!1,className:Zi(y.className||N.toastClassName),bodyClassName:Zi(y.bodyClassName||N.bodyClassName),progressClassName:Zi(y.progressClassName||N.progressClassName),autoClose:!y.isLoading&&(L=y.autoClose,M=N.autoClose,L===!1||ii(L)&&L>0?L:M),deleteToast(){const B=Ao(a.get(S),"removed");a.delete(S),gt.emit(4,B);const R=l.queue.length;if(l.count=S==null?l.count-l.displayedToast:l.count-1,l.count<0&&(l.count=0),R>0){const A=S==null?l.props.limit:1;if(R===1||A===1)l.displayedToast++,d();else{const V=A>R?R:A;l.displayedToast=V;for(let z=0;z<V;z++)d()}}else e()}};var L,M;P.iconOut=function(B){let{theme:R,type:A,isLoading:V,icon:z}=B,q=null;const Y={theme:R,type:A};return z===!1||(nt(z)?q=z(Y):v.isValidElement(z)?q=v.cloneElement(z,Y):ms(z)||ii(z)?q=z:V?q=yr.spinner():(te=>te in yr)(A)&&(q=yr[A](Y))),q}(P),nt(y.onOpen)&&(P.onOpen=y.onOpen),nt(y.onClose)&&(P.onClose=y.onClose),P.closeButton=N.closeButton,y.closeButton===!1||gr(y.closeButton)?P.closeButton=y.closeButton:y.closeButton===!0&&(P.closeButton=!gr(N.closeButton)||N.closeButton);let O=b;v.isValidElement(b)&&!ms(b.type)?O=v.cloneElement(b,{closeToast:T,toastProps:P,data:C}):nt(b)&&(O=b({closeToast:T,toastProps:P,data:C})),N.limit&&N.limit>0&&l.count>N.limit&&I?l.queue.push({toastContent:O,toastProps:P,staleId:f}):ii(g)?setTimeout(()=>{x(O,P,f)},g):x(O,P,f)}function x(b,p,g){const{toastId:f}=p;g&&a.delete(g);const y={content:b,props:p};a.set(f,y),n(S=>[...S,f].filter(k=>k!==g)),gt.emit(4,Ao(y,y.props.updateId==null?"added":"updated"))}return v.useEffect(()=>(l.containerId=s.containerId,gt.cancelEmit(3).on(0,m).on(1,b=>r.current&&h(b)).on(5,c).emit(2,l),()=>{a.clear(),gt.emit(3,l)}),[]),v.useEffect(()=>{l.props=s,l.isToastActive=o,l.displayedToast=t.length}),{getToastToRender:function(b){const p=new Map,g=Array.from(a.values());return s.newestOnTop&&g.reverse(),g.forEach(f=>{const{position:y}=f.props;p.has(y)||p.set(y,[]),p.get(y).push(f)}),Array.from(p,f=>b(f[0],f[1]))},containerRef:r,isToastActive:o}}function Oo(s){return s.targetTouches&&s.targetTouches.length>=1?s.targetTouches[0].clientX:s.clientX}function Fo(s){return s.targetTouches&&s.targetTouches.length>=1?s.targetTouches[0].clientY:s.clientY}function df(s){const[e,t]=v.useState(!1),[n,r]=v.useState(!1),a=v.useRef(null),o=v.useRef({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,l=v.useRef(s),{autoClose:c,pauseOnHover:h,closeToast:d,onClick:m,closeOnClick:x}=s;function b(C){if(s.draggable){C.nativeEvent.type==="touchstart"&&C.nativeEvent.preventDefault(),o.didMove=!1,document.addEventListener("mousemove",y),document.addEventListener("mouseup",S),document.addEventListener("touchmove",y),document.addEventListener("touchend",S);const N=a.current;o.canCloseOnClick=!0,o.canDrag=!0,o.boundingRect=N.getBoundingClientRect(),N.style.transition="",o.x=Oo(C.nativeEvent),o.y=Fo(C.nativeEvent),s.draggableDirection==="x"?(o.start=o.x,o.removalDistance=N.offsetWidth*(s.draggablePercent/100)):(o.start=o.y,o.removalDistance=N.offsetHeight*(s.draggablePercent===80?1.5*s.draggablePercent:s.draggablePercent/100))}}function p(C){if(o.boundingRect){const{top:N,bottom:T,left:I,right:P}=o.boundingRect;C.nativeEvent.type!=="touchend"&&s.pauseOnHover&&o.x>=I&&o.x<=P&&o.y>=N&&o.y<=T?f():g()}}function g(){t(!0)}function f(){t(!1)}function y(C){const N=a.current;o.canDrag&&N&&(o.didMove=!0,e&&f(),o.x=Oo(C),o.y=Fo(C),o.delta=s.draggableDirection==="x"?o.x-o.start:o.y-o.start,o.start!==o.x&&(o.canCloseOnClick=!1),N.style.transform=`translate${s.draggableDirection}(${o.delta}px)`,N.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function S(){document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",S),document.removeEventListener("touchmove",y),document.removeEventListener("touchend",S);const C=a.current;if(o.canDrag&&o.didMove&&C){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return r(!0),void s.closeToast();C.style.transition="transform 0.2s, opacity 0.2s",C.style.transform=`translate${s.draggableDirection}(0)`,C.style.opacity="1"}}v.useEffect(()=>{l.current=s}),v.useEffect(()=>(a.current&&a.current.addEventListener("d",g,{once:!0}),nt(s.onOpen)&&s.onOpen(v.isValidElement(s.children)&&s.children.props),()=>{const C=l.current;nt(C.onClose)&&C.onClose(v.isValidElement(C.children)&&C.children.props)}),[]),v.useEffect(()=>(s.pauseOnFocusLoss&&(document.hasFocus()||f(),window.addEventListener("focus",g),window.addEventListener("blur",f)),()=>{s.pauseOnFocusLoss&&(window.removeEventListener("focus",g),window.removeEventListener("blur",f))}),[s.pauseOnFocusLoss]);const k={onMouseDown:b,onTouchStart:b,onMouseUp:p,onTouchEnd:p};return c&&h&&(k.onMouseEnter=f,k.onMouseLeave=g),x&&(k.onClick=C=>{m&&m(C),o.canCloseOnClick&&d()}),{playToast:g,pauseToast:f,isRunning:e,preventExitTransition:n,toastRef:a,eventHandlers:k}}function Cc(s){let{closeToast:e,theme:t,ariaLabel:n="close"}=s;return Ce.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:r=>{r.stopPropagation(),e(r)},"aria-label":n},Ce.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Ce.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function uf(s){let{delay:e,isRunning:t,closeToast:n,type:r="default",hide:a,className:o,style:l,controlledProgress:c,progress:h,rtl:d,isIn:m,theme:x}=s;const b=a||c&&h===0,p={...l,animationDuration:`${e}ms`,animationPlayState:t?"running":"paused",opacity:b?0:1};c&&(p.transform=`scaleX(${h})`);const g=Vt("Toastify__progress-bar",c?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${x}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":d}),f=nt(o)?o({rtl:d,type:r,defaultClassName:g}):Vt(g,o);return Ce.createElement("div",{role:"progressbar","aria-hidden":b?"true":"false","aria-label":"notification timer",className:f,style:p,[c&&h>=1?"onTransitionEnd":"onAnimationEnd"]:c&&h<1?null:()=>{m&&n()}})}const mf=s=>{const{isRunning:e,preventExitTransition:t,toastRef:n,eventHandlers:r}=df(s),{closeButton:a,children:o,autoClose:l,onClick:c,type:h,hideProgressBar:d,closeToast:m,transition:x,position:b,className:p,style:g,bodyClassName:f,bodyStyle:y,progressClassName:S,progressStyle:k,updateId:C,role:N,progress:T,rtl:I,toastId:P,deleteToast:L,isIn:M,isLoading:O,iconOut:B,closeOnClick:R,theme:A}=s,V=Vt("Toastify__toast",`Toastify__toast-theme--${A}`,`Toastify__toast--${h}`,{"Toastify__toast--rtl":I},{"Toastify__toast--close-on-click":R}),z=nt(p)?p({rtl:I,position:b,type:h,defaultClassName:V}):Vt(V,p),q=!!T||!l,Y={closeToast:m,type:h,theme:A};let te=null;return a===!1||(te=nt(a)?a(Y):v.isValidElement(a)?v.cloneElement(a,Y):Cc(Y)),Ce.createElement(x,{isIn:M,done:L,position:b,preventExitTransition:t,nodeRef:n},Ce.createElement("div",{id:P,onClick:c,className:z,...r,style:g,ref:n},Ce.createElement("div",{...M&&{role:N},className:nt(f)?f({type:h}):Vt("Toastify__toast-body",f),style:y},B!=null&&Ce.createElement("div",{className:Vt("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!O})},B),Ce.createElement("div",null,o)),te,Ce.createElement(uf,{...C&&!q?{key:`pb-${C}`}:{},rtl:I,theme:A,delay:l,isRunning:e,isIn:M,closeToast:m,hide:d,type:h,style:k,className:S,controlledProgress:q,progress:T||0})))},Tn=function(s,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${s}-enter`,exit:`Toastify--animate Toastify__${s}-exit`,appendPosition:e}},ff=Pn(Tn("bounce",!0));Pn(Tn("slide",!0));Pn(Tn("zoom"));Pn(Tn("flip"));const hn=v.forwardRef((s,e)=>{const{getToastToRender:t,containerRef:n,isToastActive:r}=hf(s),{className:a,style:o,rtl:l,containerId:c}=s;function h(d){const m=Vt("Toastify__toast-container",`Toastify__toast-container--${d}`,{"Toastify__toast-container--rtl":l});return nt(a)?a({position:d,rtl:l,defaultClassName:m}):Vt(m,Zi(a))}return v.useEffect(()=>{e&&(e.current=n.current)},[]),Ce.createElement("div",{ref:n,className:"Toastify",id:c},t((d,m)=>{const x=m.length?{...o}:{...o,pointerEvents:"none"};return Ce.createElement("div",{className:h(d),style:x,key:`container-${d}`},m.map((b,p)=>{let{content:g,props:f}=b;return Ce.createElement(mf,{...f,isIn:r(f.toastId),style:{...f.style,"--nth":p+1,"--len":m.length},key:`toast-${f.key}`},g)}))}))});hn.displayName="ToastContainer",hn.defaultProps={position:"top-right",transition:ff,autoClose:5e3,closeButton:Cc,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};let vr,is=new Map,Zs=[],pf=1;function Pc(){return""+pf++}function gf(s){return s&&(ms(s.toastId)||ii(s.toastId))?s.toastId:Pc()}function ni(s,e){return is.size>0?gt.emit(0,s,e):Zs.push({content:s,options:e}),e.toastId}function dn(s,e){return{...e,type:e&&e.type||s,toastId:gf(e)}}function Fi(s){return(e,t)=>ni(e,dn(s,t))}function K(s,e){return ni(s,dn("default",e))}K.loading=(s,e)=>ni(s,dn("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),K.promise=function(s,e,t){let n,{pending:r,error:a,success:o}=e;r&&(n=ms(r)?K.loading(r,t):K.loading(r.render,{...t,...r}));const l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(d,m,x)=>{if(m==null)return void K.dismiss(n);const b={type:d,...l,...t,data:x},p=ms(m)?{render:m}:m;return n?K.update(n,{...b,...p}):K(p.render,{...b,...p}),x},h=nt(s)?s():s;return h.then(d=>c("success",o,d)).catch(d=>c("error",a,d)),h},K.success=Fi("success"),K.info=Fi("info"),K.error=Fi("error"),K.warning=Fi("warning"),K.warn=K.warning,K.dark=(s,e)=>ni(s,dn("default",{theme:"dark",...e})),K.dismiss=s=>{is.size>0?gt.emit(1,s):Zs=Zs.filter(e=>s!=null&&e.options.toastId!==s)},K.clearWaitingQueue=function(s){return s===void 0&&(s={}),gt.emit(5,s)},K.isActive=s=>{let e=!1;return is.forEach(t=>{t.isToastActive&&t.isToastActive(s)&&(e=!0)}),e},K.update=function(s,e){e===void 0&&(e={}),setTimeout(()=>{const t=function(n,r){let{containerId:a}=r;const o=is.get(a||vr);return o&&o.getToast(n)}(s,e);if(t){const{props:n,content:r}=t,a={delay:100,...n,...e,toastId:e.toastId||s,updateId:Pc()};a.toastId!==s&&(a.staleId=s);const o=a.render||r;delete a.render,ni(o,a)}},0)},K.done=s=>{K.update(s,{progress:1})},K.onChange=s=>(gt.on(4,s),()=>{gt.off(4,s)}),K.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},K.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},gt.on(2,s=>{vr=s.containerId||s,is.set(vr,s),Zs.forEach(e=>{gt.emit(0,e.content,e.options)}),Zs=[]}).on(3,s=>{is.delete(s.containerId||s),is.size===0&&gt.off(0).off(1).off(5)});function vt(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"}}]})(s)}function et(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"}},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"}}]})(s)}function qt(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}},{tag:"line",attr:{x1:"12",y1:"9",x2:"12",y2:"13"}},{tag:"line",attr:{x1:"12",y1:"17",x2:"12.01",y2:"17"}}]})(s)}function di(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"7",y1:"7",x2:"17",y2:"17"}},{tag:"polyline",attr:{points:"17 7 17 17 7 17"}}]})(s)}function rs(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"}},{tag:"polyline",attr:{points:"19 12 12 19 5 12"}}]})(s)}function En(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"}},{tag:"polyline",attr:{points:"12 19 5 12 12 5"}}]})(s)}function lt(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}},{tag:"polyline",attr:{points:"12 5 19 12 12 19"}}]})(s)}function ui(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"7",y1:"17",x2:"17",y2:"7"}},{tag:"polyline",attr:{points:"7 7 17 7 17 17"}}]})(s)}function Is(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"19",x2:"12",y2:"5"}},{tag:"polyline",attr:{points:"5 12 12 5 19 12"}}]})(s)}function ha(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"}},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"}}]})(s)}function rt(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"20",x2:"18",y2:"10"}},{tag:"line",attr:{x1:"12",y1:"20",x2:"12",y2:"4"}},{tag:"line",attr:{x1:"6",y1:"20",x2:"6",y2:"14"}}]})(s)}function ls(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}},{tag:"path",attr:{d:"M13.73 21a2 2 0 0 1-3.46 0"}}]})(s)}function cs(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"}}]})(s)}function Tc(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}},{tag:"path",attr:{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"}}]})(s)}function Ec(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"}},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"}}]})(s)}function yf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}},{tag:"circle",attr:{cx:"12",cy:"13",r:"4"}}]})(s)}function kt(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"}}]})(s)}function Ot(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"}}]})(s)}function st(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"polyline",attr:{points:"12 6 12 12 16 14"}}]})(s)}function vf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3H6a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3V6a3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 3 3 0 0 0-3-3z"}}]})(s)}function xf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 10 4 15 9 20"}},{tag:"path",attr:{d:"M20 4v7a4 4 0 0 1-4 4H4"}}]})(s)}function ri(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"4",y:"4",width:"16",height:"16",rx:"2",ry:"2"}},{tag:"rect",attr:{x:"9",y:"9",width:"6",height:"6"}},{tag:"line",attr:{x1:"9",y1:"1",x2:"9",y2:"4"}},{tag:"line",attr:{x1:"15",y1:"1",x2:"15",y2:"4"}},{tag:"line",attr:{x1:"9",y1:"20",x2:"9",y2:"23"}},{tag:"line",attr:{x1:"15",y1:"20",x2:"15",y2:"23"}},{tag:"line",attr:{x1:"20",y1:"9",x2:"23",y2:"9"}},{tag:"line",attr:{x1:"20",y1:"14",x2:"23",y2:"14"}},{tag:"line",attr:{x1:"1",y1:"9",x2:"4",y2:"9"}},{tag:"line",attr:{x1:"1",y1:"14",x2:"4",y2:"14"}}]})(s)}function bf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"ellipse",attr:{cx:"12",cy:"5",rx:"9",ry:"3"}},{tag:"path",attr:{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}},{tag:"path",attr:{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"}}]})(s)}function Je(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"23"}},{tag:"path",attr:{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"}}]})(s)}function wf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}},{tag:"polyline",attr:{points:"7 10 12 15 17 10"}},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"}}]})(s)}function Ic(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}}]})(s)}function In(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}},{tag:"polyline",attr:{points:"15 3 21 3 21 9"}},{tag:"line",attr:{x1:"10",y1:"14",x2:"21",y2:"3"}}]})(s)}function da(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"}}]})(s)}function fs(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}}]})(s)}function jf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}},{tag:"polyline",attr:{points:"14 2 14 8 20 8"}},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"}},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"}},{tag:"polyline",attr:{points:"10 9 9 9 8 9"}}]})(s)}function _n(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"}}]})(s)}function Bo(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 12 20 22 4 22 4 12"}},{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"5"}},{tag:"line",attr:{x1:"12",y1:"22",x2:"12",y2:"7"}},{tag:"path",attr:{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"}},{tag:"path",attr:{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"}}]})(s)}function Aa(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"}},{tag:"path",attr:{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"}}]})(s)}function Sf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"3",width:"7",height:"7"}},{tag:"rect",attr:{x:"14",y:"3",width:"7",height:"7"}},{tag:"rect",attr:{x:"14",y:"14",width:"7",height:"7"}},{tag:"rect",attr:{x:"3",y:"14",width:"7",height:"7"}}]})(s)}function Nf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"}}]})(s)}function Oa(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"}},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"}}]})(s)}function kf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"}}]})(s)}function Cf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 2 7 12 12 22 7 12 2"}},{tag:"polyline",attr:{points:"2 17 12 22 22 17"}},{tag:"polyline",attr:{points:"2 12 12 17 22 12"}}]})(s)}function _c(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"8",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"8",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"8",y1:"18",x2:"21",y2:"18"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"3.01",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"12",x2:"3.01",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"3.01",y2:"18"}}]})(s)}function en(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"6"}},{tag:"line",attr:{x1:"12",y1:"18",x2:"12",y2:"22"}},{tag:"line",attr:{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"}},{tag:"line",attr:{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"}},{tag:"line",attr:{x1:"2",y1:"12",x2:"6",y2:"12"}},{tag:"line",attr:{x1:"18",y1:"12",x2:"22",y2:"12"}},{tag:"line",attr:{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"}},{tag:"line",attr:{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"}}]})(s)}function mi(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"}}]})(s)}function Do(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}},{tag:"polyline",attr:{points:"10 17 15 12 10 7"}},{tag:"line",attr:{x1:"15",y1:"12",x2:"3",y2:"12"}}]})(s)}function Lc(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}},{tag:"polyline",attr:{points:"16 17 21 12 16 7"}},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"}}]})(s)}function Ln(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}},{tag:"polyline",attr:{points:"22,6 12,13 2,6"}}]})(s)}function Pf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"}}]})(s)}function Fa(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"}},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"}},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"}}]})(s)}function Mc(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"}}]})(s)}function Ba(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"}},{tag:"path",attr:{d:"M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"}},{tag:"path",attr:{d:"M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"}},{tag:"line",attr:{x1:"12",y1:"19",x2:"12",y2:"23"}},{tag:"line",attr:{x1:"8",y1:"23",x2:"16",y2:"23"}}]})(s)}function Us(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}},{tag:"path",attr:{d:"M19 10v2a7 7 0 0 1-14 0v-2"}},{tag:"line",attr:{x1:"12",y1:"19",x2:"12",y2:"23"}},{tag:"line",attr:{x1:"8",y1:"23",x2:"16",y2:"23"}}]})(s)}function Mn(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}}]})(s)}function t1(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}},{tag:"line",attr:{x1:"8",y1:"21",x2:"16",y2:"21"}},{tag:"line",attr:{x1:"12",y1:"17",x2:"12",y2:"21"}}]})(s)}function Rc(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"}}]})(s)}function Tf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"1"}},{tag:"circle",attr:{cx:"19",cy:"12",r:"1"}},{tag:"circle",attr:{cx:"5",cy:"12",r:"1"}}]})(s)}function Ac(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"5",x2:"5",y2:"19"}},{tag:"circle",attr:{cx:"6.5",cy:"6.5",r:"2.5"}},{tag:"circle",attr:{cx:"17.5",cy:"17.5",r:"2.5"}}]})(s)}function Ef(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"}}]})(s)}function fi(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}},{tag:"path",attr:{d:"M22 12A10 10 0 0 0 12 2v10z"}}]})(s)}function Ht(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"}},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}}]})(s)}function Ue(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"}},{tag:"polyline",attr:{points:"1 20 1 14 7 14"}},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"}}]})(s)}function Oc(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"}},{tag:"polyline",attr:{points:"7 3 7 8 15 8"}}]})(s)}function As(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"}},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}}]})(s)}function Fc(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"2",x2:"11",y2:"13"}},{tag:"polygon",attr:{points:"22 2 15 22 11 13 2 9 22 2"}}]})(s)}function Os(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"}}]})(s)}function If(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"18",cy:"5",r:"3"}},{tag:"circle",attr:{cx:"6",cy:"12",r:"3"}},{tag:"circle",attr:{cx:"18",cy:"19",r:"3"}},{tag:"line",attr:{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}},{tag:"line",attr:{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"}}]})(s)}function Ft(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"}}]})(s)}function tt(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"9",cy:"21",r:"1"}},{tag:"circle",attr:{cx:"20",cy:"21",r:"1"}},{tag:"path",attr:{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"}}]})(s)}function _f(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"}},{tag:"line",attr:{x1:"12",y1:"18",x2:"12.01",y2:"18"}}]})(s)}function Fs(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"}}]})(s)}function Bc(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"}},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"}},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"}},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"}},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"}},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"}}]})(s)}function Lf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}},{tag:"line",attr:{x1:"7",y1:"7",x2:"7.01",y2:"7"}}]})(s)}function pi(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"circle",attr:{cx:"12",cy:"12",r:"6"}},{tag:"circle",attr:{cx:"12",cy:"12",r:"2"}}]})(s)}function Mf(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"}},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"}},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"}}]})(s)}function $e(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 18 13.5 8.5 8.5 13.5 1 6"}},{tag:"polyline",attr:{points:"17 18 23 18 23 12"}}]})(s)}function Pe(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"}},{tag:"polyline",attr:{points:"17 6 23 6 23 12"}}]})(s)}function ht(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"}}]})(s)}function Dc(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"}},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"}},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"}}]})(s)}function $c(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}},{tag:"path",attr:{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"}}]})(s)}function ps(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"}},{tag:"line",attr:{x1:"15",y1:"9",x2:"9",y2:"15"}},{tag:"line",attr:{x1:"9",y1:"9",x2:"15",y2:"15"}}]})(s)}function We(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(s)}function hs(s){return Z({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}}]})(s)}const zc=v.createContext(),Rf=({children:s})=>{const[e,t]=v.useState(null),[n,r]=v.useState(!1),[a,o]=v.useState(!0);v.useEffect(()=>{const p=localStorage.getItem("token"),g=localStorage.getItem("user");if(p&&g)try{const f=JSON.parse(g);t(f),r(!0)}catch(f){console.error("Error parsing user data:",f),localStorage.removeItem("token"),localStorage.removeItem("user"),t(null),r(!1)}o(!1)},[]),v.useEffect(()=>{const p=()=>{const g=localStorage.getItem("token"),f=localStorage.getItem("user");if(!g||!f)t(null),r(!1);else try{const y=JSON.parse(f);t(y),r(!0)}catch{t(null),r(!1)}};return window.addEventListener("storage",p),()=>window.removeEventListener("storage",p)},[]);const b={user:e,isAuthenticated:n,loading:a,login:(p,g)=>{localStorage.setItem("token",g),localStorage.setItem("user",JSON.stringify(p)),t(p),r(!0)},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(null),r(!1)},updateProfile:p=>{const g={...e,...p};localStorage.setItem("user",JSON.stringify(g)),t(g)},getToken:()=>localStorage.getItem("token"),hasRole:p=>(e==null?void 0:e.role)===p,isAdmin:()=>(e==null?void 0:e.role)==="admin",userName:(e==null?void 0:e.name)||"Guest",userEmail:(e==null?void 0:e.email)||"",userAvatar:(e==null?void 0:e.avatar)||"/default-avatar.png"};return i.jsx(zc.Provider,{value:b,children:s})},Bt=()=>{const s=v.useContext(zc);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s};function Uc(s,e){return function(){return s.apply(e,arguments)}}const{toString:Af}=Object.prototype,{getPrototypeOf:Da}=Object,{iterator:Rn,toStringTag:Wc}=Symbol,An=(s=>e=>{const t=Af.call(e);return s[t]||(s[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Ct=s=>(s=s.toLowerCase(),e=>An(e)===s),On=s=>e=>typeof e===s,{isArray:Ws}=Array,gi=On("undefined");function Of(s){return s!==null&&!gi(s)&&s.constructor!==null&&!gi(s.constructor)&&at(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const Vc=Ct("ArrayBuffer");function Ff(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&Vc(s.buffer),e}const Bf=On("string"),at=On("function"),Hc=On("number"),Fn=s=>s!==null&&typeof s=="object",Df=s=>s===!0||s===!1,tn=s=>{if(An(s)!=="object")return!1;const e=Da(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Wc in s)&&!(Rn in s)},$f=Ct("Date"),zf=Ct("File"),Uf=Ct("Blob"),Wf=Ct("FileList"),Vf=s=>Fn(s)&&at(s.pipe),Hf=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||at(s.append)&&((e=An(s))==="formdata"||e==="object"&&at(s.toString)&&s.toString()==="[object FormData]"))},Yf=Ct("URLSearchParams"),[qf,Gf,Qf,Kf]=["ReadableStream","Request","Response","Headers"].map(Ct),Jf=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ji(s,e,{allOwnKeys:t=!1}={}){if(s===null||typeof s>"u")return;let n,r;if(typeof s!="object"&&(s=[s]),Ws(s))for(n=0,r=s.length;n<r;n++)e.call(null,s[n],n,s);else{const a=t?Object.getOwnPropertyNames(s):Object.keys(s),o=a.length;let l;for(n=0;n<o;n++)l=a[n],e.call(null,s[l],l,s)}}function Yc(s,e){e=e.toLowerCase();const t=Object.keys(s);let n=t.length,r;for(;n-- >0;)if(r=t[n],e===r.toLowerCase())return r;return null}const as=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,qc=s=>!gi(s)&&s!==as;function ua(){const{caseless:s}=qc(this)&&this||{},e={},t=(n,r)=>{const a=s&&Yc(e,r)||r;tn(e[a])&&tn(n)?e[a]=ua(e[a],n):tn(n)?e[a]=ua({},n):Ws(n)?e[a]=n.slice():e[a]=n};for(let n=0,r=arguments.length;n<r;n++)arguments[n]&&ji(arguments[n],t);return e}const Xf=(s,e,t,{allOwnKeys:n}={})=>(ji(e,(r,a)=>{t&&at(r)?s[a]=Uc(r,t):s[a]=r},{allOwnKeys:n}),s),Zf=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),ep=(s,e,t,n)=>{s.prototype=Object.create(e.prototype,n),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),t&&Object.assign(s.prototype,t)},tp=(s,e,t,n)=>{let r,a,o;const l={};if(e=e||{},s==null)return e;do{for(r=Object.getOwnPropertyNames(s),a=r.length;a-- >0;)o=r[a],(!n||n(o,s,e))&&!l[o]&&(e[o]=s[o],l[o]=!0);s=t!==!1&&Da(s)}while(s&&(!t||t(s,e))&&s!==Object.prototype);return e},sp=(s,e,t)=>{s=String(s),(t===void 0||t>s.length)&&(t=s.length),t-=e.length;const n=s.indexOf(e,t);return n!==-1&&n===t},ip=s=>{if(!s)return null;if(Ws(s))return s;let e=s.length;if(!Hc(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=s[e];return t},np=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&Da(Uint8Array)),rp=(s,e)=>{const n=(s&&s[Rn]).call(s);let r;for(;(r=n.next())&&!r.done;){const a=r.value;e.call(s,a[0],a[1])}},ap=(s,e)=>{let t;const n=[];for(;(t=s.exec(e))!==null;)n.push(t);return n},op=Ct("HTMLFormElement"),lp=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,r){return n.toUpperCase()+r}),$o=(({hasOwnProperty:s})=>(e,t)=>s.call(e,t))(Object.prototype),cp=Ct("RegExp"),Gc=(s,e)=>{const t=Object.getOwnPropertyDescriptors(s),n={};ji(t,(r,a)=>{let o;(o=e(r,a,s))!==!1&&(n[a]=o||r)}),Object.defineProperties(s,n)},hp=s=>{Gc(s,(e,t)=>{if(at(s)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=s[t];if(at(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},dp=(s,e)=>{const t={},n=r=>{r.forEach(a=>{t[a]=!0})};return Ws(s)?n(s):n(String(s).split(e)),t},up=()=>{},mp=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e;function fp(s){return!!(s&&at(s.append)&&s[Wc]==="FormData"&&s[Rn])}const pp=s=>{const e=new Array(10),t=(n,r)=>{if(Fn(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[r]=n;const a=Ws(n)?[]:{};return ji(n,(o,l)=>{const c=t(o,r+1);!gi(c)&&(a[l]=c)}),e[r]=void 0,a}}return n};return t(s,0)},gp=Ct("AsyncFunction"),yp=s=>s&&(Fn(s)||at(s))&&at(s.then)&&at(s.catch),Qc=((s,e)=>s?setImmediate:e?((t,n)=>(as.addEventListener("message",({source:r,data:a})=>{r===as&&a===t&&n.length&&n.shift()()},!1),r=>{n.push(r),as.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",at(as.postMessage)),vp=typeof queueMicrotask<"u"?queueMicrotask.bind(as):typeof process<"u"&&process.nextTick||Qc,xp=s=>s!=null&&at(s[Rn]),W={isArray:Ws,isArrayBuffer:Vc,isBuffer:Of,isFormData:Hf,isArrayBufferView:Ff,isString:Bf,isNumber:Hc,isBoolean:Df,isObject:Fn,isPlainObject:tn,isReadableStream:qf,isRequest:Gf,isResponse:Qf,isHeaders:Kf,isUndefined:gi,isDate:$f,isFile:zf,isBlob:Uf,isRegExp:cp,isFunction:at,isStream:Vf,isURLSearchParams:Yf,isTypedArray:np,isFileList:Wf,forEach:ji,merge:ua,extend:Xf,trim:Jf,stripBOM:Zf,inherits:ep,toFlatObject:tp,kindOf:An,kindOfTest:Ct,endsWith:sp,toArray:ip,forEachEntry:rp,matchAll:ap,isHTMLForm:op,hasOwnProperty:$o,hasOwnProp:$o,reduceDescriptors:Gc,freezeMethods:hp,toObjectSet:dp,toCamelCase:lp,noop:up,toFiniteNumber:mp,findKey:Yc,global:as,isContextDefined:qc,isSpecCompliantForm:fp,toJSONObject:pp,isAsyncFn:gp,isThenable:yp,setImmediate:Qc,asap:vp,isIterable:xp};function fe(s,e,t,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}W.inherits(fe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:W.toJSONObject(this.config),code:this.code,status:this.status}}});const Kc=fe.prototype,Jc={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{Jc[s]={value:s}});Object.defineProperties(fe,Jc);Object.defineProperty(Kc,"isAxiosError",{value:!0});fe.from=(s,e,t,n,r,a)=>{const o=Object.create(Kc);return W.toFlatObject(s,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),fe.call(o,s.message,e,t,n,r),o.cause=s,o.name=s.name,a&&Object.assign(o,a),o};const bp=null;function ma(s){return W.isPlainObject(s)||W.isArray(s)}function Xc(s){return W.endsWith(s,"[]")?s.slice(0,-2):s}function zo(s,e,t){return s?s.concat(e).map(function(r,a){return r=Xc(r),!t&&a?"["+r+"]":r}).join(t?".":""):e}function wp(s){return W.isArray(s)&&!s.some(ma)}const jp=W.toFlatObject(W,{},null,function(e){return/^is[A-Z]/.test(e)});function Bn(s,e,t){if(!W.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,t=W.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,f){return!W.isUndefined(f[g])});const n=t.metaTokens,r=t.visitor||d,a=t.dots,o=t.indexes,c=(t.Blob||typeof Blob<"u"&&Blob)&&W.isSpecCompliantForm(e);if(!W.isFunction(r))throw new TypeError("visitor must be a function");function h(p){if(p===null)return"";if(W.isDate(p))return p.toISOString();if(W.isBoolean(p))return p.toString();if(!c&&W.isBlob(p))throw new fe("Blob is not supported. Use a Buffer instead.");return W.isArrayBuffer(p)||W.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function d(p,g,f){let y=p;if(p&&!f&&typeof p=="object"){if(W.endsWith(g,"{}"))g=n?g:g.slice(0,-2),p=JSON.stringify(p);else if(W.isArray(p)&&wp(p)||(W.isFileList(p)||W.endsWith(g,"[]"))&&(y=W.toArray(p)))return g=Xc(g),y.forEach(function(k,C){!(W.isUndefined(k)||k===null)&&e.append(o===!0?zo([g],C,a):o===null?g:g+"[]",h(k))}),!1}return ma(p)?!0:(e.append(zo(f,g,a),h(p)),!1)}const m=[],x=Object.assign(jp,{defaultVisitor:d,convertValue:h,isVisitable:ma});function b(p,g){if(!W.isUndefined(p)){if(m.indexOf(p)!==-1)throw Error("Circular reference detected in "+g.join("."));m.push(p),W.forEach(p,function(y,S){(!(W.isUndefined(y)||y===null)&&r.call(e,y,W.isString(S)?S.trim():S,g,x))===!0&&b(y,g?g.concat(S):[S])}),m.pop()}}if(!W.isObject(s))throw new TypeError("data must be an object");return b(s),e}function Uo(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function $a(s,e){this._pairs=[],s&&Bn(s,this,e)}const Zc=$a.prototype;Zc.append=function(e,t){this._pairs.push([e,t])};Zc.toString=function(e){const t=e?function(n){return e.call(this,n,Uo)}:Uo;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function Sp(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function eh(s,e,t){if(!e)return s;const n=t&&t.encode||Sp;W.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let a;if(r?a=r(e,t):a=W.isURLSearchParams(e)?e.toString():new $a(e,t).toString(n),a){const o=s.indexOf("#");o!==-1&&(s=s.slice(0,o)),s+=(s.indexOf("?")===-1?"?":"&")+a}return s}class Wo{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){W.forEach(this.handlers,function(n){n!==null&&e(n)})}}const th={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Np=typeof URLSearchParams<"u"?URLSearchParams:$a,kp=typeof FormData<"u"?FormData:null,Cp=typeof Blob<"u"?Blob:null,Pp={isBrowser:!0,classes:{URLSearchParams:Np,FormData:kp,Blob:Cp},protocols:["http","https","file","blob","url","data"]},za=typeof window<"u"&&typeof document<"u",fa=typeof navigator=="object"&&navigator||void 0,Tp=za&&(!fa||["ReactNative","NativeScript","NS"].indexOf(fa.product)<0),Ep=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Ip=za&&window.location.href||"http://localhost",_p=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:za,hasStandardBrowserEnv:Tp,hasStandardBrowserWebWorkerEnv:Ep,navigator:fa,origin:Ip},Symbol.toStringTag,{value:"Module"})),Ke={..._p,...Pp};function Lp(s,e){return Bn(s,new Ke.classes.URLSearchParams,Object.assign({visitor:function(t,n,r,a){return Ke.isNode&&W.isBuffer(t)?(this.append(n,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function Mp(s){return W.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Rp(s){const e={},t=Object.keys(s);let n;const r=t.length;let a;for(n=0;n<r;n++)a=t[n],e[a]=s[a];return e}function sh(s){function e(t,n,r,a){let o=t[a++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=a>=t.length;return o=!o&&W.isArray(r)?r.length:o,c?(W.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!l):((!r[o]||!W.isObject(r[o]))&&(r[o]=[]),e(t,n,r[o],a)&&W.isArray(r[o])&&(r[o]=Rp(r[o])),!l)}if(W.isFormData(s)&&W.isFunction(s.entries)){const t={};return W.forEachEntry(s,(n,r)=>{e(Mp(n),r,t,0)}),t}return null}function Ap(s,e,t){if(W.isString(s))try{return(e||JSON.parse)(s),W.trim(s)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(s)}const Si={transitional:th,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,a=W.isObject(e);if(a&&W.isHTMLForm(e)&&(e=new FormData(e)),W.isFormData(e))return r?JSON.stringify(sh(e)):e;if(W.isArrayBuffer(e)||W.isBuffer(e)||W.isStream(e)||W.isFile(e)||W.isBlob(e)||W.isReadableStream(e))return e;if(W.isArrayBufferView(e))return e.buffer;if(W.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Lp(e,this.formSerializer).toString();if((l=W.isFileList(e))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return Bn(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return a||r?(t.setContentType("application/json",!1),Ap(e)):e}],transformResponse:[function(e){const t=this.transitional||Si.transitional,n=t&&t.forcedJSONParsing,r=this.responseType==="json";if(W.isResponse(e)||W.isReadableStream(e))return e;if(e&&W.isString(e)&&(n&&!this.responseType||r)){const o=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?fe.from(l,fe.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ke.classes.FormData,Blob:Ke.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};W.forEach(["delete","get","head","post","put","patch"],s=>{Si.headers[s]={}});const Op=W.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Fp=s=>{const e={};let t,n,r;return s&&s.split(`
`).forEach(function(o){r=o.indexOf(":"),t=o.substring(0,r).trim().toLowerCase(),n=o.substring(r+1).trim(),!(!t||e[t]&&Op[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e},Vo=Symbol("internals");function Ks(s){return s&&String(s).trim().toLowerCase()}function sn(s){return s===!1||s==null?s:W.isArray(s)?s.map(sn):String(s)}function Bp(s){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(s);)e[n[1]]=n[2];return e}const Dp=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function xr(s,e,t,n,r){if(W.isFunction(n))return n.call(this,e,t);if(r&&(e=t),!!W.isString(e)){if(W.isString(n))return e.indexOf(n)!==-1;if(W.isRegExp(n))return n.test(e)}}function $p(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function zp(s,e){const t=W.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(s,n+t,{value:function(r,a,o){return this[n].call(this,e,r,a,o)},configurable:!0})})}let ot=class{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function a(l,c,h){const d=Ks(c);if(!d)throw new Error("header name must be a non-empty string");const m=W.findKey(r,d);(!m||r[m]===void 0||h===!0||h===void 0&&r[m]!==!1)&&(r[m||c]=sn(l))}const o=(l,c)=>W.forEach(l,(h,d)=>a(h,d,c));if(W.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(W.isString(e)&&(e=e.trim())&&!Dp(e))o(Fp(e),t);else if(W.isObject(e)&&W.isIterable(e)){let l={},c,h;for(const d of e){if(!W.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[h=d[0]]=(c=l[h])?W.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,t)}else e!=null&&a(t,e,n);return this}get(e,t){if(e=Ks(e),e){const n=W.findKey(this,e);if(n){const r=this[n];if(!t)return r;if(t===!0)return Bp(r);if(W.isFunction(t))return t.call(this,r,n);if(W.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ks(e),e){const n=W.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||xr(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let r=!1;function a(o){if(o=Ks(o),o){const l=W.findKey(n,o);l&&(!t||xr(n,n[l],l,t))&&(delete n[l],r=!0)}}return W.isArray(e)?e.forEach(a):a(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const a=t[n];(!e||xr(this,this[a],a,e,!0))&&(delete this[a],r=!0)}return r}normalize(e){const t=this,n={};return W.forEach(this,(r,a)=>{const o=W.findKey(n,a);if(o){t[o]=sn(r),delete t[a];return}const l=e?$p(a):String(a).trim();l!==a&&delete t[a],t[l]=sn(r),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return W.forEach(this,(n,r)=>{n!=null&&n!==!1&&(t[r]=e&&W.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(r=>n.set(r)),n}static accessor(e){const n=(this[Vo]=this[Vo]={accessors:{}}).accessors,r=this.prototype;function a(o){const l=Ks(o);n[l]||(zp(r,o),n[l]=!0)}return W.isArray(e)?e.forEach(a):a(e),this}};ot.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);W.reduceDescriptors(ot.prototype,({value:s},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(n){this[t]=n}}});W.freezeMethods(ot);function br(s,e){const t=this||Si,n=e||t,r=ot.from(n.headers);let a=n.data;return W.forEach(s,function(l){a=l.call(t,a,r.normalize(),e?e.status:void 0)}),r.normalize(),a}function ih(s){return!!(s&&s.__CANCEL__)}function Vs(s,e,t){fe.call(this,s??"canceled",fe.ERR_CANCELED,e,t),this.name="CanceledError"}W.inherits(Vs,fe,{__CANCEL__:!0});function nh(s,e,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?s(t):e(new fe("Request failed with status code "+t.status,[fe.ERR_BAD_REQUEST,fe.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Up(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function Wp(s,e){s=s||10;const t=new Array(s),n=new Array(s);let r=0,a=0,o;return e=e!==void 0?e:1e3,function(c){const h=Date.now(),d=n[a];o||(o=h),t[r]=c,n[r]=h;let m=a,x=0;for(;m!==r;)x+=t[m++],m=m%s;if(r=(r+1)%s,r===a&&(a=(a+1)%s),h-o<e)return;const b=d&&h-d;return b?Math.round(x*1e3/b):void 0}}function Vp(s,e){let t=0,n=1e3/e,r,a;const o=(h,d=Date.now())=>{t=d,r=null,a&&(clearTimeout(a),a=null),s.apply(null,h)};return[(...h)=>{const d=Date.now(),m=d-t;m>=n?o(h,d):(r=h,a||(a=setTimeout(()=>{a=null,o(r)},n-m)))},()=>r&&o(r)]}const un=(s,e,t=3)=>{let n=0;const r=Wp(50,250);return Vp(a=>{const o=a.loaded,l=a.lengthComputable?a.total:void 0,c=o-n,h=r(c),d=o<=l;n=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:h||void 0,estimated:h&&l&&d?(l-o)/h:void 0,event:a,lengthComputable:l!=null,[e?"download":"upload"]:!0};s(m)},t)},Ho=(s,e)=>{const t=s!=null;return[n=>e[0]({lengthComputable:t,total:s,loaded:n}),e[1]]},Yo=s=>(...e)=>W.asap(()=>s(...e)),Hp=Ke.hasStandardBrowserEnv?((s,e)=>t=>(t=new URL(t,Ke.origin),s.protocol===t.protocol&&s.host===t.host&&(e||s.port===t.port)))(new URL(Ke.origin),Ke.navigator&&/(msie|trident)/i.test(Ke.navigator.userAgent)):()=>!0,Yp=Ke.hasStandardBrowserEnv?{write(s,e,t,n,r,a){const o=[s+"="+encodeURIComponent(e)];W.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),W.isString(n)&&o.push("path="+n),W.isString(r)&&o.push("domain="+r),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(s){const e=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function qp(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function Gp(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function rh(s,e,t){let n=!qp(e);return s&&(n||t==!1)?Gp(s,e):e}const qo=s=>s instanceof ot?{...s}:s;function gs(s,e){e=e||{};const t={};function n(h,d,m,x){return W.isPlainObject(h)&&W.isPlainObject(d)?W.merge.call({caseless:x},h,d):W.isPlainObject(d)?W.merge({},d):W.isArray(d)?d.slice():d}function r(h,d,m,x){if(W.isUndefined(d)){if(!W.isUndefined(h))return n(void 0,h,m,x)}else return n(h,d,m,x)}function a(h,d){if(!W.isUndefined(d))return n(void 0,d)}function o(h,d){if(W.isUndefined(d)){if(!W.isUndefined(h))return n(void 0,h)}else return n(void 0,d)}function l(h,d,m){if(m in e)return n(h,d);if(m in s)return n(void 0,h)}const c={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(h,d,m)=>r(qo(h),qo(d),m,!0)};return W.forEach(Object.keys(Object.assign({},s,e)),function(d){const m=c[d]||r,x=m(s[d],e[d],d);W.isUndefined(x)&&m!==l||(t[d]=x)}),t}const ah=s=>{const e=gs({},s);let{data:t,withXSRFToken:n,xsrfHeaderName:r,xsrfCookieName:a,headers:o,auth:l}=e;e.headers=o=ot.from(o),e.url=eh(rh(e.baseURL,e.url,e.allowAbsoluteUrls),s.params,s.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(W.isFormData(t)){if(Ke.hasStandardBrowserEnv||Ke.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[h,...d]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([h||"multipart/form-data",...d].join("; "))}}if(Ke.hasStandardBrowserEnv&&(n&&W.isFunction(n)&&(n=n(e)),n||n!==!1&&Hp(e.url))){const h=r&&a&&Yp.read(a);h&&o.set(r,h)}return e},Qp=typeof XMLHttpRequest<"u",Kp=Qp&&function(s){return new Promise(function(t,n){const r=ah(s);let a=r.data;const o=ot.from(r.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:h}=r,d,m,x,b,p;function g(){b&&b(),p&&p(),r.cancelToken&&r.cancelToken.unsubscribe(d),r.signal&&r.signal.removeEventListener("abort",d)}let f=new XMLHttpRequest;f.open(r.method.toUpperCase(),r.url,!0),f.timeout=r.timeout;function y(){if(!f)return;const k=ot.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders()),N={data:!l||l==="text"||l==="json"?f.responseText:f.response,status:f.status,statusText:f.statusText,headers:k,config:s,request:f};nh(function(I){t(I),g()},function(I){n(I),g()},N),f=null}"onloadend"in f?f.onloadend=y:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(y)},f.onabort=function(){f&&(n(new fe("Request aborted",fe.ECONNABORTED,s,f)),f=null)},f.onerror=function(){n(new fe("Network Error",fe.ERR_NETWORK,s,f)),f=null},f.ontimeout=function(){let C=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const N=r.transitional||th;r.timeoutErrorMessage&&(C=r.timeoutErrorMessage),n(new fe(C,N.clarifyTimeoutError?fe.ETIMEDOUT:fe.ECONNABORTED,s,f)),f=null},a===void 0&&o.setContentType(null),"setRequestHeader"in f&&W.forEach(o.toJSON(),function(C,N){f.setRequestHeader(N,C)}),W.isUndefined(r.withCredentials)||(f.withCredentials=!!r.withCredentials),l&&l!=="json"&&(f.responseType=r.responseType),h&&([x,p]=un(h,!0),f.addEventListener("progress",x)),c&&f.upload&&([m,b]=un(c),f.upload.addEventListener("progress",m),f.upload.addEventListener("loadend",b)),(r.cancelToken||r.signal)&&(d=k=>{f&&(n(!k||k.type?new Vs(null,s,f):k),f.abort(),f=null)},r.cancelToken&&r.cancelToken.subscribe(d),r.signal&&(r.signal.aborted?d():r.signal.addEventListener("abort",d)));const S=Up(r.url);if(S&&Ke.protocols.indexOf(S)===-1){n(new fe("Unsupported protocol "+S+":",fe.ERR_BAD_REQUEST,s));return}f.send(a||null)})},Jp=(s,e)=>{const{length:t}=s=s?s.filter(Boolean):[];if(e||t){let n=new AbortController,r;const a=function(h){if(!r){r=!0,l();const d=h instanceof Error?h:this.reason;n.abort(d instanceof fe?d:new Vs(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,a(new fe(`timeout ${e} of ms exceeded`,fe.ETIMEDOUT))},e);const l=()=>{s&&(o&&clearTimeout(o),o=null,s.forEach(h=>{h.unsubscribe?h.unsubscribe(a):h.removeEventListener("abort",a)}),s=null)};s.forEach(h=>h.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>W.asap(l),c}},Xp=function*(s,e){let t=s.byteLength;if(t<e){yield s;return}let n=0,r;for(;n<t;)r=n+e,yield s.slice(n,r),n=r},Zp=async function*(s,e){for await(const t of eg(s))yield*Xp(t,e)},eg=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;yield n}}finally{await e.cancel()}},Go=(s,e,t,n)=>{const r=Zp(s,e);let a=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:h,value:d}=await r.next();if(h){l(),c.close();return}let m=d.byteLength;if(t){let x=a+=m;t(x)}c.enqueue(new Uint8Array(d))}catch(h){throw l(h),h}},cancel(c){return l(c),r.return()}},{highWaterMark:2})},Dn=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",oh=Dn&&typeof ReadableStream=="function",tg=Dn&&(typeof TextEncoder=="function"?(s=>e=>s.encode(e))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),lh=(s,...e)=>{try{return!!s(...e)}catch{return!1}},sg=oh&&lh(()=>{let s=!1;const e=new Request(Ke.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!e}),Qo=64*1024,pa=oh&&lh(()=>W.isReadableStream(new Response("").body)),mn={stream:pa&&(s=>s.body)};Dn&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!mn[e]&&(mn[e]=W.isFunction(s[e])?t=>t[e]():(t,n)=>{throw new fe(`Response type '${e}' is not supported`,fe.ERR_NOT_SUPPORT,n)})})})(new Response);const ig=async s=>{if(s==null)return 0;if(W.isBlob(s))return s.size;if(W.isSpecCompliantForm(s))return(await new Request(Ke.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(W.isArrayBufferView(s)||W.isArrayBuffer(s))return s.byteLength;if(W.isURLSearchParams(s)&&(s=s+""),W.isString(s))return(await tg(s)).byteLength},ng=async(s,e)=>{const t=W.toFiniteNumber(s.getContentLength());return t??ig(e)},rg=Dn&&(async s=>{let{url:e,method:t,data:n,signal:r,cancelToken:a,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:h,headers:d,withCredentials:m="same-origin",fetchOptions:x}=ah(s);h=h?(h+"").toLowerCase():"text";let b=Jp([r,a&&a.toAbortSignal()],o),p;const g=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let f;try{if(c&&sg&&t!=="get"&&t!=="head"&&(f=await ng(d,n))!==0){let N=new Request(e,{method:"POST",body:n,duplex:"half"}),T;if(W.isFormData(n)&&(T=N.headers.get("content-type"))&&d.setContentType(T),N.body){const[I,P]=Ho(f,un(Yo(c)));n=Go(N.body,Qo,I,P)}}W.isString(m)||(m=m?"include":"omit");const y="credentials"in Request.prototype;p=new Request(e,{...x,signal:b,method:t.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:y?m:void 0});let S=await fetch(p,x);const k=pa&&(h==="stream"||h==="response");if(pa&&(l||k&&g)){const N={};["status","statusText","headers"].forEach(L=>{N[L]=S[L]});const T=W.toFiniteNumber(S.headers.get("content-length")),[I,P]=l&&Ho(T,un(Yo(l),!0))||[];S=new Response(Go(S.body,Qo,I,()=>{P&&P(),g&&g()}),N)}h=h||"text";let C=await mn[W.findKey(mn,h)||"text"](S,s);return!k&&g&&g(),await new Promise((N,T)=>{nh(N,T,{data:C,headers:ot.from(S.headers),status:S.status,statusText:S.statusText,config:s,request:p})})}catch(y){throw g&&g(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new fe("Network Error",fe.ERR_NETWORK,s,p),{cause:y.cause||y}):fe.from(y,y&&y.code,s,p)}}),ga={http:bp,xhr:Kp,fetch:rg};W.forEach(ga,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e})}catch{}Object.defineProperty(s,"adapterName",{value:e})}});const Ko=s=>`- ${s}`,ag=s=>W.isFunction(s)||s===null||s===!1,ch={getAdapter:s=>{s=W.isArray(s)?s:[s];const{length:e}=s;let t,n;const r={};for(let a=0;a<e;a++){t=s[a];let o;if(n=t,!ag(t)&&(n=ga[(o=String(t)).toLowerCase()],n===void 0))throw new fe(`Unknown adapter '${o}'`);if(n)break;r[o||"#"+a]=n}if(!n){const a=Object.entries(r).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=e?a.length>1?`since :
`+a.map(Ko).join(`
`):" "+Ko(a[0]):"as no adapter specified";throw new fe("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:ga};function wr(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new Vs(null,s)}function Jo(s){return wr(s),s.headers=ot.from(s.headers),s.data=br.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),ch.getAdapter(s.adapter||Si.adapter)(s).then(function(n){return wr(s),n.data=br.call(s,s.transformResponse,n),n.headers=ot.from(n.headers),n},function(n){return ih(n)||(wr(s),n&&n.response&&(n.response.data=br.call(s,s.transformResponse,n.response),n.response.headers=ot.from(n.response.headers))),Promise.reject(n)})}const hh="1.10.0",$n={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{$n[s]=function(n){return typeof n===s||"a"+(e<1?"n ":" ")+s}});const Xo={};$n.transitional=function(e,t,n){function r(a,o){return"[Axios v"+hh+"] Transitional option '"+a+"'"+o+(n?". "+n:"")}return(a,o,l)=>{if(e===!1)throw new fe(r(o," has been removed"+(t?" in "+t:"")),fe.ERR_DEPRECATED);return t&&!Xo[o]&&(Xo[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,o,l):!0}};$n.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function og(s,e,t){if(typeof s!="object")throw new fe("options must be an object",fe.ERR_BAD_OPTION_VALUE);const n=Object.keys(s);let r=n.length;for(;r-- >0;){const a=n[r],o=e[a];if(o){const l=s[a],c=l===void 0||o(l,a,s);if(c!==!0)throw new fe("option "+a+" must be "+c,fe.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new fe("Unknown option "+a,fe.ERR_BAD_OPTION)}}const nn={assertOptions:og,validators:$n},Pt=nn.validators;let ds=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Wo,response:new Wo}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const a=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=gs(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:a}=t;n!==void 0&&nn.assertOptions(n,{silentJSONParsing:Pt.transitional(Pt.boolean),forcedJSONParsing:Pt.transitional(Pt.boolean),clarifyTimeoutError:Pt.transitional(Pt.boolean)},!1),r!=null&&(W.isFunction(r)?t.paramsSerializer={serialize:r}:nn.assertOptions(r,{encode:Pt.function,serialize:Pt.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),nn.assertOptions(t,{baseUrl:Pt.spelling("baseURL"),withXsrfToken:Pt.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=a&&W.merge(a.common,a[t.method]);a&&W.forEach(["delete","get","head","post","put","patch","common"],p=>{delete a[p]}),t.headers=ot.concat(o,a);const l=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(c=c&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const h=[];this.interceptors.response.forEach(function(g){h.push(g.fulfilled,g.rejected)});let d,m=0,x;if(!c){const p=[Jo.bind(this),void 0];for(p.unshift.apply(p,l),p.push.apply(p,h),x=p.length,d=Promise.resolve(t);m<x;)d=d.then(p[m++],p[m++]);return d}x=l.length;let b=t;for(m=0;m<x;){const p=l[m++],g=l[m++];try{b=p(b)}catch(f){g.call(this,f);break}}try{d=Jo.call(this,b)}catch(p){return Promise.reject(p)}for(m=0,x=h.length;m<x;)d=d.then(h[m++],h[m++]);return d}getUri(e){e=gs(this.defaults,e);const t=rh(e.baseURL,e.url,e.allowAbsoluteUrls);return eh(t,e.params,e.paramsSerializer)}};W.forEach(["delete","get","head","options"],function(e){ds.prototype[e]=function(t,n){return this.request(gs(n||{},{method:e,url:t,data:(n||{}).data}))}});W.forEach(["post","put","patch"],function(e){function t(n){return function(a,o,l){return this.request(gs(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}ds.prototype[e]=t(),ds.prototype[e+"Form"]=t(!0)});let lg=class dh{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const n=this;this.promise.then(r=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](r);n._listeners=null}),this.promise.then=r=>{let a;const o=new Promise(l=>{n.subscribe(l),a=l}).then(r);return o.cancel=function(){n.unsubscribe(a)},o},e(function(a,o,l){n.reason||(n.reason=new Vs(a,o,l),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=n=>{e.abort(n)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new dh(function(r){e=r}),cancel:e}}};function cg(s){return function(t){return s.apply(null,t)}}function hg(s){return W.isObject(s)&&s.isAxiosError===!0}const ya={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ya).forEach(([s,e])=>{ya[e]=s});function uh(s){const e=new ds(s),t=Uc(ds.prototype.request,e);return W.extend(t,ds.prototype,e,{allOwnKeys:!0}),W.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return uh(gs(s,r))},t}const xe=uh(Si);xe.Axios=ds;xe.CanceledError=Vs;xe.CancelToken=lg;xe.isCancel=ih;xe.VERSION=hh;xe.toFormData=Bn;xe.AxiosError=fe;xe.Cancel=xe.CanceledError;xe.all=function(e){return Promise.all(e)};xe.spread=cg;xe.isAxiosError=hg;xe.mergeConfig=gs;xe.AxiosHeaders=ot;xe.formToJSON=s=>sh(W.isHTMLForm(s)?new FormData(s):s);xe.getAdapter=ch.getAdapter;xe.HttpStatusCode=ya;xe.default=xe;const{Axios:n1,AxiosError:r1,CanceledError:a1,isCancel:o1,CancelToken:l1,VERSION:c1,all:h1,Cancel:d1,isAxiosError:u1,spread:m1,toFormData:f1,AxiosHeaders:p1,HttpStatusCode:g1,formToJSON:y1,getAdapter:v1,mergeConfig:x1}=xe;var mh={exports:{}};/*!
 * Pusher JavaScript Library v8.4.0
 * https://pusher.com/
 *
 * Copyright 2020, Pusher
 * Released under the MIT licence.
 */(function(s,e){(function(n,r){s.exports=r()})(window,function(){return function(t){var n={};function r(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=n,r.d=function(a,o,l){r.o(a,o)||Object.defineProperty(a,o,{enumerable:!0,get:l})},r.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},r.t=function(a,o){if(o&1&&(a=r(a)),o&8||o&4&&typeof a=="object"&&a&&a.__esModule)return a;var l=Object.create(null);if(r.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:a}),o&2&&typeof a!="string")for(var c in a)r.d(l,c,(function(h){return a[h]}).bind(null,c));return l},r.n=function(a){var o=a&&a.__esModule?function(){return a.default}:function(){return a};return r.d(o,"a",o),o},r.o=function(a,o){return Object.prototype.hasOwnProperty.call(a,o)},r.p="",r(r.s=2)}([function(t,n,r){var a=this&&this.__extends||function(){var g=function(f,y){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,k){S.__proto__=k}||function(S,k){for(var C in k)k.hasOwnProperty(C)&&(S[C]=k[C])},g(f,y)};return function(f,y){g(f,y);function S(){this.constructor=f}f.prototype=y===null?Object.create(y):(S.prototype=y.prototype,new S)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=256,l=function(){function g(f){f===void 0&&(f="="),this._paddingCharacter=f}return g.prototype.encodedLength=function(f){return this._paddingCharacter?(f+2)/3*4|0:(f*8+5)/6|0},g.prototype.encode=function(f){for(var y="",S=0;S<f.length-2;S+=3){var k=f[S]<<16|f[S+1]<<8|f[S+2];y+=this._encodeByte(k>>>3*6&63),y+=this._encodeByte(k>>>2*6&63),y+=this._encodeByte(k>>>1*6&63),y+=this._encodeByte(k>>>0*6&63)}var C=f.length-S;if(C>0){var k=f[S]<<16|(C===2?f[S+1]<<8:0);y+=this._encodeByte(k>>>3*6&63),y+=this._encodeByte(k>>>2*6&63),C===2?y+=this._encodeByte(k>>>1*6&63):y+=this._paddingCharacter||"",y+=this._paddingCharacter||""}return y},g.prototype.maxDecodedLength=function(f){return this._paddingCharacter?f/4*3|0:(f*6+7)/8|0},g.prototype.decodedLength=function(f){return this.maxDecodedLength(f.length-this._getPaddingLength(f))},g.prototype.decode=function(f){if(f.length===0)return new Uint8Array(0);for(var y=this._getPaddingLength(f),S=f.length-y,k=new Uint8Array(this.maxDecodedLength(S)),C=0,N=0,T=0,I=0,P=0,L=0,M=0;N<S-4;N+=4)I=this._decodeChar(f.charCodeAt(N+0)),P=this._decodeChar(f.charCodeAt(N+1)),L=this._decodeChar(f.charCodeAt(N+2)),M=this._decodeChar(f.charCodeAt(N+3)),k[C++]=I<<2|P>>>4,k[C++]=P<<4|L>>>2,k[C++]=L<<6|M,T|=I&o,T|=P&o,T|=L&o,T|=M&o;if(N<S-1&&(I=this._decodeChar(f.charCodeAt(N)),P=this._decodeChar(f.charCodeAt(N+1)),k[C++]=I<<2|P>>>4,T|=I&o,T|=P&o),N<S-2&&(L=this._decodeChar(f.charCodeAt(N+2)),k[C++]=P<<4|L>>>2,T|=L&o),N<S-3&&(M=this._decodeChar(f.charCodeAt(N+3)),k[C++]=L<<6|M,T|=M&o),T!==0)throw new Error("Base64Coder: incorrect characters for decoding");return k},g.prototype._encodeByte=function(f){var y=f;return y+=65,y+=25-f>>>8&6,y+=51-f>>>8&-75,y+=61-f>>>8&-15,y+=62-f>>>8&3,String.fromCharCode(y)},g.prototype._decodeChar=function(f){var y=o;return y+=(42-f&f-44)>>>8&-o+f-43+62,y+=(46-f&f-48)>>>8&-o+f-47+63,y+=(47-f&f-58)>>>8&-o+f-48+52,y+=(64-f&f-91)>>>8&-o+f-65+0,y+=(96-f&f-123)>>>8&-o+f-97+26,y},g.prototype._getPaddingLength=function(f){var y=0;if(this._paddingCharacter){for(var S=f.length-1;S>=0&&f[S]===this._paddingCharacter;S--)y++;if(f.length<4||y>2)throw new Error("Base64Coder: incorrect padding")}return y},g}();n.Coder=l;var c=new l;function h(g){return c.encode(g)}n.encode=h;function d(g){return c.decode(g)}n.decode=d;var m=function(g){a(f,g);function f(){return g!==null&&g.apply(this,arguments)||this}return f.prototype._encodeByte=function(y){var S=y;return S+=65,S+=25-y>>>8&6,S+=51-y>>>8&-75,S+=61-y>>>8&-13,S+=62-y>>>8&49,String.fromCharCode(S)},f.prototype._decodeChar=function(y){var S=o;return S+=(44-y&y-46)>>>8&-o+y-45+62,S+=(94-y&y-96)>>>8&-o+y-95+63,S+=(47-y&y-58)>>>8&-o+y-48+52,S+=(64-y&y-91)>>>8&-o+y-65+0,S+=(96-y&y-123)>>>8&-o+y-97+26,S},f}(l);n.URLSafeCoder=m;var x=new m;function b(g){return x.encode(g)}n.encodeURLSafe=b;function p(g){return x.decode(g)}n.decodeURLSafe=p,n.encodedLength=function(g){return c.encodedLength(g)},n.maxDecodedLength=function(g){return c.maxDecodedLength(g)},n.decodedLength=function(g){return c.decodedLength(g)}},function(t,n,r){Object.defineProperty(n,"__esModule",{value:!0});var a="utf8: invalid string",o="utf8: invalid source encoding";function l(d){for(var m=new Uint8Array(c(d)),x=0,b=0;b<d.length;b++){var p=d.charCodeAt(b);p<128?m[x++]=p:p<2048?(m[x++]=192|p>>6,m[x++]=128|p&63):p<55296?(m[x++]=224|p>>12,m[x++]=128|p>>6&63,m[x++]=128|p&63):(b++,p=(p&1023)<<10,p|=d.charCodeAt(b)&1023,p+=65536,m[x++]=240|p>>18,m[x++]=128|p>>12&63,m[x++]=128|p>>6&63,m[x++]=128|p&63)}return m}n.encode=l;function c(d){for(var m=0,x=0;x<d.length;x++){var b=d.charCodeAt(x);if(b<128)m+=1;else if(b<2048)m+=2;else if(b<55296)m+=3;else if(b<=57343){if(x>=d.length-1)throw new Error(a);x++,m+=4}else throw new Error(a)}return m}n.encodedLength=c;function h(d){for(var m=[],x=0;x<d.length;x++){var b=d[x];if(b&128){var p=void 0;if(b<224){if(x>=d.length)throw new Error(o);var g=d[++x];if((g&192)!==128)throw new Error(o);b=(b&31)<<6|g&63,p=128}else if(b<240){if(x>=d.length-1)throw new Error(o);var g=d[++x],f=d[++x];if((g&192)!==128||(f&192)!==128)throw new Error(o);b=(b&15)<<12|(g&63)<<6|f&63,p=2048}else if(b<248){if(x>=d.length-2)throw new Error(o);var g=d[++x],f=d[++x],y=d[++x];if((g&192)!==128||(f&192)!==128||(y&192)!==128)throw new Error(o);b=(b&15)<<18|(g&63)<<12|(f&63)<<6|y&63,p=65536}else throw new Error(o);if(b<p||b>=55296&&b<=57343)throw new Error(o);if(b>=65536){if(b>1114111)throw new Error(o);b-=65536,m.push(String.fromCharCode(55296|b>>10)),b=56320|b&1023}}m.push(String.fromCharCode(b))}return m.join("")}n.decode=h},function(t,n,r){t.exports=r(3).default},function(t,n,r){r.r(n);class a{constructor(u,w){this.lastId=0,this.prefix=u,this.name=w}create(u){this.lastId++;var w=this.lastId,E=this.prefix+w,_=this.name+"["+w+"]",H=!1,J=function(){H||(u.apply(null,arguments),H=!0)};return this[w]=J,{number:w,id:E,name:_,callback:J}}remove(u){delete this[u.number]}}var o=new a("_pusher_script_","Pusher.ScriptReceivers"),l={VERSION:"8.4.0",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},c=l;class h{constructor(u){this.options=u,this.receivers=u.receivers||o,this.loading={}}load(u,w,E){var _=this;if(_.loading[u]&&_.loading[u].length>0)_.loading[u].push(E);else{_.loading[u]=[E];var H=me.createScriptRequest(_.getPath(u,w)),J=_.receivers.create(function(se){if(_.receivers.remove(J),_.loading[u]){var he=_.loading[u];delete _.loading[u];for(var ve=function(De){De||H.cleanup()},we=0;we<he.length;we++)he[we](se,ve)}});H.send(J)}}getRoot(u){var w,E=me.getDocument().location.protocol;return u&&u.useTLS||E==="https:"?w=this.options.cdn_https:w=this.options.cdn_http,w.replace(/\/*$/,"")+"/"+this.options.version}getPath(u,w){return this.getRoot(w)+"/"+u+this.options.suffix+".js"}}var d=new a("_pusher_dependencies","Pusher.DependenciesReceivers"),m=new h({cdn_http:c.cdn_http,cdn_https:c.cdn_https,version:c.VERSION,suffix:c.dependency_suffix,receivers:d});const x={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}};var p={buildLogSuffix:function(j){const u="See:",w=x.urls[j];if(!w)return"";let E;return w.fullUrl?E=w.fullUrl:w.path&&(E=x.baseUrl+w.path),E?`${u} ${E}`:""}},g;(function(j){j.UserAuthentication="user-authentication",j.ChannelAuthorization="channel-authorization"})(g||(g={}));class f extends Error{constructor(u){super(u),Object.setPrototypeOf(this,new.target.prototype)}}class y extends Error{constructor(u){super(u),Object.setPrototypeOf(this,new.target.prototype)}}class S extends Error{constructor(u){super(u),Object.setPrototypeOf(this,new.target.prototype)}}class k extends Error{constructor(u){super(u),Object.setPrototypeOf(this,new.target.prototype)}}class C extends Error{constructor(u){super(u),Object.setPrototypeOf(this,new.target.prototype)}}class N extends Error{constructor(u){super(u),Object.setPrototypeOf(this,new.target.prototype)}}class T extends Error{constructor(u){super(u),Object.setPrototypeOf(this,new.target.prototype)}}class I extends Error{constructor(u){super(u),Object.setPrototypeOf(this,new.target.prototype)}}class P extends Error{constructor(u,w){super(w),this.status=u,Object.setPrototypeOf(this,new.target.prototype)}}var M=function(j,u,w,E,_){const H=me.createXHR();H.open("POST",w.endpoint,!0),H.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var J in w.headers)H.setRequestHeader(J,w.headers[J]);if(w.headersProvider!=null){let se=w.headersProvider();for(var J in se)H.setRequestHeader(J,se[J])}return H.onreadystatechange=function(){if(H.readyState===4)if(H.status===200){let se,he=!1;try{se=JSON.parse(H.responseText),he=!0}catch{_(new P(200,`JSON returned from ${E.toString()} endpoint was invalid, yet status code was 200. Data was: ${H.responseText}`),null)}he&&_(null,se)}else{let se="";switch(E){case g.UserAuthentication:se=p.buildLogSuffix("authenticationEndpoint");break;case g.ChannelAuthorization:se=`Clients must be authorized to join private or presence channels. ${p.buildLogSuffix("authorizationEndpoint")}`;break}_(new P(H.status,`Unable to retrieve auth string from ${E.toString()} endpoint - received status: ${H.status} from ${w.endpoint}. ${se}`),null)}},H.send(u),H};function O(j){return q(V(j))}var B=String.fromCharCode,R="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A=function(j){var u=j.charCodeAt(0);return u<128?j:u<2048?B(192|u>>>6)+B(128|u&63):B(224|u>>>12&15)+B(128|u>>>6&63)+B(128|u&63)},V=function(j){return j.replace(/[^\x00-\x7F]/g,A)},z=function(j){var u=[0,2,1][j.length%3],w=j.charCodeAt(0)<<16|(j.length>1?j.charCodeAt(1):0)<<8|(j.length>2?j.charCodeAt(2):0),E=[R.charAt(w>>>18),R.charAt(w>>>12&63),u>=2?"=":R.charAt(w>>>6&63),u>=1?"=":R.charAt(w&63)];return E.join("")},q=window.btoa||function(j){return j.replace(/[\s\S]{1,3}/g,z)};class Y{constructor(u,w,E,_){this.clear=w,this.timer=u(()=>{this.timer&&(this.timer=_(this.timer))},E)}isRunning(){return this.timer!==null}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}}var te=Y;function ne(j){window.clearTimeout(j)}function re(j){window.clearInterval(j)}class oe extends te{constructor(u,w){super(setTimeout,ne,u,function(E){return w(),null})}}class ie extends te{constructor(u,w){super(setInterval,re,u,function(E){return w(),E})}}var D={now(){return Date.now?Date.now():new Date().valueOf()},defer(j){return new oe(0,j)},method(j,...u){var w=Array.prototype.slice.call(arguments,1);return function(E){return E[j].apply(E,w.concat(arguments))}}},$=D;function U(j,...u){for(var w=0;w<u.length;w++){var E=u[w];for(var _ in E)E[_]&&E[_].constructor&&E[_].constructor===Object?j[_]=U(j[_]||{},E[_]):j[_]=E[_]}return j}function X(){for(var j=["Pusher"],u=0;u<arguments.length;u++)typeof arguments[u]=="string"?j.push(arguments[u]):j.push(pt(arguments[u]));return j.join(" : ")}function ce(j,u){var w=Array.prototype.indexOf;if(j===null)return-1;if(w&&j.indexOf===w)return j.indexOf(u);for(var E=0,_=j.length;E<_;E++)if(j[E]===u)return E;return-1}function ye(j,u){for(var w in j)Object.prototype.hasOwnProperty.call(j,w)&&u(j[w],w,j)}function pe(j){var u=[];return ye(j,function(w,E){u.push(E)}),u}function Ae(j){var u=[];return ye(j,function(w){u.push(w)}),u}function le(j,u,w){for(var E=0;E<j.length;E++)u.call(w||window,j[E],E,j)}function Qe(j,u){for(var w=[],E=0;E<j.length;E++)w.push(u(j[E],E,j,w));return w}function Cs(j,u){var w={};return ye(j,function(E,_){w[_]=u(E)}),w}function Qt(j,u){u=u||function(_){return!!_};for(var w=[],E=0;E<j.length;E++)u(j[E],E,j,w)&&w.push(j[E]);return w}function Xe(j,u){var w={};return ye(j,function(E,_){(u&&u(E,_,j,w)||E)&&(w[_]=E)}),w}function ee(j){var u=[];return ye(j,function(w,E){u.push([E,w])}),u}function de(j,u){for(var w=0;w<j.length;w++)if(u(j[w],w,j))return!0;return!1}function ke(j,u){for(var w=0;w<j.length;w++)if(!u(j[w],w,j))return!1;return!0}function Oe(j){return Cs(j,function(u){return typeof u=="object"&&(u=pt(u)),encodeURIComponent(O(u.toString()))})}function ue(j){var u=Xe(j,function(E){return E!==void 0}),w=Qe(ee(Oe(u)),$.method("join","=")).join("&");return w}function Fe(j){var u=[],w=[];return function E(_,H){var J,se,he;switch(typeof _){case"object":if(!_)return null;for(J=0;J<u.length;J+=1)if(u[J]===_)return{$ref:w[J]};if(u.push(_),w.push(H),Object.prototype.toString.apply(_)==="[object Array]")for(he=[],J=0;J<_.length;J+=1)he[J]=E(_[J],H+"["+J+"]");else{he={};for(se in _)Object.prototype.hasOwnProperty.call(_,se)&&(he[se]=E(_[se],H+"["+JSON.stringify(se)+"]"))}return he;case"number":case"string":case"boolean":return _}}(j,"$")}function pt(j){try{return JSON.stringify(j)}catch{return JSON.stringify(Fe(j))}}class Kt{constructor(){this.globalLog=u=>{window.console&&window.console.log&&window.console.log(u)}}debug(...u){this.log(this.globalLog,u)}warn(...u){this.log(this.globalLogWarn,u)}error(...u){this.log(this.globalLogError,u)}globalLogWarn(u){window.console&&window.console.warn?window.console.warn(u):this.globalLog(u)}globalLogError(u){window.console&&window.console.error?window.console.error(u):this.globalLogWarn(u)}log(u,...w){var E=X.apply(this,arguments);cr.log?cr.log(E):cr.logToConsole&&u.bind(this)(E)}}var Te=new Kt,Ei=function(j,u,w,E,_){(w.headers!==void 0||w.headersProvider!=null)&&Te.warn(`To send headers with the ${E.toString()} request, you must use AJAX, rather than JSONP.`);var H=j.nextAuthCallbackID.toString();j.nextAuthCallbackID++;var J=j.getDocument(),se=J.createElement("script");j.auth_callbacks[H]=function(we){_(null,we)};var he="Pusher.auth_callbacks['"+H+"']";se.src=w.endpoint+"?callback="+encodeURIComponent(he)+"&"+u;var ve=J.getElementsByTagName("head")[0]||J.documentElement;ve.insertBefore(se,ve.firstChild)},Ys=Ei;class Jt{constructor(u){this.src=u}send(u){var w=this,E="Error loading "+w.src;w.script=document.createElement("script"),w.script.id=u.id,w.script.src=w.src,w.script.type="text/javascript",w.script.charset="UTF-8",w.script.addEventListener?(w.script.onerror=function(){u.callback(E)},w.script.onload=function(){u.callback(null)}):w.script.onreadystatechange=function(){(w.script.readyState==="loaded"||w.script.readyState==="complete")&&u.callback(null)},w.script.async===void 0&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(w.errorScript=document.createElement("script"),w.errorScript.id=u.id+"_error",w.errorScript.text=u.name+"('"+E+"');",w.script.async=w.errorScript.async=!1):w.script.async=!0;var _=document.getElementsByTagName("head")[0];_.insertBefore(w.script,_.firstChild),w.errorScript&&_.insertBefore(w.errorScript,w.script.nextSibling)}cleanup(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null}}class xt{constructor(u,w){this.url=u,this.data=w}send(u){if(!this.request){var w=ue(this.data),E=this.url+"/"+u.number+"?"+w;this.request=me.createScriptRequest(E),this.request.send(u)}}cleanup(){this.request&&this.request.cleanup()}}var Ii=function(j,u){return function(w,E){var _="http"+(u?"s":"")+"://",H=_+(j.host||j.options.host)+j.options.path,J=me.createJSONPRequest(H,w),se=me.ScriptReceivers.create(function(he,ve){o.remove(se),J.cleanup(),ve&&ve.host&&(j.host=ve.host),E&&E(he,ve)});J.send(se)}},Ps={name:"jsonp",getAgent:Ii},_i=Ps;function G(j,u,w){var E=j+(u.useTLS?"s":""),_=u.useTLS?u.hostTLS:u.hostNonTLS;return E+"://"+_+w}function Me(j,u){var w="/app/"+j,E="?protocol="+c.PROTOCOL+"&client=js&version="+c.VERSION+(u?"&"+u:"");return w+E}var _e={getInitial:function(j,u){var w=(u.httpPath||"")+Me(j,"flash=false");return G("ws",u,w)}},Xt={getInitial:function(j,u){var w=(u.httpPath||"/pusher")+Me(j);return G("http",u,w)}},qs={getInitial:function(j,u){return G("http",u,u.httpPath||"/pusher")},getPath:function(j,u){return Me(j)}};class Ad{constructor(){this._callbacks={}}get(u){return this._callbacks[tr(u)]}add(u,w,E){var _=tr(u);this._callbacks[_]=this._callbacks[_]||[],this._callbacks[_].push({fn:w,context:E})}remove(u,w,E){if(!u&&!w&&!E){this._callbacks={};return}var _=u?[tr(u)]:pe(this._callbacks);w||E?this.removeCallback(_,w,E):this.removeAllCallbacks(_)}removeCallback(u,w,E){le(u,function(_){this._callbacks[_]=Qt(this._callbacks[_]||[],function(H){return w&&w!==H.fn||E&&E!==H.context}),this._callbacks[_].length===0&&delete this._callbacks[_]},this)}removeAllCallbacks(u){le(u,function(w){delete this._callbacks[w]},this)}}function tr(j){return"_"+j}class It{constructor(u){this.callbacks=new Ad,this.global_callbacks=[],this.failThrough=u}bind(u,w,E){return this.callbacks.add(u,w,E),this}bind_global(u){return this.global_callbacks.push(u),this}unbind(u,w,E){return this.callbacks.remove(u,w,E),this}unbind_global(u){return u?(this.global_callbacks=Qt(this.global_callbacks||[],w=>w!==u),this):(this.global_callbacks=[],this)}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(u,w,E){for(var _=0;_<this.global_callbacks.length;_++)this.global_callbacks[_](u,w);var H=this.callbacks.get(u),J=[];if(E?J.push(w,E):w&&J.push(w),H&&H.length>0)for(var _=0;_<H.length;_++)H[_].fn.apply(H[_].context||window,J);else this.failThrough&&this.failThrough(u,w);return this}}class Od extends It{constructor(u,w,E,_,H){super(),this.initialize=me.transportConnectionInitializer,this.hooks=u,this.name=w,this.priority=E,this.key=_,this.options=H,this.state="new",this.timeline=H.timeline,this.activityTimeout=H.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return!!this.hooks.handlesActivityChecks}supportsPing(){return!!this.hooks.supportsPing}connect(){if(this.socket||this.state!=="initialized")return!1;var u=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(u,this.options)}catch(w){return $.defer(()=>{this.onError(w),this.changeState("closed")}),!1}return this.bindListeners(),Te.debug("Connecting",{transport:this.name,url:u}),this.changeState("connecting"),!0}close(){return this.socket?(this.socket.close(),!0):!1}send(u){return this.state==="open"?($.defer(()=>{this.socket&&this.socket.send(u)}),!0):!1}ping(){this.state==="open"&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(u){this.emit("error",{type:"WebSocketError",error:u}),this.timeline.error(this.buildTimelineMessage({error:u.toString()}))}onClose(u){u?this.changeState("closed",{code:u.code,reason:u.reason,wasClean:u.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(u){this.emit("message",u)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=u=>{this.onError(u)},this.socket.onclose=u=>{this.onClose(u)},this.socket.onmessage=u=>{this.onMessage(u)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(u,w){this.state=u,this.timeline.info(this.buildTimelineMessage({state:u,params:w})),this.emit(u,w)}buildTimelineMessage(u){return U({cid:this.id},u)}}class Ts{constructor(u){this.hooks=u}isSupported(u){return this.hooks.isSupported(u)}createConnection(u,w,E,_){return new Od(this.hooks,u,w,E,_)}}var Fd=new Ts({urls:_e,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return!!me.getWebSocketAPI()},isSupported:function(){return!!me.getWebSocketAPI()},getSocket:function(j){return me.createWebSocket(j)}}),uo={urls:Xt,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},mo=U({getSocket:function(j){return me.HTTPFactory.createStreamingSocket(j)}},uo),fo=U({getSocket:function(j){return me.HTTPFactory.createPollingSocket(j)}},uo),po={isSupported:function(){return me.isXHRSupported()}},Bd=new Ts(U({},mo,po)),Dd=new Ts(U({},fo,po)),$d={ws:Fd,xhr_streaming:Bd,xhr_polling:Dd},Li=$d,zd=new Ts({file:"sockjs",urls:qs,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return window.SockJS!==void 0},getSocket:function(j,u){return new window.SockJS(j,null,{js_path:m.getPath("sockjs",{useTLS:u.useTLS}),ignore_null_origin:u.ignoreNullOrigin})},beforeOpen:function(j,u){j.send(JSON.stringify({path:u}))}}),go={isSupported:function(j){var u=me.isXDRSupported(j.useTLS);return u}},Ud=new Ts(U({},mo,go)),Wd=new Ts(U({},fo,go));Li.xdr_streaming=Ud,Li.xdr_polling=Wd,Li.sockjs=zd;var Vd=Li;class Hd extends It{constructor(){super();var u=this;window.addEventListener!==void 0&&(window.addEventListener("online",function(){u.emit("online")},!1),window.addEventListener("offline",function(){u.emit("offline")},!1))}isOnline(){return window.navigator.onLine===void 0?!0:window.navigator.onLine}}var Yd=new Hd;class qd{constructor(u,w,E){this.manager=u,this.transport=w,this.minPingDelay=E.minPingDelay,this.maxPingDelay=E.maxPingDelay,this.pingDelay=void 0}createConnection(u,w,E,_){_=U({},_,{activityTimeout:this.pingDelay});var H=this.transport.createConnection(u,w,E,_),J=null,se=function(){H.unbind("open",se),H.bind("closed",he),J=$.now()},he=ve=>{if(H.unbind("closed",he),ve.code===1002||ve.code===1003)this.manager.reportDeath();else if(!ve.wasClean&&J){var we=$.now()-J;we<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max(we/2,this.minPingDelay))}};return H.bind("open",se),H}isSupported(u){return this.manager.isAlive()&&this.transport.isSupported(u)}}const yo={decodeMessage:function(j){try{var u=JSON.parse(j.data),w=u.data;if(typeof w=="string")try{w=JSON.parse(u.data)}catch{}var E={event:u.event,channel:u.channel,data:w};return u.user_id&&(E.user_id=u.user_id),E}catch(_){throw{type:"MessageParseError",error:_,data:j.data}}},encodeMessage:function(j){return JSON.stringify(j)},processHandshake:function(j){var u=yo.decodeMessage(j);if(u.event==="pusher:connection_established"){if(!u.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:u.data.socket_id,activityTimeout:u.data.activity_timeout*1e3}}else{if(u.event==="pusher:error")return{action:this.getCloseAction(u.data),error:this.getCloseError(u.data)};throw"Invalid handshake"}},getCloseAction:function(j){return j.code<4e3?j.code>=1002&&j.code<=1004?"backoff":null:j.code===4e3?"tls_only":j.code<4100?"refused":j.code<4200?"backoff":j.code<4300?"retry":"refused"},getCloseError:function(j){return j.code!==1e3&&j.code!==1001?{type:"PusherError",data:{code:j.code,message:j.reason||j.message}}:null}};var Zt=yo;class Gd extends It{constructor(u,w){super(),this.id=u,this.transport=w,this.activityTimeout=w.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(u){return this.transport.send(u)}send_event(u,w,E){var _={event:u,data:w};return E&&(_.channel=E),Te.debug("Event sent",_),this.send(Zt.encodeMessage(_))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var u={message:E=>{var _;try{_=Zt.decodeMessage(E)}catch(H){this.emit("error",{type:"MessageParseError",error:H,data:E.data})}if(_!==void 0){switch(Te.debug("Event recd",_),_.event){case"pusher:error":this.emit("error",{type:"PusherError",data:_.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong");break}this.emit("message",_)}},activity:()=>{this.emit("activity")},error:E=>{this.emit("error",E)},closed:E=>{w(),E&&E.code&&this.handleCloseEvent(E),this.transport=null,this.emit("closed")}},w=()=>{ye(u,(E,_)=>{this.transport.unbind(_,E)})};ye(u,(E,_)=>{this.transport.bind(_,E)})}handleCloseEvent(u){var w=Zt.getCloseAction(u),E=Zt.getCloseError(u);E&&this.emit("error",E),w&&this.emit(w,{action:w,error:E})}}class Qd{constructor(u,w){this.transport=u,this.callback=w,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=u=>{this.unbindListeners();var w;try{w=Zt.processHandshake(u)}catch(E){this.finish("error",{error:E}),this.transport.close();return}w.action==="connected"?this.finish("connected",{connection:new Gd(w.id,this.transport),activityTimeout:w.activityTimeout}):(this.finish(w.action,{error:w.error}),this.transport.close())},this.onClosed=u=>{this.unbindListeners();var w=Zt.getCloseAction(u)||"backoff",E=Zt.getCloseError(u);this.finish(w,{error:E})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(u,w){this.callback(U({transport:this.transport,action:u},w))}}class Kd{constructor(u,w){this.timeline=u,this.options=w||{}}send(u,w){this.timeline.isEmpty()||this.timeline.send(me.TimelineTransport.getAgent(this,u),w)}}class sr extends It{constructor(u,w){super(function(E,_){Te.debug("No callbacks on "+u+" for "+E)}),this.name=u,this.pusher=w,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(u,w){return w(null,{auth:""})}trigger(u,w){if(u.indexOf("client-")!==0)throw new f("Event '"+u+"' does not start with 'client-'");if(!this.subscribed){var E=p.buildLogSuffix("triggeringClientEvents");Te.warn(`Client event triggered before channel 'subscription_succeeded' event . ${E}`)}return this.pusher.send_event(u,w,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(u){var w=u.event,E=u.data;if(w==="pusher_internal:subscription_succeeded")this.handleSubscriptionSucceededEvent(u);else if(w==="pusher_internal:subscription_count")this.handleSubscriptionCountEvent(u);else if(w.indexOf("pusher_internal:")!==0){var _={};this.emit(w,E,_)}}handleSubscriptionSucceededEvent(u){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",u.data)}handleSubscriptionCountEvent(u){u.data.subscription_count&&(this.subscriptionCount=u.data.subscription_count),this.emit("pusher:subscription_count",u.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(u,w)=>{u?(this.subscriptionPending=!1,Te.error(u.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:u.message},u instanceof P?{status:u.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:w.auth,channel_data:w.channel_data,channel:this.name})}))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class ir extends sr{authorize(u,w){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:u},w)}}class Jd{constructor(){this.reset()}get(u){return Object.prototype.hasOwnProperty.call(this.members,u)?{id:u,info:this.members[u]}:null}each(u){ye(this.members,(w,E)=>{u(this.get(E))})}setMyID(u){this.myID=u}onSubscription(u){this.members=u.presence.hash,this.count=u.presence.count,this.me=this.get(this.myID)}addMember(u){return this.get(u.user_id)===null&&this.count++,this.members[u.user_id]=u.user_info,this.get(u.user_id)}removeMember(u){var w=this.get(u.user_id);return w&&(delete this.members[u.user_id],this.count--),w}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}var Xd=function(j,u,w,E){function _(H){return H instanceof w?H:new w(function(J){J(H)})}return new(w||(w=Promise))(function(H,J){function se(we){try{ve(E.next(we))}catch(De){J(De)}}function he(we){try{ve(E.throw(we))}catch(De){J(De)}}function ve(we){we.done?H(we.value):_(we.value).then(se,he)}ve((E=E.apply(j,u||[])).next())})};class Zd extends ir{constructor(u,w){super(u,w),this.members=new Jd}authorize(u,w){super.authorize(u,(E,_)=>Xd(this,void 0,void 0,function*(){if(!E)if(_=_,_.channel_data!=null){var H=JSON.parse(_.channel_data);this.members.setMyID(H.user_id)}else if(yield this.pusher.user.signinDonePromise,this.pusher.user.user_data!=null)this.members.setMyID(this.pusher.user.user_data.id);else{let J=p.buildLogSuffix("authorizationEndpoint");Te.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${J}, or the user should be signed in.`),w("Invalid auth response");return}w(E,_)}))}handleEvent(u){var w=u.event;if(w.indexOf("pusher_internal:")===0)this.handleInternalEvent(u);else{var E=u.data,_={};u.user_id&&(_.user_id=u.user_id),this.emit(w,E,_)}}handleInternalEvent(u){var w=u.event,E=u.data;switch(w){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(u);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(u);break;case"pusher_internal:member_added":var _=this.members.addMember(E);this.emit("pusher:member_added",_);break;case"pusher_internal:member_removed":var H=this.members.removeMember(E);H&&this.emit("pusher:member_removed",H);break}}handleSubscriptionSucceededEvent(u){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(u.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var eu=r(1),nr=r(0);class tu extends ir{constructor(u,w,E){super(u,w),this.key=null,this.nacl=E}authorize(u,w){super.authorize(u,(E,_)=>{if(E){w(E,_);return}let H=_.shared_secret;if(!H){w(new Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null);return}this.key=Object(nr.decode)(H),delete _.shared_secret,w(null,_)})}trigger(u,w){throw new N("Client events are not currently supported for encrypted channels")}handleEvent(u){var w=u.event,E=u.data;if(w.indexOf("pusher_internal:")===0||w.indexOf("pusher:")===0){super.handleEvent(u);return}this.handleEncryptedEvent(w,E)}handleEncryptedEvent(u,w){if(!this.key){Te.debug("Received encrypted event before key has been retrieved from the authEndpoint");return}if(!w.ciphertext||!w.nonce){Te.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+w);return}let E=Object(nr.decode)(w.ciphertext);if(E.length<this.nacl.secretbox.overheadLength){Te.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${E.length}`);return}let _=Object(nr.decode)(w.nonce);if(_.length<this.nacl.secretbox.nonceLength){Te.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${_.length}`);return}let H=this.nacl.secretbox.open(E,_,this.key);if(H===null){Te.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),this.authorize(this.pusher.connection.socket_id,(J,se)=>{if(J){Te.error(`Failed to make a request to the authEndpoint: ${se}. Unable to fetch new key, so dropping encrypted event`);return}if(H=this.nacl.secretbox.open(E,_,this.key),H===null){Te.error("Failed to decrypt event with new key. Dropping encrypted event");return}this.emit(u,this.getDataToEmit(H))});return}this.emit(u,this.getDataToEmit(H))}getDataToEmit(u){let w=Object(eu.decode)(u);try{return JSON.parse(w)}catch{return w}}}class su extends It{constructor(u,w){super(),this.state="initialized",this.connection=null,this.key=u,this.options=w,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var E=me.getNetwork();E.bind("online",()=>{this.timeline.info({netinfo:"online"}),(this.state==="connecting"||this.state==="unavailable")&&this.retryIn(0)}),E.bind("offline",()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()}),this.updateStrategy()}connect(){if(!(this.connection||this.runner)){if(!this.strategy.isSupported()){this.updateState("failed");return}this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}}send(u){return this.connection?this.connection.send(u):!1}send_event(u,w,E){return this.connection?this.connection.send_event(u,w,E):!1}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var u=(w,E)=>{w?this.runner=this.strategy.connect(0,u):E.action==="error"?(this.emit("error",{type:"HandshakeError",error:E.error}),this.timeline.error({handshakeError:E.error})):(this.abortConnecting(),this.handshakeCallbacks[E.action](E))};this.runner=this.strategy.connect(0,u)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){if(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection){var u=this.abandonConnection();u.close()}}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(u){this.timeline.info({action:"retry",delay:u}),u>0&&this.emit("connecting_in",Math.round(u/1e3)),this.retryTimer=new oe(u||0,()=>{this.disconnectInternally(),this.connect()})}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new oe(this.options.unavailableTimeout,()=>{this.updateState("unavailable")})}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new oe(this.options.pongTimeout,()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)})}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new oe(this.activityTimeout,()=>{this.sendActivityCheck()}))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(u){return U({},u,{message:w=>{this.resetActivityCheck(),this.emit("message",w)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:w=>{this.emit("error",w)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(u){return U({},u,{connected:w=>{this.activityTimeout=Math.min(this.options.activityTimeout,w.activityTimeout,w.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(w.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let u=w=>E=>{E.error&&this.emit("error",{type:"WebSocketError",error:E.error}),w(E)};return{tls_only:u(()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)}),refused:u(()=>{this.disconnect()}),backoff:u(()=>{this.retryIn(1e3)}),retry:u(()=>{this.retryIn(0)})}}setConnection(u){this.connection=u;for(var w in this.connectionCallbacks)this.connection.bind(w,this.connectionCallbacks[w]);this.resetActivityCheck()}abandonConnection(){if(this.connection){this.stopActivityCheck();for(var u in this.connectionCallbacks)this.connection.unbind(u,this.connectionCallbacks[u]);var w=this.connection;return this.connection=null,w}}updateState(u,w){var E=this.state;if(this.state=u,E!==u){var _=u;_==="connected"&&(_+=" with new socket ID "+w.socket_id),Te.debug("State changed",E+" -> "+_),this.timeline.info({state:u,params:w}),this.emit("state_change",{previous:E,current:u}),this.emit(u,w)}}shouldRetry(){return this.state==="connecting"||this.state==="connected"}}class iu{constructor(){this.channels={}}add(u,w){return this.channels[u]||(this.channels[u]=nu(u,w)),this.channels[u]}all(){return Ae(this.channels)}find(u){return this.channels[u]}remove(u){var w=this.channels[u];return delete this.channels[u],w}disconnect(){ye(this.channels,function(u){u.disconnect()})}}function nu(j,u){if(j.indexOf("private-encrypted-")===0){if(u.config.nacl)return _t.createEncryptedChannel(j,u,u.config.nacl);let w="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",E=p.buildLogSuffix("encryptedChannelSupport");throw new N(`${w}. ${E}`)}else{if(j.indexOf("private-")===0)return _t.createPrivateChannel(j,u);if(j.indexOf("presence-")===0)return _t.createPresenceChannel(j,u);if(j.indexOf("#")===0)throw new y('Cannot create a channel with name "'+j+'".');return _t.createChannel(j,u)}}var ru={createChannels(){return new iu},createConnectionManager(j,u){return new su(j,u)},createChannel(j,u){return new sr(j,u)},createPrivateChannel(j,u){return new ir(j,u)},createPresenceChannel(j,u){return new Zd(j,u)},createEncryptedChannel(j,u,w){return new tu(j,u,w)},createTimelineSender(j,u){return new Kd(j,u)},createHandshake(j,u){return new Qd(j,u)},createAssistantToTheTransportManager(j,u,w){return new qd(j,u,w)}},_t=ru;class vo{constructor(u){this.options=u||{},this.livesLeft=this.options.lives||1/0}getAssistant(u){return _t.createAssistantToTheTransportManager(this,u,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class es{constructor(u,w){this.strategies=u,this.loop=!!w.loop,this.failFast=!!w.failFast,this.timeout=w.timeout,this.timeoutLimit=w.timeoutLimit}isSupported(){return de(this.strategies,$.method("isSupported"))}connect(u,w){var E=this.strategies,_=0,H=this.timeout,J=null,se=(he,ve)=>{ve?w(null,ve):(_=_+1,this.loop&&(_=_%E.length),_<E.length?(H&&(H=H*2,this.timeoutLimit&&(H=Math.min(H,this.timeoutLimit))),J=this.tryStrategy(E[_],u,{timeout:H,failFast:this.failFast},se)):w(!0))};return J=this.tryStrategy(E[_],u,{timeout:H,failFast:this.failFast},se),{abort:function(){J.abort()},forceMinPriority:function(he){u=he,J&&J.forceMinPriority(he)}}}tryStrategy(u,w,E,_){var H=null,J=null;return E.timeout>0&&(H=new oe(E.timeout,function(){J.abort(),_(!0)})),J=u.connect(w,function(se,he){se&&H&&H.isRunning()&&!E.failFast||(H&&H.ensureAborted(),_(se,he))}),{abort:function(){H&&H.ensureAborted(),J.abort()},forceMinPriority:function(se){J.forceMinPriority(se)}}}}class rr{constructor(u){this.strategies=u}isSupported(){return de(this.strategies,$.method("isSupported"))}connect(u,w){return au(this.strategies,u,function(E,_){return function(H,J){if(_[E].error=H,H){ou(_)&&w(!0);return}le(_,function(se){se.forceMinPriority(J.transport.priority)}),w(null,J)}})}}function au(j,u,w){var E=Qe(j,function(_,H,J,se){return _.connect(u,w(H,se))});return{abort:function(){le(E,lu)},forceMinPriority:function(_){le(E,function(H){H.forceMinPriority(_)})}}}function ou(j){return ke(j,function(u){return!!u.error})}function lu(j){!j.error&&!j.aborted&&(j.abort(),j.aborted=!0)}class cu{constructor(u,w,E){this.strategy=u,this.transports=w,this.ttl=E.ttl||1800*1e3,this.usingTLS=E.useTLS,this.timeline=E.timeline}isSupported(){return this.strategy.isSupported()}connect(u,w){var E=this.usingTLS,_=hu(E),H=_&&_.cacheSkipCount?_.cacheSkipCount:0,J=[this.strategy];if(_&&_.timestamp+this.ttl>=$.now()){var se=this.transports[_.transport];se&&(["ws","wss"].includes(_.transport)||H>3?(this.timeline.info({cached:!0,transport:_.transport,latency:_.latency}),J.push(new es([se],{timeout:_.latency*2+1e3,failFast:!0}))):H++)}var he=$.now(),ve=J.pop().connect(u,function we(De,Ai){De?(xo(E),J.length>0?(he=$.now(),ve=J.pop().connect(u,we)):w(De)):(du(E,Ai.transport.name,$.now()-he,H),w(null,Ai))});return{abort:function(){ve.abort()},forceMinPriority:function(we){u=we,ve&&ve.forceMinPriority(we)}}}}function ar(j){return"pusherTransport"+(j?"TLS":"NonTLS")}function hu(j){var u=me.getLocalStorage();if(u)try{var w=u[ar(j)];if(w)return JSON.parse(w)}catch{xo(j)}return null}function du(j,u,w,E){var _=me.getLocalStorage();if(_)try{_[ar(j)]=pt({timestamp:$.now(),transport:u,latency:w,cacheSkipCount:E})}catch{}}function xo(j){var u=me.getLocalStorage();if(u)try{delete u[ar(j)]}catch{}}class Mi{constructor(u,{delay:w}){this.strategy=u,this.options={delay:w}}isSupported(){return this.strategy.isSupported()}connect(u,w){var E=this.strategy,_,H=new oe(this.options.delay,function(){_=E.connect(u,w)});return{abort:function(){H.ensureAborted(),_&&_.abort()},forceMinPriority:function(J){u=J,_&&_.forceMinPriority(J)}}}}class Gs{constructor(u,w,E){this.test=u,this.trueBranch=w,this.falseBranch=E}isSupported(){var u=this.test()?this.trueBranch:this.falseBranch;return u.isSupported()}connect(u,w){var E=this.test()?this.trueBranch:this.falseBranch;return E.connect(u,w)}}class uu{constructor(u){this.strategy=u}isSupported(){return this.strategy.isSupported()}connect(u,w){var E=this.strategy.connect(u,function(_,H){H&&E.abort(),w(_,H)});return E}}function Qs(j){return function(){return j.isSupported()}}var mu=function(j,u,w){var E={};function _(Io,um,mm,fm,pm){var _o=w(j,Io,um,mm,fm,pm);return E[Io]=_o,_o}var H=Object.assign({},u,{hostNonTLS:j.wsHost+":"+j.wsPort,hostTLS:j.wsHost+":"+j.wssPort,httpPath:j.wsPath}),J=Object.assign({},H,{useTLS:!0}),se=Object.assign({},u,{hostNonTLS:j.httpHost+":"+j.httpPort,hostTLS:j.httpHost+":"+j.httpsPort,httpPath:j.httpPath}),he={loop:!0,timeout:15e3,timeoutLimit:6e4},ve=new vo({minPingDelay:1e4,maxPingDelay:j.activityTimeout}),we=new vo({lives:2,minPingDelay:1e4,maxPingDelay:j.activityTimeout}),De=_("ws","ws",3,H,ve),Ai=_("wss","ws",3,J,ve),om=_("sockjs","sockjs",1,se),No=_("xhr_streaming","xhr_streaming",1,se,we),lm=_("xdr_streaming","xdr_streaming",1,se,we),ko=_("xhr_polling","xhr_polling",1,se),cm=_("xdr_polling","xdr_polling",1,se),Co=new es([De],he),hm=new es([Ai],he),dm=new es([om],he),Po=new es([new Gs(Qs(No),No,lm)],he),To=new es([new Gs(Qs(ko),ko,cm)],he),Eo=new es([new Gs(Qs(Po),new rr([Po,new Mi(To,{delay:4e3})]),To)],he),hr=new Gs(Qs(Eo),Eo,dm),dr;return u.useTLS?dr=new rr([Co,new Mi(hr,{delay:2e3})]):dr=new rr([Co,new Mi(hm,{delay:2e3}),new Mi(hr,{delay:5e3})]),new cu(new uu(new Gs(Qs(De),dr,hr)),E,{ttl:18e5,timeline:u.timeline,useTLS:u.useTLS})},fu=mu,pu=function(){var j=this;j.timeline.info(j.buildTimelineMessage({transport:j.name+(j.options.useTLS?"s":"")})),j.hooks.isInitialized()?j.changeState("initialized"):j.hooks.file?(j.changeState("initializing"),m.load(j.hooks.file,{useTLS:j.options.useTLS},function(u,w){j.hooks.isInitialized()?(j.changeState("initialized"),w(!0)):(u&&j.onError(u),j.onClose(),w(!1))})):j.onClose()},gu={getRequest:function(j){var u=new window.XDomainRequest;return u.ontimeout=function(){j.emit("error",new S),j.close()},u.onerror=function(w){j.emit("error",w),j.close()},u.onprogress=function(){u.responseText&&u.responseText.length>0&&j.onChunk(200,u.responseText)},u.onload=function(){u.responseText&&u.responseText.length>0&&j.onChunk(200,u.responseText),j.emit("finished",200),j.close()},u},abortRequest:function(j){j.ontimeout=j.onerror=j.onprogress=j.onload=null,j.abort()}},yu=gu;const vu=256*1024;class xu extends It{constructor(u,w,E){super(),this.hooks=u,this.method=w,this.url=E}start(u){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},me.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(u)}close(){this.unloader&&(me.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(u,w){for(;;){var E=this.advanceBuffer(w);if(E)this.emit("chunk",{status:u,data:E});else break}this.isBufferTooLong(w)&&this.emit("buffer_too_long")}advanceBuffer(u){var w=u.slice(this.position),E=w.indexOf(`
`);return E!==-1?(this.position+=E+1,w.slice(0,E)):null}isBufferTooLong(u){return this.position===u.length&&u.length>vu}}var or;(function(j){j[j.CONNECTING=0]="CONNECTING",j[j.OPEN=1]="OPEN",j[j.CLOSED=3]="CLOSED"})(or||(or={}));var ts=or,bu=1;class wu{constructor(u,w){this.hooks=u,this.session=wo(1e3)+"/"+ku(8),this.location=ju(w),this.readyState=ts.CONNECTING,this.openStream()}send(u){return this.sendRaw(JSON.stringify([u]))}ping(){this.hooks.sendHeartbeat(this)}close(u,w){this.onClose(u,w,!0)}sendRaw(u){if(this.readyState===ts.OPEN)try{return me.createSocketRequest("POST",bo(Su(this.location,this.session))).start(u),!0}catch{return!1}else return!1}reconnect(){this.closeStream(),this.openStream()}onClose(u,w,E){this.closeStream(),this.readyState=ts.CLOSED,this.onclose&&this.onclose({code:u,reason:w,wasClean:E})}onChunk(u){if(u.status===200){this.readyState===ts.OPEN&&this.onActivity();var w,E=u.data.slice(0,1);switch(E){case"o":w=JSON.parse(u.data.slice(1)||"{}"),this.onOpen(w);break;case"a":w=JSON.parse(u.data.slice(1)||"[]");for(var _=0;_<w.length;_++)this.onEvent(w[_]);break;case"m":w=JSON.parse(u.data.slice(1)||"null"),this.onEvent(w);break;case"h":this.hooks.onHeartbeat(this);break;case"c":w=JSON.parse(u.data.slice(1)||"[]"),this.onClose(w[0],w[1],!0);break}}}onOpen(u){this.readyState===ts.CONNECTING?(u&&u.hostname&&(this.location.base=Nu(this.location.base,u.hostname)),this.readyState=ts.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(u){this.readyState===ts.OPEN&&this.onmessage&&this.onmessage({data:u})}onActivity(){this.onactivity&&this.onactivity()}onError(u){this.onerror&&this.onerror(u)}openStream(){this.stream=me.createSocketRequest("POST",bo(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",u=>{this.onChunk(u)}),this.stream.bind("finished",u=>{this.hooks.onFinished(this,u)}),this.stream.bind("buffer_too_long",()=>{this.reconnect()});try{this.stream.start()}catch(u){$.defer(()=>{this.onError(u),this.onClose(1006,"Could not start streaming",!1)})}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}}function ju(j){var u=/([^\?]*)\/*(\??.*)/.exec(j);return{base:u[1],queryString:u[2]}}function Su(j,u){return j.base+"/"+u+"/xhr_send"}function bo(j){var u=j.indexOf("?")===-1?"?":"&";return j+u+"t="+ +new Date+"&n="+bu++}function Nu(j,u){var w=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(j);return w[1]+u+w[3]}function wo(j){return me.randomInt(j)}function ku(j){for(var u=[],w=0;w<j;w++)u.push(wo(32).toString(32));return u.join("")}var Cu=wu,Pu={getReceiveURL:function(j,u){return j.base+"/"+u+"/xhr_streaming"+j.queryString},onHeartbeat:function(j){j.sendRaw("[]")},sendHeartbeat:function(j){j.sendRaw("[]")},onFinished:function(j,u){j.onClose(1006,"Connection interrupted ("+u+")",!1)}},Tu=Pu,Eu={getReceiveURL:function(j,u){return j.base+"/"+u+"/xhr"+j.queryString},onHeartbeat:function(){},sendHeartbeat:function(j){j.sendRaw("[]")},onFinished:function(j,u){u===200?j.reconnect():j.onClose(1006,"Connection interrupted ("+u+")",!1)}},Iu=Eu,_u={getRequest:function(j){var u=me.getXHRAPI(),w=new u;return w.onreadystatechange=w.onprogress=function(){switch(w.readyState){case 3:w.responseText&&w.responseText.length>0&&j.onChunk(w.status,w.responseText);break;case 4:w.responseText&&w.responseText.length>0&&j.onChunk(w.status,w.responseText),j.emit("finished",w.status),j.close();break}},w},abortRequest:function(j){j.onreadystatechange=null,j.abort()}},Lu=_u,Mu={createStreamingSocket(j){return this.createSocket(Tu,j)},createPollingSocket(j){return this.createSocket(Iu,j)},createSocket(j,u){return new Cu(j,u)},createXHR(j,u){return this.createRequest(Lu,j,u)},createRequest(j,u,w){return new xu(j,u,w)}},jo=Mu;jo.createXDR=function(j,u){return this.createRequest(yu,j,u)};var Ru=jo,Au={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:o,DependenciesReceivers:d,getDefaultStrategy:fu,Transports:Vd,transportConnectionInitializer:pu,HTTPFactory:Ru,TimelineTransport:_i,getXHRAPI(){return window.XMLHttpRequest},getWebSocketAPI(){return window.WebSocket||window.MozWebSocket},setup(j){window.Pusher=j;var u=()=>{this.onDocumentBody(j.ready)};window.JSON?u():m.load("json2",{},u)},getDocument(){return document},getProtocol(){return this.getDocument().location.protocol},getAuthorizers(){return{ajax:M,jsonp:Ys}},onDocumentBody(j){document.body?j():setTimeout(()=>{this.onDocumentBody(j)},0)},createJSONPRequest(j,u){return new xt(j,u)},createScriptRequest(j){return new Jt(j)},getLocalStorage(){try{return window.localStorage}catch{return}},createXHR(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest(){var j=this.getXHRAPI();return new j},createMicrosoftXHR(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork(){return Yd},createWebSocket(j){var u=this.getWebSocketAPI();return new u(j)},createSocketRequest(j,u){if(this.isXHRSupported())return this.HTTPFactory.createXHR(j,u);if(this.isXDRSupported(u.indexOf("https:")===0))return this.HTTPFactory.createXDR(j,u);throw"Cross-origin HTTP requests are not supported"},isXHRSupported(){var j=this.getXHRAPI();return!!j&&new j().withCredentials!==void 0},isXDRSupported(j){var u=j?"https:":"http:",w=this.getProtocol();return!!window.XDomainRequest&&w===u},addUnloadListener(j){window.addEventListener!==void 0?window.addEventListener("unload",j,!1):window.attachEvent!==void 0&&window.attachEvent("onunload",j)},removeUnloadListener(j){window.addEventListener!==void 0?window.removeEventListener("unload",j,!1):window.detachEvent!==void 0&&window.detachEvent("onunload",j)},randomInt(j){return Math.floor(function(){return(window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32)}()*j)}},me=Au,lr;(function(j){j[j.ERROR=3]="ERROR",j[j.INFO=6]="INFO",j[j.DEBUG=7]="DEBUG"})(lr||(lr={}));var Ri=lr;class Ou{constructor(u,w,E){this.key=u,this.session=w,this.events=[],this.options=E||{},this.sent=0,this.uniqueID=0}log(u,w){u<=this.options.level&&(this.events.push(U({},w,{timestamp:$.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(u){this.log(Ri.ERROR,u)}info(u){this.log(Ri.INFO,u)}debug(u){this.log(Ri.DEBUG,u)}isEmpty(){return this.events.length===0}send(u,w){var E=U({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],u(E,(_,H)=>{_||this.sent++,w&&w(_,H)}),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class Fu{constructor(u,w,E,_){this.name=u,this.priority=w,this.transport=E,this.options=_||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(u,w){if(this.isSupported()){if(this.priority<u)return So(new k,w)}else return So(new I,w);var E=!1,_=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),H=null,J=function(){_.unbind("initialized",J),_.connect()},se=function(){H=_t.createHandshake(_,function(De){E=!0,we(),w(null,De)})},he=function(De){we(),w(De)},ve=function(){we();var De;De=pt(_),w(new C(De))},we=function(){_.unbind("initialized",J),_.unbind("open",se),_.unbind("error",he),_.unbind("closed",ve)};return _.bind("initialized",J),_.bind("open",se),_.bind("error",he),_.bind("closed",ve),_.initialize(),{abort:()=>{E||(we(),H?H.close():_.close())},forceMinPriority:De=>{E||this.priority<De&&(H?H.close():_.close())}}}}function So(j,u){return $.defer(function(){u(j)}),{abort:function(){},forceMinPriority:function(){}}}const{Transports:Bu}=me;var Du=function(j,u,w,E,_,H){var J=Bu[w];if(!J)throw new T(w);var se=(!j.enabledTransports||ce(j.enabledTransports,u)!==-1)&&(!j.disabledTransports||ce(j.disabledTransports,u)===-1),he;return se?(_=Object.assign({ignoreNullOrigin:j.ignoreNullOrigin},_),he=new Fu(u,E,H?H.getAssistant(J):J,_)):he=$u,he},$u={isSupported:function(){return!1},connect:function(j,u){var w=$.defer(function(){u(new I)});return{abort:function(){w.ensureAborted()},forceMinPriority:function(){}}}};function zu(j){if(j==null)throw"You must pass an options object";if(j.cluster==null)throw"Options object must provide a cluster";"disableStats"in j&&Te.warn("The disableStats option is deprecated in favor of enableStats")}const Uu=(j,u)=>{var w="socket_id="+encodeURIComponent(j.socketId);for(var E in u.params)w+="&"+encodeURIComponent(E)+"="+encodeURIComponent(u.params[E]);if(u.paramsProvider!=null){let _=u.paramsProvider();for(var E in _)w+="&"+encodeURIComponent(E)+"="+encodeURIComponent(_[E])}return w};var Wu=j=>{if(typeof me.getAuthorizers()[j.transport]>"u")throw`'${j.transport}' is not a recognized auth transport`;return(u,w)=>{const E=Uu(u,j);me.getAuthorizers()[j.transport](me,E,j,g.UserAuthentication,w)}};const Vu=(j,u)=>{var w="socket_id="+encodeURIComponent(j.socketId);w+="&channel_name="+encodeURIComponent(j.channelName);for(var E in u.params)w+="&"+encodeURIComponent(E)+"="+encodeURIComponent(u.params[E]);if(u.paramsProvider!=null){let _=u.paramsProvider();for(var E in _)w+="&"+encodeURIComponent(E)+"="+encodeURIComponent(_[E])}return w};var Hu=j=>{if(typeof me.getAuthorizers()[j.transport]>"u")throw`'${j.transport}' is not a recognized auth transport`;return(u,w)=>{const E=Vu(u,j);me.getAuthorizers()[j.transport](me,E,j,g.ChannelAuthorization,w)}};const Yu=(j,u,w)=>{const E={authTransport:u.transport,authEndpoint:u.endpoint,auth:{params:u.params,headers:u.headers}};return(_,H)=>{const J=j.channel(_.channelName);w(J,E).authorize(_.socketId,H)}};function qu(j,u){let w={activityTimeout:j.activityTimeout||c.activityTimeout,cluster:j.cluster,httpPath:j.httpPath||c.httpPath,httpPort:j.httpPort||c.httpPort,httpsPort:j.httpsPort||c.httpsPort,pongTimeout:j.pongTimeout||c.pongTimeout,statsHost:j.statsHost||c.stats_host,unavailableTimeout:j.unavailableTimeout||c.unavailableTimeout,wsPath:j.wsPath||c.wsPath,wsPort:j.wsPort||c.wsPort,wssPort:j.wssPort||c.wssPort,enableStats:Xu(j),httpHost:Gu(j),useTLS:Ju(j),wsHost:Qu(j),userAuthenticator:Zu(j),channelAuthorizer:tm(j,u)};return"disabledTransports"in j&&(w.disabledTransports=j.disabledTransports),"enabledTransports"in j&&(w.enabledTransports=j.enabledTransports),"ignoreNullOrigin"in j&&(w.ignoreNullOrigin=j.ignoreNullOrigin),"timelineParams"in j&&(w.timelineParams=j.timelineParams),"nacl"in j&&(w.nacl=j.nacl),w}function Gu(j){return j.httpHost?j.httpHost:j.cluster?`sockjs-${j.cluster}.pusher.com`:c.httpHost}function Qu(j){return j.wsHost?j.wsHost:Ku(j.cluster)}function Ku(j){return`ws-${j}.pusher.com`}function Ju(j){return me.getProtocol()==="https:"?!0:j.forceTLS!==!1}function Xu(j){return"enableStats"in j?j.enableStats:"disableStats"in j?!j.disableStats:!1}function Zu(j){const u=Object.assign(Object.assign({},c.userAuthentication),j.userAuthentication);return"customHandler"in u&&u.customHandler!=null?u.customHandler:Wu(u)}function em(j,u){let w;return"channelAuthorization"in j?w=Object.assign(Object.assign({},c.channelAuthorization),j.channelAuthorization):(w={transport:j.authTransport||c.authTransport,endpoint:j.authEndpoint||c.authEndpoint},"auth"in j&&("params"in j.auth&&(w.params=j.auth.params),"headers"in j.auth&&(w.headers=j.auth.headers)),"authorizer"in j&&(w.customHandler=Yu(u,w,j.authorizer))),w}function tm(j,u){const w=em(j,u);return"customHandler"in w&&w.customHandler!=null?w.customHandler:Hu(w)}class sm extends It{constructor(u){super(function(w,E){Te.debug(`No callbacks on watchlist events for ${w}`)}),this.pusher=u,this.bindWatchlistInternalEvent()}handleEvent(u){u.data.events.forEach(w=>{this.emit(w.name,w)})}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",u=>{var w=u.event;w==="pusher_internal:watchlist_events"&&this.handleEvent(u)})}}function im(){let j,u;return{promise:new Promise((E,_)=>{j=E,u=_}),resolve:j,reject:u}}var nm=im;class rm extends It{constructor(u){super(function(w,E){Te.debug("No callbacks on user for "+w)}),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(w,E)=>{if(w){Te.warn(`Error during signin: ${w}`),this._cleanup();return}this.pusher.send_event("pusher:signin",{auth:E.auth,user_data:E.user_data})},this.pusher=u,this.pusher.connection.bind("state_change",({previous:w,current:E})=>{w!=="connected"&&E==="connected"&&this._signin(),w==="connected"&&E!=="connected"&&(this._cleanup(),this._newSigninPromiseIfNeeded())}),this.watchlist=new sm(u),this.pusher.connection.bind("message",w=>{var E=w.event;E==="pusher:signin_success"&&this._onSigninSuccess(w.data),this.serverToUserChannel&&this.serverToUserChannel.name===w.channel&&this.serverToUserChannel.handleEvent(w)})}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),this.pusher.connection.state==="connected"&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(u){try{this.user_data=JSON.parse(u.user_data)}catch{Te.error(`Failed parsing user data after signin: ${u.user_data}`),this._cleanup();return}if(typeof this.user_data.id!="string"||this.user_data.id===""){Te.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),this._cleanup();return}this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){const u=w=>{w.subscriptionPending&&w.subscriptionCancelled?w.reinstateSubscription():!w.subscriptionPending&&this.pusher.connection.state==="connected"&&w.subscribe()};this.serverToUserChannel=new sr(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global((w,E)=>{w.indexOf("pusher_internal:")===0||w.indexOf("pusher:")===0||this.emit(w,E)}),u(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested||this.signinDonePromise&&!this.signinDonePromise.done)return;const{promise:u,resolve:w}=nm();u.done=!1;const E=()=>{u.done=!0};u.then(E).catch(E),this.signinDonePromise=u,this._signinDoneResolve=w}}class He{static ready(){He.isReady=!0;for(var u=0,w=He.instances.length;u<w;u++)He.instances[u].connect()}static getClientFeatures(){return pe(Xe({ws:me.Transports.ws},function(u){return u.isSupported({})}))}constructor(u,w){am(u),zu(w),this.key=u,this.config=qu(w,this),this.channels=_t.createChannels(),this.global_emitter=new It,this.sessionID=me.randomInt(1e9),this.timeline=new Ou(this.key,this.sessionID,{cluster:this.config.cluster,features:He.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:Ri.INFO,version:c.VERSION}),this.config.enableStats&&(this.timelineSender=_t.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+me.TimelineTransport.name}));var E=_=>me.getDefaultStrategy(this.config,_,Du);this.connection=_t.createConnectionManager(this.key,{getStrategy:E,timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:!!this.config.useTLS}),this.connection.bind("connected",()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())}),this.connection.bind("message",_=>{var H=_.event,J=H.indexOf("pusher_internal:")===0;if(_.channel){var se=this.channel(_.channel);se&&se.handleEvent(_)}J||this.global_emitter.emit(_.event,_.data)}),this.connection.bind("connecting",()=>{this.channels.disconnect()}),this.connection.bind("disconnected",()=>{this.channels.disconnect()}),this.connection.bind("error",_=>{Te.warn(_)}),He.instances.push(this),this.timeline.info({instances:He.instances.length}),this.user=new rm(this),He.isReady&&this.connect()}channel(u){return this.channels.find(u)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var u=this.connection.isUsingTLS(),w=this.timelineSender;this.timelineSenderTimer=new ie(6e4,function(){w.send(u)})}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(u,w,E){return this.global_emitter.bind(u,w,E),this}unbind(u,w,E){return this.global_emitter.unbind(u,w,E),this}bind_global(u){return this.global_emitter.bind_global(u),this}unbind_global(u){return this.global_emitter.unbind_global(u),this}unbind_all(u){return this.global_emitter.unbind_all(),this}subscribeAll(){var u;for(u in this.channels.channels)this.channels.channels.hasOwnProperty(u)&&this.subscribe(u)}subscribe(u){var w=this.channels.add(u,this);return w.subscriptionPending&&w.subscriptionCancelled?w.reinstateSubscription():!w.subscriptionPending&&this.connection.state==="connected"&&w.subscribe(),w}unsubscribe(u){var w=this.channels.find(u);w&&w.subscriptionPending?w.cancelSubscription():(w=this.channels.remove(u),w&&w.subscribed&&w.unsubscribe())}send_event(u,w,E){return this.connection.send_event(u,w,E)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}He.instances=[],He.isReady=!1,He.logToConsole=!1,He.Runtime=me,He.ScriptReceivers=me.ScriptReceivers,He.DependenciesReceivers=me.DependenciesReceivers,He.auth_callbacks=me.auth_callbacks;var cr=n.default=He;function am(j){if(j==null)throw"You must pass your app key when you instantiate Pusher."}me.setup(He)}])})})(mh);var dg=mh.exports;const ug=xm(dg);class mg{constructor(){this.baseURL="http://localhost:5001",this.pusher=null,this.channel=null,this.listeners=new Set,this.isConnected=!1,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=1e3}async initializePusher(e){try{const t="478146ed5eddba9a37cb";this.pusher&&this.disconnectPusher(),this.pusher=new ug(t,{cluster:"ap2",encrypted:!0,authEndpoint:`${this.baseURL}/pusher/auth`,auth:{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}}),this.channel=this.pusher.subscribe(`user-${e}`),this.setupEventListeners(),this.pusher.connection.bind("connected",()=>{console.log("✅ Pusher connected for notifications"),this.isConnected=!0,this.reconnectAttempts=0,this.notifyListeners("connection",{status:"connected"})}),this.pusher.connection.bind("disconnected",()=>{console.log("❌ Pusher disconnected"),this.isConnected=!1,this.notifyListeners("connection",{status:"disconnected"}),this.handleReconnection(e)}),this.pusher.connection.bind("error",n=>{console.error("❌ Pusher connection error:",n),this.notifyListeners("connection",{status:"error",error:n})})}catch(t){throw console.error("Failed to initialize Pusher:",t),t}}setupEventListeners(){this.channel&&(this.channel.bind("notification",e=>{console.log("📢 New notification received:",e),this.notifyListeners("notification",e)}),this.channel.bind("notification-update",e=>{console.log("📝 Notification updated:",e),this.notifyListeners("notification-update",e)}),this.channel.bind("notifications-read-all",e=>{console.log("📝 All notifications marked as read:",e),this.notifyListeners("notifications-read-all",e)}))}async handleReconnection(e){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.error("Max reconnection attempts reached");return}this.reconnectAttempts++;const t=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);console.log(`Attempting to reconnect in ${t}ms (attempt ${this.reconnectAttempts})`),setTimeout(()=>{this.initializePusher(e)},t)}disconnectPusher(){this.channel&&(this.channel.unbind_all(),this.pusher.unsubscribe(this.channel.name)),this.pusher&&this.pusher.disconnect(),this.pusher=null,this.channel=null,this.isConnected=!1}addEventListener(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(e,t){this.listeners.forEach(n=>{try{n(e,t)}catch(r){console.error("Error in notification listener:",r)}})}getAuthHeaders(){return{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}}async getNotifications(e=1,t=10,n="-createdAt"){try{return(await xe.get(`${this.baseURL}/notifications`,{params:{page:e,limit:t,sort:n},headers:this.getAuthHeaders(),timeout:5e3})).data}catch{return this.getMockNotifications(e,t)}}async getUnreadCount(){try{return(await xe.get(`${this.baseURL}/notifications/unread-count`,{headers:this.getAuthHeaders(),timeout:5e3})).data}catch{return{success:!0,count:3}}}async markAsRead(e){try{return(await xe.put(`${this.baseURL}/notifications/${e}/read`,{},{headers:this.getAuthHeaders()})).data}catch(t){return console.error("Failed to mark notification as read:",t),{success:!0,message:"Notification marked as read"}}}async markAllAsRead(){try{return(await xe.put(`${this.baseURL}/notifications/read-all`,{},{headers:this.getAuthHeaders()})).data}catch(e){return console.error("Failed to mark all notifications as read:",e),{success:!0,message:"All notifications marked as read"}}}async deleteNotification(e){try{return(await xe.delete(`${this.baseURL}/notifications/${e}`,{headers:this.getAuthHeaders()})).data}catch(t){return console.error("Failed to delete notification:",t),{success:!0,message:"Notification deleted"}}}async createNotification(e){var t;try{return(await xe.post(`${this.baseURL}/api/notifications`,e,{headers:this.getAuthHeaders()})).data}catch(n){if(console.error("Failed to create notification:",n),((t=n.response)==null?void 0:t.status)===404)return{success:!0,message:"Notification created"};throw this.handleError(n)}}handleError(e){var t;return e.response?{message:((t=e.response.data)==null?void 0:t.message)||"Server error occurred",status:e.response.status,data:e.response.data}:e.request?{message:"Network error - please check your connection",status:0,data:null}:{message:e.message||"An unexpected error occurred",status:-1,data:null}}getMockNotifications(e=1,t=10){const n=[{id:"1",title:"Trade Executed Successfully",message:"Your buy order for 100 shares of RELIANCE has been executed at ₹2,450.00",type:"success",read:!1,createdAt:new Date(Date.now()-3e5).toISOString(),data:{symbol:"RELIANCE",quantity:100,price:2450}},{id:"2",title:"Price Alert Triggered",message:"TCS has reached your target price of ₹3,500.00",type:"info",read:!1,createdAt:new Date(Date.now()-18e5).toISOString(),data:{symbol:"TCS",targetPrice:3500}},{id:"3",title:"Market Update",message:"NIFTY 50 is up 1.2% today. Your portfolio is performing well!",type:"info",read:!0,createdAt:new Date(Date.now()-72e5).toISOString(),data:{index:"NIFTY50",change:1.2}},{id:"4",title:"Dividend Received",message:"You received ₹150 dividend from HDFC Bank",type:"success",read:!0,createdAt:new Date(Date.now()-864e5).toISOString(),data:{symbol:"HDFCBANK",amount:150}},{id:"5",title:"Stop Loss Triggered",message:"Your stop loss order for INFY has been executed at ₹1,420.00",type:"warning",read:!1,createdAt:new Date(Date.now()-2592e5).toISOString(),data:{symbol:"INFY",price:1420,type:"stop_loss"}}],r=(e-1)*t,a=r+t;return{success:!0,notifications:n.slice(r,a),pagination:{page:e,limit:t,total:n.length,hasMore:a<n.length}}}startMockLiveNotifications(){this.mockInterval||(this.mockInterval=setInterval(()=>{const e=this.generateMockNotification();this.notifyListeners("notification",e)},3e4))}stopMockLiveNotifications(){this.mockInterval&&(clearInterval(this.mockInterval),this.mockInterval=null)}generateMockNotification(){const e=["success","info","warning","error"],t={success:[{title:"Trade Executed",message:"Your buy order for {symbol} has been executed successfully"},{title:"Dividend Received",message:"You received ₹{amount} dividend from {symbol}"},{title:"Profit Booked",message:"Successfully sold {symbol} with {profit}% profit"}],info:[{title:"Price Alert",message:"{symbol} has reached your target price of ₹{price}"},{title:"Market Update",message:"NIFTY 50 is {change}% today"},{title:"News Alert",message:"Important news update for {symbol}"}],warning:[{title:"Stop Loss Alert",message:"{symbol} is approaching your stop loss level"},{title:"High Volatility",message:"{symbol} showing high volatility today"},{title:"Market Closure",message:"Market will close in 30 minutes"}],error:[{title:"Order Failed",message:"Your order for {symbol} could not be executed"},{title:"Connection Issue",message:"Temporary connection issue detected"}]},n=["RELIANCE","TCS","INFY","HDFCBANK","ICICIBANK","WIPRO","ITC"],r=e[Math.floor(Math.random()*e.length)],a=t[r][Math.floor(Math.random()*t[r].length)];return{id:Date.now().toString(),title:a.title,message:a.message.replace("{symbol}",n[Math.floor(Math.random()*n.length)]).replace("{amount}",Math.floor(Math.random()*500)+50).replace("{price}",Math.floor(Math.random()*1e3)+1e3).replace("{profit}",(Math.random()*20+5).toFixed(1)).replace("{change}",(Math.random()*4-2).toFixed(1)),type:r,read:!1,createdAt:new Date().toISOString(),data:{}}}getConnectionStatus(){var e,t;return{isConnected:this.isConnected,reconnectAttempts:this.reconnectAttempts,pusherState:((t=(e=this.pusher)==null?void 0:e.connection)==null?void 0:t.state)||"disconnected"}}}const bt=new mg,fg={notifications:[],unreadCount:0,loading:!1,error:null,connectionStatus:"disconnected",filters:{type:"all",read:"all",dateRange:"all"},pagination:{page:1,limit:10,total:0,hasMore:!1}},ge={SET_LOADING:"SET_LOADING",SET_ERROR:"SET_ERROR",SET_NOTIFICATIONS:"SET_NOTIFICATIONS",ADD_NOTIFICATION:"ADD_NOTIFICATION",UPDATE_NOTIFICATION:"UPDATE_NOTIFICATION",REMOVE_NOTIFICATION:"REMOVE_NOTIFICATION",SET_UNREAD_COUNT:"SET_UNREAD_COUNT",MARK_AS_READ:"MARK_AS_READ",MARK_ALL_AS_READ:"MARK_ALL_AS_READ",SET_CONNECTION_STATUS:"SET_CONNECTION_STATUS",SET_FILTERS:"SET_FILTERS",SET_PAGINATION:"SET_PAGINATION",CLEAR_ALL:"CLEAR_ALL"};function pg(s,e){switch(e.type){case ge.SET_LOADING:return{...s,loading:e.payload};case ge.SET_ERROR:return{...s,error:e.payload,loading:!1};case ge.SET_NOTIFICATIONS:return{...s,notifications:e.payload.notifications||[],pagination:{...s.pagination,...e.payload.pagination},loading:!1,error:null};case ge.ADD_NOTIFICATION:return{...s,notifications:[e.payload,...s.notifications],unreadCount:s.unreadCount+(e.payload.read?0:1)};case ge.UPDATE_NOTIFICATION:return{...s,notifications:s.notifications.map(n=>n.id===e.payload.id?{...n,...e.payload}:n)};case ge.REMOVE_NOTIFICATION:const t=s.notifications.find(n=>n.id===e.payload);return{...s,notifications:s.notifications.filter(n=>n.id!==e.payload),unreadCount:t&&!t.read?s.unreadCount-1:s.unreadCount};case ge.SET_UNREAD_COUNT:return{...s,unreadCount:e.payload};case ge.MARK_AS_READ:return{...s,notifications:s.notifications.map(n=>n.id===e.payload?{...n,read:!0,readAt:new Date().toISOString()}:n),unreadCount:Math.max(0,s.unreadCount-1)};case ge.MARK_ALL_AS_READ:return{...s,notifications:s.notifications.map(n=>({...n,read:!0,readAt:new Date().toISOString()})),unreadCount:0};case ge.SET_CONNECTION_STATUS:return{...s,connectionStatus:e.payload};case ge.SET_FILTERS:return{...s,filters:{...s.filters,...e.payload},pagination:{...s.pagination,page:1}};case ge.SET_PAGINATION:return{...s,pagination:{...s.pagination,...e.payload}};case ge.CLEAR_ALL:return{...s,notifications:[],unreadCount:0};default:return s}}const fh=v.createContext(),gg=({children:s})=>{const[e,t]=v.useReducer(pg,fg),{user:n,isAuthenticated:r}=Bt();v.useEffect(()=>(r&&(n!=null&&n.id)?a():c(),()=>c()),[r,n==null?void 0:n.id]);const a=v.useCallback(async()=>{try{t({type:ge.SET_LOADING,payload:!0});try{await bt.initializePusher(n.id);const y=bt.addEventListener(o);t({type:ge.SET_CONNECTION_STATUS,payload:"connected"})}catch(y){console.warn("Pusher initialization failed, using polling mode:",y.message),t({type:ge.SET_CONNECTION_STATUS,payload:"polling"})}await h(),await d(),bt.startMockLiveNotifications(),t({type:ge.SET_LOADING,payload:!1})}catch(y){console.error("Failed to initialize notifications:",y),t({type:ge.SET_ERROR,payload:y.message}),t({type:ge.SET_LOADING,payload:!1})}},[n==null?void 0:n.id]),o=v.useCallback((y,S)=>{switch(y){case"notification":t({type:ge.ADD_NOTIFICATION,payload:S}),l(S);break;case"notification-update":t({type:ge.UPDATE_NOTIFICATION,payload:S});break;case"notifications-read-all":t({type:ge.MARK_ALL_AS_READ});break;case"connection":t({type:ge.SET_CONNECTION_STATUS,payload:S.status});break;default:console.log("Unknown notification event:",y,S)}},[]),l=v.useCallback(y=>{const S={position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0};switch(y.type){case"success":K.success(y.message,S);break;case"error":K.error(y.message,S);break;case"warning":K.warning(y.message,S);break;case"info":case"alert":default:K.info(y.message,S);break}},[]),c=v.useCallback(()=>{bt.stopMockLiveNotifications(),bt.disconnectPusher(),t({type:ge.CLEAR_ALL}),t({type:ge.SET_CONNECTION_STATUS,payload:"disconnected"})},[]),h=v.useCallback(async(y=1)=>{try{t({type:ge.SET_LOADING,payload:!0});const S=await bt.getNotifications(y,e.pagination.limit,"-createdAt");S.success&&t({type:ge.SET_NOTIFICATIONS,payload:{notifications:y===1?S.data:[...e.notifications,...S.data],pagination:{page:S.pagination.page,total:S.pagination.total,hasMore:S.pagination.hasMore}}})}catch(S){t({type:ge.SET_ERROR,payload:S.message})}},[e.pagination.limit,e.notifications]),d=v.useCallback(async()=>{try{const y=await bt.getUnreadCount();y.success&&t({type:ge.SET_UNREAD_COUNT,payload:y.count})}catch(y){console.error("Failed to fetch unread count:",y)}},[]),m=v.useCallback(async y=>{try{await bt.markAsRead(y),t({type:ge.MARK_AS_READ,payload:y})}catch(S){console.error("Failed to mark notification as read:",S),t({type:ge.SET_ERROR,payload:S.message})}},[]),x=v.useCallback(async()=>{try{await bt.markAllAsRead(),t({type:ge.MARK_ALL_AS_READ})}catch(y){console.error("Failed to mark all notifications as read:",y),t({type:ge.SET_ERROR,payload:y.message})}},[]),b=v.useCallback(async y=>{try{await bt.deleteNotification(y),t({type:ge.REMOVE_NOTIFICATION,payload:y})}catch(S){console.error("Failed to delete notification:",S),t({type:ge.SET_ERROR,payload:S.message})}},[]),p=v.useCallback(y=>{t({type:ge.SET_FILTERS,payload:y})},[]),g=v.useCallback(()=>{e.pagination.hasMore&&!e.loading&&h(e.pagination.page+1)},[e.pagination.hasMore,e.loading,e.pagination.page,h]),f={...e,fetchNotifications:h,markAsRead:m,markAllAsRead:x,deleteNotification:b,setFilters:p,loadMore:g,connectionStatus:bt.getConnectionStatus()};return i.jsx(fh.Provider,{value:f,children:s})},zn=()=>{const s=v.useContext(fh);if(!s)throw new Error("useNotifications must be used within a NotificationProvider");return s},yg=(s,e=100,t=30)=>{const n=[];let r=e;const a=new Date;for(let o=t;o>=0;o--){const l=new Date(a);l.setDate(l.getDate()-o);const c=(Math.random()-.5)*.1;r=Math.max(r*(1+c),1);const h=r,d=h*(1+Math.random()*.05),m=h*(1-Math.random()*.05),x=m+Math.random()*(d-m),b=Math.floor(Math.random()*1e6)+1e5;n.push({time:l.toISOString().split("T")[0],open:parseFloat(h.toFixed(2)),high:parseFloat(d.toFixed(2)),low:parseFloat(m.toFixed(2)),close:parseFloat(x.toFixed(2)),volume:b}),r=x}return n},Zo={"RELIANCE.NS":{symbol:"RELIANCE.NS",name:"Reliance Industries Limited",price:2847.5,change:15.25,changesPercentage:.54,dayLow:2835.4,dayHigh:2865.8,yearHigh:3024.9,yearLow:2220.3,marketCap:1925e10,priceAvg50:2798.45,priceAvg200:2654.78,volume:8765432,avgVolume:12e6,exchange:"NSE",open:2840.2,previousClose:2832.25,timestamp:Math.floor(Date.now()/1e3)},"TCS.NS":{symbol:"TCS.NS",name:"Tata Consultancy Services",price:4125.8,change:-12.4,changesPercentage:-.3,dayLow:4118.25,dayHigh:4145.6,yearHigh:4592.25,yearLow:3311,marketCap:151e11,priceAvg50:4089.75,priceAvg200:3987.2,volume:1234567,avgVolume:25e5,exchange:"NSE",open:4138.2,previousClose:4138.2,timestamp:Math.floor(Date.now()/1e3)},"HDFCBANK.NS":{symbol:"HDFCBANK.NS",name:"HDFC Bank Limited",price:1687.9,change:8.75,changesPercentage:.52,dayLow:1678.3,dayHigh:1695.4,yearHigh:1794.5,yearLow:1363.55,marketCap:1285e10,priceAvg50:1654.45,priceAvg200:1598.78,volume:5678901,avgVolume:85e5,exchange:"NSE",open:1682.15,previousClose:1679.15,timestamp:Math.floor(Date.now()/1e3)},"INFY.NS":{symbol:"INFY.NS",name:"Infosys Limited",price:1842.35,change:22.15,changesPercentage:1.22,dayLow:1835.2,dayHigh:1856.8,yearHigh:1953.9,yearLow:1351.65,marketCap:765e10,priceAvg50:1798.75,priceAvg200:1687.2,volume:3456789,avgVolume:52e5,exchange:"NSE",open:1838.4,previousClose:1820.2,timestamp:Math.floor(Date.now()/1e3)},"HINDUNILVR.NS":{symbol:"HINDUNILVR.NS",name:"Hindustan Unilever Limited",price:2456.7,change:-5.3,changesPercentage:-.22,dayLow:2445.6,dayHigh:2468.9,yearHigh:2844.95,yearLow:2172,marketCap:575e10,priceAvg50:2489.75,priceAvg200:2398.2,volume:987654,avgVolume:18e5,exchange:"NSE",open:2462,previousClose:2462,timestamp:Math.floor(Date.now()/1e3)},"ICICIBANK.NS":{symbol:"ICICIBANK.NS",name:"ICICI Bank Limited",price:1287.45,change:18.9,changesPercentage:1.49,dayLow:1278.3,dayHigh:1295.8,yearHigh:1257.65,yearLow:912.35,marketCap:905e10,priceAvg50:1245.75,priceAvg200:1156.2,volume:7890123,avgVolume:125e5,exchange:"NSE",open:1280.55,previousClose:1268.55,timestamp:Math.floor(Date.now()/1e3)},INFY:{symbol:"INFY",name:"Infosys Limited",price:1456.3,change:8.75,changesPercentage:.6,dayLow:1445.2,dayHigh:1468.9,yearHigh:1953.9,yearLow:1330.2,marketCap:61e11,priceAvg50:1423.45,priceAvg200:1567.89,volume:3456789,avgVolume:42e5,exchange:"NSE",open:1447.55,previousClose:1447.55,timestamp:Math.floor(Date.now()/1e3)},HDFCBANK:{symbol:"HDFCBANK",name:"HDFC Bank Limited",price:1567.45,change:12.3,changesPercentage:.79,dayLow:1555.2,dayHigh:1578.9,yearHigh:1725,yearLow:1363.55,marketCap:119e11,priceAvg50:1534.67,priceAvg200:1598.23,volume:2345678,avgVolume:28e5,exchange:"NSE",open:1555.15,previousClose:1555.15,timestamp:Math.floor(Date.now()/1e3)},ICICIBANK:{symbol:"ICICIBANK",name:"ICICI Bank Limited",price:987.65,change:-5.45,changesPercentage:-.55,dayLow:982.3,dayHigh:995.8,yearHigh:1257.8,yearLow:875.35,marketCap:69e11,priceAvg50:1012.34,priceAvg200:1089.67,volume:4567890,avgVolume:52e5,exchange:"NSE",open:993.1,previousClose:993.1,timestamp:Math.floor(Date.now()/1e3)}},el=[{symbol:"RELIANCE.NS",name:"Reliance Industries Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"TCS.NS",name:"Tata Consultancy Services",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"HDFCBANK.NS",name:"HDFC Bank Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"INFY.NS",name:"Infosys Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"HINDUNILVR.NS",name:"Hindustan Unilever Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"ICICIBANK.NS",name:"ICICI Bank Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"KOTAKBANK.NS",name:"Kotak Mahindra Bank Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"BHARTIARTL.NS",name:"Bharti Airtel Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"ITC.NS",name:"ITC Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"SBIN.NS",name:"State Bank of India",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"LT.NS",name:"Larsen & Toubro Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"ASIANPAINT.NS",name:"Asian Paints Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"MARUTI.NS",name:"Maruti Suzuki India Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"BAJFINANCE.NS",name:"Bajaj Finance Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"WIPRO.NS",name:"Wipro Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"HCLTECH.NS",name:"HCL Technologies Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"TECHM.NS",name:"Tech Mahindra Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"SUNPHARMA.NS",name:"Sun Pharmaceutical Industries Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"TITAN.NS",name:"Titan Company Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"NESTLEIND.NS",name:"Nestle India Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"ULTRACEMCO.NS",name:"UltraTech Cement Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"POWERGRID.NS",name:"Power Grid Corporation of India Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"NTPC.NS",name:"NTPC Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"ONGC.NS",name:"Oil and Natural Gas Corporation Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"COALINDIA.NS",name:"Coal India Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"ZOMATO.NS",name:"Zomato Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"PAYTM.NS",name:"One 97 Communications Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"NYKAA.NS",name:"FSN E-Commerce Ventures Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"POLICYBZR.NS",name:"PB Fintech Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"ZOMATO.NS",name:"Zomato Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"SWIGGY.NS",name:"Bundl Technologies Private Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"INFY.NS",name:"Infosys Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"AAPL",name:"Apple Inc.",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"GOOGL",name:"Alphabet Inc.",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"MSFT",name:"Microsoft Corporation",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"AMZN",name:"Amazon.com Inc.",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"TSLA",name:"Tesla Inc.",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"META",name:"Meta Platforms Inc.",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"NVDA",name:"NVIDIA Corporation",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"ADANIPORTS.NS",name:"Adani Ports and Special Economic Zone Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"AXISBANK.NS",name:"Axis Bank Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"BAJAJ-AUTO.NS",name:"Bajaj Auto Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"BRITANNIA.NS",name:"Britannia Industries Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"CIPLA.NS",name:"Cipla Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"DRREDDY.NS",name:"Dr. Reddys Laboratories Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"EICHERMOT.NS",name:"Eicher Motors Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"GRASIM.NS",name:"Grasim Industries Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"HEROMOTOCO.NS",name:"Hero MotoCorp Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"JSWSTEEL.NS",name:"JSW Steel Limited",exchange:"NSE",currency:"INR",type:"stock"},{symbol:"TSLA",name:"Tesla Inc.",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"META",name:"Meta Platforms Inc.",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"NVDA",name:"NVIDIA Corporation",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"NFLX",name:"Netflix Inc.",exchange:"NASDAQ",currency:"USD",type:"stock"},{symbol:"CRM",name:"Salesforce Inc.",exchange:"NYSE",currency:"USD",type:"stock"},{symbol:"ADBE",name:"Adobe Inc.",exchange:"NASDAQ",currency:"USD",type:"stock"}],vg=[{symbol:"AAPL",name:"Apple Inc.",change:2.15,changesPercentage:1.24,price:175.43},{symbol:"NVDA",name:"NVIDIA Corporation",change:15.42,changesPercentage:1.79,price:875.28},{symbol:"META",name:"Meta Platforms Inc.",change:8.75,changesPercentage:1.84,price:484.2},{symbol:"GOOGL",name:"Alphabet Inc.",change:3.42,changesPercentage:2.46,price:142.56},{symbol:"AMZN",name:"Amazon.com Inc.",change:1.87,changesPercentage:1.25,price:151.94}],xg=[{title:"Reliance Industries Reports Strong Q3 Results",text:"Reliance Industries Limited reported strong quarterly results with increased revenue from petrochemicals and retail segments.",url:"#",image:"https://via.placeholder.com/300x200",site:"Economic Times",publishedDate:new Date().toISOString(),symbol:"RELIANCE"},{title:"TCS Announces New Digital Transformation Services",text:"Tata Consultancy Services launches new suite of digital transformation services for enterprise clients.",url:"#",image:"https://via.placeholder.com/300x200",site:"Business Standard",publishedDate:new Date(Date.now()-36e5).toISOString(),symbol:"TCS"},{title:"Indian IT Sector Shows Resilience Amid Global Challenges",text:"The Indian IT sector continues to show strong performance despite global economic uncertainties.",url:"#",image:"https://via.placeholder.com/300x200",site:"Financial Express",publishedDate:new Date(Date.now()-72e5).toISOString(),symbol:"INFY"}],ai={searchStocks:async(s,e=10)=>{if(await new Promise(r=>setTimeout(r,300)),console.log(`🔍 Mock API searching for: "${s}"`),!s||s.trim()===""){console.log("⚠️ Empty search query, returning popular stocks");const r=el.slice(0,e);return{success:!0,results:r,total:r.length}}const t=s.toLowerCase().trim(),n=el.map(r=>{let a=0;const o=r.symbol.toLowerCase(),l=r.name.toLowerCase();return o===t?a+=100:o.startsWith(t)?a+=50:o.includes(t)&&(a+=25),l===t?a+=75:l.startsWith(t)?a+=40:l.split(" ").some(c=>c.startsWith(t))?a+=30:l.includes(t)&&(a+=20),(r.exchange==="NSE"||r.exchange==="BSE"||r.symbol.endsWith(".NS")||r.symbol.endsWith(".BO"))&&(a+=10),{stock:r,score:a}}).filter(r=>r.score>0).sort((r,a)=>a.score-r.score).map(r=>r.stock).slice(0,e);return console.log(`📊 Mock search found ${n.length} results for "${s}"`),n.length>0&&console.log("📋 Sample results:",n.slice(0,3)),{success:!0,results:n,total:n.length}},getStockQuote:async s=>{await new Promise(t=>setTimeout(t,200));const e=Zo[s.toUpperCase()];return e?{success:!0,data:e}:{success:!1,error:"Stock not found"}},getHistoricalData:async(s,e="1D")=>{var r;await new Promise(a=>setTimeout(a,500));const t=((r=Zo[s.toUpperCase()])==null?void 0:r.price)||100;return{success:!0,data:yg(s,t,e==="1D"?1:e==="1M"?30:90),symbol:s,period:e}},getGainers:async(s=10)=>(await new Promise(e=>setTimeout(e,300)),{success:!0,data:vg.slice(0,s)}),getMarketNews:async(s=20)=>(await new Promise(e=>setTimeout(e,400)),{success:!0,data:xg.slice(0,s)})},bg="https://financialmodelingprep.com/api/v3",Nt=["VCMjfaz3k5CjRqbLvtpMALKTks5YVLxx","sYWvqZLnzWgIlTE2XBWWL0ZxDUK4O1MY","ORvcjYythoW1cNX3sA7gvYD46sK8mxvx",void 0].filter(Boolean),Ua=new Set,wg=()=>Nt.some(s=>!Ua.has(s)),jg=s=>{Ua.add(s),console.warn(`❌ API key marked as failed: ${s.substring(0,8)}...`)};Nt.length===0&&console.warn("⚠️ No FMP API keys found in environment variables. Using mock data for development.");let _s=0,ei=Nt[_s];const tl=()=>{ei&&jg(ei);for(let s=_s+1;s<Nt.length;s++)if(!Ua.has(Nt[s]))return _s=s,ei=Nt[_s],console.log(`🔄 Switching to API key ${_s+1}/${Nt.length} due to API error`),yt.defaults.params.apikey=ei,!0;return console.log("⚠️ All API keys exhausted or failed, falling back to mock data"),!1},Sg=()=>Nt.length>0&&wg();Nt.length>0?console.log(`✅ FMP API initialized with ${Nt.length} API key(s)`):console.warn("⚠️ No FMP API keys found. Using mock data for development.");const yt=xe.create({baseURL:bg,timeout:1e4,params:{apikey:ei}});yt.interceptors.request.use(s=>{var e;return console.log(`🔄 FMP API Request: ${(e=s.method)==null?void 0:e.toUpperCase()} ${s.url}`),s},s=>(console.error("🚫 FMP API Request Error:",s),Promise.reject(s)));yt.interceptors.response.use(s=>(console.log(`✅ FMP API Response: ${s.config.url} - ${s.status}`),s),s=>{var e;return console.error("🚫 FMP API Response Error:",(e=s.response)==null?void 0:e.status,s.message),Promise.reject(s)});const Wt={searchStocks:async(s,e=10)=>{var t,n,r,a,o,l;if(!Sg())return console.log("🎭 No valid API keys, using mock data for search"),await ai.searchStocks(s,e);try{console.log(`🔄 FMP API Request: GET /search?query=${s}&limit=${e}`),console.log(`🔑 Using API Key ${_s+1}/${Nt.length}`);const c=await yt.get("/search",{params:{query:s,limit:e}});if(console.log(`✅ FMP Search response status: ${c.status}`),console.log("📊 FMP Search raw data:",c.data),console.log(`📈 FMP Search results: ${c.data.length} stocks found`),!Array.isArray(c.data))throw console.error("❌ FMP API returned non-array data:",c.data),new Error("Invalid response format from FMP API");const h=c.data.map(m=>({symbol:m.symbol,name:m.name,exchange:m.exchangeShortName||"Unknown",currency:m.currency||"USD",type:m.type||"stock"}));h.length>0&&console.log("📊 Mapped results sample:",h.slice(0,3));const d={success:!0,results:h,total:c.data.length};return console.log("🎯 Final search result object:",d),d}catch(c){const h=((t=c.response)==null?void 0:t.status)===429,d=((n=c.response)==null?void 0:n.status)===403,m=((r=c.response)==null?void 0:r.status)===401,x=h||d||m,b=h?"Rate limit exceeded":d?"API key forbidden/invalid":m?"API key unauthorized":c.message;if(console.warn(`🚫 FMP Stock search failed: ${b} (Status: ${(a=c.response)==null?void 0:a.status})`),x&&tl()){console.log("🔄 Retrying with next API key...");try{const g=await yt.get("/search",{params:{query:s,limit:e}});return console.log(`✅ Next API key success: ${g.data.length} results`),{success:!0,results:g.data.map(y=>({symbol:y.symbol,name:y.name,exchange:y.exchangeShortName||"Unknown",currency:y.currency||"USD",type:y.type||"stock"})),total:g.data.length}}catch(g){const f=((o=g.response)==null?void 0:o.status)===429;if(console.warn(`🚫 Next API key also failed: ${g.message}`),f&&tl()){console.log("🔄 Trying final API key...");try{const y=await yt.get("/search",{params:{query:s,limit:e}});return console.log(`✅ Final API key success: ${y.data.length} results`),{success:!0,results:y.data.map(k=>({symbol:k.symbol,name:k.name,exchange:k.exchangeShortName||"Unknown",currency:k.currency||"USD",type:k.type||"stock"})),total:y.data.length}}catch(y){console.warn("🚫 All API keys failed:",y.message)}}}}h?console.log("⏰ All API keys rate limited - using mock data"):console.log("📋 Error details:",((l=c.response)==null?void 0:l.data)||c),console.log("⚠️ Falling back to mock data for search");const p=await ai.searchStocks(s,e);return console.log("🎭 Mock search result:",p),p}},getStockQuote:async s=>(console.log(`🎭 Using mock data for quote: ${s}`),await ai.getStockQuote(s)),getMultipleQuotes:async s=>{try{const e=Array.isArray(s)?s.join(","):s;return{success:!0,data:(await yt.get(`/quote/${e}`)).data.map(n=>({symbol:n.symbol,name:n.name,price:n.price,change:n.change,changesPercentage:n.changesPercentage,volume:n.volume,marketCap:n.marketCap}))}}catch(e){return console.error("FMP Multiple quotes error:",e),{success:!1,data:[],error:e.message}}},getStockProfile:async s=>{try{const t=(await yt.get(`/profile/${s}`)).data[0];if(!t)throw new Error("Company profile not found");return{success:!0,data:{symbol:t.symbol,companyName:t.companyName,currency:t.currency,exchange:t.exchangeShortName,industry:t.industry,sector:t.sector,country:t.country,marketCap:t.mktCap,price:t.price,beta:t.beta,volAvg:t.volAvg,lastDiv:t.lastDiv,range:t.range,changes:t.changes,description:t.description,ceo:t.ceo,website:t.website,image:t.image}}}catch(e){return console.error("FMP Stock profile error:",e),{success:!1,error:e.message}}}},Ng={getHistoricalData:async(s,e="1D",t=null,n=null)=>(console.log(`🎭 Using mock data for historical data: ${s} (${e})`),await ai.getHistoricalData(s,e)),getIntradayData:async(s,e="1min")=>{try{return{success:!0,data:(await yt.get(`/historical-chart/${e}/${s}`)).data.map(r=>({time:r.date,open:r.open,high:r.high,low:r.low,close:r.close,volume:r.volume})).reverse(),symbol:s,interval:e}}catch(t){return console.error("FMP Intraday data error:",t),{success:!1,data:[],error:t.message}}}},ph={getGainers:async(s=10)=>{try{return{success:!0,data:(await yt.get("/gainers",{params:{limit:s}})).data.map(t=>({symbol:t.symbol,name:t.name,change:t.change,changesPercentage:t.changesPercentage,price:t.price}))}}catch(e){return console.warn("FMP Gainers failed, using mock data:",e.message),await ai.getGainers(s)}},getLosers:async(s=10)=>{try{return{success:!0,data:(await yt.get("/losers",{params:{limit:s}})).data.map(t=>({symbol:t.symbol,name:t.name,change:t.change,changesPercentage:t.changesPercentage,price:t.price}))}}catch(e){return console.error("FMP Losers error:",e),{success:!1,data:[],error:e.message}}},getMarketNews:async(s=20)=>{try{return{success:!0,data:(await yt.get("/stock_news",{params:{limit:s}})).data.map(t=>({title:t.title,text:t.text,url:t.url,image:t.image,site:t.site,publishedDate:t.publishedDate,symbol:t.symbol}))}}catch(e){return console.error("FMP Market news error:",e),{success:!1,data:[],error:e.message}}}},jr={stock:Wt,chart:Ng,market:ph},kg="http://localhost:5001",ae=xe.create({baseURL:kg,timeout:3e4,headers:{"Content-Type":"application/json"}});ae.interceptors.request.use(s=>{const e=localStorage.getItem("token");return e&&(s.headers.Authorization=`Bearer ${e}`),s},s=>Promise.reject(s));ae.interceptors.response.use(s=>s,s=>{var e,t;return s.code==="ERR_NETWORK"||((e=s.response)==null||e.status),((t=s.response)==null?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(s)});const Ni={login:async s=>(await ae.post("/auth/login",s)).data,register:async s=>(await ae.post("/auth/register",s)).data,verifyToken:async()=>(await ae.get("/auth/verify")).data,googleAuth:async s=>(await ae.post("/auth/google",{tokenId:s})).data,logout:async()=>(await ae.post("/auth/logout")).data},ki={getQuote:async s=>(await ae.get(`/proxy/fmp/quote/${s}`)).data,getBatchQuotes:async s=>{const e=Array.isArray(s)?s.join(","):s;return(await ae.get(`/proxy/stock-batch?symbols=${e}`)).data},searchStocks:async(s,e=10)=>{try{return(await ae.get(`/search/stocks?q=${encodeURIComponent(s)}&limit=${e}`)).data}catch(t){return console.warn("Backend search failed, trying FMP API directly:",t),await Wt.searchStocks(s,e)}},getStockSuggestions:async(s,e=5)=>{try{return(await ae.get(`/search/suggestions?q=${encodeURIComponent(s)}&limit=${e}`)).data}catch(t){console.warn("Backend suggestions failed, using FMP API:",t);const n=await Wt.searchStocks(s,e);return{success:n.success,suggestions:n.results||[]}}},getTrendingStocks:async(s=10)=>{try{return(await ae.get(`/search/trending?limit=${s}`)).data}catch(e){console.warn("Backend trending failed, using FMP gainers:",e);const t=await ph.getGainers(s);return{success:t.success,results:t.data||[]}}},getStockQuote:async s=>await Wt.getStockQuote(s),getMultipleQuotes:async s=>await Wt.getMultipleQuotes(s),getStockProfile:async s=>await Wt.getStockProfile(s),getMarketMovers:async()=>{try{const[s,e]=await Promise.all([ae.get("/proxy/top-gainers"),ae.get("/proxy/top-losers")]);return{gainers:s.data||[],losers:e.data||[],mostActive:[]}}catch(s){return console.error("Error fetching market movers:",s),{gainers:[],losers:[],mostActive:[]}}},getIndianIndices:async()=>(await ae.get("/proxy/market-indices")).data,getNSEGainers:async(s=10)=>(await ae.get(`/stocks/nse-gainers?limit=${s}`)).data,getNSELosers:async(s=10)=>(await ae.get(`/stocks/nse-losers?limit=${s}`)).data,getProfile:async s=>(await ae.get(`/stocks/profile/${s}`)).data,getHistoricalData:async(s,e="1y")=>(await ae.get(`/stocks/historical/${s}?period=${e}`)).data,getIntradayData:async(s,e="5min")=>(await ae.get(`/stocks/intraday/${s}?interval=${e}`)).data,getLivePortfolio:async()=>(await ae.get("/api/portfolio/live")).data,getMarketStatus:async()=>(await ae.get("/api/stocks/market-status")).data,getRealTimePrice:async s=>(await ae.get(`/stocks/realtime/${s}`)).data},gh={getSummary:async()=>(await ae.get("/portfolio/summary")).data,getHoldings:async()=>(await ae.get("/portfolio/holdings")).data,getPerformance:async(s="1m")=>(await ae.get(`/portfolio/performance?period=${s}`)).data,getAnalytics:async()=>(await ae.get("/portfolio/analytics")).data},Ns={placeOrder:async s=>(await ae.post("/orders/place",s)).data,getOrders:async({status:s="all",page:e=1,limit:t=20,stockSymbol:n=null,type:r=null,orderType:a=null,sort:o="-createdAt"}={})=>{let l=`/orders/all?page=${e}&limit=${t}&sort=${o}`;return s!=="all"&&(l+=`&status=${s}`),n&&(l+=`&stockSymbol=${n.toUpperCase()}`),r&&(l+=`&type=${r}`),a&&(l+=`&orderType=${a}`),(await ae.get(l)).data},searchOrders:async(s,e={})=>{const{status:t,type:n,orderType:r,limit:a=20}=e;let o=`/orders/all?stockSymbol=${s.toUpperCase()}&limit=${a}`;return t&&(o+=`&status=${t}`),n&&(o+=`&type=${n}`),r&&(o+=`&orderType=${r}`),(await ae.get(o)).data},cancelOrder:async s=>(await ae.delete(`/orders/${s}`)).data,getOrderHistory:async(s=50)=>(await ae.get(`/orders/history?limit=${s}`)).data,getRecentTrades:async(s=10)=>(await ae.get(`/trades/recent?limit=${s}`)).data},Hs={getWatchlists:async()=>(await ae.get("/watchlist")).data,createWatchlist:async(s,e="")=>(await ae.post("/watchlist",{name:s,description:e})).data,addStock:async(s,e)=>(await ae.post(`/watchlist/${s}/add`,{symbol:e})).data,removeStock:async(s,e)=>(await ae.delete(`/watchlist/${s}/remove/${e}`)).data,deleteWatchlist:async s=>(await ae.delete(`/watchlist/${s}`)).data,searchStocks:async(s,e=10)=>(await ae.get(`/watchlist/search?query=${encodeURIComponent(s)}&limit=${e}`)).data},yh={startSession:async()=>({success:!0,sessionId:(await ae.post("/saytrix/chat",{message:"Hello",sessionId:null})).sessionId||"new-session",message:{id:"welcome_"+Date.now(),content:`Hello! I'm Saytrix, your AI-powered stock market assistant. I can help you with:

• Real-time stock prices and data
• Market analysis and trends
• Company information and fundamentals
• Top gainers and losers
• Latest market news
• Stock market education

What would you like to know about the stock market today?`,timestamp:new Date().toISOString(),suggestions:["Show me NIFTY performance","What are today's top gainers?","Tell me about RELIANCE stock","Latest market news"]}}),sendMessage:async(s,e=null)=>(await ae.post("/saytrix/chat",{message:s,sessionId:e})).data,getChatHistory:async s=>(await ae.get(`/saytrix/history/${s}`)).data,voiceCommand:async s=>{const e=new FormData;return e.append("audio",s),(await ae.post("/saytrix/voice",e,{headers:{"Content-Type":"multipart/form-data"}})).data},getStockAnalysis:async s=>(await ae.get(`/saytrix/analysis/${s}`)).data,clearSession:async s=>(await ae.post("/saytrix/clear",{sessionId:s})).data,getSuggestions:async s=>(await ae.get(`/saytrix/suggestions?input=${encodeURIComponent(s)}`)).data},Wa={getMarketNews:async(s=20)=>(await ae.get(`/news/market?limit=${s}`)).data,getNews:async({category:s="all",limit:e=20,q:t=null}={})=>{let n=`/news?limit=${e}`;return t&&(n+=`&q=${encodeURIComponent(t)}`),(await ae.get(n)).data},searchNews:async(s,e=20)=>(await ae.get(`/news/search?q=${encodeURIComponent(s)}&limit=${e}`)).data,getStockNews:async(s,e=10)=>(await ae.get(`/news/stock/${s}?limit=${e}`)).data,getTrendingNews:async()=>(await ae.get("/news/trending")).data};class Cg{constructor(e){this.navigate=e}async processCommand(e){console.log("AI Processing:",e);const t=this.localProcess(e);if(t.success)return t;try{const n=await yh.sendMessage(e,"voice_session");if(n.success&&n.data.action)return this.executeAction(n.data.action,n.data.params)}catch{console.log("AI processing failed, using local")}return{success:!1,message:"Command not recognized"}}executeAction(e,t={}){switch(e){case"navigate":return this.navigate(t.path),{success:!0,message:`Navigating to ${t.path}`};case"search_stock":return this.navigate(`/stock/${t.symbol}`),{success:!0,message:`Showing ${t.symbol} details`};case"buy_stock":return this.navigate("/trading"),{success:!0,message:"Opening trading page"};case"show_portfolio":return this.navigate("/portfolio"),{success:!0,message:"Opening portfolio"};default:return{success:!1,message:"Command not understood"}}}localProcess(e){const t=e.toLowerCase().trim(),n={chart:"/charts",charge:"/charts",charts:"/charts",dashboard:"/dashboard",home:"/dashboard",portfolio:"/portfolio",trading:"/trading",trade:"/trading",orders:"/orders",order:"/orders",history:"/history",news:"/news",watchlist:"/watchlist",notifications:"/notifications",profile:"/profile",settings:"/settings",saytrix:"/saytrix"};for(const[r,a]of Object.entries(n))if(t===r||t.includes(r))return console.log(`Navigating to ${a}`),this.navigate(a),{success:!0,message:`Opening ${r}`};if(t.includes("price")||t.includes("stock")){const r=t.match(/(?:price of|stock|show me)\s+([a-z]+)/i);if(r){const a=r[1].toUpperCase();return this.navigate(`/stock/${a}`),{success:!0,message:`Showing ${a} price`}}}return{success:!1}}}const vh=v.createContext(),Un=()=>{const s=v.useContext(vh);if(s===void 0)throw new Error("useVoice must be used within a VoiceProvider");return s},Pg=({children:s})=>{const e=Ve(),t=new Cg(e),[n,r]=v.useState(!1),[a,o]=v.useState(!1),[l,c]=v.useState(""),[h,d]=v.useState(null),[m,x]=v.useState(!1);v.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const N=window.SpeechRecognition||window.webkitSpeechRecognition,T=new N;T.continuous=!0,T.interimResults=!0,T.lang="en-US",T.maxAlternatives=1,d(T),x(!0)}else console.warn("Speech recognition not supported in this browser"),x(!1)},[]);const b=v.useCallback(N=>{const T=N.toLowerCase().trim();if(console.log("Processing voice command:",T),T.includes("dashboard")||T.includes("home")?e("/dashboard"):T.includes("chart")||T.includes("charge")?e("/charts"):T.includes("portfolio")?e("/portfolio"):T.includes("watchlist")||T.includes("watch list")?e("/watchlist"):T.includes("orders")||T.includes("order")?e("/orders"):T.includes("history")?e("/history"):T.includes("news")?e("/news"):T.includes("notifications")||T.includes("notification")?e("/notifications"):T.includes("saytrix")||T.includes("chat")?e("/saytrix"):T.includes("profile")?e("/profile"):T.includes("settings")||T.includes("setting")?e("/settings"):(T.includes("trading")||T.includes("trade"))&&e("/trading"),T.includes("price of")||T.includes("show price")){const I=p(T);I&&e(`/stock/${I}`)}else(T.includes("top gainers")||T.includes("gainers")||T.includes("top losers")||T.includes("losers"))&&e("/dashboard");(T.includes("buy")&&(T.includes("stock")||T.includes("share"))||T.includes("sell")&&(T.includes("stock")||T.includes("share")))&&e("/trading")},[e]),p=v.useCallback(N=>{const T=[/price of ([a-zA-Z]+)/i,/show price ([a-zA-Z]+)/i,/([a-zA-Z]+) price/i];for(const I of T){const P=N.match(I);if(P)return P[1].toUpperCase()}return null},[]),g=v.useCallback(N=>{if("speechSynthesis"in window){const T=new SpeechSynthesisUtterance(N);T.rate=.9,T.pitch=1,T.volume=.8,speechSynthesis.speak(T)}},[]),f=v.useCallback(()=>{if(!(!h||!m||n)){r(!0),h.onresult=N=>{let T="";for(let L=N.resultIndex;L<N.results.length;L++){const M=N.results[L][0].transcript;N.results[L].isFinal,T+=M}console.log("Heard:",T),c(T),["saytrix","citrix","citric","matrix","tricks","se tric","say tricks"].some(L=>T.toLowerCase().includes(L))&&(console.log("Wake word detected:",T),h.stop(),y())},h.onerror=N=>{console.error("Speech recognition error:",N.error),N.error==="not-allowed"&&alert("Please allow microphone access to use voice commands."),r(!1),N.error!=="aborted"&&setTimeout(()=>{f()},1e3)},h.onend=()=>{console.log("Wake word detection ended"),r(!1),a||setTimeout(()=>{f()},500)};try{h.start(),console.log('Voice recognition started - say "Saytrix" to activate')}catch(N){N.name!=="InvalidStateError"&&(console.log("Recognition start failed:",N),r(!1))}}},[h,m,n,a]),y=v.useCallback(()=>{if(console.log("Voice mode activated"),o(!0),g("Yes?"),!!h){h.onresult=N=>{let T="";for(let I=N.resultIndex;I<N.results.length;I++){const P=N.results[I][0].transcript;N.results[I].isFinal&&(T+=P)}if(T){console.log("Voice command received:",T),c(T);let I=T;if(N.results[0].length>1){I=N.results[0][0].transcript;for(let P=1;P<N.results[0].length;P++)N.results[0][P].confidence>N.results[0][0].confidence&&(I=N.results[0][P].transcript)}t.processCommand(I).then(P=>{console.log("Command executed:",P),P.success?g(P.message||"Done"):g("Could you repeat that?")}),o(!1),h.stop(),setTimeout(()=>{f()},500)}};try{h.start()}catch(N){console.log("Voice mode recognition failed:",N)}}},[h,b,g,f]),S=v.useCallback(()=>{if(r(!1),o(!1),h)try{h.stop()}catch{}},[h]),k=v.useCallback(()=>{if(!m){alert("Voice commands are not supported in this browser. Please use Chrome, Edge, or Safari.");return}a?S():y()},[m,a,y,S]);v.useEffect(()=>(m&&!n&&!a&&f(),()=>{if(h)try{h.stop()}catch{}}),[m,f]);const C={isListening:n,isVoiceModeActive:a,transcript:l,isSupported:m,triggerVoiceMode:k,stopListening:S,speak:g,activateVoiceMode:y,startWakeWordDetection:f,processVoiceCommand:b};return i.jsx(vh.Provider,{value:C,children:s})},Tg=({position:s="navbar",size:e="small",showLabel:t=!1,className:n=""})=>{const{isVoiceModeActive:r,isListening:a,isSupported:o,triggerVoiceMode:l}=Un(),c=()=>{l()};return o?i.jsxs("button",{className:`saytrix-trigger-btn ${s} ${e} ${n} ${r?"active":""} ${a?"listening":""}`,onClick:c,title:r?"Deactivate Saytrix AI":"Activate Saytrix AI","aria-label":r?"Deactivate Saytrix AI voice assistant":"Activate Saytrix AI voice assistant",children:[r?i.jsx(Ba,{}):i.jsx(Us,{}),t&&i.jsx("span",{children:"Saytrix"}),a&&i.jsx("div",{className:"pulse-indicator"})]}):null},xh=v.createContext(),Va=()=>{const s=v.useContext(xh);if(!s)throw new Error("useLocalSidebar must be used within LocalSidebarProvider");return s},Eg=({children:s})=>{const[e,t]=v.useState(!1),[n,r]=v.useState(!1);v.useEffect(()=>{const l=()=>{const c=window.innerWidth<=768;r(c),c&&t(!0)};return l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),v.useEffect(()=>{const l=document.querySelector(".main-content");return l&&(l.classList.add("with-sidebar"),e?(l.classList.add("sidebar-collapsed"),l.classList.remove("sidebar-expanded")):(l.classList.add("sidebar-expanded"),l.classList.remove("sidebar-collapsed"))),()=>{l&&l.classList.remove("with-sidebar","sidebar-collapsed","sidebar-expanded")}},[e]);const o={isCollapsed:e,isMobile:n,toggleSidebar:()=>{t(!e)},setIsCollapsed:t};return i.jsx(xh.Provider,{value:o,children:s})},Ig=()=>{const{isCollapsed:s,isMobile:e,toggleSidebar:t}=Va();return!e||!s?null:i.jsx("button",{className:"mobile-menu-btn",onClick:t,"aria-label":"Open navigation menu",type:"button",children:i.jsx(Fa,{})})},_g=()=>{const{isCollapsed:s,isMobile:e,toggleSidebar:t}=Va();return!e||s?null:i.jsx("div",{className:`sidebar-overlay ${s?"":"show"}`,onClick:t,"aria-hidden":"true"})},Lg=()=>{const{isCollapsed:s,isMobile:e,toggleSidebar:t}=Va(),{unreadCount:n}=zn(),r=$t(),a=Ve(),{isAuthenticated:o,logout:l}=Bt(),c=v.useRef(null),[h,d]=v.useState(!1),[m,x]=v.useState(!1),{user:b}=Bt();v.useEffect(()=>{(async()=>{await new Promise(y=>setTimeout(y,100)),d(!0)})()},[]);const p=f=>{f.preventDefault(),f.stopPropagation(),x(!0),t(),setTimeout(()=>x(!1),300)},g=()=>{l(),a("/login")};return v.useEffect(()=>{(()=>{const y=document.documentElement;e?y.style.setProperty("--sidebar-current-width","0px"):y.style.setProperty("--sidebar-current-width",s?"80px":"280px")})()},[s,e]),i.jsxs("div",{ref:c,className:`sidebar ${s?"collapsed":""} ${e?"mobile":""} ${h?"loaded":"loading"} ${m?"animating":""}`,role:"navigation","aria-label":"Main navigation",style:{position:"fixed",top:"0px",left:"0px",width:s?"80px":"280px",height:"100vh",zIndex:999999,background:"white",borderRight:"1px solid #e5e7eb",padding:"24px 20px",display:"flex",flexDirection:"column",overflowY:"auto",margin:"0px",transform:"none"},children:[i.jsxs("div",{className:"top-section",children:[i.jsx("button",{className:"toggle-btn",onClick:p,type:"button","aria-label":s?"Expand sidebar navigation":"Collapse sidebar navigation",title:s?"Expand sidebar":"Collapse sidebar","aria-expanded":!s,children:i.jsx(Fa,{})}),(!s||e)&&i.jsxs("div",{className:"logo-section",children:[i.jsx("h1",{className:"logo",role:"banner",children:"⚡ TradeBro"}),!s&&i.jsx(Tg,{position:"navbar",size:"small",showLabel:!1,className:"sidebar-voice-btn"})]})]}),!s&&b&&i.jsxs("div",{className:"user-profile",children:[i.jsx("div",{className:"user-avatar",children:b.profileImage?i.jsx("img",{src:b.profileImage,alt:b.fullName,className:"avatar-image"}):i.jsx("div",{className:"avatar-symbol",children:b.fullName?b.fullName.charAt(0).toUpperCase():"👤"})}),i.jsxs("div",{className:"user-info",children:[i.jsx("h3",{className:"user-name",children:b.fullName||b.firstName||"User"}),i.jsx("p",{className:"user-role",children:"Member"})]})]}),i.jsx("nav",{role:"navigation","aria-label":"Main menu",children:i.jsxs("ul",{className:"sidebar-links",children:[i.jsx("li",{children:i.jsxs(be,{to:"/dashboard",className:`sidebar-link ${r.pathname==="/dashboard"?"active":""}`,"aria-current":r.pathname==="/dashboard"?"page":void 0,title:"Dashboard",children:[i.jsx(rt,{"aria-hidden":"true"}),!s&&i.jsx("span",{children:"Dashboard"})]})}),i.jsx("li",{children:i.jsxs(be,{to:"/charts",className:`sidebar-link ${r.pathname==="/charts"?"active":""}`,children:[i.jsx(Pe,{}),!s&&i.jsx("span",{children:"Charts"})]})}),i.jsx("li",{children:i.jsxs(be,{to:"/portfolio",className:`sidebar-link ${r.pathname==="/portfolio"?"active":""}`,children:[i.jsx(fi,{}),!s&&i.jsx("span",{children:"Portfolio"})]})}),i.jsx("li",{children:i.jsxs(be,{to:"/watchlist",className:`sidebar-link ${r.pathname==="/watchlist"?"active":""}`,children:[i.jsx(cs,{}),!s&&i.jsx("span",{children:"Watchlist"})]})}),i.jsx("li",{children:i.jsxs(be,{to:"/orders",className:`sidebar-link ${r.pathname==="/orders"?"active":""}`,children:[i.jsx(tt,{}),!s&&i.jsx("span",{children:"Orders"})]})}),i.jsx("li",{children:i.jsxs(be,{to:"/history",className:`sidebar-link ${r.pathname==="/history"?"active":""}`,children:[i.jsx(st,{}),!s&&i.jsx("span",{children:"History"})]})}),i.jsx("li",{children:i.jsxs(be,{to:"/news",className:`sidebar-link ${r.pathname==="/news"?"active":""}`,children:[i.jsx(jf,{}),!s&&i.jsx("span",{children:"News"})]})}),i.jsx("li",{children:i.jsx(be,{to:"/notifications",className:`sidebar-link ${r.pathname==="/notifications"?"active":""}`,children:i.jsxs("div",{className:"sidebar-link-content",children:[i.jsxs("div",{className:"sidebar-icon-wrapper",children:[i.jsx(ls,{}),n>0&&i.jsx("span",{className:"notification-badge",children:n>99?"99+":n})]}),!s&&i.jsx("span",{children:"Notifications"})]})})}),i.jsx("li",{children:i.jsxs(be,{to:"/saytrix",className:`sidebar-link ${r.pathname==="/saytrix"||r.pathname==="/chatbot"?"active":""} highlight`,children:[i.jsx(Mc,{}),!s&&i.jsx("span",{children:"Saytrix AI"})]})})]})}),i.jsxs("div",{className:"sidebar-bottom",children:[i.jsxs("div",{className:"sidebar-actions",children:[i.jsxs(be,{to:"/profile",className:`sidebar-link ${r.pathname==="/profile"?"active":""}`,children:[i.jsx(ht,{}),!s&&i.jsx("span",{children:"Profile"})]}),i.jsxs(be,{to:"/settings",className:`sidebar-link ${r.pathname==="/settings"?"active":""}`,children:[i.jsx(Os,{}),!s&&i.jsx("span",{children:"Settings"})]}),i.jsxs("button",{onClick:g,className:"sidebar-link logout-btn","aria-label":"Logout from TradeBro",title:"Logout from TradeBro",children:[i.jsx(Lc,{}),!s&&i.jsx("span",{children:"Logout"})]})]}),!s&&i.jsxs("div",{className:"sidebar-footer",children:[i.jsx("p",{className:"copyright",children:"© 2024 TradeBro ⚡"}),i.jsx("p",{className:"version",children:"v1.0.0 • 🚀"})]})]})]})},Mg=()=>{const s=$t(),{isAuthenticated:e}=Bt();return e&&!["/login","/signup","/"].includes(s.pathname)?i.jsxs(Eg,{children:[i.jsx(Ig,{}),i.jsx(_g,{}),i.jsx(Lg,{})]}):null},Rg=({isAuthenticated:s})=>s?null:i.jsxs(F.div,{className:"card card-glass",style:{position:"fixed",bottom:"24px",right:"24px",width:"320px",zIndex:999,background:"rgba(255, 255, 255, 0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.2)",boxShadow:"0 8px 20px rgba(0, 0, 0, 0.2)",borderRadius:"12px"},initial:{opacity:0,y:100,scale:.8},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:100,scale:.8},transition:{duration:.5,type:"spring",stiffness:100},children:[i.jsx("div",{className:"card-header",style:{padding:"16px"},children:i.jsxs("div",{className:"d-flex align-center gap-md",children:[i.jsx("div",{style:{width:"40px",height:"40px",background:"linear-gradient(135deg, #4facfe, #00f2fe)",borderRadius:"8px",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx(mi,{size:20})}),i.jsxs("div",{children:[i.jsx("h3",{style:{fontSize:"1rem",marginBottom:"4px"},children:"Sign In Required"}),i.jsx("p",{style:{fontSize:"0.75rem",color:"#ccc"},children:"Access premium features"})]})]})}),i.jsxs("div",{className:"card-body",style:{padding:"16px"},children:[i.jsx("p",{style:{fontSize:"0.875rem",color:"#bbb",marginBottom:"16px",lineHeight:1.5},children:"Sign in to access your portfolio, trading tools, and personalized insights."}),i.jsxs("div",{className:"d-flex gap-sm",children:[i.jsxs(be,{to:"/login",className:"btn btn-primary btn-sm flex-1",children:[i.jsx(ht,{size:14})," Sign In"]}),i.jsxs(be,{to:"/signup",className:"btn btn-outline btn-sm flex-1",children:[i.jsx(lt,{size:14})," Sign Up"]})]})]})]}),fn={STOCK_SEARCH:"tradebro_stock_search_history",NEWS_SEARCH:"tradebro_news_search_history",ORDER_SEARCH:"tradebro_order_search_history",GLOBAL_SEARCH:"tradebro_global_search_history"},Ag=10,bh=s=>{try{const e=fn[`${s.toUpperCase()}_SEARCH`]||fn.GLOBAL_SEARCH,t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch(e){return console.warn("Failed to get search history:",e),[]}},Og=(s,e,t={})=>{if(!(!e||e.trim().length<2))try{const n=fn[`${s.toUpperCase()}_SEARCH`]||fn.GLOBAL_SEARCH,r=bh(s),a={query:e.trim(),timestamp:Date.now(),type:s,...t},o=r.filter(c=>c.query.toLowerCase()!==e.toLowerCase()),l=[a,...o].slice(0,Ag);localStorage.setItem(n,JSON.stringify(l))}catch(n){console.warn("Failed to add to search history:",n)}},sl=s=>bh(s).slice(0,5),Ha=(s,e={})=>{const[t,n]=v.useState(""),[r,a]=v.useState([]),[o,l]=v.useState([]),[c,h]=v.useState(!1),[d,m]=v.useState(null),[x,b]=v.useState(null),[p,g]=v.useState([]),[f,y]=v.useState(!1),{debounceMs:S=300,minQueryLength:k=2,limit:C=10,enableSuggestions:N=!0,enableHistory:T=!0,filters:I={},onResults:P=null,onError:L=null}=e;v.useEffect(()=>{T&&g(sl(s))},[s,T]);const M=v.useCallback(z=>{x&&clearTimeout(x);const q=setTimeout(async()=>{z.length>=k?await O(z):(a([]),l([]),m(null))},S);b(q)},[x,k,S]),O=v.useCallback(async z=>{if(!(!z||z.length<k)){h(!0),m(null);try{let q=[],Y=[];switch(s){case"stocks":console.log(`🔍 Searching stocks for: "${z}"`);const te=await Wt.searchStocks(z,C);if(console.log("📊 Stock search response:",te),q=te.success?te.results:[],console.log(`📈 Found ${q.length} search results`),q.length>0){const ie=q.filter($=>$.exchange==="NSE"||$.exchange==="BSE"||$.symbol.endsWith(".NS")||$.symbol.endsWith(".BO")),D=q.filter($=>!($.exchange==="NSE"||$.exchange==="BSE"||$.symbol.endsWith(".NS")||$.symbol.endsWith(".BO")));q=[...ie,...D],console.log(`🇮🇳 Indian stocks: ${ie.length}, Other stocks: ${D.length}`)}N&&z.length>=1&&(Y=q.slice(0,5));break;case"news":const ne=await Wa.searchNews(z,C);q=ne.success?ne.data:[];break;case"orders":const re=await Ns.searchOrders(z,I);q=re.success?re.data:[];break;case"watchlist":const oe=await Hs.searchStocks(z,C);q=oe.success?oe.data:[];break;default:throw new Error(`Unsupported search type: ${s}`)}console.log("🎯 Setting search results:",q),console.log("💡 Setting search suggestions:",Y),a(q),l(Y),T&&q.length>0&&(Og(s,z,{resultsCount:q.length,hasResults:!0}),g(sl(s))),P&&P(q,z)}catch(q){console.error(`Search error for ${s}:`,q),m(q.message||"Search failed"),a([]),l([]),L&&L(q,z)}finally{h(!1)}}},[s,C,k,N,I,P,L]),B=v.useCallback(z=>{n(z),M(z)},[M]),R=v.useCallback(()=>{n(""),a([]),l([]),m(null),x&&clearTimeout(x)},[x]),A=v.useCallback((z=t)=>{O(z)},[O,t]);v.useEffect(()=>()=>{x&&clearTimeout(x)},[x]);const V=v.useCallback(z=>{n(z.query),y(!1),A(z.query)},[A]);return v.useMemo(()=>({query:t,results:r,suggestions:o,loading:c,error:d,recentSearches:p,showHistory:f,setQuery:B,clearSearch:R,triggerSearch:A,setShowHistory:y,handleHistoryClick:V,hasResults:r.length>0,hasSuggestions:o.length>0,hasRecentSearches:p.length>0,isEmpty:!c&&r.length===0&&t.length>=k,searchType:s,minQueryLength:k,enableHistory:T}),[t,r,o,c,d,p,f,B,R,A,V,s,k,T])},Ya=(s={})=>Ha("stocks",{enableSuggestions:!0,limit:10,...s}),wh=(s={})=>Ha("news",{enableSuggestions:!1,limit:20,...s}),Fg=(s={})=>Ha("orders",{enableSuggestions:!1,limit:20,minQueryLength:1,...s}),Ci=({placeholder:s="Search...",value:e="",onChange:t,onSearch:n,onClear:r,suggestions:a=[],onSuggestionClick:o,recentSearches:l=[],onHistoryClick:c,showHistory:h=!1,loading:d=!1,disabled:m=!1,size:x="md",showSuggestions:b=!0,enableHistory:p=!0,renderSuggestion:g,renderHistoryItem:f,className:y="",autoFocus:S=!1,...k})=>{const[C,N]=v.useState(!1),[T,I]=v.useState(!1),[P,L]=v.useState(-1),M=v.useRef(null),O=v.useRef(null),B=()=>{N(!0),b&&a.length>0&&I(!0)},R=$=>{setTimeout(()=>{var U;(U=O.current)!=null&&U.contains(document.activeElement)||(N(!1),I(!1))},150)},A=$=>{const U=$.target.value;t==null||t(U),b&&U.length>0&&a.length>0?I(!0):I(!1)},V=()=>{var $;t==null||t(""),r==null||r(),I(!1),($=M.current)==null||$.focus()},z=$=>{var U;o==null||o($),I(!1),(U=M.current)==null||U.blur()},q=()=>{const $=[];return ie&&$.push(...l.map(U=>({type:"history",data:U}))),D&&$.push(...a.map(U=>({type:"suggestion",data:U}))),$},Y=$=>{var X;const U=q();if($.key==="ArrowDown")$.preventDefault(),U.length>0&&(L(ce=>ce<U.length-1?ce+1:0),T||I(!0));else if($.key==="ArrowUp")$.preventDefault(),U.length>0&&(L(ce=>ce>0?ce-1:U.length-1),T||I(!0));else if($.key==="Enter"){if($.preventDefault(),P>=0&&U[P]){const ce=U[P];ce.type==="history"?c==null||c(ce.data):z(ce.data)}else n==null||n(e);I(!1),L(-1)}else $.key==="Escape"?(I(!1),L(-1),(X=M.current)==null||X.blur()):L(-1)};v.useEffect(()=>{S&&M.current&&M.current.focus()},[S]),v.useEffect(()=>{b&&C&&a.length>0&&e.length>0?I(!0):I(!1)},[a,b,C,e]);const te=($,U)=>{const X=$.symbol||$.title||$;return i.jsx("div",{className:"search-suggestion-item",children:i.jsxs("div",{className:"suggestion-content",children:[i.jsx("span",{className:"suggestion-text",children:X}),$.name&&i.jsx("span",{className:"suggestion-subtitle",children:$.name})]})},U)},ne=($,U)=>i.jsx("div",{className:"search-history-item",children:i.jsxs("div",{className:"history-content",children:[i.jsx(st,{className:"history-icon"}),i.jsx("span",{className:"history-text",children:$.query}),i.jsx("span",{className:"history-time",children:new Date($.timestamp).toLocaleDateString()})]})},U),re=g||te,oe=f||ne,ie=p&&h&&l.length>0&&!e,D=b&&a.length>0&&e;return i.jsxs("div",{className:`search-input-container ${y} size-${x}`,children:[i.jsxs("div",{className:`search-input-wrapper ${C?"focused":""} ${m?"disabled":""}`,children:[i.jsx(As,{className:"search-icon"}),i.jsx("input",{ref:M,type:"text",className:"search-input",placeholder:s,value:e,onChange:A,onFocus:B,onBlur:R,onKeyDown:Y,disabled:m,...k}),i.jsxs("div",{className:"search-actions",children:[d&&i.jsx(en,{className:"search-loading animate-spin"}),e&&!d&&i.jsx("button",{type:"button",className:"search-clear",onClick:V,disabled:m,children:i.jsx(We,{})})]})]}),i.jsx(Se,{children:T&&(ie||D)&&i.jsxs(F.div,{ref:O,className:"search-suggestions-dropdown",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.15},children:[ie&&i.jsxs("div",{className:"history-section",children:[i.jsx("div",{className:"section-header",children:i.jsx("span",{className:"section-title",children:"Recent Searches"})}),i.jsx("div",{className:"history-list",children:l.map(($,U)=>{const X=P===U;return i.jsx(F.div,{className:`history-item-wrapper ${X?"selected":""}`,onClick:()=>c==null?void 0:c($),whileHover:{backgroundColor:"var(--hover-bg)"},transition:{duration:.1},children:oe($,U)},`history-${U}`)})})]}),D&&i.jsxs("div",{className:"suggestions-section",children:[ie&&i.jsx("div",{className:"section-header",children:i.jsx("span",{className:"section-title",children:"Suggestions"})}),i.jsx("div",{className:"suggestions-list",children:a.map(($,U)=>{const X=ie?l.length+U:U,ce=P===X;return i.jsx(F.div,{className:`suggestion-item-wrapper ${ce?"selected":""}`,onClick:()=>z($),whileHover:{backgroundColor:"var(--hover-bg)"},transition:{duration:.1},children:re($,U)},`suggestion-${U}`)})})]})]})})]})},Bg=({isOpen:s,onClose:e,onSearch:t})=>{const[n,r]=v.useState("stocks"),[a,o]=v.useState(""),l=v.useRef(null),c=Ya({enableSuggestions:!0,enableHistory:!0,limit:8}),h=wh({enableSuggestions:!1,enableHistory:!0,limit:6}),m=(()=>{switch(n){case"stocks":return c;case"news":return h;default:return c}})(),x=y=>{r(y),o(""),m.clearSearch()},b=y=>{y.trim()&&t(y.trim(),n)},p=y=>{const S=y.query||y.symbol||y.title||y;b(S)};v.useEffect(()=>{const y=S=>{l.current&&!l.current.contains(S.target)&&e()};if(s)return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[s,e]),v.useEffect(()=>{s&&setTimeout(()=>{var S;const y=(S=l.current)==null?void 0:S.querySelector(".search-input");y==null||y.focus()},100)},[s]);const g=[{id:"stocks",label:"Stocks",icon:Pe,placeholder:"Search stocks, symbols...",shortcut:"S"},{id:"news",label:"News",icon:Aa,placeholder:"Search news articles...",shortcut:"N"},{id:"orders",label:"Orders",icon:tt,placeholder:"Search orders by symbol...",shortcut:"O"}],f=g.find(y=>y.id===n);return i.jsx(Se,{children:s&&i.jsxs(i.Fragment,{children:[i.jsx(F.div,{className:"global-search-backdrop",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},onClick:e}),i.jsxs(F.div,{ref:l,className:"global-search-modal",initial:{opacity:0,scale:.95,y:-20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-20},transition:{duration:.2},children:[i.jsx("div",{className:"global-search-header",children:i.jsx("div",{className:"search-type-tabs",children:g.map(y=>{const S=y.icon;return i.jsxs("button",{className:`search-type-tab ${n===y.id?"active":""}`,onClick:()=>x(y.id),children:[i.jsx(S,{className:"tab-icon"}),i.jsx("span",{className:"tab-label",children:y.label}),i.jsx("kbd",{className:"tab-shortcut",children:y.shortcut})]},y.id)})})}),i.jsx("div",{className:"global-search-input-container",children:i.jsx(Ci,{placeholder:(f==null?void 0:f.placeholder)||"Search...",value:m.query,onChange:m.setQuery,onSearch:b,onClear:m.clearSearch,suggestions:m.suggestions,recentSearches:m.recentSearches,onSuggestionClick:p,onHistoryClick:p,showHistory:m.showHistory,loading:m.loading,size:"lg",showSuggestions:!0,enableHistory:!0,className:"global-search-input",autoFocus:!0})}),i.jsxs("div",{className:"global-search-footer",children:[i.jsxs("div",{className:"search-shortcuts",children:[i.jsxs("div",{className:"shortcut-item",children:[i.jsx("kbd",{children:i.jsx(Is,{})}),i.jsx("kbd",{children:i.jsx(rs,{})}),i.jsx("span",{children:"Navigate"})]}),i.jsxs("div",{className:"shortcut-item",children:[i.jsx("kbd",{children:i.jsx(xf,{})}),i.jsx("span",{children:"Select"})]}),i.jsxs("div",{className:"shortcut-item",children:[i.jsx("kbd",{children:"Esc"}),i.jsx("span",{children:"Close"})]})]}),i.jsxs("div",{className:"search-branding",children:[i.jsx("span",{children:"Global Search"}),i.jsxs("div",{className:"shortcut-badge",children:[i.jsx(vf,{className:"command-icon"}),i.jsx("span",{children:"K"})]})]})]})]})]})})},Dg=()=>{const{isVoiceModeActive:s,isListening:e,transcript:t,stopListening:n}=Un();return s?i.jsx("div",{className:"voice-modal-overlay",children:i.jsxs("div",{className:"voice-modal",children:[i.jsxs("div",{className:"voice-modal-header",children:[i.jsx("h3",{children:"🎤 Saytrix Voice Commands"}),i.jsx("button",{className:"voice-modal-close",onClick:n,"aria-label":"Close voice commands",children:i.jsx(We,{})})]}),i.jsxs("div",{className:"voice-modal-content",children:[i.jsxs("div",{className:"voice-status",children:[i.jsxs("div",{className:`voice-indicator ${e?"listening":""}`,children:[i.jsx(Us,{}),i.jsx("div",{className:"pulse-ring"}),i.jsx("div",{className:"pulse-ring delay-1"}),i.jsx("div",{className:"pulse-ring delay-2"})]}),i.jsx("p",{className:"voice-status-text",children:e?"Listening for commands...":"Voice mode active"})]}),t&&i.jsx("div",{className:"voice-transcript",children:i.jsxs("p",{children:[i.jsx("strong",{children:"You said:"}),' "',t,'"']})}),i.jsxs("div",{className:"voice-commands-list",children:[i.jsx("h4",{children:"Available Commands:"}),i.jsxs("div",{className:"commands-grid",children:[i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"Dashboard"'}),i.jsx("span",{className:"command-desc",children:"Go to dashboard"})]}),i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"Charts"'}),i.jsx("span",{className:"command-desc",children:"Open charts"})]}),i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"Portfolio"'}),i.jsx("span",{className:"command-desc",children:"View portfolio"})]}),i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"Watchlist"'}),i.jsx("span",{className:"command-desc",children:"Open watchlist"})]}),i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"Orders"'}),i.jsx("span",{className:"command-desc",children:"View orders"})]}),i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"History"'}),i.jsx("span",{className:"command-desc",children:"Check history"})]}),i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"News"'}),i.jsx("span",{className:"command-desc",children:"Read news"})]}),i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"Notifications"'}),i.jsx("span",{className:"command-desc",children:"View notifications"})]}),i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"Profile"'}),i.jsx("span",{className:"command-desc",children:"Open profile"})]}),i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"Settings"'}),i.jsx("span",{className:"command-desc",children:"Open settings"})]}),i.jsxs("div",{className:"command-item",children:[i.jsx("span",{className:"command-text",children:'"Stop" / "Exit"'}),i.jsx("span",{className:"command-desc",children:"Close voice mode"})]})]})]}),i.jsx("div",{className:"voice-tips",children:i.jsxs("p",{children:[i.jsx("strong",{children:"💡 Tip:"}),' Say "Saytrix" anytime to activate voice commands']})})]})]})}):null},$g=()=>{const{isListening:s,isVoiceModeActive:e,isSupported:t}=Un();return!t||e?null:i.jsxs("div",{className:`voice-status-indicator ${s?"listening":""}`,children:[i.jsx("div",{className:"voice-status-icon",children:i.jsx(Us,{})}),i.jsx("div",{className:"voice-status-text",children:i.jsx("span",{children:'Say "Saytrix" to activate'})}),s&&i.jsxs("div",{className:"voice-pulse-rings",children:[i.jsx("div",{className:"pulse-ring"}),i.jsx("div",{className:"pulse-ring delay-1"}),i.jsx("div",{className:"pulse-ring delay-2"})]})]})};class zg{constructor(){this.portfolio=new Map,this.tradingHistory=[],this.virtualBalance=1e4,this.listeners=new Set,this.dailyRewards={lastLoginDate:null,lastClaimDate:null,totalRewards:0,loginStreak:0},this.loadPortfolioFromStorage(),this.checkDailyLogin()}loadPortfolioFromStorage(){try{const e=localStorage.getItem("tradebro_portfolio"),t=localStorage.getItem("tradebro_balance"),n=localStorage.getItem("tradebro_history"),r=localStorage.getItem("tradebro_daily_rewards");if(e){const a=JSON.parse(e);this.portfolio=new Map(Object.entries(a))}t?(this.virtualBalance=parseFloat(t),console.log("💰 Loaded balance from localStorage:",this.virtualBalance)):(this.virtualBalance=1e4,console.log("💰 Using default balance for new user:",this.virtualBalance)),n&&(this.tradingHistory=JSON.parse(n)),r&&(this.dailyRewards=JSON.parse(r))}catch(e){console.error("Error loading portfolio from storage:",e),this.virtualBalance=1e4,this.dailyRewards={lastLoginDate:null,lastClaimDate:null,totalRewards:0,loginStreak:0}}}savePortfolioToStorage(){try{const e=Object.fromEntries(this.portfolio);localStorage.setItem("tradebro_portfolio",JSON.stringify(e)),localStorage.setItem("tradebro_balance",this.virtualBalance.toString()),localStorage.setItem("tradebro_history",JSON.stringify(this.tradingHistory)),localStorage.setItem("tradebro_daily_rewards",JSON.stringify(this.dailyRewards))}catch(e){console.error("Error saving portfolio to storage:",e)}}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}notifyListeners(){this.listeners.forEach(e=>{try{e(this.getPortfolioSummary())}catch(t){console.error("Error in portfolio listener:",t)}})}hasHoldings(e){const t=this.portfolio.get(e);return t&&t.quantity>0}getPosition(e){return this.portfolio.get(e)||{symbol:e,quantity:0,avgPrice:0,totalInvested:0,currentValue:0,pnl:0,pnlPercentage:0,lastUpdated:new Date}}calculateTradeMetrics(e,t,n,r){const a=this.getPosition(e),o=t*n,l=this.calculateBrokerage(o),c=this.calculateTaxes(o,r),h=o+l+c;let d={...a};if(r==="BUY"){const m=a.quantity+t,x=a.totalInvested+h;d={...a,quantity:m,avgPrice:x/m,totalInvested:x,lastUpdated:new Date}}else if(r==="SELL"){if(a.quantity<t)throw new Error(`Insufficient holdings. You have ${a.quantity} shares, trying to sell ${t}`);const m=a.quantity-t,x=o-l-c,b=t/a.quantity*a.totalInvested,p=x-b;d={...a,quantity:m,totalInvested:m>0?a.totalInvested-b:0,avgPrice:m>0?a.avgPrice:0,lastUpdated:new Date,realizedPnL:(a.realizedPnL||0)+p}}return{newPosition:d,tradeValue:o,brokerage:l,taxes:c,totalCost:r==="BUY"?h:o-l-c,realizedPnL:r==="SELL"?o-l-c-t/a.quantity*a.totalInvested:0}}calculateBrokerage(e){return Math.min(e*.001,20)}calculateTaxes(e,t){const n=t==="SELL"?e*25e-5:0,r=e*345e-7,a=(this.calculateBrokerage(e)+r)*.18,o=e*1e-6,l=t==="BUY"?e*3e-5:0;return n+r+a+o+l}async executeTrade(e,t,n,r,a="MARKET"){try{if(!e||!t||!n||!r)throw new Error("Missing required trade parameters");if(t<=0||n<=0)throw new Error("Quantity and price must be positive");const o=this.calculateTradeMetrics(e,t,n,r);if(r==="BUY"&&this.virtualBalance<o.totalCost)throw new Error(`Insufficient balance. Required: ₹${o.totalCost.toFixed(2)}, Available: ₹${this.virtualBalance.toFixed(2)}`);this.portfolio.set(e,o.newPosition),r==="BUY"?this.virtualBalance-=o.totalCost:this.virtualBalance+=o.totalCost;const l={id:Date.now().toString(),symbol:e,quantity:t,price:n,action:r,orderType:a,tradeValue:o.tradeValue,brokerage:o.brokerage,taxes:o.taxes,totalCost:o.totalCost,realizedPnL:o.realizedPnL,timestamp:new Date,status:"EXECUTED"};return this.tradingHistory.unshift(l),this.tradingHistory.length>1e3&&(this.tradingHistory=this.tradingHistory.slice(0,1e3)),this.savePortfolioToStorage(),this.notifyListeners(),console.log(`✅ Trade executed: ${r} ${t} ${e} @ ₹${n}`),{success:!0,trade:l,newPosition:o.newPosition,newBalance:this.virtualBalance,message:`Successfully ${r.toLowerCase()}ed ${t} shares of ${e}`}}catch(o){return console.error("❌ Trade execution failed:",o),{success:!1,error:o.message}}}async buyStock(e,t,n,r="market"){return this.executeTrade(e,t,n,"BUY",r)}async sellStock(e,t,n,r="market"){return this.executeTrade(e,t,n,"SELL",r)}async getPortfolio(){return{success:!0,data:this.getPortfolioSummary()}}async getHoldings(){return{success:!0,data:this.getPortfolioSummary().positions}}async getVirtualMoneyAccount(){return{success:!0,data:{balance:this.virtualBalance,totalInvested:this.getPortfolioSummary().totalInvested,totalReturns:this.getPortfolioSummary().totalPnL}}}getPortfolioSummary(){const e=Array.from(this.portfolio.values()).filter(c=>c.quantity>0);let t=0,n=0,r=0,a=0;e.forEach(c=>{t+=c.totalInvested,n+=c.currentValue||c.totalInvested,r+=(c.currentValue||c.totalInvested)-c.totalInvested,a+=c.realizedPnL||0});const o=t>0?r/t*100:0,l={totalValue:this.virtualBalance+n,availableCash:this.virtualBalance,totalInvested:t,totalCurrentValue:n,totalPnL:r,totalPnLPercentage:o,totalRealizedPnL:a,positions:e,totalPositions:e.length,lastUpdated:new Date};return console.log("📊 Trading service getPortfolioSummary returning:",{availableCash:l.availableCash,totalValue:l.totalValue,virtualBalance:this.virtualBalance}),l}getTradingHistory(e=100){return this.tradingHistory.slice(0,e)}checkDailyLogin(){try{const e=new Date().toDateString(),t=this.dailyRewards.lastLoginDate;if(this.dailyRewards.lastClaimDate===e)return{awarded:!1,alreadyClaimed:!0,streak:this.dailyRewards.loginStreak,totalRewards:this.dailyRewards.totalRewards,message:"You've already claimed your daily reward today! Come back tomorrow."};if(t!==e){const a=this.virtualBalance;this.virtualBalance+=100;const o=new Date;o.setDate(o.getDate()-1);const l=t===o.toDateString();return this.dailyRewards={lastLoginDate:e,lastClaimDate:e,totalRewards:this.dailyRewards.totalRewards+100,loginStreak:l?this.dailyRewards.loginStreak+1:1},this.tradingHistory.unshift({id:`daily_${Date.now()}`,type:"BONUS",symbol:"DAILY_REWARD",quantity:1,price:100,total:100,timestamp:new Date,description:`Daily login bonus - Day ${this.dailyRewards.loginStreak}`,balanceBefore:a,balanceAfter:this.virtualBalance}),this.savePortfolioToStorage(),this.notifyListeners(),console.log(`🎉 Daily login bonus: ₹100 | Streak: ${this.dailyRewards.loginStreak} days | New Balance: ₹${this.virtualBalance}`),{awarded:!0,amount:100,streak:this.dailyRewards.loginStreak,totalRewards:this.dailyRewards.totalRewards,newBalance:this.virtualBalance,oldBalance:a}}return{awarded:!1,alreadyClaimed:!1,streak:this.dailyRewards.loginStreak,totalRewards:this.dailyRewards.totalRewards}}catch(e){return console.error("Error checking daily login:",e),{awarded:!1,error:e.message}}}getDailyRewardsInfo(){const e=new Date().toDateString(),t=this.dailyRewards.lastClaimDate,n=t!==e;return{...this.dailyRewards,nextRewardAvailable:n,canClaimToday:n,alreadyClaimedToday:t===e,timeUntilNextReward:this.getTimeUntilNextReward()}}getTimeUntilNextReward(){const e=this.dailyRewards.lastClaimDate;if(!e)return null;const t=new Date(e),n=new Date(t);n.setDate(n.getDate()+1),n.setHours(0,0,0,0);const r=new Date,a=n.getTime()-r.getTime();if(a<=0)return null;const o=Math.floor(a/(1e3*60*60)),l=Math.floor(a%(1e3*60*60)/(1e3*60));return{hours:o,minutes:l,totalMinutes:Math.floor(a/(1e3*60)),nextRewardTime:n.toISOString()}}async claimDailyReward(){try{const e=new Date().toDateString();if(this.dailyRewards.lastClaimDate===e)return{success:!1,alreadyClaimed:!0,message:"You've already claimed your daily reward today!",timeUntilNext:this.getTimeUntilNextReward()};const n=100,r=this.virtualBalance;this.virtualBalance+=n;const a=new Date;a.setDate(a.getDate()-1);const l=this.dailyRewards.lastLoginDate===a.toDateString();return this.dailyRewards={lastLoginDate:e,lastClaimDate:e,totalRewards:this.dailyRewards.totalRewards+n,loginStreak:l?this.dailyRewards.loginStreak+1:1},this.tradingHistory.unshift({id:`daily_${Date.now()}`,type:"BONUS",symbol:"DAILY_REWARD",quantity:1,price:n,total:n,timestamp:new Date,description:`Daily login bonus - Day ${this.dailyRewards.loginStreak}`,balanceBefore:r,balanceAfter:this.virtualBalance}),this.savePortfolioToStorage(),await this.syncPortfolioData(),setTimeout(()=>{this.notifyListeners(),window.dispatchEvent(new CustomEvent("balanceUpdated",{detail:{newBalance:this.virtualBalance,change:n,type:"DAILY_REWARD"}}))},100),{success:!0,awarded:!0,amount:n,streak:this.dailyRewards.loginStreak,totalRewards:this.dailyRewards.totalRewards,newBalance:this.virtualBalance,oldBalance:r}}catch(e){return console.error("Error claiming daily reward:",e),{success:!1,error:e.message}}}forceDailyReward(){this.dailyRewards.lastLoginDate=null,this.dailyRewards.lastClaimDate=null,this.savePortfolioToStorage();const e=this.checkDailyLogin();return setTimeout(()=>{this.notifyListeners()},100),e}async syncPortfolioData(){try{return this.savePortfolioToStorage(),await this.syncWithServer(),this.notifyListeners(),console.log("🔄 Portfolio data synchronized across all components and server"),{success:!0,summary:this.getPortfolioSummary(),rewards:this.getDailyRewardsInfo()}}catch(e){return console.error("Error syncing portfolio data:",e),{success:!1,error:e.message}}}async syncWithServer(){try{const e=localStorage.getItem("token");if(!e)return;(await fetch("http://localhost:5001/api/virtual-money/sync-balance",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({balance:this.virtualBalance,totalRewards:this.dailyRewards.totalRewards,loginStreak:this.dailyRewards.loginStreak,lastClaimDate:this.dailyRewards.lastClaimDate})})).ok&&console.log("✅ Successfully synced balance with server")}catch(e){console.warn("⚠️ Failed to sync with server:",e.message)}}clearAllData(){this.portfolio.clear(),this.tradingHistory=[],this.virtualBalance=1e4,this.dailyRewards={lastLoginDate:null,lastClaimDate:null,totalRewards:0,loginStreak:0},localStorage.removeItem("tradebro_portfolio"),localStorage.removeItem("tradebro_balance"),localStorage.removeItem("tradebro_history"),localStorage.removeItem("tradebro_daily_rewards"),this.notifyListeners()}}const je=new zg,jh=v.createContext(),ft=()=>{const s=v.useContext(jh);if(!s)throw new Error("usePortfolio must be used within a PortfolioProvider");return s},Sh=({children:s,user:e})=>{const[t,n]=v.useState({totalValue:1e4,availableCash:1e4,totalInvested:0,totalGainLoss:0,totalGainLossPercentage:0,holdings:[],transactions:[],watchlist:[]}),[r,a]=v.useState(!1);v.useEffect(()=>{const f=C=>{console.log("🔄 Portfolio context updating from trading engine:",{availableCash:C.availableCash,totalValue:C.totalValue}),n(N=>{const T={...N,totalValue:C.totalValue,availableCash:C.availableCash,totalInvested:C.totalInvested,totalGainLoss:C.totalPnL,totalGainLossPercentage:C.totalPnLPercentage,holdings:C.positions.map(I=>({symbol:I.symbol,quantity:I.quantity,avgPrice:I.avgPrice,currentPrice:I.currentValue/I.quantity||I.avgPrice,totalValue:I.currentValue||I.totalInvested,gainLoss:(I.currentValue||I.totalInvested)-I.totalInvested,gainLossPercentage:I.totalInvested>0?((I.currentValue||I.totalInvested)-I.totalInvested)/I.totalInvested*100:0}))};return console.log("📊 Setting new portfolio data:",{oldAvailableCash:N.availableCash,newAvailableCash:T.availableCash,oldTotalValue:N.totalValue,newTotalValue:T.totalValue}),T})};je.addListener(f);const y=je.getPortfolioSummary();console.log("📊 Initial portfolio load:",{availableCash:y.availableCash,totalValue:y.totalValue}),f(y);const S=setTimeout(()=>{console.log("🔄 Forcing portfolio refresh after delay...");const C=je.getPortfolioSummary();console.log("📊 Latest summary after delay:",{availableCash:C.availableCash,totalValue:C.totalValue}),f(C)},2e3),k=C=>{console.log("🔄 Balance update received in PortfolioContext:",C.detail);const N=je.getPortfolioSummary();f(N)};return window.addEventListener("balanceUpdated",k),()=>{je.removeListener(f),window.removeEventListener("balanceUpdated",k),clearTimeout(S)}},[]),v.useEffect(()=>{const f=localStorage.getItem("token"),y=(e==null?void 0:e.id)||(e==null?void 0:e._id);if(e&&y&&f){const S=setTimeout(()=>{o()},100);return()=>clearTimeout(S)}else n({totalValue:1e4,availableCash:1e4,totalInvested:0,totalGainLoss:0,totalGainLossPercentage:0,holdings:[],transactions:[],watchlist:[]})},[e]);const o=async()=>{a(!0);try{const f=localStorage.getItem("token"),y=(e==null?void 0:e.id)||(e==null?void 0:e._id);if(!y||!f){console.warn("Missing user ID or token for portfolio initialization"),a(!1);return}const S=await fetch(`http://localhost:5001/api/portfolio/${y}`,{headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});if(S.ok){const k=await S.json();n(k.data||k)}else if(S.status===401){console.warn("Authentication failed for portfolio access");return}else S.status===404?await l():console.warn("Portfolio fetch failed with status:",S.status)}catch(f){console.error("Error initializing portfolio:",f),n({totalValue:1e4,availableCash:1e4,totalInvested:0,totalGainLoss:0,totalGainLossPercentage:0,holdings:[],transactions:[],watchlist:[]})}finally{a(!1)}},l=async()=>{try{const f=localStorage.getItem("token"),y=await fetch("http://localhost:5001/api/portfolio/create",{method:"POST",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"},body:JSON.stringify({userId:(e==null?void 0:e.id)||(e==null?void 0:e._id),initialCash:1e4})});if(y.ok){const S=await y.json();n(S.data||S)}else if(y.status===401){console.warn("Authentication failed for portfolio creation");return}else console.warn("Portfolio creation failed with status:",y.status)}catch(f){console.error("Error creating default portfolio:",f)}},c=v.useCallback(async(f,y,S,k=null)=>{try{a(!0);const C=await je.buyStock(f,y,S);if(!C.success)throw new Error(C.error);try{await m(f),console.log(`✅ Removed ${f} from watchlist after purchase`)}catch(N){console.warn("⚠️ Could not remove from watchlist:",N.message)}return console.log("✅ Buy order executed successfully:",C),C}catch(C){throw console.error("❌ Error buying stock:",C),C}finally{a(!1)}},[t.holdings]),h=v.useCallback(async(f,y,S,k=null)=>{try{a(!0);const C=t.holdings.find(I=>I.symbol===f),N=C&&C.quantity<=y,T=await je.sellStock(f,y,S);if(!T.success)throw new Error(T.error);if(N)try{const I=k||{symbol:f,name:(C==null?void 0:C.name)||f,price:S,sector:(C==null?void 0:C.sector)||"Unknown"};await d(f,I),console.log(`✅ Added ${f} back to watchlist after complete sale`)}catch(I){console.warn("⚠️ Could not add to watchlist:",I.message)}return console.log("✅ Sell order executed successfully:",T),T}catch(C){throw console.error("❌ Error selling stock:",C),C}finally{a(!1)}},[t.holdings]),d=async(f,y=null)=>{try{const S=localStorage.getItem("token"),k={userId:(e==null?void 0:e.id)||(e==null?void 0:e._id),symbol:f};y&&(y.name&&(k.name=y.name),y.sector&&(k.sector=y.sector),y.price&&(k.currentPrice=y.price));const C=await fetch("http://localhost:5001/api/portfolio/watchlist/add",{method:"POST",headers:{Authorization:`Bearer ${S}`,"Content-Type":"application/json"},body:JSON.stringify(k)});if(C.ok){const N=await C.json();return n(T=>({...T,watchlist:N})),N}else if((await fetch("http://localhost:5001/api/watchlist/add",{method:"POST",headers:{Authorization:`Bearer ${S}`,"Content-Type":"application/json"},body:JSON.stringify({symbol:f,name:(y==null?void 0:y.name)||"",notes:"Added after selling position"})})).ok)return console.log(`✅ Added ${f} to watchlist via fallback API`),!0}catch(S){throw console.error("Error adding to watchlist:",S),S}},m=async f=>{try{const y=localStorage.getItem("token"),S=await fetch("http://localhost:5001/api/portfolio/watchlist/remove",{method:"DELETE",headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"},body:JSON.stringify({userId:(e==null?void 0:e.id)||(e==null?void 0:e._id),symbol:f})});if(S.ok){const k=await S.json();return n(C=>({...C,watchlist:k})),k}else return(await fetch(`http://localhost:5001/api/watchlist/remove/${f}`,{method:"DELETE",headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"}})).ok?(console.log(`✅ Removed ${f} from watchlist via fallback API`),!0):(console.log(`ℹ️ ${f} was not in watchlist`),!0)}catch(y){return console.warn("Could not remove from watchlist (may not exist):",y.message),!0}},x=v.useCallback(async()=>{try{const f=localStorage.getItem("token"),y=(e==null?void 0:e.id)||(e==null?void 0:e._id),S=await fetch(`http://localhost:5001/api/portfolio/update-values/${y}`,{method:"POST",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});if(S.ok){const k=await S.json();return n(k),k}}catch(f){console.error("Error updating portfolio values:",f)}},[e==null?void 0:e.id]),b=v.useCallback(()=>{const f=je.getPortfolioSummary(),y=je.getDailyRewardsInfo();n(S=>({...S,totalValue:f.totalValue,availableCash:f.availableCash,totalInvested:f.totalInvested,totalGainLoss:f.totalPnL,totalGainLossPercentage:f.totalPnLPercentage,dailyRewards:y,holdings:f.positions.map(k=>({symbol:k.symbol,quantity:k.quantity,avgPrice:k.avgPrice,currentPrice:k.currentValue/k.quantity||k.avgPrice,totalValue:k.currentValue||k.totalInvested,gainLoss:(k.currentValue||k.totalInvested)-k.totalInvested,gainLossPercentage:k.totalInvested>0?((k.currentValue||k.totalInvested)-k.totalInvested)/k.totalInvested*100:0}))})),console.log("📊 Portfolio refreshed:",{totalValue:f.totalValue,availableCash:f.availableCash,totalRewards:y.totalRewards})},[]),p=v.useCallback(f=>{console.log("🎉 Daily reward received:",f),setTimeout(()=>{b()},100)},[b]),g={portfolioData:t,loading:r,buyStock:c,sellStock:h,addToWatchlist:d,removeFromWatchlist:m,updatePortfolioValues:x,initializePortfolio:o,refreshPortfolio:b,handleDailyReward:p};return i.jsx(jh.Provider,{value:g,children:s})},ys=v.memo(({symbol:s,price:e,change:t,changePercent:n,priceChange:r=null,showSymbol:a=!0,showChange:o=!0,size:l="medium",className:c=""})=>{const[h,d]=v.useState(!1),[m,x]=v.useState(null);v.useEffect(()=>{if(r&&r.direction){x(r.direction),d(!0);const N=setTimeout(()=>{d(!1)},2e3);return()=>clearTimeout(N)}},[r]);const b=v.useCallback(N=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(N),[]),p=v.useCallback(N=>typeof N!="number"||isNaN(N)?"--":`${N>=0?"+":""}${N.toFixed(2)}%`,[]),{trendDirection:g,isPositive:f,formattedPrice:y,formattedChange:S}=v.useMemo(()=>{const N=t>0?"up":t<0?"down":"neutral",T=t>=0,I=typeof e=="number"?b(e):e,P=typeof t=="number"?p(t):t;return{trendDirection:N,isPositive:T,formattedPrice:I,formattedChange:P}},[e,t,b,p]),k={initial:{scale:1},animate:{scale:[1,1.05,1],transition:{duration:.6,ease:"easeInOut"}}},C={initial:{opacity:0},animate:{opacity:[0,.3,0],transition:{duration:1,ease:"easeInOut"}}};return i.jsxs("div",{className:`stock-price ${l} ${c}`,children:[a&&i.jsx("div",{className:"stock-symbol",children:s}),i.jsxs("div",{className:"price-container",children:[i.jsxs(F.div,{className:`price-value ${h?"animating":""}`,variants:k,initial:"initial",animate:h?"animate":"initial",children:[b(e),i.jsx(Se,{children:h&&i.jsx(F.div,{className:`price-flash ${m}`,variants:C,initial:"initial",animate:"animate",exit:"initial"})})]}),o&&i.jsxs("div",{className:`price-change ${g}`,children:[i.jsxs("div",{className:"change-icon",children:[g==="up"&&i.jsx(Pe,{size:14}),g==="down"&&i.jsx($e,{size:14}),g==="neutral"&&i.jsx(Mn,{size:14})]}),i.jsxs("div",{className:"change-values",children:[i.jsxs("span",{className:"change-amount",children:[f?"+":"",b(Math.abs(t))]}),i.jsxs("span",{className:"change-percent",children:["(",p(n),")"]})]})]})]}),i.jsx(Se,{children:h&&i.jsx(F.div,{className:"pulse-indicator",initial:{scale:0,opacity:1},animate:{scale:2,opacity:0},exit:{scale:0,opacity:0},transition:{duration:1}})})]})});ys.displayName="StockPrice";const Ug=(s,e,t,n,r)=>{const[a,o]=v.useState({}),[l,c]=v.useState(null),[h,d]=v.useState(!1),[m,x]=v.useState(!1),{portfolioData:b}=ft(),{user:p}=Sc(N=>N.auth),g=v.useCallback(async()=>{if(!s)return o({stock:"Please select a stock"}),x(!1),!1;d(!0);const N={};try{(!t||t<=0)&&(N.quantity="Quantity must be greater than 0"),r==="limit"&&(!n||parseFloat(n)<=0)&&(N.price="Please enter a valid limit price");const T=r==="market"?s.price:parseFloat(n)||0,I=t*T,P=k(I),L=e==="buy"?I+P:I-P;return e==="buy"?await f(N,I,L,s):await y(N,t,T,s),r==="limit"&&T>0&&S(N,T,s.price,e),o(N),x(Object.keys(N).length===0),Object.keys(N).length===0}catch(T){return console.error("Validation error:",T),o({general:"Validation failed. Please try again."}),x(!1),!1}finally{d(!1)}},[s,e,t,n,r,b]),f=async(N,T,I,P)=>{I>b.availableCash&&(N.funds=`Insufficient funds. Available: ₹${b.availableCash.toLocaleString("en-IN")}, Required: ₹${I.toLocaleString("en-IN")}`),T<500&&(N.minOrder="Minimum order value is ₹500"),T>1e5&&(N.maxOrder="Maximum order value is ₹1,00,000"),P.volume&&P.volume<t&&(N.availability="Requested quantity exceeds available volume")},y=async(N,T,I,P)=>{const L=b.holdings.find(V=>V.symbol===P.symbol);if(!L){N.shares="You do not own any shares of this stock";return}if(L.quantity<T){N.shares=`Insufficient shares. Available: ${L.quantity}, Requested: ${T}`;return}const M=T*I,O=L.averagePrice||L.averageBuyPrice,B=T*O,R=M-B,A=B>0?R/B*100:0;c({amount:R,percentage:A,isProfit:R>=0,sellValue:M,buyValue:B,avgBuyPrice:O}),M<100&&(N.minSell="Minimum sell value is ₹100")},S=(N,T,I,P)=>{const M=Math.abs(T-I)/I*100;M>20&&(N.priceRange=`Limit price is ${M.toFixed(1)}% away from market price. Consider adjusting.`),P==="buy"&&T>I*1.1&&(N.buyPriceHigh="Limit price is significantly higher than market price"),P==="sell"&&T<I*.9&&(N.sellPriceLow="Limit price is significantly lower than market price")},k=N=>{const T=N*3e-4,I=N*.001,P=N*345e-7,L=(T+P)*.18,M=N*1e-6,O=N*3e-5;return{brokerage:T,stt:I,exchangeCharges:P,gst:L,sebiCharges:M,stampDuty:O,total:T+I+P+L+M+O}},C=v.useCallback(()=>{if(!s||!t)return{grossAmount:0,fees:{total:0},netAmount:0,pricePerShare:0};const N=r==="market"?s.price:parseFloat(n)||0,T=t*N,I=k(T),P=e==="buy"?T+I.total:T-I.total;return{grossAmount:T,fees:I,netAmount:P,pricePerShare:N,quantity:t}},[s,t,n,r,e]);return v.useEffect(()=>{const N=setTimeout(()=>{g()},300);return()=>clearTimeout(N)},[g]),v.useEffect(()=>{s&&(o({}),c(null),x(!1))},[s==null?void 0:s.symbol]),{validationErrors:a,profitLossEstimate:l,isValidating:h,isValid:m,validateOrder:g,getOrderSummary:C,calculateTradingFees:k}},Re=(s,e="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:e,minimumFractionDigits:2,maximumFractionDigits:2}).format(s),os=(s,e=2)=>`${s>=0?"+":""}${s.toFixed(e)}%`,Wg=(s,e=!0)=>{const[t,n]=v.useState(null),[r,a]=v.useState(!1),[o,l]=v.useState(null),[c,h]=v.useState(!1),d=v.useCallback(async k=>{if(!k||!e){n(null),h(!1),l(null);return}a(!0),l(null);try{if(!await m(k)){h(!1),l(`Invalid stock symbol: ${k}`),n(null);return}const N=await b(k);N?(n(N),h(!0),l(null)):(h(!1),l("Failed to fetch stock data"),n(null))}catch(C){console.error("Stock validation error:",C),l(C.message||"Failed to validate stock"),h(!1),n(null)}finally{a(!1)}},[e]),m=async k=>{try{const C=/^[A-Z0-9&-]{1,20}$/,N=/^[0-9]{6}$/;if(!C.test(k)&&!N.test(k))return!1;const T=await fetch(`http://localhost:5001/api/stocks/validate/${k}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});return T.ok?(await T.json()).isValid:x(k)}catch(C){return console.error("Symbol validation error:",C),x(k)}},x=k=>["RELIANCE","TCS","HDFCBANK","INFY","HINDUNILVR","ICICIBANK","KOTAKBANK","BHARTIARTL","ITC","SBIN","BAJFINANCE","ASIANPAINT","MARUTI","AXISBANK","LT","DMART","SUNPHARMA","TITAN","ULTRACEMCO","NESTLEIND","WIPRO","TECHM","POWERGRID","NTPC","ONGC","TATAMOTORS","BAJAJFINSV","HCLTECH","COALINDIA","DRREDDY","EICHERMOT","ADANIPORTS","JSWSTEEL","TATASTEEL","GRASIM","CIPLA","BRITANNIA","DIVISLAB","APOLLOHOSP","BPCL","HEROMOTOCO","SHREECEM","PIDILITIND","DABUR"].includes(k.toUpperCase()),b=async k=>{try{const C=await fetch(`http://localhost:5001/api/stocks/quote/${k}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(C.ok){const N=await C.json();return{symbol:N.symbol,name:N.name||N.symbol,price:N.price||N.c||0,change:N.change||N.d||0,changePercent:N.changePercent||N.dp||0,volume:N.volume||N.v||0,high:N.high||N.h||0,low:N.low||N.l||0,open:N.open||N.o||0,previousClose:N.previousClose||N.pc||0,marketCap:N.marketCap||0,pe:N.pe||0,lastUpdated:new Date().toISOString()}}return p(k)}catch(C){return console.error("Stock data fetch error:",C),p(k)}},p=k=>{const C=Math.random()*2e3+100,N=(Math.random()-.5)*100,T=N/C*100;return{symbol:k.toUpperCase(),name:`${k.toUpperCase()} Limited`,price:parseFloat(C.toFixed(2)),change:parseFloat(N.toFixed(2)),changePercent:parseFloat(T.toFixed(2)),volume:Math.floor(Math.random()*1e6),high:parseFloat((C+Math.abs(N)).toFixed(2)),low:parseFloat((C-Math.abs(N)).toFixed(2)),open:parseFloat((C-N).toFixed(2)),previousClose:parseFloat((C-N).toFixed(2)),marketCap:Math.floor(Math.random()*1e12),pe:parseFloat((Math.random()*50+5).toFixed(2)),lastUpdated:new Date().toISOString()}},g=v.useCallback(()=>{if(!t||!e)return;const k=setInterval(async()=>{try{const C=await b(t.symbol);C&&n(N=>({...N,...C,lastUpdated:new Date().toISOString()}))}catch(C){console.error("Price update error:",C)}},3e4);return()=>clearInterval(k)},[t,e]);v.useEffect(()=>{const k=setTimeout(()=>{s&&s.length>=2?d(s):(n(null),h(!1),l(null))},500);return()=>clearTimeout(k)},[s,d]),v.useEffect(()=>{if(t&&e)return g()},[t,e,g]);const f=v.useCallback(async()=>{t&&await d(t.symbol)},[t,d]),y=v.useCallback(()=>t?t.change>0?"positive":t.change<0?"negative":"neutral":"neutral",[t]),S=v.useCallback(()=>{const k=new Date,C=k.getDay(),N=k.getHours(),T=k.getMinutes(),I=N*100+T;return C===0||C===6?!1:I>=915&&I<=1530},[]);return{stockData:t,isLoading:r,error:o,isValidSymbol:c,refreshStockData:f,getPriceTrend:y,isMarketOpen:S(),validateAndFetchStock:d}},Vg=(s,e=2)=>typeof s!="number"?"₹0.00":`₹${s.toLocaleString("en-IN",{minimumFractionDigits:e,maximumFractionDigits:e})}`,Hg=({notification:s,onClose:e,onAction:t,theme:n="light"})=>{const r=o=>{const l={size:20};switch(o){case"success":return i.jsx(kt,{...l,className:"toast-icon success"});case"error":return i.jsx(ps,{...l,className:"toast-icon error"});case"warning":return i.jsx(qt,{...l,className:"toast-icon warning"});case"alert":return i.jsx(et,{...l,className:"toast-icon alert"});case"info":default:return i.jsx(Oa,{...l,className:"toast-icon info"})}},a=()=>{s.link&&window.open(s.link,"_blank"),t&&t(s)};return i.jsxs(F.div,{className:`notification-toast ${s.type} ${n}`,initial:{opacity:0,x:300,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.9},transition:{type:"spring",stiffness:300,damping:30},children:[i.jsx("div",{className:"toast-icon-container",children:r(s.type)}),i.jsxs("div",{className:"toast-content",children:[i.jsx("div",{className:"toast-title",children:s.title}),s.message&&i.jsx("div",{className:"toast-message",children:s.message}),s.link&&i.jsxs(F.button,{className:"toast-action",onClick:a,whileHover:{scale:1.05},whileTap:{scale:.95},children:["View Details",i.jsx(In,{size:14})]})]}),i.jsx(F.button,{className:"toast-close",onClick:e,whileHover:{scale:1.1},whileTap:{scale:.9},children:i.jsx(We,{size:16})})]})},Sr=(s,e="light")=>{const n={toastId:`notification-${s.id}`,position:"top-right",autoClose:s.type==="error"?7e3:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,closeButton:!1},r=({closeToast:a})=>i.jsx(Hg,{notification:s,onClose:a,theme:e});switch(s.type){case"success":return K.success(r,n);case"error":return K.error(r,n);case"warning":return K.warning(r,n);case"info":case"alert":default:return K.info(r,n)}},Bi={success:(s,e,t,n,r="light")=>{const a={id:Date.now(),type:"success",title:`${s} Order Executed`,message:`${s==="buy"?"Bought":"Sold"} ${t} shares of ${e} at ₹${n.toLocaleString("en-IN")}`,link:"/orders"};return Sr(a,r)},pending:(s,e,t,n="light")=>{const r={id:Date.now(),type:"info",title:`${s} Order Pending`,message:`Placing ${s} order for ${t} shares of ${e}`,link:"/orders"};return Sr(r,n)},error:(s,e,t="light")=>{const n={id:Date.now(),type:"error",title:"Order Failed",message:e||s,link:"/orders"};return Sr(n,t)}},Yg=s=>{K.dismiss(s)},qg=(s,e)=>{let t;return(...n)=>{clearTimeout(t),t=setTimeout(()=>s.apply(null,n),e)}},Gg=(s,e)=>{let t;return(...n)=>{t||(s.apply(null,n),t=!0,setTimeout(()=>t=!1,e))}};class Qg{constructor(){this.intervals=new Set,this.timeouts=new Set,this.listeners=new Set}addInterval(e){return this.intervals.add(e),e}addTimeout(e){return this.timeouts.add(e),e}addListener(e,t,n){const r={element:e,event:t,handler:n};return this.listeners.add(r),e.addEventListener(t,n),r}cleanup(){this.intervals.forEach(e=>clearInterval(e)),this.intervals.clear(),this.timeouts.forEach(e=>clearTimeout(e)),this.timeouts.clear(),this.listeners.forEach(({element:e,event:t,handler:n})=>{e.removeEventListener(t,n)}),this.listeners.clear()}}const Nh=()=>{const s=v.useRef(new Qg);return v.useEffect(()=>()=>{s.current.cleanup()},[]),s.current};class kh{constructor(e=100){this.maxSize=e,this.cache=new Map}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}return null}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){const n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}}const Kg=(s=[],e=!0)=>{const[t,n]=v.useState({}),[r,a]=v.useState(!1),[o,l]=v.useState(null),[c,h]=v.useState(0),d=v.useRef(null),m=v.useRef(null),x=v.useRef(null),b=v.useRef([]),p=v.useRef(null);v.useRef(new kh(1e3)),Nh();const g={wsUrl:"wss://ws.finnhub.io?token=YOUR_FINNHUB_TOKEN",fallbackInterval:e?3e4:6e4,debounceDelay:50,reconnectDelay:5e3,maxReconnectAttempts:5,batchSize:10,maxCacheAge:3e4},f=v.useCallback(()=>{if(b.current.length===0)return;const O=[...b.current];b.current=[];const B=O.reduce((R,A)=>(R[A.symbol]=A,R),{});n(R=>{const A={...R};let V=!1;return Object.values(B).forEach(z=>{const q=A[z.symbol];(!q||q.price!==z.price)&&(A[z.symbol]={...z,previousPrice:(q==null?void 0:q.price)||z.price,priceDirection:q?z.price>q.price?"up":z.price<q.price?"down":"same":"same",lastUpdated:new Date().toISOString()},V=!0)}),V&&(l(new Date().toISOString()),h(z=>z+1)),A})},[]),y=v.useCallback(O=>{b.current.push(O),p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{f()},g.debounceDelay)},[f,g.debounceDelay]),S=v.useCallback(()=>{if(!(!e||s.length===0))try{d.current=new WebSocket(g.wsUrl),d.current.onopen=()=>{console.log("WebSocket connected"),a(!0),s.forEach(O=>{d.current.send(JSON.stringify({type:"subscribe",symbol:O.toUpperCase()}))})},d.current.onmessage=O=>{try{const B=JSON.parse(O.data);B.type==="trade"&&B.data.forEach(R=>{y({symbol:R.s,price:R.p,volume:R.v,timestamp:R.t,change:0,changePercent:0})})}catch(B){console.error("WebSocket message parsing error:",B)}},d.current.onclose=()=>{console.log("WebSocket disconnected"),a(!1),e&&(x.current=setTimeout(()=>{S()},g.reconnectDelay))},d.current.onerror=O=>{console.error("WebSocket error:",O),a(!1)}}catch(O){console.error("WebSocket connection error:",O),a(!1)}},[e,s,y,g.wsUrl,g.reconnectDelay]),k=v.useCallback(async()=>{if(!(!e||s.length===0))try{const O=s.map(async R=>{try{const A=await fetch(`http://localhost:5001/api/stocks/quote/${R}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});if(A.ok){const V=await A.json();return{symbol:V.symbol,price:V.price||V.c,change:V.change||V.d,changePercent:V.changePercent||V.dp,volume:V.volume||V.v,high:V.high||V.h,low:V.low||V.l,timestamp:Date.now()}}}catch(A){console.error(`Error fetching ${R}:`,A)}return null});(await Promise.all(O)).filter(Boolean).forEach(y)}catch(O){console.error("Polling error:",O)}},[e,s,y]),C=v.useCallback(()=>{m.current&&clearInterval(m.current),m.current=setInterval(k,g.fallbackInterval),k()},[k,g.fallbackInterval]);v.useEffect(()=>{if(!e||s.length===0)return;S();const O=setTimeout(()=>{r||C()},2e3);return()=>{clearTimeout(O)}},[e,s,S,C,r]),v.useEffect(()=>()=>{d.current&&d.current.close(),m.current&&clearInterval(m.current),x.current&&clearTimeout(x.current),p.current&&clearTimeout(p.current)},[]);const N=v.useCallback(O=>t[O==null?void 0:O.toUpperCase()]||null,[t]),T=v.useCallback(O=>O.map(B=>({symbol:B,...N(B)})).filter(Boolean),[N]),I=v.useCallback(O=>{d.current&&d.current.readyState===WebSocket.OPEN&&d.current.send(JSON.stringify({type:"subscribe",symbol:O.toUpperCase()}))},[]),P=v.useCallback(O=>{d.current&&d.current.readyState===WebSocket.OPEN&&d.current.send(JSON.stringify({type:"unsubscribe",symbol:O.toUpperCase()}))},[]),L=v.useCallback(()=>{k()},[k]),M=v.useCallback((O,B,R)=>{const A=N(O);if(!A||!B||!R)return{pnl:0,pnlPercent:0,unrealized:!0};const V=B*A.price,z=B*R,q=V-z,Y=q/z*100;return{pnl:q,pnlPercent:Y,currentValue:V,investedValue:z,unrealized:!0,lastUpdated:A.lastUpdated}},[N]);return{prices:t,isConnected:r,lastUpdate:o,updateCount:c,getPrice:N,getPrices:T,subscribe:I,unsubscribe:P,refresh:L,calculatePnL:M,connectionStatus:r?"connected":"disconnected"}},Jg=(s,e)=>{const t=s>=0?"+":"";return{absolute:`${t}₹${Math.abs(s).toFixed(2)}`,percent:`${t}${e.toFixed(2)}%`,direction:s>0?"up":s<0?"down":"same"}},Xg=({stockData:s,orderType:e,quantity:t,orderPrice:n,averagePrice:r=null,className:a=""})=>{const[o,l]=v.useState(!1),[c,h]=v.useState(0),{getPrice:d,isConnected:m,lastUpdate:x}=Kg(s?[s.symbol]:[],!0),b=d(s==null?void 0:s.symbol),p=(b==null?void 0:b.price)||(s==null?void 0:s.price)||0,g=v.useMemo(()=>{if(!s||!t||!n)return null;const S=parseInt(t),k=parseFloat(n),C=parseFloat(p);if(e==="buy"){const N=S*k,T=S*C,I=T-N,P=N>0?I/N*100:0,L=C-k,M=k>0?L/k*100:0;return{type:"buy",orderValue:N,currentValue:T,unrealizedPnL:I,unrealizedPnLPercent:P,priceDiff:L,priceDiffPercent:M,breakEvenPrice:k,isProfit:I>=0,recommendation:L>0?"favorable":L<0?"unfavorable":"neutral"}}else{const N=parseFloat(r||k),T=S*k,I=S*N,P=T-I,L=I>0?P/I*100:0,M=S*C,O=M-T;return{type:"sell",investedValue:I,sellValue:T,marketValue:M,realizedPnL:P,realizedPnLPercent:L,opportunityCost:O,opportunityCostPercent:T>0?O/T*100:0,breakEvenPrice:N,isProfit:P>=0,recommendation:O<0?"good_timing":O>0?"consider_waiting":"neutral"}}},[s,e,t,n,p,r]);if(v.useEffect(()=>{l(!!g),g&&h(S=>S+1)},[g]),v.useEffect(()=>{b&&x&&h(S=>S+1)},[b,x]),!o||!g)return null;const f=S=>{switch(S){case"favorable":case"good_timing":return"#10B981";case"unfavorable":case"consider_waiting":return"#EF4444";default:return"#6B7280"}},y=(S,k)=>{if(k==="buy")switch(S){case"favorable":return"Good entry point - price below market";case"unfavorable":return"Consider waiting - price above market";default:return"Price aligned with market"}else switch(S){case"good_timing":return"Good timing - selling above market";case"consider_waiting":return"Consider waiting - market price higher";default:return"Price aligned with market"}};return i.jsxs(F.div,{className:`live-pnl-calculator ${a}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"},children:[i.jsxs("div",{className:"pnl-header",children:[i.jsxs("div",{className:"pnl-title",children:[i.jsx(vt,{className:"pnl-icon"}),i.jsx("span",{children:"Live P&L Calculator"})]}),i.jsxs("div",{className:"connection-status",children:[i.jsx("div",{className:`status-indicator ${m?"connected":"disconnected"}`}),i.jsx("span",{className:"status-text",children:m?"Live":"Delayed"})]})]}),i.jsxs("div",{className:"current-price-section",children:[i.jsx("div",{className:"price-label",children:"Current Market Price"}),i.jsxs("div",{className:"price-display",children:[i.jsx("span",{className:"price-value",children:Re(p)}),b&&i.jsxs(F.div,{className:`price-change ${b.priceDirection}`,initial:{scale:1},animate:{scale:[1,1.1,1]},transition:{duration:.3},children:[b.priceDirection==="up"&&i.jsx(Pe,{size:14}),b.priceDirection==="down"&&i.jsx($e,{size:14}),i.jsx("span",{children:Jg(b.change,b.changePercent).percent})]})]})]}),i.jsx("div",{className:"pnl-calculations",children:g.type==="buy"?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"calc-row",children:[i.jsx("span",{className:"calc-label",children:"Investment Value:"}),i.jsx("span",{className:"calc-value",children:Re(g.orderValue)})]}),i.jsxs("div",{className:"calc-row",children:[i.jsx("span",{className:"calc-label",children:"Current Value:"}),i.jsx("span",{className:"calc-value",children:Re(g.currentValue)})]}),i.jsxs("div",{className:"calc-row highlight",children:[i.jsx("span",{className:"calc-label",children:"Unrealized P&L:"}),i.jsxs("span",{className:`calc-value ${g.isProfit?"profit":"loss"}`,children:[g.isProfit?i.jsx(Pe,{size:14}):i.jsx($e,{size:14}),Re(Math.abs(g.unrealizedPnL)),i.jsxs("span",{className:"percent",children:["(",os(g.unrealizedPnLPercent),")"]})]})]}),i.jsxs("div",{className:"calc-row",children:[i.jsx("span",{className:"calc-label",children:"Price Difference:"}),i.jsxs("span",{className:`calc-value ${g.priceDiff>=0?"profit":"loss"}`,children:[Re(Math.abs(g.priceDiff)),i.jsxs("span",{className:"percent",children:["(",os(g.priceDiffPercent),")"]})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"calc-row",children:[i.jsx("span",{className:"calc-label",children:"Invested Value:"}),i.jsx("span",{className:"calc-value",children:Re(g.investedValue)})]}),i.jsxs("div",{className:"calc-row",children:[i.jsx("span",{className:"calc-label",children:"Sale Value:"}),i.jsx("span",{className:"calc-value",children:Re(g.sellValue)})]}),i.jsxs("div",{className:"calc-row highlight",children:[i.jsx("span",{className:"calc-label",children:"Realized P&L:"}),i.jsxs("span",{className:`calc-value ${g.isProfit?"profit":"loss"}`,children:[g.isProfit?i.jsx(Pe,{size:14}):i.jsx($e,{size:14}),Re(Math.abs(g.realizedPnL)),i.jsxs("span",{className:"percent",children:["(",os(g.realizedPnLPercent),")"]})]})]}),i.jsxs("div",{className:"calc-row",children:[i.jsx("span",{className:"calc-label",children:"Opportunity Cost:"}),i.jsxs("span",{className:`calc-value ${g.opportunityCost<=0?"profit":"loss"}`,children:[Re(Math.abs(g.opportunityCost)),i.jsxs("span",{className:"percent",children:["(",os(g.opportunityCostPercent),")"]})]})]})]})}),i.jsx("div",{className:"pnl-recommendation",children:i.jsxs("div",{className:"recommendation-indicator",style:{color:f(g.recommendation)},children:[i.jsx(Je,{size:16}),i.jsx("span",{children:y(g.recommendation,g.type)})]})}),i.jsxs("div",{className:"break-even-info",children:[i.jsx(Ac,{size:14}),i.jsxs("span",{children:["Break-even: ",Re(g.breakEvenPrice)]})]}),x&&i.jsxs("div",{className:"last-update",children:[i.jsx(st,{size:12}),i.jsxs("span",{children:["Updated: ",new Date(x).toLocaleTimeString()]})]})]},c)},Zg=({stockData:s,orderType:e,portfolioData:t,currentPrice:n,onQuantitySelect:r,selectedQuantity:a,className:o=""})=>{const l=v.useMemo(()=>{if(!s||!n)return[];const h=[];if(e==="buy"){const m=t.availableCash;[1,5,10,25,50,100,200,500].forEach(f=>{const y=f*n;y<=m&&y>=500&&h.push({type:"round",quantity:f,amount:y,label:`${f} shares`,description:"Round number",icon:pi,priority:2})}),[1e3,2500,5e3,1e4,25e3,5e4].forEach(f=>{if(f<=m){const y=Math.floor(f/n);y>0&&h.push({type:"amount",quantity:y,amount:y*n,label:`₹${f.toLocaleString("en-IN")}`,description:`${y} shares`,icon:Je,priority:3})}}),[10,25,50,75,100].forEach(f=>{const y=m*f/100,S=Math.floor(y/n);S>0&&y>=500&&h.push({type:"percentage",quantity:S,amount:S*n,label:`${f}%`,description:`${S} shares of available cash`,icon:Ac,priority:f===25||f===50?1:2})});const g=t.totalValue||0;g>0&&[2,5,10].forEach(y=>{const S=g*y/100,k=Math.floor(S/n);k>0&&S<=m&&h.push({type:"diversification",quantity:k,amount:k*n,label:`${y}% of portfolio`,description:`${k} shares for diversification`,icon:fi,priority:1})})}else{const m=t.holdings.find(f=>f.symbol===s.symbol);if(!m||m.quantity===0)return[];const x=m.quantity,b=m.averagePrice||m.averageBuyPrice||0;if([25,50,75,100].forEach(f=>{const y=Math.floor(x*f/100);if(y>0){const S=y*n,k=y*b,C=S-k,N=k>0?C/k*100:0;h.push({type:"profit",quantity:y,amount:S,label:`${f}% of holding`,description:`${y} shares • ${C>=0?"Profit":"Loss"}: ₹${Math.abs(C).toLocaleString("en-IN")}`,icon:C>=0?Pe:rt,priority:C>=0?1:3,profitLoss:C,profitPercent:N})}}),[1,5,10,25,50,100].forEach(f=>{if(f<=x){const y=f*n,S=f*b,k=y-S;h.push({type:"round",quantity:f,amount:y,label:`${f} shares`,description:`${k>=0?"Profit":"Loss"}: ₹${Math.abs(k).toLocaleString("en-IN")}`,icon:pi,priority:2,profitLoss:k})}}),b>0&&n!==b){const f=Math.min(x,Math.floor(x/2));f>0&&h.push({type:"breakeven",quantity:f,amount:f*n,label:"Break-even",description:`${f} shares at current price`,icon:hs,priority:n>=b?1:3})}}return h.filter((m,x,b)=>x===b.findIndex(p=>p.quantity===m.quantity)).sort((m,x)=>m.priority!==x.priority?m.priority-x.priority:m.quantity-x.quantity).slice(0,8)},[s,e,t,n]);if(l.length===0)return null;l.reduce((h,d)=>{const m=d.type;return h[m]||(h[m]=[]),h[m].push(d),h},{});const c=h=>{switch(h.type){case"percentage":case"diversification":return"#8B5CF6";case"amount":return"#10B981";case"profit":return h.profitLoss>=0?"#10B981":"#EF4444";case"round":return"#3B82F6";case"breakeven":return"#F59E0B";default:return"#6B7280"}};return i.jsxs("div",{className:`smart-quantity-suggestions ${o}`,children:[i.jsxs("div",{className:"suggestions-header",children:[i.jsx(Fs,{className:"suggestions-icon"}),i.jsx("span",{className:"suggestions-title",children:"Smart Suggestions"})]}),i.jsx("div",{className:"suggestions-grid",children:l.map((h,d)=>{const m=h.icon,x=a===h.quantity,b=c(h);return i.jsxs(F.button,{className:`suggestion-card ${x?"selected":""}`,onClick:()=>r(h.quantity),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2,delay:d*.05},whileHover:{scale:1.02},whileTap:{scale:.98},style:{"--suggestion-color":b},children:[i.jsxs("div",{className:"suggestion-header",children:[i.jsx(m,{className:"suggestion-icon",size:16}),i.jsx("span",{className:"suggestion-label",children:h.label})]}),i.jsxs("div",{className:"suggestion-details",children:[i.jsx("div",{className:"suggestion-description",children:h.description}),i.jsxs("div",{className:"suggestion-amount",children:["₹",h.amount.toLocaleString("en-IN")]})]}),h.profitLoss!==void 0&&i.jsxs("div",{className:`profit-indicator ${h.profitLoss>=0?"profit":"loss"}`,children:[h.profitLoss>=0?"+":"","₹",Math.abs(h.profitLoss).toLocaleString("en-IN"),h.profitPercent!==void 0&&i.jsxs("span",{className:"profit-percent",children:["(",h.profitPercent>=0?"+":"",h.profitPercent.toFixed(1),"%)"]})]}),h.priority===1&&i.jsxs("div",{className:"priority-badge",children:[i.jsx(Fs,{size:10}),"Recommended"]})]},`${h.type}-${h.quantity}`)})}),i.jsx("div",{className:"suggestions-footer",children:i.jsx("span",{className:"suggestions-note",children:"Suggestions based on your portfolio and market conditions"})})]})},Ch=({isOpen:s,onClose:e,stockData:t=null,initialOrderType:n="buy",onOrderPlaced:r,onShowConfirmation:a})=>{var oe,ie;const[o,l]=v.useState(n),[c,h]=v.useState("market"),[d,m]=v.useState(1),[x,b]=v.useState(""),[p,g]=v.useState(!1),[f,y]=v.useState(!1),{portfolioData:S,buyStock:k,sellStock:C}=ft(),{user:N}=Sc(D=>D.auth),T=document.documentElement.getAttribute("data-theme")||"light",{validationErrors:I,profitLossEstimate:P,isValidating:L,isValid:M,getOrderSummary:O}=Ug(t,o,d,x,c),{stockData:B,isLoading:R,refreshStockData:A,isMarketOpen:V}=Wg(t==null?void 0:t.symbol,s),z=B||t;v.useEffect(()=>{var D;s&&z&&(b(((D=z.price)==null?void 0:D.toString())||""),m(1))},[s,z]),v.useEffect(()=>{if(s&&(z!=null&&z.symbol)){const D=setInterval(()=>{A()},3e4);return()=>clearInterval(D)}},[s,z==null?void 0:z.symbol,A]);const q=O(),Y=D=>{const $=Math.max(1,d+D);m($)},te=()=>{if(!z)return[];const D=c==="market"?z.price:parseFloat(x)||z.price;if(o==="buy"){const $=S.availableCash,U=[];return[1e3,2500,5e3,1e4].forEach(ye=>{const pe=Math.floor(ye/D);pe>0&&ye<=$&&U.push({value:pe,label:`${pe} shares`,amount:pe*D,disabled:!1})}),[25,50,75,100].forEach(ye=>{const pe=$*ye/100,Ae=Math.floor(pe/D);Ae>0&&!U.find(le=>le.value===Ae)&&U.push({value:Ae,label:`${ye}% (${Ae})`,amount:Ae*D,disabled:!1})}),U.sort((ye,pe)=>ye.value-pe.value).slice(0,6).map(ye=>({...ye,disabled:ye.amount>$}))}else{const $=S.holdings.find(pe=>pe.symbol===z.symbol);if(!$||$.quantity===0)return[];const U=$.quantity,X=[];return[1,5,10,25,50,100].forEach(pe=>{pe<=U&&X.push({value:pe,label:`${pe} shares`,amount:pe*D,disabled:!1})}),[25,50,75,100].forEach(pe=>{const Ae=Math.floor(U*pe/100);Ae>0&&!X.find(le=>le.value===Ae)&&X.push({value:Ae,label:`${pe}% (${Ae})`,amount:Ae*D,disabled:!1})}),X.find(pe=>pe.value===U)||X.push({value:U,label:`All (${U})`,amount:U*D,disabled:!1}),X.sort((pe,Ae)=>pe.value-Ae.value).slice(0,6)}},ne=()=>{!M||p&&!document.getElementById("confirm-checkbox").checked||(a?a({orderData:{orderType:o,orderMethod:c,quantity:d,limitPrice:x},stockData:z,orderSummary:q,profitLossEstimate:P,onConfirm:re}):console.warn("OrderModal: onShowConfirmation prop not provided. Order confirmation disabled."))},re=async()=>{y(!0);try{const D=c==="market"?z.price:parseFloat(x);console.log("🚀 Placing order:",{orderType:o,symbol:z.symbol,quantity:d,orderPrice:D,orderMethod:c});const $=Bi.pending(o,z.symbol,d,T);let U;if(o==="buy"?U=await k(z.symbol,d,D,z):U=await C(z.symbol,d,D,z),Yg($),U.success){if(console.log("✅ Order successful:",U),o==="buy")Bi.buySuccess(z.symbol,d,D,T);else{const X=P?P.amount:0;Bi.sellSuccess(z.symbol,d,D,X,T)}S!=null&&S.refreshPortfolio&&S.refreshPortfolio(),r==null||r(),e()}else throw console.error("❌ Order failed:",U),new Error(U.error||"Order failed")}catch(D){console.error("❌ Order error:",D),Bi.error("Order failed",D.message||"An unexpected error occurred",T)}finally{y(!1)}};return s?i.jsx(Se,{children:i.jsx(F.div,{className:"order-modal-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:D=>D.target===D.currentTarget&&e(),children:i.jsxs(F.div,{className:"order-modal",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3,ease:[.4,0,.2,1]},children:[i.jsxs("div",{className:"order-modal-header",children:[i.jsxs("h2",{className:"order-modal-title",children:[i.jsx(tt,{}),o==="buy"?"Buy Order":"Sell Order"]}),i.jsx("button",{className:"order-modal-close",onClick:e,children:i.jsx(We,{size:20})})]}),i.jsxs("div",{className:"order-modal-body",children:[z&&i.jsxs("div",{className:"order-stock-info",children:[i.jsxs("div",{className:"order-stock-details",children:[i.jsx("h3",{children:z.symbol}),i.jsx("p",{children:z.name||z.symbol}),!V&&i.jsxs("span",{className:"market-closed-indicator",children:[i.jsx(st,{size:12}),"Market Closed"]})]}),i.jsxs("div",{className:"order-stock-price",children:[i.jsx(ys,{price:z.price,change:z.change,changePercent:z.changePercent,size:"large"}),R&&i.jsxs("div",{className:"price-loading",children:[i.jsx("div",{className:"loading-spinner"}),"Updating..."]})]})]}),i.jsxs("div",{className:"order-form-section",children:[i.jsxs("h3",{className:"section-title",children:[i.jsx(vt,{}),"Order Type"]}),i.jsxs("div",{className:"order-type-toggle",children:[i.jsxs("button",{className:`order-type-btn ${o==="buy"?"active buy":""}`,onClick:()=>l("buy"),children:[i.jsx(Pe,{}),"Buy"]}),i.jsxs("button",{className:`order-type-btn ${o==="sell"?"active sell":""}`,onClick:()=>l("sell"),children:[i.jsx($e,{}),"Sell"]})]})]}),i.jsx("div",{className:"order-form-section",children:i.jsxs("div",{className:"order-method-select",children:[i.jsx("label",{htmlFor:"order-method",children:"Order Method"}),i.jsxs("select",{id:"order-method",value:c,onChange:D=>h(D.target.value),children:[i.jsx("option",{value:"market",children:"Market Order"}),i.jsx("option",{value:"limit",children:"Limit Order"})]})]})}),i.jsxs("div",{className:"order-form-section",children:[i.jsxs("div",{className:"order-inputs-grid",children:[i.jsxs("div",{className:"order-input-group full-width",children:[i.jsx("label",{children:"Quantity"}),i.jsx(Zg,{stockData:z,orderType:o,portfolioData:S,currentPrice:c==="market"?(z==null?void 0:z.price)||0:parseFloat(x)||0,onQuantitySelect:m,selectedQuantity:d}),i.jsx("div",{className:"quantity-options",children:te().map(D=>i.jsxs("button",{className:`quantity-option-btn ${d===D.value?"active":""}`,onClick:()=>m(D.value),disabled:D.disabled,children:[i.jsx("span",{className:"option-value",children:D.label}),i.jsxs("span",{className:"option-amount",children:["₹",(D.value*(c==="market"?(z==null?void 0:z.price)||0:parseFloat(x)||0)).toLocaleString("en-IN")]})]},D.value))}),i.jsxs("div",{className:"order-quantity-control",children:[i.jsx("button",{className:"qty-control-btn",onClick:()=>Y(-1),disabled:d<=1,children:i.jsx(Mn,{})}),i.jsx("input",{type:"number",className:"qty-control-input",value:d,onChange:D=>m(Math.max(1,parseInt(D.target.value)||1)),min:"1",placeholder:"Enter quantity"}),i.jsx("button",{className:"qty-control-btn",onClick:()=>Y(1),children:i.jsx(Ht,{})})]}),i.jsxs("div",{className:"investment-amount-display",children:[i.jsx("span",{className:"investment-label",children:"Investment Amount:"}),i.jsxs("span",{className:"investment-value",children:["₹",(d*(c==="market"?(z==null?void 0:z.price)||0:parseFloat(x)||0)).toLocaleString("en-IN")]})]}),I.quantity&&i.jsx("span",{className:"error-text",children:I.quantity})]}),c==="limit"&&i.jsxs("div",{className:"order-input-group",children:[i.jsx("label",{children:"Limit Price (₹)"}),i.jsx("input",{type:"number",className:"order-price-input",value:x,onChange:D=>b(D.target.value),placeholder:"Enter limit price",step:"0.01"}),I.price&&i.jsx("span",{className:"error-text",children:I.price})]})]}),I.funds&&i.jsxs("div",{className:"error-message",children:[i.jsx(qt,{}),I.funds]}),I.shares&&i.jsxs("div",{className:"error-message",children:[i.jsx(qt,{}),I.shares]})]}),z&&d>0&&(c==="market"||x)&&i.jsx("div",{className:"order-form-section",children:i.jsx(Xg,{stockData:z,orderType:o,quantity:d,orderPrice:c==="market"?z.price:parseFloat(x)||0,averagePrice:o==="sell"?(oe=S.holdings.find(D=>D.symbol===z.symbol))==null?void 0:oe.averagePrice:null})}),i.jsx("div",{className:"order-form-section",children:i.jsxs("div",{className:"order-summary-card",children:[i.jsxs("h3",{className:"order-summary-title",children:[i.jsx(Je,{}),"Order Summary"]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{className:"summary-label",children:"Quantity:"}),i.jsxs("span",{className:"summary-value",children:[d," shares"]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{className:"summary-label",children:"Price per share:"}),i.jsx("span",{className:"summary-value",children:Vg(q.pricePerShare)})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{className:"summary-label",children:"Gross amount:"}),i.jsx("span",{className:"summary-value",children:Re(q.grossAmount)})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{className:"summary-label",children:"Fees & charges:"}),i.jsx("span",{className:"summary-value",children:Re(q.fees.total)})]}),i.jsxs("div",{className:"summary-row total",children:[i.jsx("span",{className:"summary-label",children:"Net amount:"}),i.jsx("span",{className:"summary-value",children:Re(q.netAmount)})]}),P&&i.jsxs("div",{className:`profit-loss-indicator ${P.isProfit?"profit":"loss"}`,children:[P.isProfit?i.jsx(Pe,{}):i.jsx($e,{}),"Estimated ",P.isProfit?"Profit":"Loss",":",Re(Math.abs(P.amount)),"(",os(P.percentage),")"]})]})}),i.jsxs("div",{className:"confirm-checkbox",children:[i.jsx("input",{type:"checkbox",id:"confirm-checkbox",checked:p,onChange:D=>g(D.target.checked)}),i.jsxs("label",{htmlFor:"confirm-checkbox",children:["I confirm that I want to place this ",o," order"]})]}),i.jsxs("div",{className:"order-modal-actions",children:[i.jsx("button",{className:"order-action-btn cancel",onClick:e,disabled:f,children:"Cancel"}),i.jsx("button",{className:`order-action-btn ${o==="buy"?"place-buy":"place-sell"}`,onClick:ne,disabled:f||!M||L||p&&!((ie=document.getElementById("confirm-checkbox"))!=null&&ie.checked),children:f?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"loading-spinner"}),"Placing Order..."]}):`Place ${o==="buy"?"Buy":"Sell"} Order`})]})]})]})})}):null},ey=({isOpen:s,onClose:e,onConfirm:t,orderData:n,stockData:r,orderSummary:a,profitLossEstimate:o,isProcessing:l=!1})=>{const[c,h]=v.useState("details"),[d,m]=v.useState(0),[x,b]=v.useState(!1),p=v.useRef(null),{portfolioData:g}=ft(),f=Ce.useMemo(()=>{if((n==null?void 0:n.orderType)==="sell"&&r&&(g!=null&&g.holdings)){const P=g.holdings.find(L=>L.symbol===r.symbol);if(P){const L=r.price||0,M=P.averagePrice||0,O=P.quantity||0,B=M*O,R=L*O,A=R-B,V=B>0?A/B*100:0;return{...P,currentPrice:L,buyPrice:M,totalInvested:B,currentValue:R,totalGainLoss:A,gainLossPercentage:V,isProfit:A>=0}}}return null},[n,r,g]);Ce.useMemo(()=>{if(f){const L=f.currentPrice-f.buyPrice,M=[];for(let O=0;O<=20;O++){const B=O/20,R=f.buyPrice+L*B,A=R*f.quantity;M.push({time:Date.now()-(20-O)*24*60*60*1e3,price:R,value:A})}return M}return[]},[f]),v.useEffect(()=>{s&&(h("details"),m(0),b(!1))},[s]);const y=P=>{b(!0);const L=P.touches?P.touches[0].clientX:P.clientX,M=p.current;if(!M)return;const B=M.getBoundingClientRect().width-60,R=V=>{const z=V.touches?V.touches[0].clientX:V.clientX,Y=Math.max(0,Math.min(B,z-L))/B*100;m(Y)},A=()=>{d>80?(h("processing"),t()):m(0),b(!1),document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",A),document.removeEventListener("touchmove",R),document.removeEventListener("touchend",A)};document.addEventListener("mousemove",R),document.addEventListener("mouseup",A),document.addEventListener("touchmove",R),document.addEventListener("touchend",A)};if(!s||!n||!r)return null;const{orderType:S,orderMethod:k,quantity:C,limitPrice:N}=n,T=k==="market"?r.price:parseFloat(N),I=S==="buy";return i.jsx(Se,{mode:"wait",children:s&&i.jsx(F.div,{className:"enhanced-confirmation-overlay app-level-modal",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:P=>P.target===P.currentTarget&&e(),"data-modal-level":"app",children:i.jsxs(F.div,{className:"enhanced-confirmation-modal",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3,ease:[.4,0,.2,1]},children:[i.jsx(F.button,{className:"enhanced-modal-close",onClick:e,whileHover:{scale:1.1},whileTap:{scale:.9},children:i.jsx(We,{size:24})}),c==="details"&&i.jsxs(F.div,{className:"modal-content",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[i.jsxs("div",{className:"stock-header",children:[i.jsxs("div",{className:"stock-info",children:[i.jsx("h1",{className:"stock-symbol",children:r.symbol}),i.jsx("p",{className:"stock-name",children:r.name}),i.jsx("div",{className:"stock-exchange-badge",children:"NSE"})]}),i.jsxs("div",{className:"stock-price",children:[i.jsx("span",{className:"current-price",children:Re(T)}),i.jsxs("div",{className:`price-change ${r.change>=0?"positive":"negative"}`,children:[r.change>=0?i.jsx(Pe,{}):i.jsx($e,{}),i.jsxs("span",{children:[Re(Math.abs(r.change))," (",os(Math.abs(r.changePercent)),")"]})]})]})]}),i.jsxs("div",{className:"order-details",children:[i.jsxs("h3",{className:"section-title",children:[i.jsx(Je,{}),"Order Details"]}),i.jsxs("div",{className:"detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"label",children:"Order Type:"}),i.jsx("span",{className:`value ${I?"buy":"sell"}`,children:I?"BUY":"SELL"})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"label",children:"Quantity:"}),i.jsxs("span",{className:"value",children:[C," shares"]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"label",children:"Price:"}),i.jsx("span",{className:"value",children:Re(T)})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"label",children:"Total Amount:"}),i.jsx("span",{className:"value total",children:Re(T*C)})]})]})]}),!I&&f&&i.jsxs("div",{className:"profit-loss-analysis",children:[i.jsxs("h3",{className:"section-title",children:[i.jsx(rt,{}),"Profit & Loss Analysis"]}),i.jsxs("div",{className:"pnl-summary",children:[i.jsxs("div",{className:"pnl-item",children:[i.jsx("span",{className:"label",children:"Buy Price:"}),i.jsx("span",{className:"value",children:Re(f.buyPrice)})]}),i.jsxs("div",{className:"pnl-item",children:[i.jsx("span",{className:"label",children:"Current Price:"}),i.jsx("span",{className:"value",children:Re(f.currentPrice)})]}),i.jsxs("div",{className:"pnl-item",children:[i.jsx("span",{className:"label",children:"Total Invested:"}),i.jsx("span",{className:"value",children:Re(f.totalInvested)})]}),i.jsxs("div",{className:"pnl-item total",children:[i.jsxs("span",{className:"label",children:["Total ",f.isProfit?"Profit":"Loss",":"]}),i.jsxs("span",{className:`value ${f.isProfit?"profit":"loss"}`,children:[f.isProfit?"+":"",Re(f.totalGainLoss),"(",f.isProfit?"+":"",os(f.gainLossPercentage),")"]})]})]})]}),i.jsx("div",{className:"slide-to-confirm",children:i.jsxs("div",{ref:p,className:"slide-container",children:[i.jsx("div",{className:"slide-track",style:{background:`linear-gradient(to right, ${I?"#10B981":"#EF4444"} ${d}%, #E5E7EB ${d}%)`},children:i.jsx(F.div,{className:"slide-button",style:{left:`${d}%`},onMouseDown:y,onTouchStart:y,whileHover:{scale:1.05},whileTap:{scale:.95},children:i.jsx(lt,{})})}),i.jsxs("span",{className:"slide-text",children:["Slide to ",I?"Buy":"Sell"]})]})})]}),c==="processing"&&i.jsxs(F.div,{className:"processing-content",initial:{opacity:0},animate:{opacity:1},children:[i.jsx("div",{className:"processing-animation",children:i.jsx(F.div,{className:"spinner",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})}),i.jsx("h2",{children:"Processing Order..."}),i.jsxs("p",{children:["Please wait while we execute your ",I?"buy":"sell"," order"]})]}),c==="success"&&i.jsxs(F.div,{className:"success-content",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},children:[i.jsx(F.div,{className:"success-icon",initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:300},children:i.jsx(kt,{})}),i.jsx("h2",{children:"Order Confirmed!"}),i.jsxs("p",{children:["Your ",I?"buy":"sell"," order has been successfully placed"]}),i.jsx(F.button,{className:"success-button",onClick:e,whileHover:{scale:1.05},whileTap:{scale:.95},children:"Done"})]})]})})})},ty=()=>{const[s,e]=v.useState(!1),t=Ve(),n=v.useCallback(l=>{if((l.ctrlKey||l.metaKey)&&l.key==="k"){l.preventDefault(),l.stopPropagation();const h=document.activeElement,d=h&&(h.tagName==="INPUT"||h.tagName==="TEXTAREA"||h.contentEditable==="true"),m=h&&h.classList.contains("search-input");if(d&&!m)return;e(!0)}},[]),r=v.useCallback(l=>{l.key==="Escape"&&s&&e(!1)},[s]);v.useEffect(()=>(document.addEventListener("keydown",n),document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",n),document.removeEventListener("keydown",r)}),[n,r]);const a=v.useCallback((l,c="stocks")=>{if(l.trim()){switch(c){case"stocks":t(`/trading?search=${encodeURIComponent(l)}`);break;case"news":t(`/news?search=${encodeURIComponent(l)}`);break;case"orders":t(`/orders?search=${encodeURIComponent(l)}`);break;default:t(`/trading?search=${encodeURIComponent(l)}`)}e(!1)}},[t]),o=v.useCallback(()=>{e(!1)},[]);return{isGlobalSearchOpen:s,setIsGlobalSearchOpen:e,handleGlobalSearch:a,closeGlobalSearch:o}},Di=(s,e="manual")=>s?{symbol:s.symbol||s.ticker||s.stockSymbol,name:s.name||s.companyName||s.longName||s.symbol,price:s.price||s.currentPrice||s.close||s.regularMarketPrice||0,change:s.change||s.priceChange||s.regularMarketChange||0,changePercent:s.changePercent||s.percentChange||s.regularMarketChangePercent||0,volume:s.volume||s.regularMarketVolume||0,marketCap:s.marketCap||0,sector:s.sector||s.sectorName||"",industry:s.industry||"",source:e,timestamp:new Date().toISOString(),...s}:null,qa=()=>{const[s,e]=v.useState({isOpen:!1,stockData:null,orderType:"buy",source:null}),t=Ve(),n=v.useCallback((p,g="buy",f="manual")=>{console.log("🚀 openOrderModal called",{stockData:p,orderType:g,source:f});const y=Di(p,f);console.log("📊 Normalized stock data",y),e({isOpen:!0,stockData:y,orderType:g,source:f}),console.log("✅ Order modal state updated")},[]),r=v.useCallback(()=>{e({isOpen:!1,stockData:null,orderType:"buy",source:null})},[]),a=v.useCallback(async(p,g=1)=>{try{console.log("🚀 Quick buy:",{stockData:p,quantity:g});const f=Di(p);if(!f)throw new Error("Invalid stock data");const y=await je.buyStock(f.symbol,g,f.price,"market");return y.success?(K.success(y.message),{success:!0,data:y.data}):(K.error(y.error),{success:!1,error:y.error})}catch(f){return console.error("Quick buy error:",f),K.error(f.message||"Failed to buy stock"),{success:!1,error:f.message}}},[]),o=v.useCallback(async(p,g=1)=>{try{console.log("🚀 Quick sell:",{stockData:p,quantity:g});const f=Di(p);if(!f)throw new Error("Invalid stock data");const y=await je.sellStock(f.symbol,g,f.price,"market");return y.success?(K.success(y.message),{success:!0,data:y.data}):(K.error(y.error),{success:!1,error:y.error})}catch(f){return console.error("Quick sell error:",f),K.error(f.message||"Failed to sell stock"),{success:!1,error:f.message}}},[]),l=v.useCallback((p,g="buy")=>{const f=p.symbol||p.stockSymbol;t(`/trading?symbol=${f}&type=${g}`)},[t]),c=v.useCallback(p=>{const g={symbol:p.symbol,name:p.name||p.symbol,price:p.price||p.close||p.c,change:p.change||p.d||0,changePercent:p.changePercent||p.dp||0,volume:p.volume||p.v||0,high:p.high||p.h||0,low:p.low||p.l||0,open:p.open||p.o||0,source:"chart"};n(g,"buy","chart")},[n]),h=v.useCallback((p,g="buy")=>{const f={symbol:p.symbol||p.stockSymbol,name:p.name||p.stockName||p.symbol,price:p.price||p.currentPrice||0,change:p.change||p.dayChange||0,changePercent:p.changePercent||p.dayChangePercent||0,volume:p.volume||0,high:p.high||p.dayHigh||0,low:p.low||p.dayLow||0,open:p.open||0,source:"watchlist"};n(f,g,"watchlist")},[n]),d=v.useCallback((p,g="sell")=>{const f={symbol:p.symbol||p.stockSymbol,name:p.name||p.stockName||p.symbol,price:p.currentPrice||p.price||0,change:p.dayChange||p.change||0,changePercent:p.dayChangePercent||p.changePercent||0,volume:p.volume||0,high:p.dayHigh||p.high||0,low:p.dayLow||p.low||0,open:p.open||0,averagePrice:p.averagePrice||p.averageBuyPrice||0,quantity:p.quantity||0,totalValue:p.totalValue||p.currentValue||0,totalGains:p.totalGains||p.gainLoss||0,gainsPercent:p.gainsPercent||p.gainLossPercentage||0,source:"portfolio"};n(f,g,"portfolio")},[n]),m=v.useCallback((p,g="buy")=>{const f={symbol:p.symbol||p.ticker,name:p.name||p.companyName||p.symbol,price:p.price||p.lastPrice||0,change:p.change||p.priceChange||0,changePercent:p.changePercent||p.percentChange||0,volume:p.volume||p.totalVolume||0,high:p.high||p.dayHigh||0,low:p.low||p.dayLow||0,open:p.open||p.openPrice||0,source:"market"};n(f,g,"market")},[n]),x=v.useCallback((p,g="buy")=>{if(p.length>0){const f=p[0],y={...Di(f,"bulk"),bulkList:p,source:"bulk"};n(y,g,"bulk")}},[n]),b=v.useCallback(p=>[{label:"Quick Buy",icon:"FiTrendingUp",action:()=>a(p),color:"green"},{label:"Quick Sell",icon:"FiTrendingDown",action:()=>o(p),color:"red",disabled:!sy(p.symbol)},{label:"View Chart",icon:"FiBarChart2",action:()=>t(`/charts?symbol=${p.symbol}`),color:"blue"},{label:"Add to Watchlist",icon:"FiBookmark",action:()=>iy(p),color:"purple"}],[a,o,t]);return{orderModalState:s,openOrderModal:n,closeOrderModal:r,navigateToTrading:l,handleChartStockClick:c,handleWatchlistStockClick:h,handlePortfolioStockClick:d,handleMarketDataClick:m,quickBuy:a,quickSell:o,handleBulkOrder:x,getContextMenuActions:b}},sy=s=>!0,iy=s=>{console.log("Adding to watchlist:",s.symbol)},ny=(s,e={})=>{const{enableProfiling:t=!1,cacheSize:n=100,debounceDelay:r=300,throttleDelay:a=1e3}=e,o=v.useRef(0),l=v.useRef(Date.now()),c=v.useRef(new kh(n)),h=Nh();v.useEffect(()=>{o.current+=1;const p=Date.now(),g=p-l.current;l.current=p,t&&(console.log(`🔄 ${s} render #${o.current} (${g}ms since last)`),g<16&&console.warn(`⚠️ ${s} rendering too frequently (${g}ms)`))});const d=v.useCallback((p,g=r)=>qg(p,g),[r]),m=v.useCallback((p,g=a)=>Gg(p,g),[a]),x=v.useMemo(()=>({get:p=>c.current.get(p),set:(p,g)=>c.current.set(p,g),clear:()=>c.current.clear(),size:()=>c.current.size()}),[]),b=v.useCallback(()=>({renderCount:o.current,lastRenderTime:l.current,cacheSize:c.current.size(),componentName:s}),[s]);return{debounce:d,throttle:m,cache:x,getMetrics:b,cleanupManager:h}};class ry{constructor(){this.listeners=new Set,this.currentBalance=1e4,this.isInitialized=!1}async initialize(){if(!this.isInitialized)try{const e=je.getPortfolioSummary();this.currentBalance=e.availableCash,je.addListener(this.handleTradingServiceUpdate.bind(this)),window.addEventListener("balanceUpdated",this.handleBalanceUpdate.bind(this)),this.isInitialized=!0,console.log("✅ Balance sync manager initialized with balance:",this.currentBalance)}catch(e){console.error("❌ Failed to initialize balance sync manager:",e)}}handleTradingServiceUpdate(e){const t=e.availableCash;t!==this.currentBalance&&(this.currentBalance=t,this.notifyListeners())}handleBalanceUpdate(e){const{newBalance:t}=e.detail;t!==this.currentBalance&&(this.currentBalance=t,this.notifyListeners())}getCurrentBalance(){return this.currentBalance}getFormattedBalance(){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(this.currentBalance)}async updateBalance(e,t="manual"){const n=this.currentBalance;this.currentBalance=e,console.log(`💰 Balance updated from ${t}: ₹${n} → ₹${e}`),je.virtualBalance=e,je.savePortfolioToStorage(),je.notifyListeners(),await this.syncWithServer(),this.notifyListeners(),window.dispatchEvent(new CustomEvent("balanceUpdated",{detail:{newBalance:e,oldBalance:n,change:e-n,source:t}}))}async syncWithServer(){try{const e=localStorage.getItem("token");if(!e)return;(await fetch("http://localhost:5001/api/virtual-money/sync-balance",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({balance:this.currentBalance,totalRewards:je.dailyRewards.totalRewards,loginStreak:je.dailyRewards.loginStreak,lastClaimDate:je.dailyRewards.lastClaimDate})})).ok?console.log("✅ Balance synced with server successfully"):console.warn("⚠️ Failed to sync balance with server")}catch(e){console.warn("⚠️ Server sync error:",e.message)}}addListener(e){return this.listeners.add(e),e({balance:this.currentBalance,formattedBalance:this.getFormattedBalance()}),()=>this.listeners.delete(e)}removeListener(e){this.listeners.delete(e)}notifyListeners(){const e={balance:this.currentBalance,formattedBalance:this.getFormattedBalance()};this.listeners.forEach(t=>{try{t(e)}catch(n){console.error("Error in balance listener:",n)}})}async forceRefresh(){try{const e=je.getPortfolioSummary(),t=localStorage.getItem("token");if(t){const n=await fetch("http://localhost:5001/api/virtual-money/account",{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(n.ok){const a=(await n.json()).data.balance;this.currentBalance=a,je.virtualBalance=a,je.savePortfolioToStorage()}}this.notifyListeners(),console.log("🔄 Balance force refreshed:",this.currentBalance)}catch(e){console.error("❌ Error force refreshing balance:",e)}}cleanup(){this.listeners.clear(),window.removeEventListener("balanceUpdated",this.handleBalanceUpdate.bind(this)),this.isInitialized=!1}}const ay=new ry,oy=({isAuthenticated:s=!1,user:e=null,theme:t="light",onToggleTheme:n=()=>{},onLogin:r=()=>{},onSignup:a=()=>{}})=>{const[o,l]=v.useState(!1),[c,h]=v.useState(!1),d=$t();v.useEffect(()=>{const p=()=>{h(window.scrollY>20)};return window.addEventListener("scroll",p),()=>window.removeEventListener("scroll",p)},[]),v.useEffect(()=>{l(!1)},[d.pathname]);const m=()=>{l(!o)},x=[{name:"Features",href:"#features",external:!1},{name:"How it Works",href:"#how-it-works",external:!1},{name:"AI Demo",href:"#ai-demo",external:!1}],b=p=>{if(p.startsWith("#")){const g=document.querySelector(p);g&&g.scrollIntoView({behavior:"smooth"})}};return i.jsxs(F.header,{className:`tradebro-header ${c?"scrolled":""} ${t}`,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:[i.jsxs("div",{className:"header-container",children:[i.jsx(F.div,{className:"header-logo",whileHover:{scale:1.02},transition:{type:"spring",stiffness:400,damping:17},children:i.jsx(be,{to:"/",className:"logo-link",children:i.jsxs("div",{className:"logo-text",children:[i.jsx("span",{className:"logo-main",children:"TradeBro"}),i.jsx("span",{className:"logo-tagline",children:"AI Trading Platform"})]})})}),i.jsx("nav",{className:"header-nav desktop-nav",children:x.map((p,g)=>i.jsx(F.button,{className:"nav-item",onClick:()=>b(p.href),whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:g*.1},children:p.name},p.name))}),i.jsxs("div",{className:"header-actions",children:[i.jsx(F.button,{className:"theme-toggle",onClick:n,whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":"Toggle theme",children:i.jsx(Se,{mode:"wait",children:t==="dark"?i.jsx(F.div,{initial:{rotate:-90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:90,opacity:0},transition:{duration:.2},children:i.jsx(Bc,{})},"sun"):i.jsx(F.div,{initial:{rotate:90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:-90,opacity:0},transition:{duration:.2},children:i.jsx(Rc,{})},"moon")})}),s?i.jsx(F.div,{className:"user-profile",whileHover:{scale:1.05},transition:{type:"spring",stiffness:400,damping:17},children:i.jsxs(be,{to:"/dashboard",className:"profile-link",children:[i.jsx("div",{className:"profile-avatar",children:e!=null&&e.profilePicture?i.jsx("img",{src:e.profilePicture,alt:e.name}):i.jsx(ht,{})}),i.jsx("span",{className:"profile-name",children:(e==null?void 0:e.name)||"User"})]})}):i.jsxs("div",{className:"auth-actions",children:[i.jsxs(F.button,{className:"btn-header btn-ghost",onClick:r,whileHover:{scale:1.05},whileTap:{scale:.95},children:[i.jsx(Do,{size:16}),i.jsx("span",{className:"btn-text",children:"Login"})]}),i.jsxs(F.button,{className:"btn-header btn-primary",onClick:a,whileHover:{scale:1.05},whileTap:{scale:.95},children:[i.jsx(hs,{size:16}),i.jsx("span",{className:"btn-text",children:"Start Trading"}),i.jsx(lt,{size:14})]})]}),i.jsx(F.button,{className:"mobile-menu-toggle",onClick:m,whileHover:{scale:1.1},whileTap:{scale:.9},"aria-label":"Toggle mobile menu",children:i.jsx(Se,{mode:"wait",children:o?i.jsx(F.div,{initial:{rotate:-90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:90,opacity:0},transition:{duration:.2},children:i.jsx(We,{})},"close"):i.jsx(F.div,{initial:{rotate:90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:-90,opacity:0},transition:{duration:.2},children:i.jsx(Fa,{})},"menu")})})]})]}),i.jsx(Se,{children:o&&i.jsx(F.div,{className:"mobile-nav-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},onClick:m,children:i.jsxs(F.nav,{className:"mobile-nav",initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},onClick:p=>p.stopPropagation(),children:[i.jsxs("div",{className:"mobile-nav-header",children:[i.jsxs("div",{className:"mobile-logo",children:[i.jsx(hs,{className:"mobile-logo-icon"}),i.jsx("span",{children:"TradeBro"})]}),i.jsx("button",{className:"mobile-close-btn",onClick:m,children:i.jsx(We,{})})]}),i.jsxs("div",{className:"mobile-nav-content",children:[x.map((p,g)=>i.jsx(F.button,{className:"mobile-nav-item",onClick:()=>{b(p.href),m()},initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:g*.1},children:p.name},p.name)),!s&&i.jsxs("div",{className:"mobile-auth-actions",children:[i.jsxs(F.button,{className:"mobile-btn btn-ghost",onClick:()=>{r(),m()},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},children:[i.jsx(Do,{size:16}),"Login"]}),i.jsxs(F.button,{className:"mobile-btn btn-primary",onClick:()=>{a(),m()},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.5},children:[i.jsx(hs,{size:16}),"Start Trading",i.jsx(lt,{size:14})]})]})]})]})})})]})},ly=({className:s="",orbCount:e=3,colors:t=["#3B82F6","#10B981","#8B5CF6"],size:n="large"})=>{const r={small:"orb-small",medium:"orb-medium",large:"orb-large"};return i.jsx("div",{className:`orb-background ${s}`,children:Array.from({length:e}).map((a,o)=>i.jsx(F.div,{className:`orb ${r[n]}`,style:{background:`radial-gradient(circle, ${t[o%t.length]}40 0%, ${t[o%t.length]}20 50%, transparent 70%)`,left:`${20+o*30}%`,top:`${10+o*20}%`},animate:{x:[0,100,-50,0],y:[0,-80,60,0],scale:[1,1.2,.8,1]},transition:{duration:20+o*5,repeat:1/0,ease:"easeInOut",delay:o*2}},o))})},cy=({className:s="",gridSize:e=50,lineColor:t="rgba(59, 130, 246, 0.1)",speed:n=20,animate:r=!0})=>i.jsx("div",{className:`grid-motion-container ${s}`,children:i.jsx(F.div,{className:"grid-motion-background",style:{backgroundImage:`
            linear-gradient(${t} 1px, transparent 1px),
            linear-gradient(90deg, ${t} 1px, transparent 1px)
          `,backgroundSize:`${e}px ${e}px`},animate:r?{x:[0,e],y:[0,e]}:{},transition:{duration:n,repeat:1/0,ease:"linear"}})}),hy=()=>{const[s,e]=v.useState(0),[t,n]=v.useState(!1),r=[{value:1e4,label:"Start",color:"#3B82F6"},{value:12500,label:"1 Month",color:"#10B981"},{value:11800,label:"2 Months",color:"#F59E0B"},{value:15200,label:"3 Months",color:"#10B981"},{value:18750,label:"6 Months",color:"#10B981"},{value:22300,label:"1 Year",color:"#10B981"}];return v.useEffect(()=>{const a=setInterval(()=>{t||e(o=>(o+1)%r.length)},2e3);return()=>clearInterval(a)},[t,r.length]),i.jsxs("div",{className:"interactive-chart",onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[i.jsxs("div",{className:"chart-header",children:[i.jsx("div",{className:"chart-title-section",children:i.jsx("h3",{children:"Portfolio Growth Simulation"})}),i.jsxs("div",{className:"chart-value-section",children:[i.jsxs("div",{className:"chart-value",children:[i.jsx("span",{className:"currency",children:"₹"}),i.jsx(F.span,{className:"amount",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:r[s].value.toLocaleString()},s)]}),i.jsx("span",{className:"chart-period",children:r[s].label})]})]}),i.jsx("div",{className:"chart-container",children:i.jsxs("svg",{viewBox:"0 0 400 200",className:"chart-svg",children:[i.jsx("defs",{children:i.jsx("pattern",{id:"grid",width:"40",height:"20",patternUnits:"userSpaceOnUse",children:i.jsx("path",{d:"M 40 0 L 0 0 0 20",fill:"none",stroke:"rgba(59, 130, 246, 0.1)",strokeWidth:"1"})})}),i.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid)"}),i.jsx(F.path,{d:"M 20 150 Q 80 120 120 130 T 200 100 T 280 80 T 360 60",fill:"none",stroke:"url(#chartGradient)",strokeWidth:"3",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:2,ease:"easeInOut"}}),i.jsx("defs",{children:i.jsxs("linearGradient",{id:"chartGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[i.jsx("stop",{offset:"0%",stopColor:"#3B82F6"}),i.jsx("stop",{offset:"50%",stopColor:"#10B981"}),i.jsx("stop",{offset:"100%",stopColor:"#10B981"})]})}),r.map((a,o)=>i.jsx(F.circle,{cx:20+o*68,cy:150-o*15,r:s===o?8:5,fill:a.color,className:"chart-point",initial:{scale:0},animate:{scale:1},transition:{delay:o*.2,duration:.3},onClick:()=>e(o),style:{cursor:"pointer"}},o)),i.jsx(F.circle,{cx:20+s*68,cy:150-s*15,r:"12",fill:"none",stroke:r[s].color,strokeWidth:"2",initial:{scale:0},animate:{scale:1},transition:{duration:.3}})]})}),i.jsx("div",{className:"chart-legend",children:r.map((a,o)=>i.jsxs(F.button,{className:`legend-item ${s===o?"active":""}`,onClick:()=>e(o),whileHover:{scale:1.05},whileTap:{scale:.95},children:[i.jsx("span",{className:"legend-dot",style:{backgroundColor:a.color}}),i.jsx("span",{className:"legend-label",children:a.label})]},o))})]})},dy=({texts:s=["AI-Powered Trading","Smart Portfolio Management","Real-Time Market Data","Risk-Free Virtual Trading"],speed:e=100,deleteSpeed:t=50,pauseTime:n=2e3})=>{const[r,a]=v.useState(0),[o,l]=v.useState(""),[c,h]=v.useState(!1),[d,m]=v.useState(!1);return v.useEffect(()=>{const x=s[r];if(d){const p=setTimeout(()=>{m(!1),h(!0)},n);return()=>clearTimeout(p)}const b=setTimeout(()=>{c?o.length>0?l(o.slice(0,-1)):(h(!1),a(p=>(p+1)%s.length)):o.length<x.length?l(x.slice(0,o.length+1)):m(!0)},c?t:e);return()=>clearTimeout(b)},[o,r,c,d,s,e,t,n]),i.jsx("div",{className:"typewriter-container",children:i.jsxs("span",{className:"typewriter-text",children:[o,i.jsx(F.span,{className:"cursor",animate:{opacity:[1,0]},transition:{duration:.8,repeat:1/0,repeatType:"reverse"},children:"|"})]})})},uy=({children:s,className:e="",variant:t="primary",animate:n=!0,size:r="base"})=>{const a={primary:["#047857","#064E3B","#065F46"],secondary:["#10B981","#059669","#047857"],accent:["#3B82F6","#2563EB","#1D4ED8"],rainbow:["#047857","#10B981","#3B82F6","#EF4444","#F59E0B"],saytrix:["#14F195","#10B981","#059669"]},o={sm:"text-sm",base:"text-base",lg:"text-lg",xl:"text-xl","2xl":"text-2xl","3xl":"text-3xl"},c={background:`linear-gradient(135deg, ${(a[t]||a.primary).join(", ")})`,backgroundSize:n?"200% 200%":"100% 100%",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"};return n?i.jsx(F.span,{className:`gradient-text ${o[r]} ${e}`,style:c,animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:s}):i.jsx("span",{className:`gradient-text ${o[r]} ${e}`,style:c,children:s})},Ga=({title:s,subtitle:e,highlight:t,variant:n="primary",align:r="center",className:a="",animate:o=!0})=>{const l={left:"text-left",center:"text-center",right:"text-right"},c=()=>{if(t&&s.includes(t)){const h=s.split(t);return i.jsxs(i.Fragment,{children:[h[0],i.jsx(uy,{variant:n,animate:o,children:t}),h[1]]})}return s};return o?i.jsxs(F.div,{className:`section-header-modern ${l[r]} ${a}`,initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},transition:{duration:.6},viewport:{once:!0},children:[i.jsx(F.h2,{className:"section-title-modern",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.1},viewport:{once:!0},children:c()}),e&&i.jsx(F.p,{className:"section-subtitle-modern",initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.6,delay:.2},viewport:{once:!0},children:e})]}):i.jsxs("div",{className:`section-header-modern ${l[r]} ${a}`,children:[i.jsx("h2",{className:"section-title-modern",children:c()}),e&&i.jsx("p",{className:"section-subtitle-modern",children:e})]})},my=()=>{const s=Ve(),[e,t]=v.useState([]),[n,r]=v.useState(0),[a,o]=v.useState(!1),[l,c]=v.useState(""),h=[{type:"user",message:"Compare TCS and Infosys for me",timestamp:"2:34 PM"},{type:"ai",message:`Great question! Here's a detailed comparison:

TCS (Tata Consultancy Services)
• Current Price: ₹3,789.60 (+1.21%)
• Market Cap: ₹13.8L Cr
• P/E Ratio: 28.5
• Dividend Yield: 1.8%

Infosys
• Current Price: ₹1,456.75 (-0.57%)
• Market Cap: ₹6.2L Cr
• P/E Ratio: 24.2
• Dividend Yield: 2.1%

My Analysis: TCS has stronger fundamentals and market leadership, but Infosys offers better value at current levels. For long-term investment, I'd lean towards TCS.`,timestamp:"2:34 PM"},{type:"user",message:"What about the technical analysis?",timestamp:"2:35 PM"},{type:"ai",message:`📈 Technical Analysis:

TCS:
• RSI: 65 (Slightly overbought)
• Moving Average: Above 50-day MA
• Support: ₹3,650 | Resistance: ₹3,850
• Trend: Bullish momentum

Infosys:
• RSI: 45 (Neutral zone)
• Moving Average: Near 50-day MA
• Support: ₹1,400 | Resistance: ₹1,500
• Trend: Consolidation phase

Recommendation: TCS shows stronger momentum, while Infosys is in a good accumulation zone.`,timestamp:"2:35 PM"}],d=["Compare stocks","Market analysis","Portfolio review","Risk assessment"];v.useEffect(()=>{const b=setTimeout(()=>{n<h.length?h[n].type==="ai"?(o(!0),setTimeout(()=>{t(p=>[...p,h[n]]),o(!1),r(p=>p+1)},1500)):(t(p=>[...p,h[n]]),r(p=>p+1)):setTimeout(()=>{t([]),r(0)},5e3)},n===0?1e3:3e3);return()=>clearTimeout(b)},[n,h.length]);const m=b=>{c(b)},x=b=>b&&b.split(`
`).map((p,g)=>p.trim().endsWith(":")&&!p.trim().startsWith("•")?i.jsx("div",{className:"message-header",children:p.trim()},g):i.jsx("div",{className:"message-line",children:p},g));return i.jsx("section",{className:"saytrix-chat-preview",children:i.jsxs("div",{className:"container",children:[i.jsx(Ga,{title:"Meet Saytrix AI Assistant",subtitle:"Your personal trading mentor powered by advanced AI",highlight:"Saytrix",variant:"saytrix"}),i.jsxs("div",{className:"chat-demo-container",children:[i.jsxs(F.div,{className:"chat-window",initial:{opacity:0,scale:.95},whileInView:{opacity:1,scale:1},transition:{duration:.6,delay:.2},viewport:{once:!0},children:[i.jsxs("div",{className:"chat-header",children:[i.jsx("div",{className:"chat-avatar",children:i.jsx(ri,{size:20})}),i.jsxs("div",{className:"chat-info",children:[i.jsx("h3",{children:"Saytrix AI"}),i.jsx("span",{className:"status",children:"Online • Ready to help"})]}),i.jsx("div",{className:"voice-indicator",children:i.jsx(Us,{size:16})})]}),i.jsxs("div",{className:"chat-messages",children:[i.jsx(Se,{children:e.map((b,p)=>i.jsxs(F.div,{className:`message ${b.type}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[i.jsx("div",{className:"message-avatar",children:b.type==="user"?i.jsx(ht,{size:16}):i.jsx(ri,{size:16})}),i.jsxs("div",{className:"message-content",children:[i.jsx("div",{className:"message-text",children:b.type==="ai"?x(b.message):b.message}),i.jsx("span",{className:"message-time",children:b.timestamp})]})]},p))}),a&&i.jsxs(F.div,{className:"message ai typing",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[i.jsx("div",{className:"message-avatar",children:i.jsx(ri,{size:16})}),i.jsx("div",{className:"message-content",children:i.jsxs("div",{className:"typing-indicator",children:[i.jsx("span",{}),i.jsx("span",{}),i.jsx("span",{})]})})]})]}),i.jsxs("div",{className:"chat-input-container",children:[i.jsx("div",{className:"quick-actions",children:d.map((b,p)=>i.jsx(F.button,{className:"quick-action-btn",onClick:()=>m(b),whileHover:{scale:1.05},whileTap:{scale:.95},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:p*.1},children:b},b))}),i.jsxs("div",{className:"chat-input",children:[i.jsx("input",{type:"text",placeholder:"Ask Saytrix anything about stocks...",value:l,onChange:b=>c(b.target.value)}),i.jsx("button",{className:"send-btn",children:i.jsx(Fc,{size:16})})]})]})]}),i.jsxs(F.div,{className:"chat-features",initial:{opacity:0,x:50},whileInView:{opacity:1,x:0},transition:{duration:.6,delay:.4},viewport:{once:!0},children:[i.jsx("h3",{children:"What Saytrix Can Do:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"📊 Real-time stock analysis"}),i.jsx("li",{children:"📈 Technical chart interpretation"}),i.jsx("li",{children:"💰 Portfolio optimization tips"}),i.jsx("li",{children:"🎯 Risk assessment guidance"}),i.jsx("li",{children:"📰 Market news summaries"}),i.jsx("li",{children:"🗣️ Voice command support"})]}),i.jsxs(F.button,{className:"try-saytrix-btn",onClick:()=>s("/signup"),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Try Saytrix Now",i.jsx(lt,{size:16})]})]})]})]})})},fy=()=>{const[s,e]=v.useState(null),t=[{icon:Mc,title:"AI Assistant – Saytrix",description:"Ask anything, get instant insights. Your personal finance mentor available 24/7 with voice commands.",color:"#3B82F6",badge:"AI Powered",details:["Voice-activated commands","Real-time market analysis","Personalized recommendations","Smart portfolio insights"]},{icon:Ft,title:"Virtual Stock Trading",description:"Learn risk-free with ₹1L demo money. Practice with real Indian stock prices and market conditions.",color:"#10B981",badge:"Risk Free",details:["₹1,00,000 virtual money","Real NSE & BSE prices","Zero financial risk","Practice trading strategies"]},{icon:Pe,title:"Live Indian Stock Data",description:"Real-time NSE & BSE data powered by FMP API. 30-second refresh with professional-grade accuracy.",color:"#F59E0B",badge:"Real Time",details:["30-second data refresh","NSE & BSE coverage","Professional-grade accuracy","Live market indicators"]},{icon:Tc,title:"Portfolio Tracker",description:"Realistic P&L tracking, detailed charts, and comprehensive transaction history with analytics.",color:"#8B5CF6",badge:"Professional",details:["Real-time P&L tracking","Advanced analytics","Transaction history","Performance metrics"]},{icon:hs,title:"Secure Login",description:"Google OAuth integration plus email OTP support. Your data is protected with enterprise security.",color:"#EF4444",badge:"Secure",details:["Google OAuth integration","Email OTP verification","Enterprise-grade security","Data encryption"]},{icon:pi,title:"Dark & Light Mode",description:"Beautiful El-Classico theme with seamless dark/light mode switching for comfortable trading.",color:"#6366F1",badge:"Customizable",details:["El-Classico theme","Seamless mode switching","Eye-friendly design","Professional aesthetics"]}],n={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},r={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0,transition:{duration:.5,ease:"easeOut"}}};return i.jsx("section",{className:"animated-features-section",children:i.jsxs("div",{className:"container",children:[i.jsx(Ga,{title:"Complete Trading Ecosystem",subtitle:"From beginner-friendly tools to advanced analytics, TradeBro provides everything you need to succeed",highlight:"Everything You Need",variant:"secondary"}),i.jsx(F.div,{className:"animated-features-list",variants:n,initial:"hidden",whileInView:"visible",viewport:{once:!0,margin:"-100px"},children:t.map((a,o)=>{const l=a.icon,c=s===o;return i.jsxs(F.div,{className:"feature-list-item",variants:r,onMouseEnter:()=>e(o),onMouseLeave:()=>e(null),style:{"--feature-color":a.color},children:[i.jsxs("div",{className:"feature-item-content",children:[i.jsxs("div",{className:"feature-item-header",children:[i.jsx("div",{className:"feature-item-icon",style:{color:a.color},children:i.jsx(l,{size:24})}),i.jsxs("div",{className:"feature-item-info",children:[i.jsxs("div",{className:"feature-item-title-row",children:[i.jsx("h3",{className:"feature-item-title",children:a.title}),i.jsx("span",{className:"feature-item-badge",style:{backgroundColor:`${a.color}15`,color:a.color},children:a.badge})]}),i.jsx("p",{className:"feature-item-description",children:a.description})]}),i.jsx(F.div,{className:"feature-item-arrow",animate:{x:c?4:0},transition:{duration:.2},children:i.jsx(lt,{size:16})})]}),i.jsx(Se,{children:c&&i.jsx(F.div,{className:"feature-item-details",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3,ease:"easeInOut"},children:i.jsx("div",{className:"feature-details-grid",children:a.details.map((h,d)=>i.jsxs(F.div,{className:"feature-detail-item",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:d*.05},children:[i.jsx(Ot,{size:14,style:{color:a.color}}),i.jsx("span",{children:h})]},d))})})})]}),i.jsx(F.div,{className:"feature-item-glow",style:{background:`${a.color}10`},animate:{opacity:c?1:0},transition:{duration:.3}})]},o)})})]})})},py=()=>{const s=Ve(),[e,t]=v.useState(0),n=[{step:"01",title:"Create Your Account",description:"Sign up in under 2 minutes and get ₹10,000 virtual money to start trading risk-free",icon:Dc,details:["Quick email or Google signup","₹10,000 virtual trading money","Instant account activation","No documents required"],color:"#3B82F6"},{step:"02",title:"Learn with Saytrix AI",description:"Get personalized market insights, stock analysis, and trading recommendations from our AI assistant",icon:Tc,details:["Voice-activated AI assistant","Real-time market analysis","Personalized recommendations","Interactive learning modules"],color:"#10B981"},{step:"03",title:"Trade & Grow",description:"Execute trades, track your portfolio performance, and build wealth with professional-grade tools",icon:Pe,details:["Real NSE & BSE stock prices","Professional trading charts","Portfolio performance tracking","Risk-free practice environment"],color:"#F59E0B"},{step:"04",title:"Master the Markets",description:"Compete on leaderboards, earn rewards, and become a confident trader with our gamified learning system",icon:ha,details:["Global leaderboards","Achievement system","Daily trading challenges","Community competitions"],color:"#8B5CF6"}],r=a=>{t(a)};return i.jsx("section",{className:"tradebro-stepper-section",children:i.jsxs("div",{className:"container",children:[i.jsx(Ga,{title:"How TradeBro Works",subtitle:"Master trading with our step-by-step approach",highlight:"TradeBro",variant:"primary"}),i.jsxs("div",{className:"stepper-container",children:[i.jsx("div",{className:"stepper-navigation",children:n.map((a,o)=>{const l=a.icon,c=o===e,h=o<e;return i.jsxs(F.div,{className:`step-item ${c?"active":""} ${h?"completed":""}`,onClick:()=>r(o),whileHover:{scale:1.02},whileTap:{scale:.98},style:{"--step-color":a.color},children:[i.jsxs("div",{className:"step-indicator",children:[i.jsx("div",{className:"step-number",children:h?i.jsx(Ot,{size:16}):i.jsx("span",{children:a.step})}),i.jsx("div",{className:"step-icon",style:{color:a.color},children:i.jsx(l,{size:20})})]}),i.jsxs("div",{className:"step-content",children:[i.jsx("h3",{className:"step-title",children:a.title}),i.jsx("p",{className:"step-description",children:a.description})]})]},o)})}),i.jsx(Se,{mode:"wait",children:i.jsxs(F.div,{className:"step-details",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:[i.jsxs("div",{className:"step-details-header",children:[i.jsx("div",{className:"step-details-icon",style:{color:n[e].color},children:Ce.createElement(n[e].icon,{size:32})}),i.jsxs("div",{children:[i.jsx("h3",{className:"step-details-title",children:n[e].title}),i.jsx("p",{className:"step-details-description",children:n[e].description})]})]}),i.jsx("div",{className:"step-details-list",children:n[e].details.map((a,o)=>i.jsxs(F.div,{className:"detail-item",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:o*.1},children:[i.jsx(Ot,{size:16,style:{color:n[e].color}}),i.jsx("span",{children:a})]},o))}),i.jsx(F.div,{className:"step-actions",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:e<n.length-1?i.jsxs("button",{className:"next-step-btn",onClick:()=>t(e+1),style:{backgroundColor:n[e].color},children:["Next Step",i.jsx(lt,{size:16})]}):i.jsxs("button",{className:"get-started-btn",onClick:()=>s("/signup"),style:{backgroundColor:n[e].color},children:["Get Started Now",i.jsx(lt,{size:16})]})})]},e)})]})]})})},gy=({theme:s="light",onToggleTheme:e=()=>{}})=>{const t=Ve(),n=()=>{t("/login")},r=()=>{t("/signup")};return i.jsxs("div",{className:"landing-page",children:[i.jsx(oy,{isAuthenticated:!1,theme:s,onToggleTheme:e,onLogin:n,onSignup:r}),i.jsxs("section",{className:"hero-section",children:[i.jsxs("div",{className:"hero-background",children:[i.jsx(cy,{gridSize:40,lineColor:"rgba(59, 130, 246, 0.1)",speed:20}),i.jsx(ly,{orbCount:3,colors:["#3B82F6","#10B981","#8B5CF6"],size:"large"})]}),i.jsxs("div",{className:"hero-container-grid",children:[i.jsxs(F.div,{className:"hero-content",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.8},children:[i.jsxs(F.h1,{className:"hero-title",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},children:["Master the Markets with",i.jsx("br",{}),i.jsx(dy,{})]}),i.jsx(F.p,{className:"hero-subtitle",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.4},children:"Experience the future of stock trading with Saytrix AI assistant, real-time market data, professional-grade charts, and risk-free virtual trading. Join 75,000+ traders building wealth intelligently."}),i.jsx(F.div,{className:"hero-actions",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.6},children:i.jsx(F.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:i.jsxs(be,{to:"/signup",className:"btn-premium btn-primary btn-large",children:[i.jsx(hs,{}),"Start Trading Free",i.jsx(lt,{})]})})})]}),i.jsx(F.div,{className:"hero-visual",initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.8,delay:.2},children:i.jsxs("div",{className:"interactive-dashboard",children:[i.jsxs("div",{className:"dashboard-header",children:[i.jsxs("div",{className:"header-dots",children:[i.jsx(F.span,{initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.3}}),i.jsx(F.span,{initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.3}}),i.jsx(F.span,{initial:{scale:0},animate:{scale:1},transition:{delay:1,duration:.3}})]}),i.jsx(F.span,{className:"dashboard-title",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.1,duration:.5},children:"TradeBro Dashboard"})]}),i.jsx("div",{className:"dashboard-content",children:i.jsx(hy,{})})]})})]})]}),i.jsx("section",{id:"features",children:i.jsx(fy,{})}),i.jsx("section",{id:"ai-demo",children:i.jsx(my,{})}),i.jsx("section",{id:"how-it-works",children:i.jsx(py,{})})]})},Ph=({onSuccess:s,onError:e})=>{const t=v.useRef(null);v.useEffect(()=>{const r=()=>{var l;if((l=window.google)!=null&&l.accounts){a();return}const o=document.createElement("script");o.src="https://accounts.google.com/gsi/client",o.async=!0,o.defer=!0,o.onload=a,o.onerror=()=>console.error("Failed to load Google Sign-In"),document.head.appendChild(o)},a=()=>{var l;const o="858430300178-f76rk8do7lqcnggimqp60793naq1la9t.apps.googleusercontent.com";if(!((l=window.google)!=null&&l.accounts)){console.error("Google Sign-In not available");return}window.google.accounts.id.initialize({client_id:o,callback:n,auto_select:!1}),window.google.accounts.id.renderButton(t.current,{theme:"outline",size:"large",text:"continue_with",shape:"rectangular"})};r()},[s,e]);const n=async r=>{try{const o=await(await fetch("http://localhost:5001/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:r.credential})})).json();if(o.success)localStorage.setItem("token",o.token),localStorage.setItem("user",JSON.stringify(o.user)),s(o.user,o.token),K.success(`Welcome ${o.user.fullName}!`);else throw new Error(o.message)}catch(a){console.error("Google auth error:",a),K.error("Google Sign-In failed"),e==null||e(a.message)}};return i.jsx("div",{ref:t})},yy=({onLogin:s})=>{var C,N;const e=Ve(),t=$t(),[n,r]=v.useState({email:"",password:""}),[a,o]=v.useState(!1),[l,c]=v.useState(!1),[h,d]=v.useState({}),[m,x]=v.useState(!1),b=((N=(C=t.state)==null?void 0:C.from)==null?void 0:N.pathname)||"/dashboard",p=localStorage.getItem("redirectAfterLogin")||b;v.useEffect(()=>{var T;(T=t.state)!=null&&T.from&&K.info("Please log in to access that page",{position:"top-right",autoClose:3e3})},[t.state]);const g=T=>{const{name:I,value:P}=T.target;r(L=>({...L,[I]:P})),h[I]&&d(L=>({...L,[I]:""}))},f=()=>{const T={};return n.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||(T.email="Please enter a valid email address"):T.email="Email is required",n.password?n.password.length<6&&(T.password="Password must be at least 6 characters"):T.password="Password is required",d(T),Object.keys(T).length===0},y=async T=>{if(T.preventDefault(),!!f()){c(!0),d({});try{const I=await fetch("http://localhost:5001/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.email,password:n.password})}),P=await I.json();I.ok&&P.success?(s(P.user,P.token),K.success("Welcome back! Login successful",{position:"top-right",autoClose:2e3}),setTimeout(()=>{e(p,{replace:!0}),localStorage.removeItem("redirectAfterLogin")},1e3)):(d({general:P.message||"Login failed. Please try again."}),K.error(P.message||"Invalid credentials. Please try again.",{position:"top-right",autoClose:3e3}))}catch(I){console.error("Login error:",I),d({general:"Network error. Please try again."}),K.error("Network error. Please check your connection.",{position:"top-right",autoClose:3e3})}finally{c(!1)}}},S=(T,I)=>{s(T,I),setTimeout(()=>{e(p,{replace:!0}),localStorage.removeItem("redirectAfterLogin")},1e3)},k=T=>{d({general:T||"Google login failed. Please try again."}),K.error("Google login failed. Please try again.",{position:"top-right",autoClose:3e3})};return i.jsx("div",{className:"auth-page",children:i.jsxs(F.div,{className:"auth-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[i.jsxs("div",{className:"auth-header",children:[i.jsxs("div",{className:"auth-logo",children:[i.jsx("div",{className:"auth-logo-icon",children:"📈"}),i.jsx("h1",{className:"auth-logo-text",children:"TradeBro"})]}),i.jsxs("div",{children:[i.jsx("h2",{className:"auth-title",children:"Welcome Back"}),i.jsx("p",{className:"auth-subtitle",children:"Sign in to your account to continue trading"})]})]}),i.jsxs("form",{onSubmit:y,className:"auth-form",children:[h.general&&i.jsxs("div",{className:"error-message",children:[i.jsx(et,{size:16}),i.jsx("span",{children:h.general})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{className:"form-label",children:[i.jsx(Ln,{size:16}),"Email Address"]}),i.jsx("input",{type:"email",name:"email",value:n.email,onChange:g,className:`form-input ${h.email?"form-input-error":""}`,placeholder:"Enter your email",disabled:l,autoComplete:"email",required:!0}),h.email&&i.jsxs("div",{className:"form-error",children:[i.jsx(et,{size:14}),i.jsx("span",{children:h.email})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{className:"form-label",children:[i.jsx(mi,{size:16}),"Password"]}),i.jsxs("div",{className:"password-input",children:[i.jsx("input",{type:a?"text":"password",name:"password",value:n.password,onChange:g,className:`form-input ${h.password?"form-input-error":""}`,placeholder:"Enter your password",disabled:l,autoComplete:"current-password",required:!0}),i.jsx("button",{type:"button",className:"password-toggle",onClick:()=>o(!a),disabled:l,"aria-label":a?"Hide password":"Show password",children:a?i.jsx(da,{size:16}):i.jsx(fs,{size:16})})]}),h.password&&i.jsxs("div",{className:"form-error",children:[i.jsx(et,{size:14}),i.jsx("span",{children:h.password})]})]}),i.jsxs("div",{className:"form-options",children:[i.jsxs("label",{className:"checkbox-label",children:[i.jsx("input",{type:"checkbox",checked:m,onChange:T=>{console.log("Checkbox clicked:",T.target.checked),x(T.target.checked)},disabled:l,id:"remember-me"}),i.jsx("span",{children:"Remember me"})]}),i.jsx(be,{to:"/forgot-password",className:"forgot-link",children:"Forgot password?"})]}),i.jsx("button",{type:"submit",className:"auth-submit",disabled:l,children:l?i.jsx("div",{className:"loading-spinner"}):i.jsxs(i.Fragment,{children:["Sign In",i.jsx(lt,{size:16})]})})]}),i.jsx("div",{className:"auth-divider",children:i.jsx("span",{children:"or continue with"})}),i.jsx(Ph,{onSuccess:S,onError:k,buttonText:"Sign in with Google",disabled:l,className:"google-button"}),i.jsx("div",{className:"auth-footer",children:i.jsxs("p",{children:["Don't have an account?"," ",i.jsx(be,{to:"/signup",children:"Sign up for free"})]})})]})})},vy=({onSignup:s})=>{const e=Ve(),[t,n]=v.useState({name:"",email:"",password:"",confirmPassword:""}),[r,a]=v.useState(!1),[o,l]=v.useState(!1),[c,h]=v.useState(!1),[d,m]=v.useState({}),[x,b]=v.useState(!1),[p,g]=v.useState({length:!1,uppercase:!1,lowercase:!1,number:!1,special:!1}),f=localStorage.getItem("redirectAfterLogin")||"/dashboard",y=M=>{const O={length:M.length>=8,uppercase:/[A-Z]/.test(M),lowercase:/[a-z]/.test(M),number:/\d/.test(M),special:/[!@#$%^&*(),.?":{}|<>]/.test(M)};return g(O),O},S=M=>{const{name:O,value:B}=M.target;n(R=>({...R,[O]:B})),O==="password"&&y(B),d[O]&&m(R=>({...R,[O]:""}))},k=()=>{const M={};return t.name.trim()?t.name.trim().length<2&&(M.name="Name must be at least 2 characters"):M.name="Full name is required",t.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)||(M.email="Please enter a valid email address"):M.email="Email is required",t.password?t.password.length<8&&(M.password="Password must be at least 8 characters"):M.password="Password is required",t.confirmPassword?t.password!==t.confirmPassword&&(M.confirmPassword="Passwords do not match"):M.confirmPassword="Please confirm your password",x||(M.terms="You must accept the Terms of Service and Privacy Policy"),m(M),Object.keys(M).length===0},C=async M=>{if(M.preventDefault(),!!k()){h(!0),m({});try{const O=t.email.split("@")[0].replace(/[^a-zA-Z0-9]/g,""),B=Date.now().toString().slice(-4),R=O+B;console.log("📤 Sending signup data:",{username:R,email:t.email,fullName:t.name,passwordLength:t.password.length});const A=await fetch("http://localhost:5001/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:R,email:t.email,password:t.password,fullName:t.name})}),V=await A.json();if(A.ok&&V.success)s(V.user,V.token),K.success("Welcome to TradeBro! Account created successfully",{position:"top-right",autoClose:2e3}),setTimeout(()=>{e(f,{replace:!0}),localStorage.removeItem("redirectAfterLogin")},1e3);else if(console.log("❌ Signup failed:",V),V.errors&&typeof V.errors=="object"){m(V.errors);const z=Object.values(V.errors)[0];K.error(z||"Please fix the validation errors.",{position:"top-right",autoClose:4e3})}else m({general:V.message||"Signup failed. Please try again."}),K.error(V.message||"Signup failed. Please try again.",{position:"top-right",autoClose:3e3})}catch(O){console.error("Signup error:",O),m({general:"Network error. Please try again."}),K.error("Network error. Please check your connection.",{position:"top-right",autoClose:3e3})}finally{h(!1)}}},N=(M,O)=>{s(M,O),setTimeout(()=>{e(f,{replace:!0}),localStorage.removeItem("redirectAfterLogin")},1e3)},T=M=>{m({general:M||"Google signup failed. Please try again."}),K.error("Google signup failed. Please try again.",{position:"top-right",autoClose:3e3})},I=()=>Object.values(p).filter(Boolean).length,P=()=>{const M=I();return M<2?"Weak":M<4?"Medium":"Strong"},L=()=>{const M=I();return M<2?"#ef4444":M<4?"#f59e0b":"#10b981"};return i.jsx("div",{className:"auth-page",children:i.jsxs(F.div,{className:"auth-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[i.jsxs("div",{className:"auth-header",children:[i.jsxs("div",{className:"auth-logo",children:[i.jsx("div",{className:"auth-logo-icon",children:"📈"}),i.jsx("h1",{className:"auth-logo-text",children:"TradeBro"})]}),i.jsxs("div",{children:[i.jsx("h2",{className:"auth-title",children:"Create Account"}),i.jsx("p",{className:"auth-subtitle",children:"Join TradeBro and start your trading journey today"})]})]}),i.jsxs("form",{onSubmit:C,className:"auth-form",children:[d.general&&i.jsxs("div",{className:"error-message",children:[i.jsx(et,{size:16}),i.jsx("span",{children:d.general})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{className:"form-label",children:[i.jsx(ht,{size:16}),"Full Name"]}),i.jsx("input",{type:"text",name:"name",value:t.name,onChange:S,className:`form-input ${d.name?"form-input-error":""}`,placeholder:"Enter your full name",disabled:c,autoComplete:"name",required:!0}),d.name&&i.jsxs("div",{className:"form-error",children:[i.jsx(et,{size:14}),i.jsx("span",{children:d.name})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{className:"form-label",children:[i.jsx(Ln,{size:16}),"Email Address"]}),i.jsx("input",{type:"email",name:"email",value:t.email,onChange:S,className:`form-input ${d.email?"form-input-error":""}`,placeholder:"Enter your email",disabled:c,autoComplete:"email",required:!0}),d.email&&i.jsxs("div",{className:"form-error",children:[i.jsx(et,{size:14}),i.jsx("span",{children:d.email})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{className:"form-label",children:[i.jsx(mi,{size:16}),"Password"]}),i.jsxs("div",{className:"password-input",children:[i.jsx("input",{type:r?"text":"password",name:"password",value:t.password,onChange:S,className:`form-input ${d.password?"form-input-error":""}`,placeholder:"Create a password",disabled:c,autoComplete:"new-password",required:!0}),i.jsx("button",{type:"button",className:"password-toggle",onClick:()=>a(!r),disabled:c,"aria-label":r?"Hide password":"Show password",children:r?i.jsx(da,{size:16}):i.jsx(fs,{size:16})})]}),d.password&&i.jsxs("div",{className:"form-error",children:[i.jsx(et,{size:14}),i.jsx("span",{children:d.password})]}),t.password&&i.jsxs("div",{className:"password-strength",children:[i.jsx("div",{className:"password-strength-bar",children:i.jsx("div",{className:"password-strength-fill",style:{width:`${I()/5*100}%`,backgroundColor:L()}})}),i.jsx("span",{className:"password-strength-text",style:{color:L()},children:P()})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{className:"form-label",children:[i.jsx(mi,{size:16}),"Confirm Password"]}),i.jsxs("div",{className:"password-input",children:[i.jsx("input",{type:o?"text":"password",name:"confirmPassword",value:t.confirmPassword,onChange:S,className:`form-input ${d.confirmPassword?"form-input-error":""}`,placeholder:"Confirm your password",disabled:c,autoComplete:"new-password",required:!0}),i.jsx("button",{type:"button",className:"password-toggle",onClick:()=>l(!o),disabled:c,"aria-label":o?"Hide password":"Show password",children:o?i.jsx(da,{size:16}):i.jsx(fs,{size:16})})]}),d.confirmPassword&&i.jsxs("div",{className:"form-error",children:[i.jsx(et,{size:14}),i.jsx("span",{children:d.confirmPassword})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{className:"checkbox-label",children:[i.jsx("input",{type:"checkbox",checked:x,onChange:M=>b(M.target.checked),disabled:c}),i.jsxs("span",{children:["I agree to the"," ",i.jsx(be,{to:"/terms",children:"Terms of Service"})," ","and"," ",i.jsx(be,{to:"/privacy",children:"Privacy Policy"})]})]}),d.terms&&i.jsxs("div",{className:"form-error",children:[i.jsx(et,{size:14}),i.jsx("span",{children:d.terms})]})]}),i.jsx("button",{type:"submit",className:"auth-submit",disabled:c,children:c?i.jsx("div",{className:"loading-spinner"}):i.jsxs(i.Fragment,{children:["Create Account",i.jsx(lt,{size:16})]})})]}),i.jsx("div",{className:"auth-divider",children:i.jsx("span",{children:"or continue with"})}),i.jsx(Ph,{onSuccess:N,onError:T,buttonText:"Sign up with Google",disabled:c,className:"google-button"}),i.jsx("div",{className:"auth-footer",children:i.jsxs("p",{children:["Already have an account?"," ",i.jsx(be,{to:"/login",children:"Sign in"})]})})]})})};var Qa={},va={exports:{}};(function(s,e){(function(t,n){n(e)})(bm,function(t){var n=function(){return n=Object.assign||function(a){for(var o,l=1,c=arguments.length;l<c;l++)for(var h in o=arguments[l])Object.prototype.hasOwnProperty.call(o,h)&&(a[h]=o[h]);return a},n.apply(this,arguments)},r=function(){function a(o,l,c){var h=this;this.endVal=l,this.options=c,this.version="2.9.0",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,useIndianSeparators:!1,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:"",enableScrollSpy:!1,scrollSpyDelay:200,scrollSpyOnce:!1},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.once=!1,this.count=function(d){h.startTime||(h.startTime=d);var m=d-h.startTime;h.remaining=h.duration-m,h.useEasing?h.countDown?h.frameVal=h.startVal-h.easingFn(m,0,h.startVal-h.endVal,h.duration):h.frameVal=h.easingFn(m,h.startVal,h.endVal-h.startVal,h.duration):h.frameVal=h.startVal+(h.endVal-h.startVal)*(m/h.duration);var x=h.countDown?h.frameVal<h.endVal:h.frameVal>h.endVal;h.frameVal=x?h.endVal:h.frameVal,h.frameVal=Number(h.frameVal.toFixed(h.options.decimalPlaces)),h.printValue(h.frameVal),m<h.duration?h.rAF=requestAnimationFrame(h.count):h.finalEndVal!==null?h.update(h.finalEndVal):h.options.onCompleteCallback&&h.options.onCompleteCallback()},this.formatNumber=function(d){var m,x,b,p,g=d<0?"-":"";m=Math.abs(d).toFixed(h.options.decimalPlaces);var f=(m+="").split(".");if(x=f[0],b=f.length>1?h.options.decimal+f[1]:"",h.options.useGrouping){p="";for(var y=3,S=0,k=0,C=x.length;k<C;++k)h.options.useIndianSeparators&&k===4&&(y=2,S=1),k!==0&&S%y==0&&(p=h.options.separator+p),S++,p=x[C-k-1]+p;x=p}return h.options.numerals&&h.options.numerals.length&&(x=x.replace(/[0-9]/g,function(N){return h.options.numerals[+N]}),b=b.replace(/[0-9]/g,function(N){return h.options.numerals[+N]})),g+h.options.prefix+x+b+h.options.suffix},this.easeOutExpo=function(d,m,x,b){return x*(1-Math.pow(2,-10*d/b))*1024/1023+m},this.options=n(n({},this.defaults),c),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.el=typeof o=="string"?document.getElementById(o):o,l=l??this.parse(this.el.innerHTML),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(l),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,this.options.separator===""&&(this.options.useGrouping=!1),this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined",typeof window<"u"&&this.options.enableScrollSpy&&(this.error?console.error(this.error,o):(window.onScrollFns=window.onScrollFns||[],window.onScrollFns.push(function(){return h.handleScroll(h)}),window.onscroll=function(){window.onScrollFns.forEach(function(d){return d()})},this.handleScroll(this)))}return a.prototype.handleScroll=function(o){if(o&&window&&!o.once){var l=window.innerHeight+window.scrollY,c=o.el.getBoundingClientRect(),h=c.top+window.pageYOffset,d=c.top+c.height+window.pageYOffset;d<l&&d>window.scrollY&&o.paused?(o.paused=!1,setTimeout(function(){return o.start()},o.options.scrollSpyDelay),o.options.scrollSpyOnce&&(o.once=!0)):(window.scrollY>d||h>l)&&!o.paused&&o.reset()}},a.prototype.determineDirectionAndSmartEasing=function(){var o=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>o;var l=o-this.startVal;if(Math.abs(l)>this.options.smartEasingThreshold&&this.options.useEasing){this.finalEndVal=o;var c=this.countDown?1:-1;this.endVal=o+c*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=o,this.finalEndVal=null;this.finalEndVal!==null?this.useEasing=!1:this.useEasing=this.options.useEasing},a.prototype.start=function(o){this.error||(this.options.onStartCallback&&this.options.onStartCallback(),o&&(this.options.onCompleteCallback=o),this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},a.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},a.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},a.prototype.update=function(o){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(o),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal==null&&this.resetDuration(),this.finalEndVal=null,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},a.prototype.printValue=function(o){var l;if(this.el){var c=this.formattingFn(o);!((l=this.options.plugin)===null||l===void 0)&&l.render?this.options.plugin.render(this.el,c):this.el.tagName==="INPUT"?this.el.value=c:this.el.tagName==="text"||this.el.tagName==="tspan"?this.el.textContent=c:this.el.innerHTML=c}},a.prototype.ensureNumber=function(o){return typeof o=="number"&&!isNaN(o)},a.prototype.validateValue=function(o){var l=Number(o);return this.ensureNumber(l)?l:(this.error="[CountUp] invalid start or end value: ".concat(o),null)},a.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},a.prototype.parse=function(o){var l=function(m){return m.replace(/([.,'  ])/g,"\\$1")},c=l(this.options.separator),h=l(this.options.decimal),d=o.replace(new RegExp(c,"g"),"").replace(new RegExp(h,"g"),".");return parseFloat(d)},a}();t.CountUp=r})})(va,va.exports);var xy=va.exports;Object.defineProperty(Qa,"__esModule",{value:!0});var ze=v,by=xy;function wy(s,e){var t=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(t!=null){var n,r,a,o,l=[],c=!0,h=!1;try{if(a=(t=t.call(s)).next,e!==0)for(;!(c=(n=a.call(t)).done)&&(l.push(n.value),l.length!==e);c=!0);}catch(d){h=!0,r=d}finally{try{if(!c&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(h)throw r}}return l}}function il(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,n)}return t}function pn(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?il(Object(t),!0).forEach(function(n){Ny(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):il(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function jy(s,e){if(typeof s!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function Sy(s){var e=jy(s,"string");return typeof e=="symbol"?e:String(e)}function Ny(s,e,t){return e=Sy(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function xa(){return xa=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},xa.apply(this,arguments)}function ky(s,e){if(s==null)return{};var t={},n=Object.keys(s),r,a;for(a=0;a<n.length;a++)r=n[a],!(e.indexOf(r)>=0)&&(t[r]=s[r]);return t}function Th(s,e){if(s==null)return{};var t=ky(s,e),n,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);for(r=0;r<a.length;r++)n=a[r],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(t[n]=s[n])}return t}function Cy(s,e){return Py(s)||wy(s,e)||Ty(s,e)||Ey()}function Py(s){if(Array.isArray(s))return s}function Ty(s,e){if(s){if(typeof s=="string")return nl(s,e);var t=Object.prototype.toString.call(s).slice(8,-1);if(t==="Object"&&s.constructor&&(t=s.constructor.name),t==="Map"||t==="Set")return Array.from(s);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return nl(s,e)}}function nl(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=s[t];return n}function Ey(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Iy=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?ze.useLayoutEffect:ze.useEffect;function jt(s){var e=ze.useRef(s);return Iy(function(){e.current=s}),ze.useCallback(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.current.apply(void 0,n)},[])}var _y=function(e,t){var n=t.decimal,r=t.decimals,a=t.duration,o=t.easingFn,l=t.end,c=t.formattingFn,h=t.numerals,d=t.prefix,m=t.separator,x=t.start,b=t.suffix,p=t.useEasing,g=t.useGrouping,f=t.useIndianSeparators,y=t.enableScrollSpy,S=t.scrollSpyDelay,k=t.scrollSpyOnce,C=t.plugin;return new by.CountUp(e,l,{startVal:x,duration:a,decimal:n,decimalPlaces:r,easingFn:o,formattingFn:c,numerals:h,separator:m,prefix:d,suffix:b,plugin:C,useEasing:p,useIndianSeparators:f,useGrouping:g,enableScrollSpy:y,scrollSpyDelay:S,scrollSpyOnce:k})},Ly=["ref","startOnMount","enableReinitialize","delay","onEnd","onStart","onPauseResume","onReset","onUpdate"],My={decimal:".",separator:",",delay:null,prefix:"",suffix:"",duration:2,start:0,decimals:0,startOnMount:!0,enableReinitialize:!0,useEasing:!0,useGrouping:!0,useIndianSeparators:!1},Eh=function(e){var t=Object.fromEntries(Object.entries(e).filter(function(L){var M=Cy(L,2),O=M[1];return O!==void 0})),n=ze.useMemo(function(){return pn(pn({},My),t)},[e]),r=n.ref,a=n.startOnMount,o=n.enableReinitialize,l=n.delay,c=n.onEnd,h=n.onStart,d=n.onPauseResume,m=n.onReset,x=n.onUpdate,b=Th(n,Ly),p=ze.useRef(),g=ze.useRef(),f=ze.useRef(!1),y=jt(function(){return _y(typeof r=="string"?r:r.current,b)}),S=jt(function(L){var M=p.current;if(M&&!L)return M;var O=y();return p.current=O,O}),k=jt(function(){var L=function(){return S(!0).start(function(){c==null||c({pauseResume:C,reset:N,start:I,update:T})})};l&&l>0?g.current=setTimeout(L,l*1e3):L(),h==null||h({pauseResume:C,reset:N,update:T})}),C=jt(function(){S().pauseResume(),d==null||d({reset:N,start:I,update:T})}),N=jt(function(){S().el&&(g.current&&clearTimeout(g.current),S().reset(),m==null||m({pauseResume:C,start:I,update:T}))}),T=jt(function(L){S().update(L),x==null||x({pauseResume:C,reset:N,start:I})}),I=jt(function(){N(),k()}),P=jt(function(L){a&&(L&&N(),k())});return ze.useEffect(function(){f.current?o&&P(!0):(f.current=!0,P())},[o,f,P,l,e.start,e.suffix,e.prefix,e.duration,e.separator,e.decimals,e.decimal,e.formattingFn]),ze.useEffect(function(){return function(){N()}},[N]),{start:I,pauseResume:C,reset:N,update:T,getCountUp:S}},Ry=["className","redraw","containerProps","children","style"],Ay=function(e){var t=e.className,n=e.redraw,r=e.containerProps,a=e.children,o=e.style,l=Th(e,Ry),c=ze.useRef(null),h=ze.useRef(!1),d=Eh(pn(pn({},l),{},{ref:c,startOnMount:typeof a!="function"||e.delay===0,enableReinitialize:!1})),m=d.start,x=d.reset,b=d.update,p=d.pauseResume,g=d.getCountUp,f=jt(function(){m()}),y=jt(function(C){e.preserveValue||x(),b(C)}),S=jt(function(){if(typeof e.children=="function"&&!(c.current instanceof Element)){console.error(`Couldn't find attached element to hook the CountUp instance into! Try to attach "containerRef" from the render prop to a an Element, eg. <span ref={containerRef} />.`);return}g()});ze.useEffect(function(){S()},[S]),ze.useEffect(function(){h.current&&y(e.end)},[e.end,y]);var k=n&&e;return ze.useEffect(function(){n&&h.current&&f()},[f,n,k]),ze.useEffect(function(){!n&&h.current&&f()},[f,n,e.start,e.suffix,e.prefix,e.duration,e.separator,e.decimals,e.decimal,e.className,e.formattingFn]),ze.useEffect(function(){h.current=!0},[]),typeof a=="function"?a({countUpRef:c,start:m,reset:x,update:b,pauseResume:p,getCountUp:g}):ze.createElement("span",xa({className:t,ref:c,style:o},r),typeof e.start<"u"?g().formattingFn(e.start):"")},gn=Qa.default=Ay;Qa.useCountUp=Eh;const Oy=()=>{const[s,e]=v.useState(!1),[t,n]=v.useState(null),[r,a]=v.useState(null),{refreshPortfolio:o}=ft(),l=v.useRef(!1);v.useEffect(()=>{if(l.current)return;(()=>{const m=je.checkDailyLogin(),x=je.getDailyRewardsInfo();a(x),m.awarded&&(n(m),e(!0),setTimeout(()=>{je.syncPortfolioData(),o()},500)),l.current=!0})()},[]);const c=()=>{e(!1),je.syncPortfolioData(),o()},h=d=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(d);return i.jsxs(i.Fragment,{children:[i.jsx(Se,{children:s&&t&&i.jsx(F.div,{className:"daily-reward-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:c,children:i.jsxs(F.div,{className:"daily-reward-modal",initial:{scale:.8,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},exit:{scale:.8,opacity:0,y:50},onClick:d=>d.stopPropagation(),children:[i.jsx("button",{className:"close-btn",onClick:c,children:i.jsx(We,{})}),i.jsxs("div",{className:"reward-content",children:[i.jsx(F.div,{className:"reward-icon",animate:{rotate:[0,-10,10,-10,0],scale:[1,1.1,1]},transition:{duration:.6,repeat:1/0,repeatDelay:2},children:i.jsx(Bo,{})}),i.jsx("h2",{children:"Daily Login Bonus!"}),i.jsx("div",{className:"reward-amount",children:h(t.amount)}),i.jsxs("div",{className:"reward-details",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx(Ec,{}),i.jsxs("span",{children:["Login Streak: ",t.streak," days"]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx(Pe,{}),i.jsxs("span",{children:["Total Rewards: ",h(t.totalRewards)]})]})]}),i.jsxs("div",{className:"reward-message",children:[i.jsx("p",{children:"Keep logging in daily to maintain your streak!"}),t.streak>=7&&i.jsxs("div",{className:"streak-bonus",children:[i.jsx(Fs,{}),i.jsx("span",{children:"Amazing! 7+ day streak!"})]})]}),i.jsx("button",{className:"claim-btn",onClick:c,children:"Awesome! 🎉"})]})]})})}),r&&i.jsxs("div",{className:"daily-rewards-widget",children:[i.jsxs("div",{className:"widget-header",children:[i.jsx(Bo,{}),i.jsx("span",{children:"Daily Rewards"})]}),i.jsxs("div",{className:"widget-content",children:[i.jsxs("div",{className:"streak-info",children:[i.jsx("span",{className:"streak-number",children:r.loginStreak}),i.jsx("span",{className:"streak-label",children:"Day Streak"})]}),i.jsxs("div",{className:"total-rewards",children:[i.jsx("span",{className:"total-label",children:"Total Earned"}),i.jsx("span",{className:"total-amount",children:h(r.totalRewards)})]}),r.nextRewardAvailable&&i.jsx("div",{className:"next-reward",children:i.jsx("span",{children:"Next reward available tomorrow!"})})]})]})]})},Ih=({notification:s,onClick:e,onDelete:t,onMarkAsRead:n,compact:r=!1,showActions:a=!0})=>{const[o,l]=v.useState(!1),c=b=>{const p={size:r?16:20};switch(b){case"success":return i.jsx(kt,{...p,className:"icon-success"});case"error":return i.jsx(ps,{...p,className:"icon-error"});case"warning":return i.jsx(qt,{...p,className:"icon-warning"});case"alert":return i.jsx(et,{...p,className:"icon-alert"});case"info":default:return i.jsx(Oa,{...p,className:"icon-info"})}},h=b=>{const p=new Date(b),f=Math.floor((new Date-p)/(1e3*60));return f<1?"Just now":f<60?`${f}m ago`:f<1440?`${Math.floor(f/60)}h ago`:`${Math.floor(f/1440)}d ago`},d=()=>{e&&e(s)},m=b=>{b.stopPropagation(),t&&t(b)},x=b=>{b.stopPropagation(),n&&n(s.id)};return i.jsxs(F.div,{className:`notification-item ${r?"compact":""} ${s.read?"read":"unread"} ${s.type}`,onClick:d,onHoverStart:()=>l(!0),onHoverEnd:()=>l(!1),whileHover:{backgroundColor:"var(--notification-hover-bg)"},layout:!0,children:[!s.read&&i.jsx("div",{className:"unread-indicator"}),i.jsxs("div",{className:"notification-content",children:[i.jsx("div",{className:"notification-icon",children:c(s.type)}),i.jsxs("div",{className:"notification-text",children:[i.jsx("div",{className:"notification-title",children:s.title}),s.message&&i.jsx("div",{className:"notification-message",children:s.message}),i.jsxs("div",{className:"notification-meta",children:[i.jsxs("span",{className:"notification-time",children:[i.jsx(st,{size:12}),h(s.createdAt)]}),s.link&&i.jsxs("span",{className:"notification-link",children:[i.jsx(In,{size:12}),"View details"]})]})]}),a&&i.jsxs("div",{className:`notification-actions ${o?"visible":""}`,children:[!s.read&&n&&i.jsx(F.button,{className:"action-btn mark-read",onClick:x,whileHover:{scale:1.1},whileTap:{scale:.9},title:"Mark as read",children:i.jsx(kt,{size:14})}),t&&i.jsx(F.button,{className:"action-btn delete",onClick:m,whileHover:{scale:1.1},whileTap:{scale:.9},title:"Delete notification",children:i.jsx(We,{size:14})})]})]})]})},Fy=({notifications:s=[],unreadCount:e=0,loading:t=!1,onMarkAllAsRead:n,onClose:r})=>{const{markAsRead:a,deleteNotification:o}=zn(),l=s.slice(0,5),c=async d=>{d.read||await a(d.id),d.link&&(window.location.href=d.link)},h=async(d,m)=>{m.stopPropagation();try{await o(d)}catch(x){console.error("Failed to delete notification:",x)}};return i.jsxs("div",{className:"notification-dropdown",children:[i.jsxs("div",{className:"dropdown-header",children:[i.jsxs("div",{className:"header-content",children:[i.jsx("h3",{className:"dropdown-title",children:"Notifications"}),e>0&&i.jsxs("span",{className:"unread-count",children:[e," new"]})]}),i.jsxs("div",{className:"header-actions",children:[e>0&&i.jsx(F.button,{className:"mark-all-read-btn",onClick:n,whileHover:{scale:1.05},whileTap:{scale:.95},title:"Mark all as read",children:i.jsx(Ot,{size:16})}),i.jsx(be,{to:"/settings",className:"settings-btn",title:"Notification settings",children:i.jsx(Os,{size:16})})]})]}),i.jsx("div",{className:"dropdown-content",children:t?i.jsxs("div",{className:"dropdown-loading",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("span",{children:"Loading notifications..."})]}):l.length>0?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"notification-list",children:l.map((d,m)=>i.jsx(F.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:m*.05},children:i.jsx(Ih,{notification:d,onClick:()=>c(d),onDelete:x=>h(d.id,x),compact:!0})},d.id))}),i.jsx("div",{className:"dropdown-footer",children:i.jsxs(be,{to:"/notifications",className:"view-all-btn",onClick:r,children:["View all notifications",i.jsx(In,{size:14})]})})]}):i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"empty-icon",children:i.jsx(Ot,{size:32})}),i.jsx("h4",{children:"All caught up!"}),i.jsx("p",{children:"You have no new notifications"})]})})]})},By=({className:s="",position:e="bottom-right"})=>{const[t,n]=v.useState(!1),[r,a]=v.useState(!1),o=v.useRef(null),l=v.useRef(null),{unreadCount:c,notifications:h,loading:d,markAllAsRead:m,connectionStatus:x}=zn();v.useEffect(()=>{const f=y=>{o.current&&!o.current.contains(y.target)&&l.current&&!l.current.contains(y.target)&&n(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]),v.useEffect(()=>{c>0&&!r&&(a(!0),setTimeout(()=>a(!1),1e3))},[c,r]);const b=()=>{n(!t)},p=async()=>{try{await m()}catch(f){console.error("Failed to mark all as read:",f)}},g=()=>{switch(x){case"connected":return"connected";case"connecting":return"connecting";case"disconnected":return"disconnected";default:return"unknown"}};return i.jsxs("div",{className:`notification-bell-container ${s}`,ref:o,children:[i.jsxs(F.button,{className:`notification-bell ${r?"animate":""} ${t?"active":""}`,onClick:b,whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":`Notifications ${c>0?`(${c} unread)`:""}`,children:[i.jsx(F.div,{className:"bell-icon",animate:r?{rotate:[0,-10,10,-10,10,0],transition:{duration:.6,ease:"easeInOut"}}:{},children:i.jsx(ls,{size:20})}),i.jsx(Se,{children:c>0&&i.jsx(F.div,{className:"notification-badge",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:500,damping:30},children:c>99?"99+":c})}),i.jsx("div",{className:`connection-indicator ${g()}`})]}),i.jsx(Se,{children:t&&i.jsx(F.div,{ref:l,className:`notification-dropdown-wrapper ${e}`,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.2,ease:"easeOut"},children:i.jsx(Fy,{notifications:h,unreadCount:c,loading:d,onMarkAllAsRead:p,onClose:()=>n(!1)})})})]})},ks=({icon:s,title:e,subtitle:t,actions:n=[],borderColor:r="primary",showNotifications:a=!0,className:o=""})=>{const l=c=>{switch(c){case"primary":return"border-primary";case"success":return"border-success";case"warning":return"border-warning";case"info":return"border-info";case"purple":return"border-purple";case"orange":return"border-orange";default:return"border-primary"}};return i.jsx(F.div,{className:`page-header ${l(r)} ${o}`,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},children:i.jsxs("div",{className:"header-content",children:[i.jsx("div",{className:"header-left",children:i.jsxs("div",{className:"header-title-section",children:[s&&i.jsx("div",{className:"header-icon",children:i.jsx(s,{size:24})}),i.jsxs("div",{className:"header-text",children:[i.jsx("h1",{className:"header-title",children:e}),t&&i.jsx("p",{className:"header-subtitle",children:t})]})]})}),i.jsx("div",{className:"header-right",children:i.jsxs("div",{className:"header-actions",children:[n.map((c,h)=>i.jsxs(F.button,{className:`header-action-btn ${c.variant||"secondary"}`,onClick:c.onClick,disabled:c.disabled,whileHover:{scale:1.02},whileTap:{scale:.98},title:c.tooltip,children:[c.icon&&i.jsx(c.icon,{size:16}),i.jsx("span",{children:c.label})]},h)),a&&i.jsx("div",{className:"header-notifications",children:i.jsx(By,{position:"bottom-right"})})]})})]})})},Ee=(s,e=!1)=>{if(s==null||isNaN(s))return"₹0.00";const t=Number(s);if(e){if(t>=1e7)return`₹${(t/1e7).toFixed(2)}Cr`;if(t>=1e5)return`₹${(t/1e5).toFixed(2)}L`;if(t>=1e3)return`₹${(t/1e3).toFixed(2)}K`}return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)},ba=(s,e=!1)=>{if(s==null||isNaN(s))return"0";const t=Number(s);if(e){if(t>=1e7)return`${(t/1e7).toFixed(2)}Cr`;if(t>=1e5)return`${(t/1e5).toFixed(2)}L`;if(t>=1e3)return`${(t/1e3).toFixed(2)}K`}return new Intl.NumberFormat("en-IN",{minimumFractionDigits:0,maximumFractionDigits:2}).format(t)},Nr=(s,e="short")=>{if(!s)return"";const t=new Date(s);if(isNaN(t.getTime()))return"";const n={short:{day:"2-digit",month:"2-digit",year:"numeric"},long:{day:"numeric",month:"long",year:"numeric"},time:{hour:"2-digit",minute:"2-digit",hour12:!0},datetime:{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}};return new Intl.DateTimeFormat("en-IN",n[e]).format(t)},_h=()=>{const{user:s}=Bt(),[e,t]=v.useState([]),[n,r]=v.useState(!1),[a,o]=v.useState(null),l=v.useCallback(async()=>{if(s!=null&&s.id)try{r(!0),o(null);const S=`watchlists_${s.id}`,k=localStorage.getItem(S);if(k){const C=JSON.parse(k);t(C)}else{const C={_id:"default",name:"My Watchlist",stocks:[],isDefault:!0,createdAt:new Date().toISOString()};t([C]),localStorage.setItem(S,JSON.stringify([C]))}}catch(S){console.error("Error fetching watchlists:",S),o(S.message);const k={_id:"default",name:"My Watchlist",stocks:[],isDefault:!0,createdAt:new Date().toISOString()};t([k])}finally{r(!1)}},[s==null?void 0:s.id]);v.useEffect(()=>{l()},[l]);const c=v.useCallback(S=>e.some(k=>k.stocks.some(C=>C.symbol===S||C.stockSymbol===S)),[e]),h=v.useCallback(S=>e.find(k=>k.stocks.some(C=>C.symbol===S||C.stockSymbol===S)),[e]),d=v.useCallback(async(S,k=null)=>{var C,N;if(!(s!=null&&s.id))return K.error("Please login to add stocks to watchlist"),{success:!1,message:"User not authenticated"};try{r(!0);const T=k||((C=e.find(B=>B.isDefault))==null?void 0:C._id)||((N=e[0])==null?void 0:N._id);if(!T){const B={_id:"default",name:"My Watchlist",stocks:[],isDefault:!0,createdAt:new Date().toISOString()},R=[...e,B];t(R);const A=`watchlists_${s.id}`;return localStorage.setItem(A,JSON.stringify(R)),d(S,B._id)}const I=e.find(B=>B._id===T);if(I==null?void 0:I.stocks.some(B=>B.symbol===(S.symbol||S.stockSymbol)))return K.info(`${S.symbol||S.stockSymbol} is already in your watchlist`),{success:!1,message:"Stock already in watchlist"};const L={symbol:S.symbol||S.stockSymbol,name:S.name||S.companyName||`${S.symbol} Corporation`,price:S.price||S.currentPrice||0,change:S.change||S.priceChange||0,changePercent:S.changePercent||S.changePercentage||0,volume:S.volume||0,marketCap:S.marketCap||0,sector:S.sector||"Unknown",addedAt:new Date().toISOString()},M=e.map(B=>B._id===T?{...B,stocks:[...B.stocks,L]}:B);t(M);const O=`watchlists_${s.id}`;return localStorage.setItem(O,JSON.stringify(M)),K.success(`${L.symbol} added to watchlist!`),{success:!0,data:M.find(B=>B._id===T)}}catch(T){return console.error("Error adding to watchlist:",T),K.error(T.message||"Failed to add stock to watchlist"),{success:!1,message:T.message}}finally{r(!1)}},[s==null?void 0:s.id,e]),m=v.useCallback(async(S,k=null)=>{if(!(s!=null&&s.id))return K.error("Please login to manage watchlist"),{success:!1,message:"User not authenticated"};try{r(!0);const C=k?e.find(I=>I._id===k):h(S);if(!C)return K.error("Stock not found in any watchlist"),{success:!1,message:"Stock not found in watchlist"};const N=e.map(I=>I._id===C._id?{...I,stocks:I.stocks.filter(P=>P.symbol!==S&&P.stockSymbol!==S)}:I);t(N);const T=`watchlists_${s.id}`;return localStorage.setItem(T,JSON.stringify(N)),K.success(`${S} removed from watchlist!`),{success:!0}}catch(C){return console.error("Error removing from watchlist:",C),K.error(C.message||"Failed to remove stock from watchlist"),{success:!1,message:C.message}}finally{r(!1)}},[s==null?void 0:s.id,e,h]),x=v.useCallback(async S=>{const k=S.symbol||S.stockSymbol;return c(k)?await m(k):await d(S)},[c,d,m]),b=v.useCallback(async(S,k="")=>{if(!(s!=null&&s.id))return K.error("Please login to create watchlist"),{success:!1,message:"User not authenticated"};try{r(!0);const C={_id:`watchlist_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:S,description:k,stocks:[],isDefault:e.length===0,createdAt:new Date().toISOString()},N=[...e,C];t(N);const T=`watchlists_${s.id}`;return localStorage.setItem(T,JSON.stringify(N)),K.success(`Watchlist "${S}" created successfully!`),{success:!0,data:C}}catch(C){return console.error("Error creating watchlist:",C),K.error(C.message||"Failed to create watchlist"),{success:!1,message:C.message}}finally{r(!1)}},[s==null?void 0:s.id,e]),p=v.useCallback(async S=>{if(!(s!=null&&s.id))return K.error("Please login to delete watchlist"),{success:!1,message:"User not authenticated"};try{r(!0);const k=e.filter(N=>N._id!==S);t(k);const C=`watchlists_${s.id}`;return localStorage.setItem(C,JSON.stringify(k)),K.success("Watchlist deleted successfully!"),{success:!0}}catch(k){return console.error("Error deleting watchlist:",k),K.error(k.message||"Failed to delete watchlist"),{success:!1,message:k.message}}finally{r(!1)}},[s==null?void 0:s.id,e]),g=v.useCallback(()=>e.reduce((S,k)=>S+k.stocks.length,0),[e]),f=v.useCallback(()=>e.find(S=>S.isDefault)||e[0]||null,[e]),y=v.useCallback(async()=>{console.log("🔄 Refreshing watchlists..."),await l()},[l]);return{watchlists:e,loading:n,error:a,isInWatchlist:c,getWatchlistWithStock:h,addToWatchlist:d,removeFromWatchlist:m,toggleWatchlist:x,createWatchlist:b,deleteWatchlist:p,refreshWatchlists:y,getTotalStockCount:g,getDefaultWatchlist:f}},Pi=({stockData:s,size:e="medium",variant:t="icon",showText:n=!1,className:r="",onSuccess:a,onError:o})=>{const{isInWatchlist:l,toggleWatchlist:c,addToWatchlist:h,removeFromWatchlist:d,watchlists:m,loading:x}=_h(),[b,p]=v.useState(!1),[g,f]=v.useState(!1),[y,S]=v.useState(!1);if(!s)return console.warn("⚠️ WatchlistButton: No stock data provided"),null;const k=s.symbol||s.stockSymbol;if(!k)return console.warn("⚠️ WatchlistButton: No stock symbol found in data:",s),null;const C=l(k);console.log("🔍 WatchlistButton render:",{symbol:k,inWatchlist:C,watchlistsCount:m.length,isProcessing:g,loading:x});const N=async P=>{if(P==null||P.stopPropagation(),!(g||x)){f(!0);try{console.log("🎯 Toggling watchlist for:",k,"Currently in watchlist:",C);const L={symbol:k,name:s.name||s.companyName||`${k} Corporation`,price:s.price||s.currentPrice||0,change:s.change||s.priceChange||0,changePercent:s.changePercent||s.changePercentage||0,volume:s.volume||0,marketCap:s.marketCap||0,sector:s.sector||"Unknown"},M=await c(L);M.success?(console.log("✅ Watchlist toggle successful:",M),a&&a(M,C?"removed":"added"),navigator.vibrate&&navigator.vibrate(50),S(!0),setTimeout(()=>S(!1),600)):(console.warn("⚠️ Watchlist toggle failed:",M.message),o&&o(M.message||"Failed to update watchlist"))}catch(L){console.error("❌ Error toggling watchlist:",L),o&&o("Failed to update watchlist")}finally{f(!1)}}},T=async P=>{if(!(g||x)){f(!0),p(!1);try{console.log("➕ Adding to watchlist:",P,"Stock:",k);const L={symbol:k,name:s.name||s.companyName||`${k} Corporation`,price:s.price||s.currentPrice||0,change:s.change||s.priceChange||0,changePercent:s.changePercent||s.changePercentage||0,volume:s.volume||0,marketCap:s.marketCap||0,sector:s.sector||"Unknown"},M=await h(L,P);M.success?(console.log("✅ Successfully added to watchlist"),a&&a(M,"added")):(console.warn("⚠️ Failed to add to watchlist:",M.message),o&&o(M.message||"Failed to add to watchlist"))}catch(L){console.error("❌ Error adding to watchlist:",L),o&&o("Failed to add to watchlist")}finally{f(!1)}}},I=async()=>{if(!(g||x)){f(!0),p(!1);try{const P=await d(k);P.success&&a?a(P,"removed"):!P.success&&o&&o(P.message)}catch(P){console.error("Error removing from watchlist:",P),o&&o("Failed to remove from watchlist")}finally{f(!1)}}};return t==="simple"?i.jsxs("button",{className:`watchlist-btn watchlist-btn-${e} ${C?"active":""} ${g?"processing":""} ${y?"success":""} ${r}`,onClick:N,disabled:g||x,title:C?"Remove from watchlist":"Add to watchlist",children:[g?i.jsx(en,{className:"animate-spin"}):C?i.jsx(Ot,{}):i.jsx(Fs,{}),n&&i.jsx("span",{className:"btn-text",children:C?"In Watchlist":"Add to Watchlist"})]}):t==="dropdown"?i.jsxs("div",{className:`watchlist-dropdown-container ${r}`,children:[i.jsxs("button",{className:`watchlist-btn watchlist-btn-${e} ${C?"active":""}`,onClick:P=>{P.stopPropagation(),p(!b)},disabled:g||x,title:"Manage watchlist",children:[g?i.jsx(en,{className:"animate-spin"}):i.jsx(_c,{}),n&&i.jsx("span",{className:"btn-text",children:"Watchlist"})]}),i.jsx(Se,{children:b&&i.jsxs(F.div,{className:"watchlist-dropdown",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:[i.jsxs("div",{className:"dropdown-header",children:[i.jsx("span",{children:"Add to Watchlist"}),i.jsx("button",{className:"close-btn",onClick:()=>p(!1),children:i.jsx(We,{})})]}),i.jsxs("div",{className:"dropdown-content",children:[C&&i.jsxs("button",{className:"dropdown-item remove-item",onClick:I,disabled:g,children:[i.jsx(We,{}),i.jsx("span",{children:"Remove from Watchlist"})]}),m.map(P=>{const L=P.stocks.some(M=>M.symbol===k||M.stockSymbol===k);return i.jsxs("button",{className:`dropdown-item ${L?"has-stock":""}`,onClick:()=>T(P._id),disabled:g||L,children:[L?i.jsx(Ot,{}):i.jsx(Ht,{}),i.jsx("span",{children:P.name}),P.isDefault&&i.jsx("span",{className:"default-badge",children:"Default"})]},P._id)}),m.length===0&&i.jsx("div",{className:"dropdown-empty",children:i.jsx("span",{children:"No watchlists found"})})]})]})}),b&&i.jsx("div",{className:"watchlist-dropdown-backdrop",onClick:()=>p(!1)})]}):i.jsxs("button",{className:`watchlist-btn watchlist-btn-${e} ${C?"active":""} ${g?"processing":""} ${y?"success":""} ${r}`,onClick:N,disabled:g||x,title:C?"Remove from watchlist":"Add to watchlist",children:[i.jsx(F.div,{initial:{scale:.5,opacity:0,rotate:-180},animate:{scale:1,opacity:1,rotate:0,y:y?[-2,0]:0},transition:{duration:.4,type:"spring",stiffness:300,damping:20},children:g?i.jsx(F.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:i.jsx(en,{})}):i.jsx(F.div,{animate:{scale:y?[1,1.3,1]:1,rotate:C?[0,15,-15,0]:0},transition:{duration:.3},children:i.jsx(Fs,{className:C?"filled":""})})},C?"filled":"empty"),n&&i.jsx("span",{className:"btn-text",children:C?"In Watchlist":"Add to Watchlist"})]})},Wn=({stockData:s,isOpen:e,onClose:t,showQuantityControls:n=!0,defaultQuantity:r=1,onSuccess:a,compact:o=!1})=>{var L;const l=Ve(),{portfolioData:c,buyStock:h,isLoading:d}=ft(),[m,x]=v.useState(r),[b,p]=v.useState(!1),[g,f]=v.useState(0),[y,S]=v.useState(!1);v.useEffect(()=>{e&&(x(r),f(0),S(!1))},[e,r]);const k=(s==null?void 0:s.price)||0,C=m*k,N=c.availableCash>=C,T=M=>{if(!N||y)return;M.preventDefault(),M.stopPropagation();const O=M.currentTarget.closest(".slide-to-buy");if(!O)return;const B=O.getBoundingClientRect(),R=52,A=B.width-R-8;let V=!0;const z=Y=>{if(!V)return;Y.preventDefault();const ne=(Y.touches?Y.touches[0].clientX:Y.clientX)-B.left-R/2,re=Math.min(Math.max(ne/A*100,0),100);f(re)},q=async()=>{V=!1,g>80?(f(100),await I()):f(0),document.removeEventListener("mousemove",z,{passive:!1}),document.removeEventListener("mouseup",q),document.removeEventListener("touchmove",z,{passive:!1}),document.removeEventListener("touchend",q)};document.addEventListener("mousemove",z,{passive:!1}),document.addEventListener("mouseup",q),document.addEventListener("touchmove",z,{passive:!1}),document.addEventListener("touchend",q)},I=async()=>{if(!(!s||!m||y)){S(!0);try{const M=await h(s.symbol,m,s.price,s);M.success?(K.success(`Successfully bought ${m} shares of ${s.symbol}!`),f(100),a&&a(M),setTimeout(()=>{t(),f(0),l("/portfolio",{state:{purchasedStock:{symbol:s.symbol,name:s.name,quantity:m,price:s.price,totalCost:m*s.price},showPurchaseSuccess:!0}})},1500)):(K.error(M.message||"Failed to buy stock"),f(0))}catch(M){console.error("Error buying stock:",M),K.error("Failed to buy stock"),f(0)}finally{S(!1)}}},P=async()=>{!N||y||await I()};return!e||!s?null:i.jsx(F.div,{className:"slide-to-buy-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,children:i.jsxs(F.div,{className:`slide-to-buy-modal ${o?"compact":""}`,initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:M=>M.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsxs("div",{className:"stock-info",children:[i.jsx("h3",{children:s.symbol}),i.jsx("p",{children:s.name})]}),i.jsxs("div",{className:"header-actions",children:[i.jsx(Pi,{stockData:s,size:"medium",variant:"simple",showText:!1}),i.jsx("button",{onClick:t,className:"close-btn",children:i.jsx(We,{})})]})]}),i.jsx("div",{className:"stock-price-section",children:i.jsxs("div",{className:"current-price",children:[i.jsx("span",{className:"price-value",children:Ee(s.price)}),i.jsxs("div",{className:`price-change ${s.change>=0?"positive":"negative"}`,children:[s.change>=0?"+":"",Ee(s.change),"(",((L=s.changePercent)==null?void 0:L.toFixed(2))||"0.00","%)"]})]})}),n&&i.jsxs("div",{className:"quantity-section",children:[i.jsx("label",{children:"Quantity"}),i.jsxs("div",{className:"quantity-controls",children:[i.jsx("button",{onClick:()=>x(Math.max(1,m-1)),className:"quantity-btn",disabled:y,children:i.jsx(Mn,{})}),i.jsx("input",{type:"number",value:m,onChange:M=>x(Math.max(1,parseInt(M.target.value)||1)),className:"quantity-input",min:"1",disabled:y}),i.jsx("button",{onClick:()=>x(m+1),className:"quantity-btn",disabled:y,children:i.jsx(Ht,{})})]})]}),i.jsxs("div",{className:"order-summary",children:[i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Price per share"}),i.jsx("span",{children:Ee(k)})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Quantity"}),i.jsxs("span",{children:[m," shares"]})]}),i.jsxs("div",{className:"summary-row total",children:[i.jsx("span",{children:"Total Cost"}),i.jsx("span",{children:Ee(C)})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Available Cash"}),i.jsx("span",{className:N?"positive":"negative",children:Ee(c.availableCash)})]})]}),!N&&i.jsxs("div",{className:"insufficient-funds-warning",children:[i.jsx(et,{}),i.jsx("span",{children:"Insufficient funds to complete this purchase"})]}),i.jsxs("div",{className:"action-buttons",children:[i.jsxs("button",{onClick:P,disabled:!N||y,className:`quick-buy-btn ${N?"":"disabled"}`,children:[i.jsx(tt,{}),y?"Processing...":"Quick Buy"]}),i.jsx("div",{className:"slide-to-buy-container",children:i.jsxs("div",{className:`slide-to-buy ${N?"":"disabled"} ${y?"processing":""}`,children:[i.jsx("div",{className:"slide-track",style:{background:`linear-gradient(to right, #10B981 ${g}%, #E5E7EB ${g}%)`},children:i.jsx(F.div,{className:"slide-button",style:{left:`${Math.min(g,85)}%`},onMouseDown:N?T:void 0,onTouchStart:N?T:void 0,whileHover:N?{scale:1.05}:{},whileTap:N?{scale:.95}:{},animate:{left:`${Math.min(g,85)}%`},transition:{type:g===0?"spring":"tween",stiffness:300,damping:30,duration:g===0?.5:.1},children:y?i.jsx("div",{className:"loading-spinner small"}):g>80?i.jsx(kt,{}):i.jsx(lt,{})})}),i.jsx("span",{className:"slide-text",children:y?"Processing...":g>80?"Release to Buy!":"Slide to Buy"})]})})]}),i.jsx("div",{className:"additional-actions",children:i.jsx("button",{onClick:()=>{t(),l(`/stock/${s.symbol}`)},className:"view-details-btn",children:"View Full Details"})})]})})},Vn=()=>{const[s,e]=v.useState(!1),[t,n]=v.useState(null),[r,a]=v.useState(1),o=v.useCallback((h,d=1)=>{if(!h){console.warn("No stock data provided to openSlideToBuy");return}const m={symbol:h.symbol||h.stockSymbol,name:h.name||h.companyName||`${h.symbol} Corporation`,price:h.price||h.currentPrice||0,change:h.change||h.priceChange||0,changePercent:h.changePercent||h.changePercentage||0,volume:h.volume||0,marketCap:h.marketCap||0,sector:h.sector||"Unknown",...h};n(m),a(d),e(!0)},[]),l=v.useCallback(()=>{e(!1),setTimeout(()=>{n(null),a(1)},300)},[]),c=v.useCallback(h=>{o(h,1)},[o]);return{isOpen:s,currentStock:t,defaultQuantity:r,openSlideToBuy:o,closeSlideToBuy:l,quickBuy:c}},Lh=v.memo(({user:s,theme:e})=>{var g;Ve();const[t,n]=v.useState(!1),{portfolioData:r,loading:a,updatePortfolioValues:o,refreshPortfolio:l}=ft(),{isOpen:c,currentStock:h,defaultQuantity:d,closeSlideToBuy:m}=Vn();v.useEffect(()=>{console.log("🏠 Dashboard received portfolio data update:",{availableCash:r.availableCash,totalValue:r.totalValue}),r.availableCash===1e4&&r.totalValue===1e4&&(console.log("🔄 Dashboard detected default values, forcing refresh..."),setTimeout(()=>{l()},1e3))},[r.availableCash,r.totalValue,l]);const x=[{title:"Total Value",value:r.totalValue,changePercent:r.totalGainLossPercentage,icon:Je,color:"primary"},{title:"Available Cash",value:r.availableCash,changePercent:0,icon:Je,color:"info"},{title:"Total Invested",value:r.totalInvested,changePercent:r.totalGainLossPercentage,icon:Pe,color:r.totalGainLoss>=0?"success":"danger"},{title:"Holdings",value:((g=r.holdings)==null?void 0:g.length)||0,changePercent:0,icon:tt,color:"success"}],b=[{name:"NIFTY 50",value:19674.25,change:145.3,changePercent:.74},{name:"SENSEX",value:65953.48,change:501.92,changePercent:.77},{name:"NIFTY BANK",value:44821.15,change:287.65,changePercent:.65},{name:"NIFTY IT",value:29847.3,change:-89.45,changePercent:-.3}],p=async()=>{n(!0);try{console.log("🔄 Manual refresh triggered");const f=je.getPortfolioSummary();console.log("🔍 Direct trading service check:",{availableCash:f.availableCash,totalValue:f.totalValue}),l(),await o(),await new Promise(y=>setTimeout(y,1e3))}catch(f){console.error("Error refreshing data:",f)}finally{n(!1)}};return i.jsxs("div",{className:"dashboard-page",children:[i.jsx(ks,{icon:Pe,title:"TradeBro Dashboard",subtitle:"Indian Stock Market Overview - NSE & BSE Trading Platform",borderColor:"primary",actions:[{label:"Refresh",icon:Ue,onClick:p,variant:"secondary",disabled:t},{label:"Claimed Today",icon:st,onClick:()=>{},variant:"outline",disabled:!0}]}),i.jsx(Oy,{}),i.jsxs("div",{className:"dashboard-container",children:[i.jsx(F.div,{className:"market-indices",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:b.map((f,y)=>{const S=f.change>=0;return i.jsxs(F.div,{className:"index-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:y*.1},children:[i.jsxs("div",{className:"index-header",children:[i.jsx("h3",{className:"index-name",children:f.name}),i.jsxs("div",{className:`index-change ${S?"positive":"negative"}`,children:[S?i.jsx(ui,{size:12}):i.jsx(di,{size:12}),Math.abs(f.changePercent),"%"]})]}),i.jsx("div",{className:"index-value",children:i.jsx(gn,{end:f.value,duration:2,separator:",",decimals:2})}),i.jsxs("div",{className:`index-change-value ${S?"positive":"negative"}`,children:[S?"+":"",f.change.toFixed(2)]})]},f.name)})}),i.jsx(F.div,{className:"stats-grid",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:x.map((f,y)=>{const S=f.icon,k=f.changePercent>=0;return i.jsxs(F.div,{className:`stat-card stat-${f.color}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:(y+4)*.1},children:[i.jsxs("div",{className:"stat-header",children:[i.jsx("div",{className:"stat-icon",children:i.jsx(S,{})}),f.changePercent!==0&&i.jsxs("div",{className:`stat-change ${k?"positive":"negative"}`,children:[k?i.jsx(ui,{size:12}):i.jsx(di,{size:12}),Math.abs(f.changePercent).toFixed(1),"%"]})]}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{className:"stat-value",children:typeof f.value=="number"&&f.value>1e3?i.jsx(gn,{end:f.value,duration:2,separator:",",prefix:f.title.includes("Value")||f.title.includes("Cash")||f.title.includes("Invested")?"₹":""}):f.value}),i.jsx("p",{className:"stat-title",children:f.title})]})]},f.title)})})]}),i.jsx(Wn,{stockData:h,isOpen:c,onClose:m,defaultQuantity:d,onSuccess:()=>{o()}})]})});Lh.displayName="Dashboard";const Mh=()=>{const[s,e]=v.useState(!1),[t,n]=v.useState(null),[r,a]=v.useState(!1),o=v.useCallback(m=>{n(m),e(!0)},[]),l=v.useCallback(()=>{r||(e(!1),setTimeout(()=>{n(null),a(!1)},300))},[r]),c=v.useCallback(async m=>{a(!0);try{let x;if(m.action==="BUY"?x=await je.buyStock(m.symbol,m.quantity,m.price,m.orderType||"market"):m.action==="SELL"&&(x=await je.sellStock(m.symbol,m.quantity,m.price,m.orderType||"market")),x.success)return K.success(`${m.action} order executed successfully! ${m.quantity} shares of ${m.symbol}`,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),setTimeout(()=>{l()},1500),x;throw new Error(x.message||"Order execution failed")}catch(x){return console.error("Order processing error:",x),K.error(x.message||`Failed to execute ${m.action.toLowerCase()} order`,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),a(!1),{success:!1,error:x.message}}},[l]),h=v.useCallback((m,x,b,p={})=>{o({action:"BUY",symbol:m,quantity:x,price:b,...p})},[o]),d=v.useCallback((m,x,b,p={})=>{o({action:"SELL",symbol:m,quantity:x,price:b,...p})},[o]);return{isModalOpen:s,orderData:t,loading:r,openConfirmation:o,closeConfirmation:l,processOrder:c,confirmBuy:h,confirmSell:d}},Rh=({isOpen:s,onClose:e,onConfirm:t,orderData:n,loading:r=!1})=>{const[a,o]=v.useState(!1),[l,c]=v.useState(!1),h=v.useRef(null),d=Nm(0),m=mr(d,[0,200],[0,1]),x=mr(m,[0,.3,.7,1],(n==null?void 0:n.action)==="BUY"?["rgba(229, 231, 235, 0.3)","rgba(251, 191, 36, 0.4)","rgba(16, 185, 129, 0.6)","rgba(16, 185, 129, 0.9)"]:["rgba(229, 231, 235, 0.3)","rgba(251, 191, 36, 0.4)","rgba(239, 68, 68, 0.6)","rgba(239, 68, 68, 0.9)"]),b=mr(m,[0,1],["0%","100%"]),[p,g]=v.useState(0),[f,y]=v.useState(0);v.useEffect(()=>m.on("change",I=>{const P=Math.round(I*100);g(P);const M=[25,50,75].find(O=>P>=O&&f<O);M&&l&&(y(M),navigator.vibrate&&navigator.vibrate(30))}),[m,f,l]),v.useEffect(()=>{s&&(o(!1),c(!1),y(0),g(0),d.set(0))},[s,d]);const S=v.useCallback(()=>{c(!0),y(0),navigator.vibrate&&navigator.vibrate(50)},[]),k=v.useCallback(()=>{const T=d.get();c(!1),T>=180?(o(!0),navigator.vibrate&&navigator.vibrate([100,50,100]),setTimeout(()=>{t(n)},300)):d.set(0)},[d,t,n]),C=T=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(T),N=n?n.quantity*n.price:0;return n?i.jsx(Se,{children:s&&i.jsxs(i.Fragment,{children:[i.jsx(F.div,{className:"drag-confirm-backdrop",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),i.jsxs(F.div,{className:`drag-confirm-modal ${a?"confirmed":""}`,initial:{opacity:0,scale:.9,y:-20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:-20},transition:{type:"spring",damping:25,stiffness:300},children:[i.jsxs("div",{className:"modal-header",children:[i.jsxs("div",{className:"header-content",children:[i.jsx("div",{className:`action-icon ${n.action.toLowerCase()}`,children:n.action==="BUY"?i.jsx(Pe,{}):i.jsx($e,{})}),i.jsxs("div",{className:"header-text",children:[i.jsxs("h2",{className:"modal-title",children:["Confirm ",n.action," Order"]}),i.jsx("p",{className:"modal-subtitle",children:"Review your order details carefully"})]})]}),i.jsx("button",{className:"close-button",onClick:e,children:i.jsx(We,{})})]}),i.jsxs("div",{className:"order-details",children:[i.jsxs("div",{className:"stock-info",children:[i.jsx("div",{className:"stock-symbol",children:n.symbol}),i.jsx("div",{className:"stock-name",children:n.name||n.symbol})]}),i.jsxs("div",{className:"order-summary",children:[i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{className:"label",children:"Action:"}),i.jsx("span",{className:`value ${n.action.toLowerCase()}`,children:n.action})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{className:"label",children:"Quantity:"}),i.jsxs("span",{className:"value",children:[n.quantity," shares"]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{className:"label",children:"Price per share:"}),i.jsx("span",{className:"value",children:C(n.price)})]}),i.jsxs("div",{className:"summary-row total",children:[i.jsx("span",{className:"label",children:"Total Value:"}),i.jsx("span",{className:"value",children:C(N)})]})]}),i.jsxs("div",{className:"risk-warning",children:[i.jsx(Ft,{className:"warning-icon"}),i.jsxs("div",{className:"warning-text",children:[i.jsx("strong",{children:"Important:"})," This action cannot be undone. Please review all details before confirming."]})]})]}),i.jsxs("div",{className:"drag-confirm-container",children:[i.jsx("div",{className:"drag-instruction",children:a?i.jsx("span",{className:"confirmed-text",children:"✓ Order Confirmed!"}):i.jsxs("span",{children:["Drag to confirm ",n.action.toLowerCase()," order"]})}),i.jsxs("div",{className:"drag-track",ref:h,children:[i.jsx(F.div,{className:"drag-track-fill",style:{backgroundColor:x,width:a?"100%":b}}),i.jsx(F.div,{className:`drag-handle ${l?"dragging":""} ${a?"confirmed":""}`,drag:"x",dragConstraints:h,dragElastic:.1,dragMomentum:!1,style:{x:d},onDragStart:S,onDragEnd:k,whileDrag:{scale:1.1},animate:{x:a?200:0},transition:{type:"spring",damping:20,stiffness:300},children:a?i.jsx(F.div,{initial:{scale:0},animate:{scale:1},className:"check-icon",children:"✓"}):i.jsx(lt,{})}),i.jsx("div",{className:"drag-text",children:a?"Processing...":l&&p>5?`${p}%`:`Confirm ${n.action}`})]})]}),r&&i.jsxs("div",{className:"loading-overlay",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Processing your order..."})]})]})]})}):null},Dy=({stockData:s,variant:e="default",showBoth:t=!0,defaultAction:n="buy",source:r="general",className:a="",disabled:o=!1,enableDragConfirm:l=!0})=>{const{openOrderModal:c}=qa(),{isAuthenticated:h}=Bt(),d=Ve(),{isModalOpen:m,orderData:x,loading:b,closeConfirmation:p,processOrder:g,confirmBuy:f,confirmSell:y}=Mh(),S=C=>{if(console.log("🔥 Action button clicked!",{action:C,stockData:s,isAuthenticated:h,disabled:o,enableDragConfirm:l}),!h){console.log("❌ User not authenticated, redirecting to login"),d("/login");return}if(o||!s){console.log("❌ Button disabled or no stock data",{disabled:o,stockData:s});return}if(l){console.log("✅ Opening drag confirmation modal",{stockData:s,action:C,source:r});const N={symbol:s.symbol,name:s.name||s.symbol,price:s.price||s.currentPrice||0,quantity:1,orderType:"market",source:r};C==="buy"?f(N.symbol,N.quantity,N.price,{name:N.name,orderType:N.orderType,source:N.source}):y(N.symbol,N.quantity,N.price,{name:N.name,orderType:N.orderType,source:N.source})}else console.log("✅ Opening traditional order modal",{stockData:s,action:C,source:r}),c(s,C,r)},k=()=>{switch(e){case"icon-only":return i.jsxs("div",{className:`stock-actions icon-only ${a}`,children:[(t||n==="buy")&&i.jsx("button",{className:"stock-action-btn buy icon-only",onClick:()=>S("buy"),disabled:o,title:"Buy Stock","aria-label":`Buy ${(s==null?void 0:s.symbol)||"stock"}`,children:i.jsx(Pe,{})}),(t||n==="sell")&&i.jsx("button",{className:"stock-action-btn sell icon-only",onClick:()=>S("sell"),disabled:o,title:"Sell Stock","aria-label":`Sell ${(s==null?void 0:s.symbol)||"stock"}`,children:i.jsx($e,{})})]});case"minimal":return i.jsxs("div",{className:`stock-actions minimal ${a}`,children:[(t||n==="buy")&&i.jsxs("button",{className:"stock-action-btn buy minimal",onClick:()=>S("buy"),disabled:o,children:[i.jsx(Pe,{}),i.jsx("span",{children:"Buy"})]}),(t||n==="sell")&&i.jsxs("button",{className:"stock-action-btn sell minimal",onClick:()=>S("sell"),disabled:o,children:[i.jsx($e,{}),i.jsx("span",{children:"Sell"})]})]});case"compact":return i.jsx("div",{className:`stock-actions compact ${a}`,children:t?i.jsxs(i.Fragment,{children:[i.jsxs("button",{className:"stock-action-btn buy compact",onClick:()=>S("buy"),disabled:o,children:[i.jsx(tt,{}),i.jsx("span",{children:"Buy"})]}),i.jsxs("button",{className:"stock-action-btn sell compact",onClick:()=>S("sell"),disabled:o,children:[i.jsx(Je,{}),i.jsx("span",{children:"Sell"})]})]}):i.jsxs("button",{className:`stock-action-btn ${n} compact`,onClick:()=>S(n),disabled:o,children:[n==="buy"?i.jsx(tt,{}):i.jsx(Je,{}),i.jsx("span",{children:n==="buy"?"Buy":"Sell"})]})});default:return i.jsxs("div",{className:`stock-actions default ${a}`,children:[(t||n==="buy")&&i.jsxs("button",{className:"stock-action-btn buy default",onClick:()=>S("buy"),disabled:o,children:[i.jsx(tt,{}),i.jsx("span",{children:"Buy Now"})]}),(t||n==="sell")&&i.jsxs("button",{className:"stock-action-btn sell default",onClick:()=>S("sell"),disabled:o,children:[i.jsx(Je,{}),i.jsx("span",{children:"Sell Now"})]})]})}};return s?i.jsxs(i.Fragment,{children:[k(),l&&i.jsx(Rh,{isOpen:m,onClose:p,onConfirm:g,orderData:x,loading:b})]}):null},$y=({stockData:s})=>i.jsx(Dy,{stockData:s,variant:"minimal",source:"portfolio",className:"portfolio-actions"}),zy=({user:s,theme:e})=>{var B;const t=Ve(),n=$t(),[r,a]=v.useState(!1),[o,l]=v.useState(null),{isOpen:c,currentStock:h,defaultQuantity:d,openSlideToBuy:m,closeSlideToBuy:x}=Vn(),[b,p]=v.useState("all"),[g,f]=v.useState("value"),{portfolioData:y,loading:S,updatePortfolioValues:k,refreshPortfolio:C}=ft();if(v.useEffect(()=>{var R,A;if((R=n.state)!=null&&R.showPurchaseSuccess&&((A=n.state)!=null&&A.purchasedStock)){const V=n.state.purchasedStock;K.success(`🎉 Successfully purchased ${V.quantity} shares of ${V.symbol} for ${M(V.totalCost)}!`,{duration:5e3}),l(V.symbol),setTimeout(()=>{l(null)},5e3),t(n.pathname,{replace:!0})}},[n.state,t,n.pathname]),S||!y)return i.jsx("div",{className:"portfolio-page",children:i.jsx("div",{className:"portfolio-container",children:i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Loading portfolio..."})]})})});const N=[{title:"Total Value",value:y.totalValue||0,changePercent:y.totalGainLossPercentage||0,changeAmount:y.totalGainLoss||0,icon:Je,color:"primary"},{title:"Available Cash",value:y.availableCash||0,changePercent:0,changeAmount:0,icon:Je,color:"info"},{title:"Total Invested",value:y.totalInvested||0,changePercent:y.totalGainLossPercentage||0,changeAmount:y.totalGainLoss||0,icon:rt,color:(y.totalGainLoss||0)>=0?"success":"danger"},{title:"Holdings",value:((B=y.holdings)==null?void 0:B.length)||0,changePercent:0,changeAmount:0,icon:fi,color:"info"}],T=y.holdings||[],I=T.filter(R=>b==="gainers"?(R.totalGain||0)>0:b==="losers"?(R.totalGain||0)<0:!0),P=[...I].sort((R,A)=>(A.value||0)-(R.value||0)),L=async()=>{a(!0),await new Promise(R=>setTimeout(R,1500)),a(!1)},M=R=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(R),O=R=>new Intl.NumberFormat("en-IN").format(R);return i.jsxs("div",{className:"portfolio-page",children:[i.jsx(ks,{icon:fi,title:"Portfolio",subtitle:"Track your investments and portfolio performance",borderColor:"success",actions:[{label:"Refresh",icon:Ue,onClick:L,variant:"secondary",disabled:r}]}),i.jsxs("div",{className:"portfolio-container",children:[i.jsx(F.div,{className:"portfolio-stats",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:N.map((R,A)=>{const V=R.icon,z=R.changePercent>=0;return i.jsxs(F.div,{className:`stat-card stat-${R.color}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:A*.1},children:[i.jsxs("div",{className:"stat-header",children:[i.jsx("div",{className:"stat-icon",children:i.jsx(V,{})}),i.jsxs("div",{className:`stat-change ${z?"positive":"negative"}`,children:[z?i.jsx(ui,{size:14}):i.jsx(di,{size:14}),Math.abs(R.changePercent),"%"]})]}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{className:"stat-value",children:typeof R.value=="number"&&R.value>1e3?i.jsx(gn,{end:R.value,duration:2,separator:",",prefix:R.title.includes("Value")||R.title.includes("P&L")?"₹":""}):R.value}),i.jsx("p",{className:"stat-title",children:R.title}),R.changeAmount!==0&&i.jsxs("p",{className:`stat-change-amount ${z?"positive":"negative"}`,children:[z?"+":"",M(R.changeAmount)]})]})]},R.title)})}),i.jsx("div",{className:"portfolio-grid",children:i.jsxs(F.div,{className:"portfolio-card holdings-table",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:[i.jsxs("div",{className:"card-header",children:[i.jsxs("div",{className:"header-left",children:[i.jsxs("h3",{className:"card-title",children:[i.jsx(rt,{className:"card-icon"}),"My Holdings",i.jsxs("span",{className:"holdings-count",children:["(",I.length," of ",T.length," stocks)"]})]}),i.jsxs("div",{className:"holdings-summary",children:[i.jsxs("span",{className:"total-invested",children:["Total Invested: ",M(y.totalInvested||0)]}),i.jsxs("span",{className:"current-value",children:["Current Value: ",M(y.totalValue||0)]})]})]}),i.jsxs("div",{className:"card-actions",children:[i.jsx("div",{className:"filter-group",children:i.jsxs("select",{className:"filter-select",value:b,onChange:R=>p(R.target.value),children:[i.jsx("option",{value:"all",children:"All Holdings"}),i.jsx("option",{value:"gainers",children:"Gainers Only"}),i.jsx("option",{value:"losers",children:"Losers Only"})]})}),i.jsx("button",{className:"btn-refresh",onClick:L,disabled:r,title:"Refresh Holdings",children:i.jsx(Ue,{className:r?"spinning":""})})]})]}),i.jsx("div",{className:"card-content",children:i.jsxs("div",{className:"holdings-table",children:[i.jsxs("div",{className:"table-header",children:[i.jsx("div",{className:"col-stock",children:"Stock"}),i.jsx("div",{className:"col-quantity",children:"Quantity"}),i.jsx("div",{className:"col-avg-price",children:"Avg Price"}),i.jsx("div",{className:"col-current-price",children:"Current Price"}),i.jsx("div",{className:"col-value",children:"Value"}),i.jsx("div",{className:"col-gains",children:"Total P&L"}),i.jsx("div",{className:"col-day-change",children:"Day Change"}),i.jsx("div",{className:"col-actions",children:"Actions"})]}),i.jsx("div",{className:"table-body",children:P.length>0?P.map((R,A)=>i.jsxs(F.div,{className:`table-row clickable ${o===R.symbol?"highlighted-purchase":""}`,initial:{opacity:0,y:10},animate:{opacity:1,y:0,scale:o===R.symbol?1.02:1},style:{backgroundColor:o===R.symbol?"var(--success-bg, rgba(16, 185, 129, 0.1))":"transparent"},transition:{duration:.3,delay:A*.05},onClick:()=>t(`/stock/${R.symbol}`),children:[i.jsx("div",{className:"col-stock",children:i.jsxs("div",{className:"stock-info",children:[i.jsx("div",{className:"stock-symbol",children:R.symbol}),i.jsx("div",{className:"stock-name",children:R.name}),i.jsx("div",{className:"stock-sector",children:R.sector})]})}),i.jsx("div",{className:"col-quantity",children:O(R.quantity||0)}),i.jsx("div",{className:"col-avg-price",children:M(R.avgPrice||0)}),i.jsx("div",{className:"col-current-price",children:i.jsx(ys,{price:R.currentPrice||0,change:R.dayChange||0,changePercent:R.dayChangePercent||0,size:"small"})}),i.jsx("div",{className:"col-value",children:M(R.value||0)}),i.jsxs("div",{className:"col-gains",children:[i.jsxs("div",{className:`gain-amount ${(R.totalGain||0)>=0?"positive":"negative"}`,children:[(R.totalGain||0)>=0?"+":"",M(R.totalGain||0)]}),i.jsxs("div",{className:`gain-percent ${(R.totalGainPercent||0)>=0?"positive":"negative"}`,children:["(",(R.totalGainPercent||0)>=0?"+":"",(R.totalGainPercent||0).toFixed(2),"%)"]})]}),i.jsxs("div",{className:"col-day-change",children:[i.jsxs("div",{className:`day-change ${(R.dayChange||0)>=0?"positive":"negative"}`,children:[(R.dayChange||0)>=0?"+":"",(R.dayChange||0).toFixed(2)]}),i.jsxs("div",{className:`day-change-percent ${(R.dayChangePercent||0)>=0?"positive":"negative"}`,children:["(",(R.dayChangePercent||0)>=0?"+":"",(R.dayChangePercent||0).toFixed(2),"%)"]})]}),i.jsx("div",{className:"col-actions",children:i.jsxs("div",{className:"action-buttons",children:[i.jsx(Pi,{stockData:{symbol:R.symbol,name:R.name,price:R.currentPrice,change:R.dayChange,changePercent:R.dayChangePercent},size:"small",variant:"simple",showText:!1}),i.jsx("button",{className:"buy-btn-small",onClick:V=>{V.stopPropagation(),m({symbol:R.symbol,name:R.name,price:R.currentPrice,change:R.dayChange,changePercent:R.dayChangePercent})},title:"Buy More",children:"Buy"}),i.jsx($y,{stockData:{symbol:R.symbol,name:R.name,price:R.currentPrice,change:R.dayChange,changePercent:R.dayChangePercent,quantity:R.quantity,avgPrice:R.avgPrice,totalValue:R.value}})]})})]},R.symbol)):i.jsxs("div",{className:"empty-holdings",children:[i.jsx("div",{className:"empty-icon",children:i.jsx(rt,{size:48})}),i.jsx("h3",{className:"empty-title",children:b==="gainers"?"No Gainers Found":b==="losers"?"No Losers Found":"No Holdings Yet"}),i.jsx("p",{className:"empty-description",children:b==="gainers"?"None of your holdings are currently in profit.":b==="losers"?"None of your holdings are currently in loss.":"Start building your portfolio by adding your first stock."}),b!=="all"&&i.jsx("button",{className:"btn-secondary",onClick:()=>p("all"),children:"View All Holdings"})]})})]})})]})}),i.jsx(Wn,{stockData:h,isOpen:c,onClose:x,defaultQuantity:d,onSuccess:()=>{}})]})]})},Uy=({isOpen:s,position:e,stockData:t,onClose:n,onQuickBuy:r,onQuickSell:a,onViewChart:o,onAddToWatchlist:l,onViewDetails:c,hasHolding:h=!1,isInWatchlist:d=!1})=>{var g,f,y;const m=v.useRef(null),[x,b]=v.useState(e);if(v.useEffect(()=>{if(s&&m.current&&e){const k=m.current.getBoundingClientRect(),C={width:window.innerWidth,height:window.innerHeight};let{x:N,y:T}=e;N+k.width>C.width&&(N=C.width-k.width-10),N<10&&(N=10),T+k.height>C.height&&(T=C.height-k.height-10),T<10&&(T=10),b({x:N,y:T})}},[s,e]),v.useEffect(()=>{const S=C=>{m.current&&!m.current.contains(C.target)&&n()},k=C=>{C.key==="Escape"&&n()};return s&&(document.addEventListener("mousedown",S),document.addEventListener("keydown",k)),()=>{document.removeEventListener("mousedown",S),document.removeEventListener("keydown",k)}},[s,n]),!s||!t)return null;const p=[{id:"quick-sell",label:"Quick Sell",icon:$e,action:()=>{a(t),n()},color:"red",disabled:!h,shortcut:"S"},{id:"enhanced-order",label:"Enhanced Order",icon:tt,action:()=>{n()},color:"blue",shortcut:"E"},{id:"view-chart",label:"View Chart",icon:rt,action:()=>{o(t),n()},color:"purple",shortcut:"C"},{id:"watchlist",label:d?"Remove from Watchlist":"Add to Watchlist",icon:cs,action:()=>{l(t),n()},color:"orange",shortcut:"W"},{id:"view-details",label:"View Details",icon:Oa,action:()=>{c(t),n()},color:"gray",shortcut:"I"}];return i.jsx(Se,{children:i.jsxs(F.div,{ref:m,className:"stock-context-menu",style:{position:"fixed",left:x.x,top:x.y,zIndex:1e3},initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.15,ease:"easeOut"},children:[i.jsxs("div",{className:"context-menu-header",children:[i.jsxs("div",{className:"stock-info",children:[i.jsx("span",{className:"stock-symbol",children:t.symbol}),i.jsxs("span",{className:"stock-price",children:["₹",((g=t.price)==null?void 0:g.toLocaleString("en-IN"))||"0.00"]})]}),i.jsxs("div",{className:`price-change ${t.change>=0?"positive":"negative"}`,children:[t.change>=0?"+":"",((f=t.change)==null?void 0:f.toFixed(2))||"0.00","(",((y=t.changePercent)==null?void 0:y.toFixed(2))||"0.00","%)"]})]}),i.jsx("div",{className:"context-menu-items",children:p.map((S,k)=>i.jsxs(F.button,{className:`context-menu-item ${S.color} ${S.disabled?"disabled":""}`,onClick:S.action,disabled:S.disabled,initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.1,delay:k*.02},whileHover:{backgroundColor:"var(--hover-bg)"},whileTap:{scale:.98},children:[i.jsxs("div",{className:"menu-item-content",children:[i.jsx(S.icon,{className:"menu-item-icon",size:16}),i.jsx("span",{className:"menu-item-label",children:S.label})]}),i.jsx("span",{className:"menu-item-shortcut",children:S.shortcut})]},S.id))}),i.jsxs("div",{className:"context-menu-footer",children:[i.jsxs("div",{className:"market-status",children:[i.jsx(vt,{size:12}),i.jsx("span",{children:"Market Open"})]}),i.jsxs("div",{className:"last-updated",children:["Updated: ",new Date().toLocaleTimeString()]})]})]})})},Wy=()=>{const[s,e]=v.useState({isOpen:!1,position:{x:0,y:0},stockData:null}),t=(r,a)=>{r.preventDefault(),r.stopPropagation(),e({isOpen:!0,position:{x:r.clientX,y:r.clientY},stockData:a})},n=()=>{e({isOpen:!1,position:{x:0,y:0},stockData:null})};return v.useEffect(()=>{const r=a=>{if(!s.isOpen)return;const{key:o}=a;switch(s.stockData,o.toLowerCase()){case"b":a.preventDefault(),n();break;case"s":a.preventDefault(),n();break;case"c":a.preventDefault(),n();break;case"w":a.preventDefault(),n();break;case"e":a.preventDefault(),n();break;case"i":a.preventDefault(),n();break}};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[s]),{contextMenu:s,openContextMenu:t,closeContextMenu:n}},Vy=({user:s,theme:e})=>{var _i;const[t,n]=v.useState(null),[r,a]=v.useState("market"),[o,l]=v.useState("buy"),[c,h]=v.useState(1),[d,m]=v.useState(""),[x,b]=v.useState(!1),[p,g]=v.useState(!1),[f,y]=v.useState(!1),[S,k]=v.useState(!1),[C,N]=v.useState(null),T=$t(),I=Ve(),{portfolioData:P,buyStock:L,sellStock:M}=ft(),{isOpen:O,currentStock:B,defaultQuantity:R,closeSlideToBuy:A}=Vn(),{orderModalState:V,closeOrderModal:z,quickBuy:q,quickSell:Y,navigateToTrading:te}=qa(),{contextMenu:ne,openContextMenu:re,closeContextMenu:oe}=Wy(),{isModalOpen:ie,orderData:D,loading:$,closeConfirmation:U,processOrder:X,confirmBuy:ce,confirmSell:ye}=Mh(),{query:pe,setQuery:Ae,results:le,suggestions:Qe,recentSearches:Cs,showHistory:Qt,handleHistoryClick:Xe,loading:ee,clearSearch:de,hasResults:ke}=Ya({enableSuggestions:!0,enableHistory:!0,limit:20,debounceMs:300,onResults:(G,Me)=>{G.length>0&&y(!0)}}),Oe=[{title:"Available Balance",value:P.availableCash,icon:Je,color:"primary"},{title:"Total Holdings",value:((_i=P.holdings)==null?void 0:_i.length)||0,icon:tt,color:"info"},{title:"Total Invested",value:P.totalInvested,icon:rt,color:"warning"},{title:"Total P&L",value:P.totalGainLoss,changePercent:P.totalGainLossPercentage,icon:P.totalGainLoss>=0?Pe:$e,color:P.totalGainLoss>=0?"success":"danger"}],ue=[{symbol:"RELIANCE",name:"Reliance Industries",price:2465.3,change:2.71,changePercent:.11,volume:"2.5M"},{symbol:"TCS",name:"Tata Consultancy Services",price:3185.45,change:-14.85,changePercent:-.47,volume:"1.8M"},{symbol:"HDFCBANK",name:"HDFC Bank",price:1650.2,change:51.75,changePercent:3.13,volume:"3.2M"},{symbol:"INFY",name:"Infosys",price:1595.8,change:19.7,changePercent:1.25,volume:"2.1M"},{symbol:"ICICIBANK",name:"ICICI Bank",price:945.15,change:12.3,changePercent:1.32,volume:"4.1M"},{symbol:"WIPRO",name:"Wipro Ltd",price:420.85,change:-3.25,changePercent:-.77,volume:"1.5M"},{symbol:"BAJFINANCE",name:"Bajaj Finance",price:6845.3,change:125.4,changePercent:1.87,volume:"0.8M"},{symbol:"MARUTI",name:"Maruti Suzuki",price:9245.6,change:-85.2,changePercent:-.91,volume:"0.6M"}],Fe=[{id:1,symbol:"WIPRO",type:"BUY",quantity:50,price:420,status:"completed",time:"10:30 AM",total:21e3},{id:2,symbol:"BAJFINANCE",type:"SELL",quantity:25,price:6800,status:"completed",time:"11:45 AM",total:17e4},{id:3,symbol:"MARUTI",type:"BUY",quantity:10,price:9200,status:"pending",time:"12:15 PM",total:92e3},{id:4,symbol:"ASIANPAINT",type:"SELL",quantity:15,price:3100,status:"cancelled",time:"01:30 PM",total:46500}];v.useEffect(()=>{const G=new URLSearchParams(T.search),Me=G.get("search"),_e=G.get("symbol");if(Me&&Ae(Me),_e){const Xt=ue.find(qs=>qs.symbol===_e)||le.find(qs=>qs.symbol===_e);Xt&&pt(Xt)}},[T.search,le]);const pt=G=>{var Me;n(G),m(((Me=G.price)==null?void 0:Me.toString())||"")},Kt=(G,Me="buy")=>{N({...G,initialOrderType:Me}),k(!0)},Te=()=>{k(!1),N(null)},Ei=G=>{const Me={symbol:G.symbol,name:G.name,price:0,change:0,changePercent:0,volume:"N/A"};pt(Me),de()},Ys=async()=>{if(!t||!c)return;const G=r==="market"?t.price:parseFloat(d),Me=parseInt(c),_e={symbol:t.symbol,name:t.name,price:G,quantity:Me,orderType:r,source:"trading-page"};o==="buy"?ce(_e.symbol,_e.quantity,_e.price,{name:_e.name,orderType:_e.orderType,source:_e.source}):ye(_e.symbol,_e.quantity,_e.price,{name:_e.name,orderType:_e.orderType,source:_e.source}),h(1),m("")},Jt=async()=>{b(!0),await new Promise(G=>setTimeout(G,1500)),b(!1)},xt=G=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(G),Ps=ke&&f?le.map(G=>({symbol:G.symbol,name:G.name,price:G.price||0,change:G.change||0,changePercent:G.changePercent||0,volume:G.volume||"N/A",exchange:G.exchange})):pe&&!ke?ue.filter(G=>G.symbol.toLowerCase().includes(pe.toLowerCase())||G.name.toLowerCase().includes(pe.toLowerCase())):ue;return i.jsx("div",{className:"trading-page",children:i.jsxs("div",{className:"trading-container",children:[i.jsx(F.div,{className:"trading-header",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:i.jsxs("div",{className:"header-content",children:[i.jsxs("div",{className:"header-left",children:[i.jsxs("h1",{className:"page-title",children:[i.jsx(tt,{className:"title-icon"}),"Trading"]}),i.jsx("p",{className:"page-subtitle",children:"Buy and sell stocks with real-time market data"})]}),i.jsx("div",{className:"header-actions",children:i.jsxs("button",{className:"btn-premium btn-secondary",onClick:Jt,disabled:x,children:[i.jsx(Ue,{size:16,className:x?"animate-spin":""}),"Refresh"]})})]})}),i.jsx(F.div,{className:"trading-stats",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:Oe.map((G,Me)=>{const _e=G.icon,Xt=G.changePercent>=0;return i.jsxs(F.div,{className:`stat-card stat-${G.color}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:Me*.1},children:[i.jsxs("div",{className:"stat-header",children:[i.jsx("div",{className:"stat-icon",children:i.jsx(_e,{})}),G.changePercent!==void 0&&i.jsxs("div",{className:`stat-change ${Xt?"positive":"negative"}`,children:[Xt?i.jsx(ui,{size:14}):i.jsx(di,{size:14}),Math.abs(G.changePercent),"%"]})]}),i.jsxs("div",{className:"stat-content",children:[i.jsx("h3",{className:"stat-value",children:typeof G.value=="number"&&G.value>1e3?i.jsx(gn,{end:G.value,duration:2,separator:",",prefix:G.title.includes("Balance")||G.title.includes("P&L")?"₹":""}):G.value}),i.jsx("p",{className:"stat-title",children:G.title})]})]},G.title)})}),i.jsxs("div",{className:"trading-grid",children:[i.jsxs(F.div,{className:"trading-card stocks-panel",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:[i.jsxs("div",{className:"card-header",children:[i.jsxs("h3",{className:"card-title",children:[i.jsx(rt,{className:"card-icon"}),ke&&f?"Search Results":"Popular Stocks"]}),i.jsx("div",{className:"search-container",children:i.jsx(Ci,{placeholder:"Search stocks...",value:pe,onChange:Ae,onClear:()=>{de(),y(!1)},suggestions:Qe,recentSearches:Cs,onSuggestionClick:Ei,onHistoryClick:Xe,showHistory:Qt,loading:ee,size:"sm",showSuggestions:!0,enableHistory:!0,className:"trading-search-input",renderSuggestion:(G,Me)=>i.jsx("div",{className:"trading-search-suggestion",children:i.jsxs("div",{className:"suggestion-content",children:[i.jsx("span",{className:"suggestion-symbol",children:G.symbol}),i.jsx("span",{className:"suggestion-name",children:G.name}),G.exchange&&i.jsx("span",{className:"suggestion-exchange",children:G.exchange})]})},Me)})})]}),i.jsx("div",{className:"card-content",children:i.jsxs("div",{className:"stocks-list",children:[ee&&i.jsxs("div",{className:"loading-state",children:[i.jsx(vt,{className:"loading-icon animate-spin"}),i.jsx("span",{children:"Searching stocks..."})]}),!ee&&Ps.length===0&&pe&&i.jsxs("div",{className:"empty-state",children:[i.jsx(As,{className:"empty-icon"}),i.jsxs("span",{children:['No stocks found for "',pe,'"']})]}),!ee&&Ps.map((G,Me)=>i.jsxs(F.div,{className:`stock-item ${(t==null?void 0:t.symbol)===G.symbol?"selected":""}`,onClick:_e=>{_e.detail===1?pt(G):_e.detail===2&&I(`/stock/${G.symbol}`)},onContextMenu:_e=>re(_e,G),initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:Me*.05},children:[i.jsxs("div",{className:"stock-info",children:[i.jsx("div",{className:"stock-symbol",children:G.symbol}),i.jsx("div",{className:"stock-name",children:G.name}),i.jsxs("div",{className:"stock-volume",children:["Vol: ",G.volume]})]}),i.jsx("div",{className:"stock-price-info",children:i.jsx(ys,{price:G.price,change:G.change,changePercent:G.changePercent,size:"small"})}),i.jsx("div",{className:"stock-actions",children:i.jsx(Pi,{stockData:G,size:"small",variant:"simple",showText:!1})})]},G.symbol))]})})]}),i.jsxs(F.div,{className:"trading-card order-panel",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{className:"card-title",children:[i.jsx(tt,{className:"card-icon"}),"Place Order"]})}),i.jsx("div",{className:"card-content",children:t?i.jsxs("div",{className:"order-form",children:[i.jsxs("div",{className:"selected-stock",children:[i.jsxs("div",{className:"stock-details",children:[i.jsx("h4",{children:t.symbol}),i.jsx("p",{children:t.name})]}),i.jsx(ys,{price:t.price,change:t.change,changePercent:t.changePercent,size:"medium"})]}),i.jsxs("div",{className:"order-controls",children:[i.jsxs("div",{className:"transaction-type",children:[i.jsxs("button",{className:`type-btn ${o==="buy"?"active buy":""}`,onClick:()=>l("buy"),children:[i.jsx(Pe,{size:16}),"BUY"]}),i.jsxs("button",{className:`type-btn ${o==="sell"?"active sell":""}`,onClick:()=>l("sell"),children:[i.jsx($e,{size:16}),"SELL"]})]}),i.jsxs("div",{className:"order-type",children:[i.jsx("label",{children:"Order Type"}),i.jsxs("select",{value:r,onChange:G=>a(G.target.value),className:"order-select",children:[i.jsx("option",{value:"market",children:"Market Order"}),i.jsx("option",{value:"limit",children:"Limit Order"}),i.jsx("option",{value:"stop",children:"Stop Order"})]})]}),i.jsxs("div",{className:"quantity-control",children:[i.jsx("label",{children:"Quantity"}),i.jsxs("div",{className:"quantity-input",children:[i.jsx("button",{className:"qty-btn",onClick:()=>h(Math.max(1,c-1)),children:i.jsx(Mn,{size:14})}),i.jsx("input",{type:"number",value:c,onChange:G=>h(Math.max(1,parseInt(G.target.value)||1)),className:"qty-input",min:"1"}),i.jsx("button",{className:"qty-btn",onClick:()=>h(c+1),children:i.jsx(Ht,{size:14})})]})]}),r!=="market"&&i.jsxs("div",{className:"price-control",children:[i.jsx("label",{children:"Price (₹)"}),i.jsx("input",{type:"number",value:d,onChange:G=>m(G.target.value),className:"price-input",placeholder:"Enter price",step:"0.01"})]}),i.jsxs("div",{className:"order-summary",children:[i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Quantity:"}),i.jsxs("span",{children:[c," shares"]})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Price:"}),i.jsx("span",{children:xt(r==="market"?t.price:parseFloat(d)||0)})]}),i.jsxs("div",{className:"summary-row total",children:[i.jsx("span",{children:"Total:"}),i.jsx("span",{children:xt((r==="market"?t.price:parseFloat(d)||0)*c)})]})]}),i.jsxs("div",{className:"order-actions-grid",children:[i.jsx("button",{className:`place-order-btn ${o}`,onClick:Ys,disabled:!c||r!=="market"&&!d||p,children:p?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"loading-spinner sm"}),"Placing Order..."]}):o==="buy"?"Place Buy Order":"Place Sell Order"}),i.jsxs("button",{className:"enhanced-order-btn",onClick:()=>Kt(t,o),disabled:!t,children:[i.jsx(tt,{size:16}),"Enhanced Order"]})]})]})]}):i.jsxs("div",{className:"no-stock-selected",children:[i.jsx(vt,{size:48}),i.jsx("p",{children:"Select a stock to place an order"})]})})]}),i.jsxs(F.div,{className:"trading-card orders-panel",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{className:"card-title",children:[i.jsx(st,{className:"card-icon"}),"Recent Orders"]})}),i.jsx("div",{className:"card-content",children:i.jsx("div",{className:"orders-list",children:Fe.map((G,Me)=>i.jsxs(F.div,{className:"order-item",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:Me*.05},children:[i.jsxs("div",{className:"order-info",children:[i.jsx("div",{className:"order-symbol",children:G.symbol}),i.jsxs("div",{className:"order-details",children:[i.jsx("span",{className:`order-type ${G.type.toLowerCase()}`,children:G.type}),i.jsxs("span",{className:"order-quantity",children:[G.quantity," shares"]}),i.jsx("span",{className:"order-time",children:G.time})]})]}),i.jsxs("div",{className:"order-price",children:[i.jsx("div",{className:"price-value",children:xt(G.price)}),i.jsx("div",{className:"total-value",children:xt(G.total)})]}),i.jsxs("div",{className:"order-status",children:[G.status==="completed"&&i.jsx(kt,{className:"status-icon completed"}),G.status==="pending"&&i.jsx(st,{className:"status-icon pending"}),G.status==="cancelled"&&i.jsx(ps,{className:"status-icon cancelled"}),i.jsx("span",{className:`status-text ${G.status}`,children:G.status})]})]},G.id))})})]})]}),i.jsx(Ch,{isOpen:S||V.isOpen,onClose:()=>{k(!1),z()},stockData:C||V.stockData,initialOrderType:(C==null?void 0:C.initialOrderType)||V.orderType,onOrderPlaced:()=>{Te(),z()},onShowConfirmation:null}),i.jsx(Uy,{isOpen:ne.isOpen,position:ne.position,stockData:ne.stockData,onClose:oe,onQuickBuy:q,onQuickSell:Y,onViewChart:G=>te(G,"buy"),onAddToWatchlist:G=>console.log("Add to watchlist:",G.symbol),onViewDetails:G=>console.log("View details:",G.symbol),hasHolding:ne.stockData?P.holdings.some(G=>G.symbol===ne.stockData.symbol):!1}),i.jsx(Rh,{isOpen:ie,onClose:U,onConfirm:X,orderData:D,loading:$}),i.jsx(Wn,{stockData:B,isOpen:O,onClose:A,defaultQuantity:R,onSuccess:()=>{}})]})})},Ah=v.createContext(),Hy=({children:s})=>{const e=()=>{const c=localStorage.getItem("sidebarCollapsed");return c!==null?JSON.parse(c):window.innerWidth<=768},[t,n]=v.useState(e),[r,a]=v.useState(window.innerWidth<=768);v.useEffect(()=>{const c=()=>{const h=window.innerWidth<=768;a(h),h&&n(d=>d||(localStorage.setItem("sidebarCollapsed","true"),!0))};return c(),window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]);const l={isCollapsed:t,setIsCollapsed:n,isMobile:r,toggleSidebar:()=>{n(c=>{const h=!c;return localStorage.setItem("sidebarCollapsed",JSON.stringify(h)),h})},expandSidebar:()=>{n(()=>(localStorage.setItem("sidebarCollapsed","false"),!1))},collapseSidebar:()=>{n(()=>(localStorage.setItem("sidebarCollapsed","true"),!0))}};return i.jsx(Ah.Provider,{value:l,children:s})},Yy=()=>{const s=v.useContext(Ah);if(s===void 0)throw new Error("useSidebar must be used within a SidebarProvider");return s};function Ie(s){var e=s.width,t=s.height;if(e<0)throw new Error("Negative width is not allowed for Size");if(t<0)throw new Error("Negative height is not allowed for Size");return{width:e,height:t}}function us(s,e){return s.width===e.width&&s.height===e.height}var qy=function(){function s(e){var t=this;this._resolutionListener=function(){return t._onResolutionChanged()},this._resolutionMediaQueryList=null,this._observers=[],this._window=e,this._installResolutionListener()}return s.prototype.dispose=function(){this._uninstallResolutionListener(),this._window=null},Object.defineProperty(s.prototype,"value",{get:function(){return this._window.devicePixelRatio},enumerable:!1,configurable:!0}),s.prototype.subscribe=function(e){var t=this,n={next:e};return this._observers.push(n),{unsubscribe:function(){t._observers=t._observers.filter(function(r){return r!==n})}}},s.prototype._installResolutionListener=function(){if(this._resolutionMediaQueryList!==null)throw new Error("Resolution listener is already installed");var e=this._window.devicePixelRatio;this._resolutionMediaQueryList=this._window.matchMedia("all and (resolution: ".concat(e,"dppx)")),this._resolutionMediaQueryList.addListener(this._resolutionListener)},s.prototype._uninstallResolutionListener=function(){this._resolutionMediaQueryList!==null&&(this._resolutionMediaQueryList.removeListener(this._resolutionListener),this._resolutionMediaQueryList=null)},s.prototype._reinstallResolutionListener=function(){this._uninstallResolutionListener(),this._installResolutionListener()},s.prototype._onResolutionChanged=function(){var e=this;this._observers.forEach(function(t){return t.next(e._window.devicePixelRatio)}),this._reinstallResolutionListener()},s}();function Gy(s){return new qy(s)}var Qy=function(){function s(e,t,n){var r;this._canvasElement=null,this._bitmapSizeChangedListeners=[],this._suggestedBitmapSize=null,this._suggestedBitmapSizeChangedListeners=[],this._devicePixelRatioObservable=null,this._canvasElementResizeObserver=null,this._canvasElement=e,this._canvasElementClientSize=Ie({width:this._canvasElement.clientWidth,height:this._canvasElement.clientHeight}),this._transformBitmapSize=t??function(a){return a},this._allowResizeObserver=(r=n==null?void 0:n.allowResizeObserver)!==null&&r!==void 0?r:!0,this._chooseAndInitObserver()}return s.prototype.dispose=function(){var e,t;if(this._canvasElement===null)throw new Error("Object is disposed");(e=this._canvasElementResizeObserver)===null||e===void 0||e.disconnect(),this._canvasElementResizeObserver=null,(t=this._devicePixelRatioObservable)===null||t===void 0||t.dispose(),this._devicePixelRatioObservable=null,this._suggestedBitmapSizeChangedListeners.length=0,this._bitmapSizeChangedListeners.length=0,this._canvasElement=null},Object.defineProperty(s.prototype,"canvasElement",{get:function(){if(this._canvasElement===null)throw new Error("Object is disposed");return this._canvasElement},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"canvasElementClientSize",{get:function(){return this._canvasElementClientSize},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"bitmapSize",{get:function(){return Ie({width:this.canvasElement.width,height:this.canvasElement.height})},enumerable:!1,configurable:!0}),s.prototype.resizeCanvasElement=function(e){this._canvasElementClientSize=Ie(e),this.canvasElement.style.width="".concat(this._canvasElementClientSize.width,"px"),this.canvasElement.style.height="".concat(this._canvasElementClientSize.height,"px"),this._invalidateBitmapSize()},s.prototype.subscribeBitmapSizeChanged=function(e){this._bitmapSizeChangedListeners.push(e)},s.prototype.unsubscribeBitmapSizeChanged=function(e){this._bitmapSizeChangedListeners=this._bitmapSizeChangedListeners.filter(function(t){return t!==e})},Object.defineProperty(s.prototype,"suggestedBitmapSize",{get:function(){return this._suggestedBitmapSize},enumerable:!1,configurable:!0}),s.prototype.subscribeSuggestedBitmapSizeChanged=function(e){this._suggestedBitmapSizeChangedListeners.push(e)},s.prototype.unsubscribeSuggestedBitmapSizeChanged=function(e){this._suggestedBitmapSizeChangedListeners=this._suggestedBitmapSizeChangedListeners.filter(function(t){return t!==e})},s.prototype.applySuggestedBitmapSize=function(){if(this._suggestedBitmapSize!==null){var e=this._suggestedBitmapSize;this._suggestedBitmapSize=null,this._resizeBitmap(e),this._emitSuggestedBitmapSizeChanged(e,this._suggestedBitmapSize)}},s.prototype._resizeBitmap=function(e){var t=this.bitmapSize;us(t,e)||(this.canvasElement.width=e.width,this.canvasElement.height=e.height,this._emitBitmapSizeChanged(t,e))},s.prototype._emitBitmapSizeChanged=function(e,t){var n=this;this._bitmapSizeChangedListeners.forEach(function(r){return r.call(n,e,t)})},s.prototype._suggestNewBitmapSize=function(e){var t=this._suggestedBitmapSize,n=Ie(this._transformBitmapSize(e,this._canvasElementClientSize)),r=us(this.bitmapSize,n)?null:n;t===null&&r===null||t!==null&&r!==null&&us(t,r)||(this._suggestedBitmapSize=r,this._emitSuggestedBitmapSizeChanged(t,r))},s.prototype._emitSuggestedBitmapSizeChanged=function(e,t){var n=this;this._suggestedBitmapSizeChangedListeners.forEach(function(r){return r.call(n,e,t)})},s.prototype._chooseAndInitObserver=function(){var e=this;if(!this._allowResizeObserver){this._initDevicePixelRatioObservable();return}Jy().then(function(t){return t?e._initResizeObserver():e._initDevicePixelRatioObservable()})},s.prototype._initDevicePixelRatioObservable=function(){var e=this;if(this._canvasElement!==null){var t=rl(this._canvasElement);if(t===null)throw new Error("No window is associated with the canvas");this._devicePixelRatioObservable=Gy(t),this._devicePixelRatioObservable.subscribe(function(){return e._invalidateBitmapSize()}),this._invalidateBitmapSize()}},s.prototype._invalidateBitmapSize=function(){var e,t;if(this._canvasElement!==null){var n=rl(this._canvasElement);if(n!==null){var r=(t=(e=this._devicePixelRatioObservable)===null||e===void 0?void 0:e.value)!==null&&t!==void 0?t:n.devicePixelRatio,a=this._canvasElement.getClientRects(),o=a[0]!==void 0?Xy(a[0],r):Ie({width:this._canvasElementClientSize.width*r,height:this._canvasElementClientSize.height*r});this._suggestNewBitmapSize(o)}}},s.prototype._initResizeObserver=function(){var e=this;this._canvasElement!==null&&(this._canvasElementResizeObserver=new ResizeObserver(function(t){var n=t.find(function(o){return o.target===e._canvasElement});if(!(!n||!n.devicePixelContentBoxSize||!n.devicePixelContentBoxSize[0])){var r=n.devicePixelContentBoxSize[0],a=Ie({width:r.inlineSize,height:r.blockSize});e._suggestNewBitmapSize(a)}}),this._canvasElementResizeObserver.observe(this._canvasElement,{box:"device-pixel-content-box"}))},s}();function Ky(s,e){return new Qy(s,e.transform,e.options)}function rl(s){return s.ownerDocument.defaultView}function Jy(){return new Promise(function(s){var e=new ResizeObserver(function(t){s(t.every(function(n){return"devicePixelContentBoxSize"in n})),e.disconnect()});e.observe(document.body,{box:"device-pixel-content-box"})}).catch(function(){return!1})}function Xy(s,e){return Ie({width:Math.round(s.left*e+s.width*e)-Math.round(s.left*e),height:Math.round(s.top*e+s.height*e)-Math.round(s.top*e)})}var Zy=function(){function s(e,t,n){if(t.width===0||t.height===0)throw new TypeError("Rendering target could only be created on a media with positive width and height");if(this._mediaSize=t,n.width===0||n.height===0)throw new TypeError("Rendering target could only be created using a bitmap with positive integer width and height");this._bitmapSize=n,this._context=e}return s.prototype.useMediaCoordinateSpace=function(e){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),this._context.scale(this._horizontalPixelRatio,this._verticalPixelRatio),e({context:this._context,mediaSize:this._mediaSize})}finally{this._context.restore()}},s.prototype.useBitmapCoordinateSpace=function(e){try{return this._context.save(),this._context.setTransform(1,0,0,1,0,0),e({context:this._context,mediaSize:this._mediaSize,bitmapSize:this._bitmapSize,horizontalPixelRatio:this._horizontalPixelRatio,verticalPixelRatio:this._verticalPixelRatio})}finally{this._context.restore()}},Object.defineProperty(s.prototype,"_horizontalPixelRatio",{get:function(){return this._bitmapSize.width/this._mediaSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"_verticalPixelRatio",{get:function(){return this._bitmapSize.height/this._mediaSize.height},enumerable:!1,configurable:!0}),s}();function vs(s,e){var t=s.canvasElementClientSize;if(t.width===0||t.height===0)return null;var n=s.bitmapSize;if(n.width===0||n.height===0)return null;var r=s.canvasElement.getContext("2d",e);return r===null?null:new Zy(r,t,n)}/*!
 * @license
 * TradingView Lightweight Charts™ v5.0.8
 * Copyright (c) 2025 TradingView, Inc.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */const Oh={title:"",visible:!0,lastValueVisible:!0,priceLineVisible:!0,priceLineSource:0,priceLineWidth:1,priceLineColor:"",priceLineStyle:2,baseLineVisible:!0,baseLineWidth:1,baseLineColor:"#B2B5BE",baseLineStyle:0,priceFormat:{type:"price",precision:2,minMove:.01}};var al,ol;function xs(s,e){const t={0:[],1:[s.lineWidth,s.lineWidth],2:[2*s.lineWidth,2*s.lineWidth],3:[6*s.lineWidth,6*s.lineWidth],4:[s.lineWidth,4*s.lineWidth]}[e];s.setLineDash(t)}function Fh(s,e,t,n){s.beginPath();const r=s.lineWidth%2?.5:0;s.moveTo(t,e+r),s.lineTo(n,e+r),s.stroke()}function Ge(s,e){if(!s)throw new Error("Assertion failed"+(e?": "+e:""))}function ct(s){if(s===void 0)throw new Error("Value is undefined");return s}function Q(s){if(s===null)throw new Error("Value is null");return s}function Yt(s){return Q(ct(s))}(function(s){s[s.Simple=0]="Simple",s[s.WithSteps=1]="WithSteps",s[s.Curved=2]="Curved"})(al||(al={})),function(s){s[s.Solid=0]="Solid",s[s.Dotted=1]="Dotted",s[s.Dashed=2]="Dashed",s[s.LargeDashed=3]="LargeDashed",s[s.SparseDotted=4]="SparseDotted"}(ol||(ol={}));class Be{constructor(){this.t=[]}i(e,t,n){const r={h:e,l:t,o:n===!0};this.t.push(r)}_(e){const t=this.t.findIndex(n=>e===n.h);t>-1&&this.t.splice(t,1)}u(e){this.t=this.t.filter(t=>t.l!==e)}p(e,t,n){const r=[...this.t];this.t=this.t.filter(a=>!a.o),r.forEach(a=>a.h(e,t,n))}v(){return this.t.length>0}m(){this.t=[]}}function dt(s,...e){for(const t of e)for(const n in t)t[n]!==void 0&&Object.prototype.hasOwnProperty.call(t,n)&&!["__proto__","constructor","prototype"].includes(n)&&(typeof t[n]!="object"||s[n]===void 0||Array.isArray(t[n])?s[n]=t[n]:dt(s[n],t[n]));return s}function Bs(s){return typeof s=="number"&&isFinite(s)}function yi(s){return typeof s=="number"&&s%1==0}function Ti(s){return typeof s=="string"}function $i(s){return typeof s=="boolean"}function Mt(s){const e=s;if(!e||typeof e!="object")return e;let t,n,r;for(n in t=Array.isArray(e)?[]:{},e)e.hasOwnProperty(n)&&(r=e[n],t[n]=r&&typeof r=="object"?Mt(r):r);return t}function e0(s){return s!==null}function vi(s){return s===null?void 0:s}const Bh="-apple-system, BlinkMacSystemFont, 'Trebuchet MS', Roboto, Ubuntu, sans-serif";function yn(s,e,t){return e===void 0&&(e=Bh),`${t=t!==void 0?`${t} `:""}${s}px ${e}`}class t0{constructor(e){this.M={S:1,C:5,P:NaN,k:"",T:"",R:"",D:"",V:0,I:0,B:0,A:0,L:0},this.O=e}N(){const e=this.M,t=this.F(),n=this.W();return e.P===t&&e.T===n||(e.P=t,e.T=n,e.k=yn(t,n),e.A=2.5/12*t,e.V=e.A,e.I=t/12*e.C,e.B=t/12*e.C,e.L=0),e.R=this.H(),e.D=this.U(),this.M}H(){return this.O.N().layout.textColor}U(){return this.O.$()}F(){return this.O.N().layout.fontSize}W(){return this.O.N().layout.fontFamily}}function kr(s){return s<0?0:s>255?255:Math.round(s)||0}function ll(s){return .199*s[0]+.687*s[1]+.114*s[2]}class s0{constructor(e,t){this.q=new Map,this.Y=e,t&&(this.q=t)}j(e,t){if(e==="transparent")return e;const n=this.K(e),r=n[3];return`rgba(${n[0]}, ${n[1]}, ${n[2]}, ${t*r})`}X(e){const t=this.K(e);return{Z:`rgb(${t[0]}, ${t[1]}, ${t[2]})`,G:ll(t)>160?"black":"white"}}J(e){return ll(this.K(e))}tt(e,t,n){const[r,a,o,l]=this.K(e),[c,h,d,m]=this.K(t),x=[kr(r+n*(c-r)),kr(a+n*(h-a)),kr(o+n*(d-o)),(b=l+n*(m-l),b<=0||b>1?Math.min(Math.max(b,0),1):Math.round(1e4*b)/1e4)];var b;return`rgba(${x[0]}, ${x[1]}, ${x[2]}, ${x[3]})`}K(e){const t=this.q.get(e);if(t)return t;const n=function(o){const l=document.createElement("div");l.style.display="none",document.body.appendChild(l),l.style.color=o;const c=window.getComputedStyle(l).color;return document.body.removeChild(l),c}(e),r=n.match(/^rgba?\s*\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d+))?\)$/);if(!r){if(this.Y.length)for(const o of this.Y){const l=o(e);if(l)return this.q.set(e,l),l}throw new Error(`Failed to parse color: ${e}`)}const a=[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10),r[4]?parseFloat(r[4]):1];return this.q.set(e,a),a}}class Dh{constructor(){this.it=[]}st(e){this.it=e}nt(e,t,n){this.it.forEach(r=>{r.nt(e,t,n)})}}class zt{nt(e,t,n){e.useBitmapCoordinateSpace(r=>this.et(r,t,n))}}class i0 extends zt{constructor(){super(...arguments),this.rt=null}ht(e){this.rt=e}et({context:e,horizontalPixelRatio:t,verticalPixelRatio:n}){if(this.rt===null||this.rt.lt===null)return;const r=this.rt.lt,a=this.rt,o=Math.max(1,Math.floor(t))%2/2,l=c=>{e.beginPath();for(let h=r.to-1;h>=r.from;--h){const d=a.ot[h],m=Math.round(d._t*t)+o,x=d.ut*n,b=c*n+o;e.moveTo(m,x),e.arc(m,x,b,0,2*Math.PI)}e.fill()};a.ct>0&&(e.fillStyle=a.dt,l(a.ft+a.ct)),e.fillStyle=a.vt,l(a.ft)}}function n0(){return{ot:[{_t:0,ut:0,wt:0,gt:0}],vt:"",dt:"",ft:0,ct:0,lt:null}}const r0={from:0,to:1};class a0{constructor(e,t,n){this.Mt=new Dh,this.bt=[],this.St=[],this.xt=!0,this.O=e,this.Ct=t,this.Pt=n,this.Mt.st(this.bt)}kt(e){this.yt(),this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Mt}yt(){const e=this.Pt.Dt();e.length!==this.bt.length&&(this.St=e.map(n0),this.bt=this.St.map(t=>{const n=new i0;return n.ht(t),n}),this.Mt.st(this.bt))}Rt(){const e=this.Ct.N().mode===2||!this.Ct.Vt(),t=this.Pt.It(),n=this.Ct.Bt(),r=this.O.Et();this.yt(),t.forEach((a,o)=>{const l=this.St[o],c=a.At(n),h=a.zt();!e&&c!==null&&a.Vt()&&h!==null?(l.vt=c.Lt,l.ft=c.ft,l.ct=c.Ot,l.ot[0].gt=c.gt,l.ot[0].ut=a.Ft().Nt(c.gt,h.Wt),l.dt=c.Ht??this.O.Ut(l.ot[0].ut/a.Ft().$t()),l.ot[0].wt=n,l.ot[0]._t=r.qt(n),l.lt=r0):l.lt=null})}}class o0 extends zt{constructor(e){super(),this.Yt=e}et({context:e,bitmapSize:t,horizontalPixelRatio:n,verticalPixelRatio:r}){if(this.Yt===null)return;const a=this.Yt.jt.Vt,o=this.Yt.Kt.Vt;if(!a&&!o)return;const l=Math.round(this.Yt._t*n),c=Math.round(this.Yt.ut*r);e.lineCap="butt",a&&l>=0&&(e.lineWidth=Math.floor(this.Yt.jt.ct*n),e.strokeStyle=this.Yt.jt.R,e.fillStyle=this.Yt.jt.R,xs(e,this.Yt.jt.Xt),function(h,d,m,x){h.beginPath();const b=h.lineWidth%2?.5:0;h.moveTo(d+b,m),h.lineTo(d+b,x),h.stroke()}(e,l,0,t.height)),o&&c>=0&&(e.lineWidth=Math.floor(this.Yt.Kt.ct*r),e.strokeStyle=this.Yt.Kt.R,e.fillStyle=this.Yt.Kt.R,xs(e,this.Yt.Kt.Xt),Fh(e,c,0,t.width))}}class l0{constructor(e,t){this.xt=!0,this.Zt={jt:{ct:1,Xt:0,R:"",Vt:!1},Kt:{ct:1,Xt:0,R:"",Vt:!1},_t:0,ut:0},this.Gt=new o0(this.Zt),this.Jt=e,this.Pt=t}kt(){this.xt=!0}Tt(e){return this.xt&&(this.Rt(),this.xt=!1),this.Gt}Rt(){const e=this.Jt.Vt(),t=this.Pt.Qt().N().crosshair,n=this.Zt;if(t.mode===2)return n.Kt.Vt=!1,void(n.jt.Vt=!1);n.Kt.Vt=e&&this.Jt.ti(this.Pt),n.jt.Vt=e&&this.Jt.ii(),n.Kt.ct=t.horzLine.width,n.Kt.Xt=t.horzLine.style,n.Kt.R=t.horzLine.color,n.jt.ct=t.vertLine.width,n.jt.Xt=t.vertLine.style,n.jt.R=t.vertLine.color,n._t=this.Jt.si(),n.ut=this.Jt.ni()}}function c0(s,e,t,n,r,a){s.fillRect(e+a,t,n-2*a,a),s.fillRect(e+a,t+r-a,n-2*a,a),s.fillRect(e,t,a,r),s.fillRect(e+n-a,t,a,r)}function Hn(s,e,t,n,r,a){s.save(),s.globalCompositeOperation="copy",s.fillStyle=a,s.fillRect(e,t,n,r),s.restore()}function cl(s,e,t,n,r,a){s.beginPath(),s.roundRect?s.roundRect(e,t,n,r,a):(s.lineTo(e+n-a[1],t),a[1]!==0&&s.arcTo(e+n,t,e+n,t+a[1],a[1]),s.lineTo(e+n,t+r-a[2]),a[2]!==0&&s.arcTo(e+n,t+r,e+n-a[2],t+r,a[2]),s.lineTo(e+a[3],t+r),a[3]!==0&&s.arcTo(e,t+r,e,t+r-a[3],a[3]),s.lineTo(e,t+a[0]),a[0]!==0&&s.arcTo(e,t,e+a[0],t,a[0]))}function hl(s,e,t,n,r,a,o=0,l=[0,0,0,0],c=""){if(s.save(),!o||!c||c===a)return cl(s,e,t,n,r,l),s.fillStyle=a,s.fill(),void s.restore();const h=o/2;var d;cl(s,e+h,t+h,n-o,r-o,(d=-h,l.map(m=>m===0?m:m+d))),a!=="transparent"&&(s.fillStyle=a,s.fill()),c!=="transparent"&&(s.lineWidth=o,s.strokeStyle=c,s.closePath(),s.stroke()),s.restore()}function $h(s,e,t,n,r,a,o){s.save(),s.globalCompositeOperation="copy";const l=s.createLinearGradient(0,0,0,r);l.addColorStop(0,a),l.addColorStop(1,o),s.fillStyle=l,s.fillRect(e,t,n,r),s.restore()}class dl{constructor(e,t){this.ht(e,t)}ht(e,t){this.Yt=e,this.ei=t}$t(e,t){return this.Yt.Vt?e.P+e.A+e.V:0}nt(e,t,n,r){if(!this.Yt.Vt||this.Yt.ri.length===0)return;const a=this.Yt.R,o=this.ei.Z,l=e.useBitmapCoordinateSpace(c=>{const h=c.context;h.font=t.k;const d=this.hi(c,t,n,r),m=d.ai;return d.li?hl(h,m.oi,m._i,m.ui,m.ci,o,m.di,[m.ft,0,0,m.ft],o):hl(h,m.fi,m._i,m.ui,m.ci,o,m.di,[0,m.ft,m.ft,0],o),this.Yt.pi&&(h.fillStyle=a,h.fillRect(m.fi,m.mi,m.wi-m.fi,m.gi)),this.Yt.Mi&&(h.fillStyle=t.D,h.fillRect(d.li?m.bi-m.di:0,m._i,m.di,m.Si-m._i)),d});e.useMediaCoordinateSpace(({context:c})=>{const h=l.xi;c.font=t.k,c.textAlign=l.li?"right":"left",c.textBaseline="middle",c.fillStyle=a,c.fillText(this.Yt.ri,h.Ci,(h._i+h.Si)/2+h.Pi)})}hi(e,t,n,r){const{context:a,bitmapSize:o,mediaSize:l,horizontalPixelRatio:c,verticalPixelRatio:h}=e,d=this.Yt.pi||!this.Yt.ki?t.C:0,m=this.Yt.yi?t.S:0,x=t.A+this.ei.Ti,b=t.V+this.ei.Ri,p=t.I,g=t.B,f=this.Yt.ri,y=t.P,S=n.Di(a,f),k=Math.ceil(n.Vi(a,f)),C=y+x+b,N=t.S+p+g+k+d,T=Math.max(1,Math.floor(h));let I=Math.round(C*h);I%2!=T%2&&(I+=1);const P=m>0?Math.max(1,Math.floor(m*c)):0,L=Math.round(N*c),M=Math.round(d*c),O=this.ei.Ii??this.ei.Bi,B=Math.round(O*h)-Math.floor(.5*h),R=Math.floor(B+T/2-I/2),A=R+I,V=r==="right",z=V?l.width-m:m,q=V?o.width-P:P;let Y,te,ne;return V?(Y=q-L,te=q-M,ne=z-d-p-m):(Y=q+L,te=q+M,ne=z+d+p),{li:V,ai:{_i:R,mi:B,Si:A,ui:L,ci:I,ft:2*c,di:P,oi:Y,fi:q,wi:te,gi:T,bi:o.width},xi:{_i:R/h,Si:A/h,Ci:ne,Pi:S}}}}class Yn{constructor(e){this.Ei={Bi:0,Z:"#000",Ri:0,Ti:0},this.Ai={ri:"",Vt:!1,pi:!0,ki:!1,Ht:"",R:"#FFF",Mi:!1,yi:!1},this.zi={ri:"",Vt:!1,pi:!1,ki:!0,Ht:"",R:"#FFF",Mi:!0,yi:!0},this.xt=!0,this.Li=new(e||dl)(this.Ai,this.Ei),this.Oi=new(e||dl)(this.zi,this.Ei)}ri(){return this.Ni(),this.Ai.ri}Bi(){return this.Ni(),this.Ei.Bi}kt(){this.xt=!0}$t(e,t=!1){return Math.max(this.Li.$t(e,t),this.Oi.$t(e,t))}Fi(){return this.Ei.Ii||0}Wi(e){this.Ei.Ii=e}Hi(){return this.Ni(),this.Ai.Vt||this.zi.Vt}Ui(){return this.Ni(),this.Ai.Vt}Tt(e){return this.Ni(),this.Ai.pi=this.Ai.pi&&e.N().ticksVisible,this.zi.pi=this.zi.pi&&e.N().ticksVisible,this.Li.ht(this.Ai,this.Ei),this.Oi.ht(this.zi,this.Ei),this.Li}$i(){return this.Ni(),this.Li.ht(this.Ai,this.Ei),this.Oi.ht(this.zi,this.Ei),this.Oi}Ni(){this.xt&&(this.Ai.pi=!0,this.zi.pi=!1,this.qi(this.Ai,this.zi,this.Ei))}}class h0 extends Yn{constructor(e,t,n){super(),this.Jt=e,this.Yi=t,this.ji=n}qi(e,t,n){if(e.Vt=!1,this.Jt.N().mode===2)return;const r=this.Jt.N().horzLine;if(!r.labelVisible)return;const a=this.Yi.zt();if(!this.Jt.Vt()||this.Yi.Ki()||a===null)return;const o=this.Yi.Xi().X(r.labelBackgroundColor);n.Z=o.Z,e.R=o.G;const l=2/12*this.Yi.P();n.Ti=l,n.Ri=l;const c=this.ji(this.Yi);n.Bi=c.Bi,e.ri=this.Yi.Zi(c.gt,a),e.Vt=!0}}const d0=/[1-9]/g;class zh{constructor(){this.Yt=null}ht(e){this.Yt=e}nt(e,t){if(this.Yt===null||this.Yt.Vt===!1||this.Yt.ri.length===0)return;const n=e.useMediaCoordinateSpace(({context:x})=>(x.font=t.k,Math.round(t.Gi.Vi(x,Q(this.Yt).ri,d0))));if(n<=0)return;const r=t.Ji,a=n+2*r,o=a/2,l=this.Yt.Qi;let c=this.Yt.Bi,h=Math.floor(c-o)+.5;h<0?(c+=Math.abs(0-h),h=Math.floor(c-o)+.5):h+a>l&&(c-=Math.abs(l-(h+a)),h=Math.floor(c-o)+.5);const d=h+a,m=Math.ceil(0+t.S+t.C+t.A+t.P+t.V);e.useBitmapCoordinateSpace(({context:x,horizontalPixelRatio:b,verticalPixelRatio:p})=>{const g=Q(this.Yt);x.fillStyle=g.Z;const f=Math.round(h*b),y=Math.round(0*p),S=Math.round(d*b),k=Math.round(m*p),C=Math.round(2*b);if(x.beginPath(),x.moveTo(f,y),x.lineTo(f,k-C),x.arcTo(f,k,f+C,k,C),x.lineTo(S-C,k),x.arcTo(S,k,S,k-C,C),x.lineTo(S,y),x.fill(),g.pi){const N=Math.round(g.Bi*b),T=y,I=Math.round((T+t.C)*p);x.fillStyle=g.R;const P=Math.max(1,Math.floor(b)),L=Math.floor(.5*b);x.fillRect(N-L,T,P,I-T)}}),e.useMediaCoordinateSpace(({context:x})=>{const b=Q(this.Yt),p=0+t.S+t.C+t.A+t.P/2;x.font=t.k,x.textAlign="left",x.textBaseline="middle",x.fillStyle=b.R;const g=t.Gi.Di(x,"Apr0");x.translate(h+r,p+g),x.fillText(b.ri,0,0)})}}class u0{constructor(e,t,n){this.xt=!0,this.Gt=new zh,this.Zt={Vt:!1,Z:"#4c525e",R:"white",ri:"",Qi:0,Bi:NaN,pi:!0},this.Ct=e,this.ts=t,this.ji=n}kt(){this.xt=!0}Tt(){return this.xt&&(this.Rt(),this.xt=!1),this.Gt.ht(this.Zt),this.Gt}Rt(){const e=this.Zt;if(e.Vt=!1,this.Ct.N().mode===2)return;const t=this.Ct.N().vertLine;if(!t.labelVisible)return;const n=this.ts.Et();if(n.Ki())return;e.Qi=n.Qi();const r=this.ji();if(r===null)return;e.Bi=r.Bi;const a=n.ss(this.Ct.Bt());e.ri=n.ns(Q(a)),e.Vt=!0;const o=this.ts.Xi().X(t.labelBackgroundColor);e.Z=o.Z,e.R=o.G,e.pi=n.N().ticksVisible}}class Uh{constructor(){this.es=null,this.rs=0}hs(){return this.rs}ls(e){this.rs=e}Ft(){return this.es}_s(e){this.es=e}us(e){return[]}cs(){return[]}Vt(){return!0}}var ul;(function(s){s[s.Normal=0]="Normal",s[s.Magnet=1]="Magnet",s[s.Hidden=2]="Hidden",s[s.MagnetOHLC=3]="MagnetOHLC"})(ul||(ul={}));class m0 extends Uh{constructor(e,t){super(),this.Pt=null,this.ds=NaN,this.fs=0,this.ps=!1,this.vs=new Map,this.ws=!1,this.gs=new WeakMap,this.Ms=new WeakMap,this.bs=NaN,this.Ss=NaN,this.xs=NaN,this.Cs=NaN,this.ts=e,this.Ps=t,this.ks=((r,a)=>o=>{const l=a(),c=r();if(o===Q(this.Pt).ys())return{gt:c,Bi:l};{const h=Q(o.zt());return{gt:o.Ts(l,h),Bi:l}}})(()=>this.ds,()=>this.Ss);const n=((r,a)=>()=>{const o=this.ts.Et().Rs(r()),l=a();return o&&Number.isFinite(l)?{wt:o,Bi:l}:null})(()=>this.fs,()=>this.si());this.Ds=new u0(this,e,n)}N(){return this.Ps}Vs(e,t){this.xs=e,this.Cs=t}Is(){this.xs=NaN,this.Cs=NaN}Bs(){return this.xs}Es(){return this.Cs}As(e,t,n){this.ws||(this.ws=!0),this.ps=!0,this.zs(e,t,n)}Bt(){return this.fs}si(){return this.bs}ni(){return this.Ss}Vt(){return this.ps}Ls(){this.ps=!1,this.Os(),this.ds=NaN,this.bs=NaN,this.Ss=NaN,this.Pt=null,this.Is(),this.Ns()}Fs(e){let t=this.gs.get(e);t||(t=new l0(this,e),this.gs.set(e,t));let n=this.Ms.get(e);return n||(n=new a0(this.ts,this,e),this.Ms.set(e,n)),[t,n]}ti(e){return e===this.Pt&&this.Ps.horzLine.visible}ii(){return this.Ps.vertLine.visible}Ws(e,t){this.ps&&this.Pt===e||this.vs.clear();const n=[];return this.Pt===e&&n.push(this.Hs(this.vs,t,this.ks)),n}cs(){return this.ps?[this.Ds]:[]}Us(){return this.Pt}Ns(){this.ts.$s().forEach(e=>{var t,n;(t=this.gs.get(e))==null||t.kt(),(n=this.Ms.get(e))==null||n.kt()}),this.vs.forEach(e=>e.kt()),this.Ds.kt()}qs(e){return e&&!e.ys().Ki()?e.ys():null}zs(e,t,n){this.Ys(e,t,n)&&this.Ns()}Ys(e,t,n){const r=this.bs,a=this.Ss,o=this.ds,l=this.fs,c=this.Pt,h=this.qs(n);this.fs=e,this.bs=isNaN(e)?NaN:this.ts.Et().qt(e),this.Pt=n;const d=h!==null?h.zt():null;return h!==null&&d!==null?(this.ds=t,this.Ss=h.Nt(t,d)):(this.ds=NaN,this.Ss=NaN),r!==this.bs||a!==this.Ss||l!==this.fs||o!==this.ds||c!==this.Pt}Os(){const e=this.ts.js().map(n=>n.Xs().Ks()).filter(e0),t=e.length===0?null:Math.max(...e);this.fs=t!==null?t:NaN}Hs(e,t,n){let r=e.get(t);return r===void 0&&(r=new h0(this,t,n),e.set(t,r)),r}}function qn(s){return s==="left"||s==="right"}class qe{constructor(e){this.Zs=new Map,this.Gs=[],this.Js=e}Qs(e,t){const n=function(r,a){return r===void 0?a:{tn:Math.max(r.tn,a.tn),sn:r.sn||a.sn}}(this.Zs.get(e),t);this.Zs.set(e,n)}nn(){return this.Js}en(e){const t=this.Zs.get(e);return t===void 0?{tn:this.Js}:{tn:Math.max(this.Js,t.tn),sn:t.sn}}rn(){this.hn(),this.Gs=[{an:0}]}ln(e){this.hn(),this.Gs=[{an:1,Wt:e}]}_n(e){this.un(),this.Gs.push({an:5,Wt:e})}hn(){this.un(),this.Gs.push({an:6})}cn(){this.hn(),this.Gs=[{an:4}]}dn(e){this.hn(),this.Gs.push({an:2,Wt:e})}fn(e){this.hn(),this.Gs.push({an:3,Wt:e})}pn(){return this.Gs}vn(e){for(const t of e.Gs)this.mn(t);this.Js=Math.max(this.Js,e.Js),e.Zs.forEach((t,n)=>{this.Qs(n,t)})}static wn(){return new qe(2)}static gn(){return new qe(3)}mn(e){switch(e.an){case 0:this.rn();break;case 1:this.ln(e.Wt);break;case 2:this.dn(e.Wt);break;case 3:this.fn(e.Wt);break;case 4:this.cn();break;case 5:this._n(e.Wt);break;case 6:this.un()}}un(){const e=this.Gs.findIndex(t=>t.an===5);e!==-1&&this.Gs.splice(e,1)}}class Wh{formatTickmarks(e){return e.map(t=>this.format(t))}}const ml=".";function Rt(s,e){if(!Bs(s))return"n/a";if(!yi(e))throw new TypeError("invalid length");if(e<0||e>16)throw new TypeError("invalid length");return e===0?s.toString():("0000000000000000"+s.toString()).slice(-e)}class Gn extends Wh{constructor(e,t){if(super(),t||(t=1),Bs(e)&&yi(e)||(e=100),e<0)throw new TypeError("invalid base");this.Yi=e,this.Mn=t,this.bn()}format(e){const t=e<0?"−":"";return e=Math.abs(e),t+this.Sn(e)}bn(){if(this.xn=0,this.Yi>0&&this.Mn>0){let e=this.Yi;for(;e>1;)e/=10,this.xn++}}Sn(e){const t=this.Yi/this.Mn;let n=Math.floor(e),r="";const a=this.xn!==void 0?this.xn:NaN;if(t>1){let o=+(Math.round(e*t)-n*t).toFixed(this.xn);o>=t&&(o-=t,n+=1),r=ml+Rt(+o.toFixed(this.xn)*this.Mn,a)}else n=Math.round(n*t)/t,a>0&&(r=ml+Rt(0,a));return n.toFixed(0)+r}}class Vh extends Gn{constructor(e=100){super(e)}format(e){return`${super.format(e)}%`}}class f0 extends Wh{constructor(e){super(),this.Cn=e}format(e){let t="";return e<0&&(t="-",e=-e),e<995?t+this.Pn(e):e<999995?t+this.Pn(e/1e3)+"K":e<999999995?(e=1e3*Math.round(e/1e3),t+this.Pn(e/1e6)+"M"):(e=1e6*Math.round(e/1e6),t+this.Pn(e/1e9)+"B")}Pn(e){let t;const n=Math.pow(10,this.Cn);return t=(e=Math.round(e*n)/n)>=1e-15&&e<1?e.toFixed(this.Cn).replace(/\.?0+$/,""):String(e),t.replace(/(\.[1-9]*)0+$/,(r,a)=>a)}}const p0=/[2-9]/g;class vn{constructor(e=50){this.kn=0,this.yn=1,this.Tn=1,this.Rn={},this.Dn=new Map,this.Vn=e}In(){this.kn=0,this.Dn.clear(),this.yn=1,this.Tn=1,this.Rn={}}Vi(e,t,n){return this.Bn(e,t,n).width}Di(e,t,n){const r=this.Bn(e,t,n);return((r.actualBoundingBoxAscent||0)-(r.actualBoundingBoxDescent||0))/2}Bn(e,t,n){const r=n||p0,a=String(t).replace(r,"0");if(this.Dn.has(a))return ct(this.Dn.get(a)).En;if(this.kn===this.Vn){const l=this.Rn[this.Tn];delete this.Rn[this.Tn],this.Dn.delete(l),this.Tn++,this.kn--}e.save(),e.textBaseline="middle";const o=e.measureText(a);return e.restore(),o.width===0&&t.length||(this.Dn.set(a,{En:o,An:this.yn}),this.Rn[this.yn]=a,this.kn++,this.yn++),o}}class g0{constructor(e){this.zn=null,this.M=null,this.Ln="right",this.On=e}Nn(e,t,n){this.zn=e,this.M=t,this.Ln=n}nt(e){this.M!==null&&this.zn!==null&&this.zn.nt(e,this.M,this.On,this.Ln)}}class Hh{constructor(e,t,n){this.Fn=e,this.On=new vn(50),this.Wn=t,this.O=n,this.F=-1,this.Gt=new g0(this.On)}Tt(){const e=this.O.Hn(this.Wn);if(e===null)return null;const t=e.Un(this.Wn)?e.$n():this.Wn.Ft();if(t===null)return null;const n=e.qn(t);if(n==="overlay")return null;const r=this.O.Yn();return r.P!==this.F&&(this.F=r.P,this.On.In()),this.Gt.Nn(this.Fn.$i(),r,n),this.Gt}}class y0 extends zt{constructor(){super(...arguments),this.Yt=null}ht(e){this.Yt=e}jn(e,t){var o;if(!((o=this.Yt)!=null&&o.Vt))return null;const{ut:n,ct:r,Kn:a}=this.Yt;return t>=n-r-7&&t<=n+r+7?{Xn:this.Yt,Kn:a}:null}et({context:e,bitmapSize:t,horizontalPixelRatio:n,verticalPixelRatio:r}){if(this.Yt===null||this.Yt.Vt===!1)return;const a=Math.round(this.Yt.ut*r);a<0||a>t.height||(e.lineCap="butt",e.strokeStyle=this.Yt.R,e.lineWidth=Math.floor(this.Yt.ct*n),xs(e,this.Yt.Xt),Fh(e,a,0,t.width))}}class Ka{constructor(e){this.Zn={ut:0,R:"rgba(0, 0, 0, 0)",ct:1,Xt:0,Vt:!1},this.Gn=new y0,this.xt=!0,this.Jn=e,this.Qn=e.Qt(),this.Gn.ht(this.Zn)}kt(){this.xt=!0}Tt(){return this.Jn.Vt()?(this.xt&&(this.te(),this.xt=!1),this.Gn):null}}class v0 extends Ka{constructor(e){super(e)}te(){this.Zn.Vt=!1;const e=this.Jn.Ft(),t=e.ie().ie;if(t!==2&&t!==3)return;const n=this.Jn.N();if(!n.baseLineVisible||!this.Jn.Vt())return;const r=this.Jn.zt();r!==null&&(this.Zn.Vt=!0,this.Zn.ut=e.Nt(r.Wt,r.Wt),this.Zn.R=n.baseLineColor,this.Zn.ct=n.baseLineWidth,this.Zn.Xt=n.baseLineStyle)}}class x0 extends zt{constructor(){super(...arguments),this.Yt=null}ht(e){this.Yt=e}se(){return this.Yt}et({context:e,horizontalPixelRatio:t,verticalPixelRatio:n}){const r=this.Yt;if(r===null)return;const a=Math.max(1,Math.floor(t)),o=a%2/2,l=Math.round(r.ne.x*t)+o,c=r.ne.y*n;e.fillStyle=r.ee,e.beginPath();const h=Math.max(2,1.5*r.re)*t;e.arc(l,c,h,0,2*Math.PI,!1),e.fill(),e.fillStyle=r.he,e.beginPath(),e.arc(l,c,r.ft*t,0,2*Math.PI,!1),e.fill(),e.lineWidth=a,e.strokeStyle=r.ae,e.beginPath(),e.arc(l,c,r.ft*t+a/2,0,2*Math.PI,!1),e.stroke()}}const b0=[{le:0,oe:.25,_e:4,ue:10,ce:.25,de:0,fe:.4,pe:.8},{le:.25,oe:.525,_e:10,ue:14,ce:0,de:0,fe:.8,pe:0},{le:.525,oe:1,_e:14,ue:14,ce:0,de:0,fe:0,pe:0}];class w0{constructor(e){this.Gt=new x0,this.xt=!0,this.ve=!0,this.me=performance.now(),this.we=this.me-1,this.ge=e}Me(){this.we=this.me-1,this.kt()}be(){if(this.kt(),this.ge.N().lastPriceAnimation===2){const e=performance.now(),t=this.we-e;if(t>0)return void(t<650&&(this.we+=2600));this.me=e,this.we=e+2600}}kt(){this.xt=!0}Se(){this.ve=!0}Vt(){return this.ge.N().lastPriceAnimation!==0}xe(){switch(this.ge.N().lastPriceAnimation){case 0:return!1;case 1:return!0;case 2:return performance.now()<=this.we}}Tt(){return this.xt?(this.Rt(),this.xt=!1,this.ve=!1):this.ve&&(this.Ce(),this.ve=!1),this.Gt}Rt(){this.Gt.ht(null);const e=this.ge.Qt().Et(),t=e.Pe(),n=this.ge.zt();if(t===null||n===null)return;const r=this.ge.ke(!0);if(r.ye||!t.Te(r.Re))return;const a={x:e.qt(r.Re),y:this.ge.Ft().Nt(r.gt,n.Wt)},o=r.R,l=this.ge.N().lineWidth,c=this.De(this.Ve(),o);this.Gt.ht({ee:o,re:l,he:c.he,ae:c.ae,ft:c.ft,ne:a})}Ce(){const e=this.Gt.se();if(e!==null){const t=this.De(this.Ve(),e.ee);e.he=t.he,e.ae=t.ae,e.ft=t.ft}}Ve(){return this.xe()?performance.now()-this.me:2599}Ie(e,t,n,r){const a=n+(r-n)*t;return this.ge.Qt().Xi().j(e,a)}De(e,t){const n=e%2600/2600;let r;for(const h of b0)if(n>=h.le&&n<=h.oe){r=h;break}Ge(r!==void 0,"Last price animation internal logic error");const a=(n-r.le)/(r.oe-r.le);return{he:this.Ie(t,a,r.ce,r.de),ae:this.Ie(t,a,r.fe,r.pe),ft:(o=a,l=r._e,c=r.ue,l+(c-l)*o)};var o,l,c}}class j0 extends Ka{constructor(e){super(e)}te(){const e=this.Zn;e.Vt=!1;const t=this.Jn.N();if(!t.priceLineVisible||!this.Jn.Vt())return;const n=this.Jn.ke(t.priceLineSource===0);n.ye||(e.Vt=!0,e.ut=n.Bi,e.R=this.Jn.Be(n.R),e.ct=t.priceLineWidth,e.Xt=t.priceLineStyle)}}class S0 extends Yn{constructor(e){super(),this.Jt=e}qi(e,t,n){e.Vt=!1,t.Vt=!1;const r=this.Jt;if(!r.Vt())return;const a=r.N(),o=a.lastValueVisible,l=r.Ee()!=="",c=a.seriesLastValueMode===0,h=r.ke(!1);if(h.ye)return;o&&(e.ri=this.Ae(h,o,c),e.Vt=e.ri.length!==0),(l||c)&&(t.ri=this.ze(h,o,l,c),t.Vt=t.ri.length>0);const d=r.Be(h.R),m=this.Jt.Qt().Xi().X(d);n.Z=m.Z,n.Bi=h.Bi,t.Ht=r.Qt().Ut(h.Bi/r.Ft().$t()),e.Ht=d,e.R=m.G,t.R=m.G}ze(e,t,n,r){let a="";const o=this.Jt.Ee();return n&&o.length!==0&&(a+=`${o} `),t&&r&&(a+=this.Jt.Ft().Le()?e.Oe:e.Ne),a.trim()}Ae(e,t,n){return t?n?this.Jt.Ft().Le()?e.Ne:e.Oe:e.ri:""}}function fl(s,e,t,n){const r=Number.isFinite(e),a=Number.isFinite(t);return r&&a?s(e,t):r||a?r?e:t:n}class it{constructor(e,t){this.Fe=e,this.We=t}He(e){return e!==null&&this.Fe===e.Fe&&this.We===e.We}Ue(){return new it(this.Fe,this.We)}$e(){return this.Fe}qe(){return this.We}Ye(){return this.We-this.Fe}Ki(){return this.We===this.Fe||Number.isNaN(this.We)||Number.isNaN(this.Fe)}vn(e){return e===null?this:new it(fl(Math.min,this.$e(),e.$e(),-1/0),fl(Math.max,this.qe(),e.qe(),1/0))}je(e){if(!Bs(e)||this.We-this.Fe===0)return;const t=.5*(this.We+this.Fe);let n=this.We-t,r=this.Fe-t;n*=e,r*=e,this.We=t+n,this.Fe=t+r}Ke(e){Bs(e)&&(this.We+=e,this.Fe+=e)}Xe(){return{minValue:this.Fe,maxValue:this.We}}static Ze(e){return e===null?null:new it(e.minValue,e.maxValue)}}class xn{constructor(e,t){this.Ge=e,this.Je=t||null}Qe(){return this.Ge}tr(){return this.Je}Xe(){return{priceRange:this.Ge===null?null:this.Ge.Xe(),margins:this.Je||void 0}}static Ze(e){return e===null?null:new xn(it.Ze(e.priceRange),e.margins)}}class N0 extends Ka{constructor(e,t){super(e),this.ir=t}te(){const e=this.Zn;e.Vt=!1;const t=this.ir.N();if(!this.Jn.Vt()||!t.lineVisible)return;const n=this.ir.sr();n!==null&&(e.Vt=!0,e.ut=n,e.R=t.color,e.ct=t.lineWidth,e.Xt=t.lineStyle,e.Kn=this.ir.N().id)}}class k0 extends Yn{constructor(e,t){super(),this.ge=e,this.ir=t}qi(e,t,n){e.Vt=!1,t.Vt=!1;const r=this.ir.N(),a=r.axisLabelVisible,o=r.title!=="",l=this.ge;if(!a||!l.Vt())return;const c=this.ir.sr();if(c===null)return;o&&(t.ri=r.title,t.Vt=!0),t.Ht=l.Qt().Ut(c/l.Ft().$t()),e.ri=this.nr(r.price),e.Vt=!0;const h=this.ge.Qt().Xi().X(r.axisLabelColor||r.color);n.Z=h.Z;const d=r.axisLabelTextColor||h.G;e.R=d,t.R=d,n.Bi=c}nr(e){const t=this.ge.zt();return t===null?"":this.ge.Ft().Zi(e,t.Wt)}}class C0{constructor(e,t){this.ge=e,this.Ps=t,this.er=new N0(e,this),this.Fn=new k0(e,this),this.rr=new Hh(this.Fn,e,e.Qt())}hr(e){dt(this.Ps,e),this.kt(),this.ge.Qt().ar()}N(){return this.Ps}lr(){return this.er}_r(){return this.rr}ur(){return this.Fn}kt(){this.er.kt(),this.Fn.kt()}sr(){const e=this.ge,t=e.Ft();if(e.Qt().Et().Ki()||t.Ki())return null;const n=e.zt();return n===null?null:t.Nt(this.Ps.price,n.Wt)}}class P0 extends Uh{constructor(e){super(),this.ts=e}Qt(){return this.ts}}const T0={Bar:(s,e,t,n)=>{const r=e.upColor,a=e.downColor,o=Q(s(t,n)),l=Yt(o.Wt[0])<=Yt(o.Wt[3]);return{cr:o.R??(l?r:a)}},Candlestick:(s,e,t,n)=>{const r=e.upColor,a=e.downColor,o=e.borderUpColor,l=e.borderDownColor,c=e.wickUpColor,h=e.wickDownColor,d=Q(s(t,n)),m=Yt(d.Wt[0])<=Yt(d.Wt[3]);return{cr:d.R??(m?r:a),dr:d.Ht??(m?o:l),pr:d.vr??(m?c:h)}},Custom:(s,e,t,n)=>({cr:Q(s(t,n)).R??e.color}),Area:(s,e,t,n)=>{const r=Q(s(t,n));return{cr:r.vt??e.lineColor,vt:r.vt??e.lineColor,mr:r.mr??e.topColor,wr:r.wr??e.bottomColor}},Baseline:(s,e,t,n)=>{const r=Q(s(t,n));return{cr:r.Wt[3]>=e.baseValue.price?e.topLineColor:e.bottomLineColor,gr:r.gr??e.topLineColor,Mr:r.Mr??e.bottomLineColor,br:r.br??e.topFillColor1,Sr:r.Sr??e.topFillColor2,Cr:r.Cr??e.bottomFillColor1,Pr:r.Pr??e.bottomFillColor2}},Line:(s,e,t,n)=>{const r=Q(s(t,n));return{cr:r.R??e.color,vt:r.R??e.color}},Histogram:(s,e,t,n)=>({cr:Q(s(t,n)).R??e.color})};class E0{constructor(e){this.kr=(t,n)=>n!==void 0?n.Wt:this.ge.Xs().yr(t),this.ge=e,this.Tr=T0[e.Rr()]}Dr(e,t){return this.Tr(this.kr,this.ge.N(),e,t)}}function Yh(s,e,t,n,r=0,a=e.length){let o=a-r;for(;0<o;){const l=o>>1,c=r+l;n(e[c],t)===s?(r=c+1,o-=l+1):o=l}return r}const Ds=Yh.bind(null,!0),qh=Yh.bind(null,!1);var pl;(function(s){s[s.NearestLeft=-1]="NearestLeft",s[s.None=0]="None",s[s.NearestRight=1]="NearestRight"})(pl||(pl={}));const Ut=30;class I0{constructor(){this.Vr=[],this.Ir=new Map,this.Br=new Map,this.Er=[]}Ar(){return this.zr()>0?this.Vr[this.Vr.length-1]:null}Lr(){return this.zr()>0?this.Or(0):null}Ks(){return this.zr()>0?this.Or(this.Vr.length-1):null}zr(){return this.Vr.length}Ki(){return this.zr()===0}Te(e){return this.Nr(e,0)!==null}yr(e){return this.Fr(e)}Fr(e,t=0){const n=this.Nr(e,t);return n===null?null:{...this.Wr(n),Re:this.Or(n)}}Hr(){return this.Vr}Ur(e,t,n){if(this.Ki())return null;let r=null;for(const a of n)r=zi(r,this.$r(e,t,a));return r}ht(e){this.Br.clear(),this.Ir.clear(),this.Vr=e,this.Er=e.map(t=>t.Re)}qr(){return this.Er}Or(e){return this.Vr[e].Re}Wr(e){return this.Vr[e]}Nr(e,t){const n=this.Yr(e);if(n===null&&t!==0)switch(t){case-1:return this.jr(e);case 1:return this.Kr(e);default:throw new TypeError("Unknown search mode")}return n}jr(e){let t=this.Xr(e);return t>0&&(t-=1),t!==this.Vr.length&&this.Or(t)<e?t:null}Kr(e){const t=this.Zr(e);return t!==this.Vr.length&&e<this.Or(t)?t:null}Yr(e){const t=this.Xr(e);return t===this.Vr.length||e<this.Vr[t].Re?null:t}Xr(e){return Ds(this.Vr,e,(t,n)=>t.Re<n)}Zr(e){return qh(this.Vr,e,(t,n)=>t.Re>n)}Gr(e,t,n){let r=null;for(let a=e;a<t;a++){const o=this.Vr[a].Wt[n];Number.isNaN(o)||(r===null?r={Jr:o,Qr:o}:(o<r.Jr&&(r.Jr=o),o>r.Qr&&(r.Qr=o)))}return r}$r(e,t,n){if(this.Ki())return null;let r=null;const a=Q(this.Lr()),o=Q(this.Ks()),l=Math.max(e,a),c=Math.min(t,o),h=Math.ceil(l/Ut)*Ut,d=Math.max(h,Math.floor(c/Ut)*Ut);{const x=this.Xr(l),b=this.Zr(Math.min(c,h,t));r=zi(r,this.Gr(x,b,n))}let m=this.Ir.get(n);m===void 0&&(m=new Map,this.Ir.set(n,m));for(let x=Math.max(h+1,l);x<d;x+=Ut){const b=Math.floor(x/Ut);let p=m.get(b);if(p===void 0){const g=this.Xr(b*Ut),f=this.Zr((b+1)*Ut-1);p=this.Gr(g,f,n),m.set(b,p)}r=zi(r,p)}{const x=this.Xr(d),b=this.Zr(c);r=zi(r,this.Gr(x,b,n))}return r}}function zi(s,e){return s===null?e:e===null?s:{Jr:Math.min(s.Jr,e.Jr),Qr:Math.max(s.Qr,e.Qr)}}class _0{constructor(e){this.th=e}nt(e,t,n){this.th.draw(e)}ih(e,t,n){var r,a;(a=(r=this.th).drawBackground)==null||a.call(r,e)}}class L0{constructor(e){this.Dn=null,this.sh=e}Tt(){var n;const e=this.sh.renderer();if(e===null)return null;if(((n=this.Dn)==null?void 0:n.nh)===e)return this.Dn.eh;const t=new _0(e);return this.Dn={nh:e,eh:t},t}rh(){var e,t;return((t=(e=this.sh).zOrder)==null?void 0:t.call(e))??"normal"}}class Gh{constructor(e){this.hh=null,this.ah=e}oh(){return this.ah}Ns(){var e,t;(t=(e=this.ah).updateAllViews)==null||t.call(e)}Fs(){var n,r,a;const e=((r=(n=this.ah).paneViews)==null?void 0:r.call(n))??[];if(((a=this.hh)==null?void 0:a.nh)===e)return this.hh.eh;const t=e.map(o=>new L0(o));return this.hh={nh:e,eh:t},t}jn(e,t){var n,r;return((r=(n=this.ah).hitTest)==null?void 0:r.call(n,e,t))??null}}let M0=class extends Gh{us(){return[]}};class R0{constructor(e){this.th=e}nt(e,t,n){this.th.draw(e)}ih(e,t,n){var r,a;(a=(r=this.th).drawBackground)==null||a.call(r,e)}}class gl{constructor(e){this.Dn=null,this.sh=e}Tt(){var n;const e=this.sh.renderer();if(e===null)return null;if(((n=this.Dn)==null?void 0:n.nh)===e)return this.Dn.eh;const t=new R0(e);return this.Dn={nh:e,eh:t},t}rh(){var e,t;return((t=(e=this.sh).zOrder)==null?void 0:t.call(e))??"normal"}}function Qh(s){var e,t,n;return{ri:s.text(),Bi:s.coordinate(),Ii:(e=s.fixedCoordinate)==null?void 0:e.call(s),R:s.textColor(),Z:s.backColor(),Vt:((t=s.visible)==null?void 0:t.call(s))??!0,pi:((n=s.tickVisible)==null?void 0:n.call(s))??!0}}class A0{constructor(e,t){this.Gt=new zh,this._h=e,this.uh=t}Tt(){return this.Gt.ht({Qi:this.uh.Qi(),...Qh(this._h)}),this.Gt}}class O0 extends Yn{constructor(e,t){super(),this._h=e,this.Yi=t}qi(e,t,n){const r=Qh(this._h);n.Z=r.Z,e.R=r.R;const a=2/12*this.Yi.P();n.Ti=a,n.Ri=a,n.Bi=r.Bi,n.Ii=r.Ii,e.ri=r.ri,e.Vt=r.Vt,e.pi=r.pi}}class F0 extends Gh{constructor(e,t){super(e),this.dh=null,this.fh=null,this.ph=null,this.mh=null,this.ge=t}cs(){var r,a,o;const e=((a=(r=this.ah).timeAxisViews)==null?void 0:a.call(r))??[];if(((o=this.dh)==null?void 0:o.nh)===e)return this.dh.eh;const t=this.ge.Qt().Et(),n=e.map(l=>new A0(l,t));return this.dh={nh:e,eh:n},n}Ws(){var r,a,o;const e=((a=(r=this.ah).priceAxisViews)==null?void 0:a.call(r))??[];if(((o=this.fh)==null?void 0:o.nh)===e)return this.fh.eh;const t=this.ge.Ft(),n=e.map(l=>new O0(l,t));return this.fh={nh:e,eh:n},n}wh(){var n,r,a;const e=((r=(n=this.ah).priceAxisPaneViews)==null?void 0:r.call(n))??[];if(((a=this.ph)==null?void 0:a.nh)===e)return this.ph.eh;const t=e.map(o=>new gl(o));return this.ph={nh:e,eh:t},t}gh(){var n,r,a;const e=((r=(n=this.ah).timeAxisPaneViews)==null?void 0:r.call(n))??[];if(((a=this.mh)==null?void 0:a.nh)===e)return this.mh.eh;const t=e.map(o=>new gl(o));return this.mh={nh:e,eh:t},t}Mh(e,t){var n,r;return((r=(n=this.ah).autoscaleInfo)==null?void 0:r.call(n,e,t))??null}}function Cr(s,e,t,n){s.forEach(r=>{e(r).forEach(a=>{a.rh()===t&&n.push(a)})})}function Pr(s){return s.Fs()}function B0(s){return s.wh()}function D0(s){return s.gh()}const $0=["Area","Line","Baseline"];class Qn extends P0{constructor(e,t,n,r,a){super(e),this.Yt=new I0,this.er=new j0(this),this.bh=[],this.Sh=new v0(this),this.xh=null,this.Ch=null,this.Ph=null,this.kh=[],this.Ps=n,this.yh=t;const o=new S0(this);this.vs=[o],this.rr=new Hh(o,this,e),$0.includes(this.yh)&&(this.xh=new w0(this)),this.Th(),this.sh=r(this,this.Qt(),a)}m(){this.Ph!==null&&clearTimeout(this.Ph)}Be(e){return this.Ps.priceLineColor||e}ke(e){const t={ye:!0},n=this.Ft();if(this.Qt().Et().Ki()||n.Ki()||this.Yt.Ki())return t;const r=this.Qt().Et().Pe(),a=this.zt();if(r===null||a===null)return t;let o,l;if(e){const m=this.Yt.Ar();if(m===null)return t;o=m,l=m.Re}else{const m=this.Yt.Fr(r.bi(),-1);if(m===null||(o=this.Yt.yr(m.Re),o===null))return t;l=m.Re}const c=o.Wt[3],h=this.Rh().Dr(l,{Wt:o}),d=n.Nt(c,a.Wt);return{ye:!1,gt:c,ri:n.Zi(c,a.Wt),Oe:n.Dh(c),Ne:n.Vh(c,a.Wt),R:h.cr,Bi:d,Re:l}}Rh(){return this.Ch!==null||(this.Ch=new E0(this)),this.Ch}N(){return this.Ps}hr(e){const t=e.priceScaleId;t!==void 0&&t!==this.Ps.priceScaleId&&this.Qt().Ih(this,t),dt(this.Ps,e),e.priceFormat!==void 0&&(this.Th(),this.Qt().Bh()),this.Qt().Eh(this),this.Qt().Ah(),this.sh.kt("options")}ht(e,t){this.Yt.ht(e),this.sh.kt("data"),this.xh!==null&&(t&&t.zh?this.xh.be():e.length===0&&this.xh.Me());const n=this.Qt().Hn(this);this.Qt().Lh(n),this.Qt().Eh(this),this.Qt().Ah(),this.Qt().ar()}Oh(e){const t=new C0(this,e);return this.bh.push(t),this.Qt().Eh(this),t}Nh(e){const t=this.bh.indexOf(e);t!==-1&&this.bh.splice(t,1),this.Qt().Eh(this)}Fh(){return this.bh}Rr(){return this.yh}zt(){const e=this.Wh();return e===null?null:{Wt:e.Wt[3],Hh:e.wt}}Wh(){const e=this.Qt().Et().Pe();if(e===null)return null;const t=e.Uh();return this.Yt.Fr(t,1)}Xs(){return this.Yt}$h(e){const t=this.Yt.yr(e);return t===null?null:this.yh==="Bar"||this.yh==="Candlestick"||this.yh==="Custom"?{qh:t.Wt[0],Yh:t.Wt[1],jh:t.Wt[2],Kh:t.Wt[3]}:t.Wt[3]}Xh(e){const t=[];Cr(this.kh,Pr,"top",t);const n=this.xh;return n!==null&&n.Vt()&&(this.Ph===null&&n.xe()&&(this.Ph=setTimeout(()=>{this.Ph=null,this.Qt().Zh()},0)),n.Se(),t.unshift(n)),t}Fs(){const e=[];this.Gh()||e.push(this.Sh),e.push(this.sh,this.er);const t=this.bh.map(n=>n.lr());return e.push(...t),Cr(this.kh,Pr,"normal",e),e}Jh(){return this.Qh(Pr,"bottom")}ta(e){return this.Qh(B0,e)}ia(e){return this.Qh(D0,e)}sa(e,t){return this.kh.map(n=>n.jn(e,t)).filter(n=>n!==null)}us(){return[this.rr,...this.bh.map(e=>e._r())]}Ws(e,t){if(t!==this.es&&!this.Gh())return[];const n=[...this.vs];for(const r of this.bh)n.push(r.ur());return this.kh.forEach(r=>{n.push(...r.Ws())}),n}cs(){const e=[];return this.kh.forEach(t=>{e.push(...t.cs())}),e}Mh(e,t){if(this.Ps.autoscaleInfoProvider!==void 0){const n=this.Ps.autoscaleInfoProvider(()=>{const r=this.na(e,t);return r===null?null:r.Xe()});return xn.Ze(n)}return this.na(e,t)}ea(){return this.Ps.priceFormat.minMove}ra(){return this.ha}Ns(){var e;this.sh.kt();for(const t of this.vs)t.kt();for(const t of this.bh)t.kt();this.er.kt(),this.Sh.kt(),(e=this.xh)==null||e.kt(),this.kh.forEach(t=>t.Ns())}Ft(){return Q(super.Ft())}At(e){if(!((this.yh==="Line"||this.yh==="Area"||this.yh==="Baseline")&&this.Ps.crosshairMarkerVisible))return null;const t=this.Yt.yr(e);return t===null?null:{gt:t.Wt[3],ft:this.aa(),Ht:this.la(),Ot:this.oa(),Lt:this._a(e)}}Ee(){return this.Ps.title}Vt(){return this.Ps.visible}ua(e){this.kh.push(new F0(e,this))}ca(e){this.kh=this.kh.filter(t=>t.oh()!==e)}da(){if(this.yh==="Custom")return e=>this.sh.fa(e)}pa(){if(this.yh==="Custom")return e=>this.sh.va(e)}ma(){return this.Yt.qr()}Gh(){return!qn(this.Ft().wa())}na(e,t){if(!yi(e)||!yi(t)||this.Yt.Ki())return null;const n=this.yh==="Line"||this.yh==="Area"||this.yh==="Baseline"||this.yh==="Histogram"?[3]:[2,1],r=this.Yt.Ur(e,t,n);let a=r!==null?new it(r.Jr,r.Qr):null,o=null;if(this.Rr()==="Histogram"){const l=this.Ps.base,c=new it(l,l);a=a!==null?a.vn(c):c}return this.kh.forEach(l=>{const c=l.Mh(e,t);if(c!=null&&c.priceRange){const h=new it(c.priceRange.minValue,c.priceRange.maxValue);a=a!==null?a.vn(h):h}c!=null&&c.margins&&(o=c.margins)}),new xn(a,o)}aa(){switch(this.yh){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerRadius}return 0}la(){switch(this.yh){case"Line":case"Area":case"Baseline":{const e=this.Ps.crosshairMarkerBorderColor;if(e.length!==0)return e}}return null}oa(){switch(this.yh){case"Line":case"Area":case"Baseline":return this.Ps.crosshairMarkerBorderWidth}return 0}_a(e){switch(this.yh){case"Line":case"Area":case"Baseline":{const t=this.Ps.crosshairMarkerBackgroundColor;if(t.length!==0)return t}}return this.Rh().Dr(e).cr}Th(){switch(this.Ps.priceFormat.type){case"custom":{const e=this.Ps.priceFormat.formatter;this.ha={format:e,formatTickmarks:this.Ps.priceFormat.tickmarksFormatter??(t=>t.map(e))};break}case"volume":this.ha=new f0(this.Ps.priceFormat.precision);break;case"percent":this.ha=new Vh(this.Ps.priceFormat.precision);break;default:{const e=Math.pow(10,this.Ps.priceFormat.precision);this.ha=new Gn(e,this.Ps.priceFormat.minMove*e)}}this.es!==null&&this.es.ga()}Qh(e,t){const n=[];return Cr(this.kh,e,t,n),n}}const z0=[3],U0=[0,1,2,3];class W0{constructor(e){this.Ps=e}Ma(e,t,n){let r=e;if(this.Ps.mode===0)return r;const a=n.ys(),o=a.zt();if(o===null)return r;const l=a.Nt(e,o),c=n.ba().filter(d=>d instanceof Qn).reduce((d,m)=>{if(n.Un(m)||!m.Vt())return d;const x=m.Ft(),b=m.Xs();if(x.Ki()||!b.Te(t))return d;const p=b.yr(t);if(p===null)return d;const g=Yt(m.zt()),f=this.Ps.mode===3?U0:z0;return d.concat(f.map(y=>x.Nt(p.Wt[y],g.Wt)))},[]);if(c.length===0)return r;c.sort((d,m)=>Math.abs(d-l)-Math.abs(m-l));const h=c[0];return r=a.Ts(h,o),r}}function Ms(s,e,t){return Math.min(Math.max(s,e),t)}function Ui(s,e,t){return e-s<=t}class V0 extends zt{constructor(){super(...arguments),this.Yt=null}ht(e){this.Yt=e}et({context:e,bitmapSize:t,horizontalPixelRatio:n,verticalPixelRatio:r}){if(this.Yt===null)return;const a=Math.max(1,Math.floor(n));e.lineWidth=a,function(o,l){o.save(),o.lineWidth%2&&o.translate(.5,.5),l(),o.restore()}(e,()=>{const o=Q(this.Yt);if(o.Sa){e.strokeStyle=o.xa,xs(e,o.Ca),e.beginPath();for(const l of o.Pa){const c=Math.round(l.ka*n);e.moveTo(c,-a),e.lineTo(c,t.height+a)}e.stroke()}if(o.ya){e.strokeStyle=o.Ta,xs(e,o.Ra),e.beginPath();for(const l of o.Da){const c=Math.round(l.ka*r);e.moveTo(-a,c),e.lineTo(t.width+a,c)}e.stroke()}})}}class H0{constructor(e){this.Gt=new V0,this.xt=!0,this.Pt=e}kt(){this.xt=!0}Tt(){if(this.xt){const e=this.Pt.Qt().N().grid,t={ya:e.horzLines.visible,Sa:e.vertLines.visible,Ta:e.horzLines.color,xa:e.vertLines.color,Ra:e.horzLines.style,Ca:e.vertLines.style,Da:this.Pt.ys().Va(),Pa:(this.Pt.Qt().Et().Va()||[]).map(n=>({ka:n.coord}))};this.Gt.ht(t),this.xt=!1}return this.Gt}}class Y0{constructor(e){this.sh=new H0(e)}lr(){return this.sh}}const Tr={Ia:4,Ba:1e-4};function Ls(s,e){const t=100*(s-e)/e;return e<0?-t:t}function q0(s,e){const t=Ls(s.$e(),e),n=Ls(s.qe(),e);return new it(t,n)}function oi(s,e){const t=100*(s-e)/e+100;return e<0?-t:t}function G0(s,e){const t=oi(s.$e(),e),n=oi(s.qe(),e);return new it(t,n)}function bn(s,e){const t=Math.abs(s);if(t<1e-15)return 0;const n=Math.log10(t+e.Ba)+e.Ia;return s<0?-n:n}function li(s,e){const t=Math.abs(s);if(t<1e-15)return 0;const n=Math.pow(10,t-e.Ia)-e.Ba;return s<0?-n:n}function Js(s,e){if(s===null)return null;const t=bn(s.$e(),e),n=bn(s.qe(),e);return new it(t,n)}function ti(s,e){if(s===null)return null;const t=li(s.$e(),e),n=li(s.qe(),e);return new it(t,n)}function Er(s){if(s===null)return Tr;const e=Math.abs(s.qe()-s.$e());if(e>=1||e<1e-15)return Tr;const t=Math.ceil(Math.abs(Math.log10(e))),n=Tr.Ia+t;return{Ia:n,Ba:1/Math.pow(10,n)}}class Ir{constructor(e,t){if(this.Ea=e,this.Aa=t,function(n){if(n<0)return!1;for(let r=n;r>1;r/=10)if(r%10!=0)return!1;return!0}(this.Ea))this.za=[2,2.5,2];else{this.za=[];for(let n=this.Ea;n!==1;){if(n%2==0)this.za.push(2),n/=2;else{if(n%5!=0)throw new Error("unexpected base");this.za.push(2,2.5),n/=5}if(this.za.length>100)throw new Error("something wrong with base")}}}La(e,t,n){const r=this.Ea===0?0:1/this.Ea;let a=Math.pow(10,Math.max(0,Math.ceil(Math.log10(e-t)))),o=0,l=this.Aa[0];for(;;){const m=Ui(a,r,1e-14)&&a>r+1e-14,x=Ui(a,n*l,1e-14),b=Ui(a,1,1e-14);if(!(m&&x&&b))break;a/=l,l=this.Aa[++o%this.Aa.length]}if(a<=r+1e-14&&(a=r),a=Math.max(1,a),this.za.length>0&&(c=a,h=1,d=1e-14,Math.abs(c-h)<d))for(o=0,l=this.za[0];Ui(a,n*l,1e-14)&&a>r+1e-14;)a/=l,l=this.za[++o%this.za.length];var c,h,d;return a}}class yl{constructor(e,t,n,r){this.Oa=[],this.Yi=e,this.Ea=t,this.Na=n,this.Fa=r}La(e,t){if(e<t)throw new Error("high < low");const n=this.Yi.$t(),r=(e-t)*this.Wa()/n,a=new Ir(this.Ea,[2,2.5,2]),o=new Ir(this.Ea,[2,2,2.5]),l=new Ir(this.Ea,[2.5,2,2]),c=[];return c.push(a.La(e,t,r),o.La(e,t,r),l.La(e,t,r)),function(h){if(h.length<1)throw Error("array is empty");let d=h[0];for(let m=1;m<h.length;++m)h[m]<d&&(d=h[m]);return d}(c)}Ha(){const e=this.Yi,t=e.zt();if(t===null)return void(this.Oa=[]);const n=e.$t(),r=this.Na(n-1,t),a=this.Na(0,t),o=this.Yi.N().entireTextOnly?this.Ua()/2:0,l=o,c=n-1-o,h=Math.max(r,a),d=Math.min(r,a);if(h===d)return void(this.Oa=[]);const m=this.La(h,d);if(this.$a(t,m,h,d,l,c),e.qa()&&this.Ya(m,d,h)){const p=this.Yi.ja();this.Ka(t,m,l,c,p,2*p)}const x=this.Oa.map(p=>p.Xa),b=this.Yi.Za(x);for(let p=0;p<this.Oa.length;p++)this.Oa[p].Ga=b[p]}Va(){return this.Oa}Ua(){return this.Yi.P()}Wa(){return Math.ceil(2.5*this.Ua())}$a(e,t,n,r,a,o){const l=this.Oa,c=this.Yi;let h=n%t;h+=h<0?t:0;const d=n>=r?1:-1;let m=null,x=0;for(let b=n-h;b>r;b-=t){const p=this.Fa(b,e,!0);m!==null&&Math.abs(p-m)<this.Wa()||p<a||p>o||(x<l.length?(l[x].ka=p,l[x].Ga=c.Ja(b),l[x].Xa=b):l.push({ka:p,Ga:c.Ja(b),Xa:b}),x++,m=p,c.Qa()&&(t=this.La(b*d,r)))}l.length=x}Ka(e,t,n,r,a,o){const l=this.Oa,c=this.tl(e,n,a,o),h=this.tl(e,r,-o,-a),d=this.Fa(0,e,!0)-this.Fa(t,e,!0);l.length>0&&l[0].ka-c.ka<d/2&&l.shift(),l.length>0&&h.ka-l[l.length-1].ka<d/2&&l.pop(),l.unshift(c),l.push(h)}tl(e,t,n,r){const a=(n+r)/2,o=this.Na(t+n,e),l=this.Na(t+r,e),c=Math.min(o,l),h=Math.max(o,l),d=Math.max(.1,this.La(h,c)),m=this.Na(t+a,e),x=m-m%d,b=this.Fa(x,e,!0);return{Ga:this.Yi.Ja(x),ka:b,Xa:x}}Ya(e,t,n){let r=Yt(this.Yi.Qe());return this.Yi.Qa()&&(r=ti(r,this.Yi.il())),r.$e()-t<e&&n-r.qe()<e}}function Kh(s){return s.slice().sort((e,t)=>Q(e.hs())-Q(t.hs()))}var vl;(function(s){s[s.Normal=0]="Normal",s[s.Logarithmic=1]="Logarithmic",s[s.Percentage=2]="Percentage",s[s.IndexedTo100=3]="IndexedTo100"})(vl||(vl={}));const xl=new Vh,bl=new Gn(100,1);class Q0{constructor(e,t,n,r,a){this.sl=0,this.nl=null,this.Ge=null,this.el=null,this.rl={hl:!1,al:null},this.ll=!1,this.ol=0,this._l=0,this.ul=new Be,this.cl=new Be,this.dl=[],this.fl=null,this.pl=null,this.vl=null,this.ml=null,this.wl=null,this.ha=bl,this.gl=Er(null),this.Ml=e,this.Ps=t,this.bl=n,this.Sl=r,this.xl=a,this.Cl=new yl(this,100,this.Pl.bind(this),this.kl.bind(this))}wa(){return this.Ml}N(){return this.Ps}hr(e){if(dt(this.Ps,e),this.ga(),e.mode!==void 0&&this.yl({ie:e.mode}),e.scaleMargins!==void 0){const t=ct(e.scaleMargins.top),n=ct(e.scaleMargins.bottom);if(t<0||t>1)throw new Error(`Invalid top margin - expect value between 0 and 1, given=${t}`);if(n<0||n>1)throw new Error(`Invalid bottom margin - expect value between 0 and 1, given=${n}`);if(t+n>1)throw new Error(`Invalid margins - sum of margins must be less than 1, given=${t+n}`);this.Tl(),this.vl=null}}Rl(){return this.Ps.autoScale}Dl(){return this.ll}Qa(){return this.Ps.mode===1}Le(){return this.Ps.mode===2}Vl(){return this.Ps.mode===3}il(){return this.gl}ie(){return{sn:this.Ps.autoScale,Il:this.Ps.invertScale,ie:this.Ps.mode}}yl(e){const t=this.ie();let n=null;e.sn!==void 0&&(this.Ps.autoScale=e.sn),e.ie!==void 0&&(this.Ps.mode=e.ie,e.ie!==2&&e.ie!==3||(this.Ps.autoScale=!0),this.rl.hl=!1),t.ie===1&&e.ie!==t.ie&&(function(a,o){if(a===null)return!1;const l=li(a.$e(),o),c=li(a.qe(),o);return isFinite(l)&&isFinite(c)}(this.Ge,this.gl)?(n=ti(this.Ge,this.gl),n!==null&&this.Bl(n)):this.Ps.autoScale=!0),e.ie===1&&e.ie!==t.ie&&(n=Js(this.Ge,this.gl),n!==null&&this.Bl(n));const r=t.ie!==this.Ps.mode;r&&(t.ie===2||this.Le())&&this.ga(),r&&(t.ie===3||this.Vl())&&this.ga(),e.Il!==void 0&&t.Il!==e.Il&&(this.Ps.invertScale=e.Il,this.El()),this.cl.p(t,this.ie())}Al(){return this.cl}P(){return this.bl.fontSize}$t(){return this.sl}zl(e){this.sl!==e&&(this.sl=e,this.Tl(),this.vl=null)}Ll(){if(this.nl)return this.nl;const e=this.$t()-this.Ol()-this.Nl();return this.nl=e,e}Qe(){return this.Fl(),this.Ge}Bl(e,t){const n=this.Ge;(t||n===null&&e!==null||n!==null&&!n.He(e))&&(this.vl=null,this.Ge=e)}Wl(e){this.Bl(e),this.Hl(e!==null)}Ki(){return this.Fl(),this.sl===0||!this.Ge||this.Ge.Ki()}Ul(e){return this.Il()?e:this.$t()-1-e}Nt(e,t){return this.Le()?e=Ls(e,t):this.Vl()&&(e=oi(e,t)),this.kl(e,t)}$l(e,t,n){this.Fl();const r=this.Nl(),a=Q(this.Qe()),o=a.$e(),l=a.qe(),c=this.Ll()-1,h=this.Il(),d=c/(l-o),m=n===void 0?0:n.from,x=n===void 0?e.length:n.to,b=this.ql();for(let p=m;p<x;p++){const g=e[p],f=g.gt;if(isNaN(f))continue;let y=f;b!==null&&(y=b(g.gt,t));const S=r+d*(y-o),k=h?S:this.sl-1-S;g.ut=k}}Yl(e,t,n){this.Fl();const r=this.Nl(),a=Q(this.Qe()),o=a.$e(),l=a.qe(),c=this.Ll()-1,h=this.Il(),d=c/(l-o),m=n===void 0?0:n.from,x=n===void 0?e.length:n.to,b=this.ql();for(let p=m;p<x;p++){const g=e[p];let f=g.qh,y=g.Yh,S=g.jh,k=g.Kh;b!==null&&(f=b(g.qh,t),y=b(g.Yh,t),S=b(g.jh,t),k=b(g.Kh,t));let C=r+d*(f-o),N=h?C:this.sl-1-C;g.jl=N,C=r+d*(y-o),N=h?C:this.sl-1-C,g.Kl=N,C=r+d*(S-o),N=h?C:this.sl-1-C,g.Xl=N,C=r+d*(k-o),N=h?C:this.sl-1-C,g.Zl=N}}Ts(e,t){const n=this.Pl(e,t);return this.Gl(n,t)}Gl(e,t){let n=e;return this.Le()?n=function(r,a){return a<0&&(r=-r),r/100*a+a}(n,t):this.Vl()&&(n=function(r,a){return r-=100,a<0&&(r=-r),r/100*a+a}(n,t)),n}ba(){return this.dl}Dt(){return this.pl||(this.pl=Kh(this.dl)),this.pl}Jl(e){this.dl.indexOf(e)===-1&&(this.dl.push(e),this.ga(),this.Ql())}io(e){const t=this.dl.indexOf(e);if(t===-1)throw new Error("source is not attached to scale");this.dl.splice(t,1),this.dl.length===0&&(this.yl({sn:!0}),this.Bl(null)),this.ga(),this.Ql()}zt(){let e=null;for(const t of this.dl){const n=t.zt();n!==null&&(e===null||n.Hh<e.Hh)&&(e=n)}return e===null?null:e.Wt}Il(){return this.Ps.invertScale}Va(){const e=this.zt()===null;if(this.vl!==null&&(e||this.vl.so===e))return this.vl.Va;this.Cl.Ha();const t=this.Cl.Va();return this.vl={Va:t,so:e},this.ul.p(),t}no(){return this.ul}eo(e){this.Le()||this.Vl()||this.ml===null&&this.el===null&&(this.Ki()||(this.ml=this.sl-e,this.el=Q(this.Qe()).Ue()))}ro(e){if(this.Le()||this.Vl()||this.ml===null)return;this.yl({sn:!1}),(e=this.sl-e)<0&&(e=0);let t=(this.ml+.2*(this.sl-1))/(e+.2*(this.sl-1));const n=Q(this.el).Ue();t=Math.max(t,.1),n.je(t),this.Bl(n)}ho(){this.Le()||this.Vl()||(this.ml=null,this.el=null)}ao(e){this.Rl()||this.wl===null&&this.el===null&&(this.Ki()||(this.wl=e,this.el=Q(this.Qe()).Ue()))}lo(e){if(this.Rl()||this.wl===null)return;const t=Q(this.Qe()).Ye()/(this.Ll()-1);let n=e-this.wl;this.Il()&&(n*=-1);const r=n*t,a=Q(this.el).Ue();a.Ke(r),this.Bl(a,!0),this.vl=null}oo(){this.Rl()||this.wl!==null&&(this.wl=null,this.el=null)}ra(){return this.ha||this.ga(),this.ha}Zi(e,t){switch(this.Ps.mode){case 2:return this._o(Ls(e,t));case 3:return this.ra().format(oi(e,t));default:return this.nr(e)}}Ja(e){switch(this.Ps.mode){case 2:return this._o(e);case 3:return this.ra().format(e);default:return this.nr(e)}}Za(e){switch(this.Ps.mode){case 2:return this.uo(e);case 3:return this.ra().formatTickmarks(e);default:return this.co(e)}}Dh(e){return this.nr(e,Q(this.fl).ra())}Vh(e,t){return e=Ls(e,t),this._o(e,xl)}do(){return this.dl}fo(e){this.rl={al:e,hl:!1}}Ns(){this.dl.forEach(e=>e.Ns())}qa(){return this.Ps.ensureEdgeTickMarksVisible&&this.Rl()}ja(){return this.P()/2}ga(){this.vl=null;let e=1/0;this.fl=null;for(const n of this.dl)n.hs()<e&&(e=n.hs(),this.fl=n);let t=100;this.fl!==null&&(t=Math.round(1/this.fl.ea())),this.ha=bl,this.Le()?(this.ha=xl,t=100):this.Vl()?(this.ha=new Gn(100,1),t=100):this.fl!==null&&(this.ha=this.fl.ra()),this.Cl=new yl(this,t,this.Pl.bind(this),this.kl.bind(this)),this.Cl.Ha()}Ql(){this.pl=null}Xi(){return this.xl}Hl(e){this.ll=e}Ol(){return this.Il()?this.Ps.scaleMargins.bottom*this.$t()+this._l:this.Ps.scaleMargins.top*this.$t()+this.ol}Nl(){return this.Il()?this.Ps.scaleMargins.top*this.$t()+this.ol:this.Ps.scaleMargins.bottom*this.$t()+this._l}Fl(){this.rl.hl||(this.rl.hl=!0,this.po())}Tl(){this.nl=null}kl(e,t){if(this.Fl(),this.Ki())return 0;e=this.Qa()&&e?bn(e,this.gl):e;const n=Q(this.Qe()),r=this.Nl()+(this.Ll()-1)*(e-n.$e())/n.Ye();return this.Ul(r)}Pl(e,t){if(this.Fl(),this.Ki())return 0;const n=this.Ul(e),r=Q(this.Qe()),a=r.$e()+r.Ye()*((n-this.Nl())/(this.Ll()-1));return this.Qa()?li(a,this.gl):a}El(){this.vl=null,this.Cl.Ha()}po(){if(this.Dl()&&!this.Rl())return;const e=this.rl.al;if(e===null)return;let t=null;const n=this.do();let r=0,a=0;for(const c of n){if(!c.Vt())continue;const h=c.zt();if(h===null)continue;const d=c.Mh(e.Uh(),e.bi());let m=d&&d.Qe();if(m!==null){switch(this.Ps.mode){case 1:m=Js(m,this.gl);break;case 2:m=q0(m,h.Wt);break;case 3:m=G0(m,h.Wt)}if(t=t===null?m:t.vn(Q(m)),d!==null){const x=d.tr();x!==null&&(r=Math.max(r,x.above),a=Math.max(a,x.below))}}}if(this.qa()&&(r=Math.max(r,this.ja()),a=Math.max(a,this.ja())),r===this.ol&&a===this._l||(this.ol=r,this._l=a,this.vl=null,this.Tl()),t!==null){if(t.$e()===t.qe()){const c=this.fl,h=5*(c===null||this.Le()||this.Vl()?1:c.ea());this.Qa()&&(t=ti(t,this.gl)),t=new it(t.$e()-h,t.qe()+h),this.Qa()&&(t=Js(t,this.gl))}if(this.Qa()){const c=ti(t,this.gl),h=Er(c);if(o=h,l=this.gl,o.Ia!==l.Ia||o.Ba!==l.Ba){const d=this.el!==null?ti(this.el,this.gl):null;this.gl=h,t=Js(c,h),d!==null&&(this.el=Js(d,h))}}this.Bl(t)}else this.Ge===null&&(this.Bl(new it(-.5,.5)),this.gl=Er(null));var o,l}ql(){return this.Le()?Ls:this.Vl()?oi:this.Qa()?e=>bn(e,this.gl):null}vo(e,t,n){return t===void 0?(n===void 0&&(n=this.ra()),n.format(e)):t(e)}mo(e,t,n){return t===void 0?(n===void 0&&(n=this.ra()),n.formatTickmarks(e)):t(e)}nr(e,t){return this.vo(e,this.Sl.priceFormatter,t)}co(e,t){const n=this.Sl.priceFormatter;return this.mo(e,this.Sl.tickmarksPriceFormatter??(n?r=>r.map(n):void 0),t)}_o(e,t){return this.vo(e,this.Sl.percentageFormatter,t)}uo(e,t){const n=this.Sl.percentageFormatter;return this.mo(e,this.Sl.tickmarksPercentageFormatter??(n?r=>r.map(n):void 0),t)}}function wl(s){return s instanceof Qn}class jl{constructor(e,t){this.dl=[],this.wo=new Map,this.sl=0,this.Mo=0,this.bo=1,this.pl=null,this.So=!1,this.xo=new Be,this.kh=[],this.uh=e,this.ts=t,this.Co=new Y0(this);const n=t.N();this.Po=this.ko("left",n.leftPriceScale),this.yo=this.ko("right",n.rightPriceScale),this.Po.Al().i(this.To.bind(this,this.Po),this),this.yo.Al().i(this.To.bind(this,this.yo),this),this.Ro(n)}Ro(e){if(e.leftPriceScale&&this.Po.hr(e.leftPriceScale),e.rightPriceScale&&this.yo.hr(e.rightPriceScale),e.localization&&(this.Po.ga(),this.yo.ga()),e.overlayPriceScales){const t=Array.from(this.wo.values());for(const n of t){const r=Q(n[0].Ft());r.hr(e.overlayPriceScales),e.localization&&r.ga()}}}Do(e){switch(e){case"left":return this.Po;case"right":return this.yo}return this.wo.has(e)?ct(this.wo.get(e))[0].Ft():null}m(){this.Qt().Vo().u(this),this.Po.Al().u(this),this.yo.Al().u(this),this.dl.forEach(e=>{e.m&&e.m()}),this.kh=this.kh.filter(e=>{const t=e.oh();return t.detached&&t.detached(),!1}),this.xo.p()}Io(){return this.bo}Bo(e){this.bo=e}Qt(){return this.ts}Qi(){return this.Mo}$t(){return this.sl}Eo(e){this.Mo=e,this.Ao()}zl(e){this.sl=e,this.Po.zl(e),this.yo.zl(e),this.dl.forEach(t=>{if(this.Un(t)){const n=t.Ft();n!==null&&n.zl(e)}}),this.Ao()}zo(e){this.So=e}Lo(){return this.So}Oo(){return this.dl.filter(wl)}ba(){return this.dl}Un(e){const t=e.Ft();return t===null||this.Po!==t&&this.yo!==t}Jl(e,t,n){this.No(e,t,n?e.hs():this.dl.length)}io(e,t){const n=this.dl.indexOf(e);Ge(n!==-1,"removeDataSource: invalid data source"),this.dl.splice(n,1),t||this.dl.forEach((o,l)=>o.ls(l));const r=Q(e.Ft()).wa();if(this.wo.has(r)){const o=ct(this.wo.get(r)),l=o.indexOf(e);l!==-1&&(o.splice(l,1),o.length===0&&this.wo.delete(r))}const a=e.Ft();a&&a.ba().indexOf(e)>=0&&(a.io(e),this.Fo(a)),this.pl=null}qn(e){return e===this.Po?"left":e===this.yo?"right":"overlay"}Wo(){return this.Po}Ho(){return this.yo}Uo(e,t){e.eo(t)}$o(e,t){e.ro(t),this.Ao()}qo(e){e.ho()}Yo(e,t){e.ao(t)}jo(e,t){e.lo(t),this.Ao()}Ko(e){e.oo()}Ao(){this.dl.forEach(e=>{e.Ns()})}ys(){let e=null;return this.ts.N().rightPriceScale.visible&&this.yo.ba().length!==0?e=this.yo:this.ts.N().leftPriceScale.visible&&this.Po.ba().length!==0?e=this.Po:this.dl.length!==0&&(e=this.dl[0].Ft()),e===null&&(e=this.yo),e}$n(){let e=null;return this.ts.N().rightPriceScale.visible?e=this.yo:this.ts.N().leftPriceScale.visible&&(e=this.Po),e}Fo(e){e!==null&&e.Rl()&&this.Xo(e)}Zo(e){const t=this.uh.Pe();e.yl({sn:!0}),t!==null&&e.fo(t),this.Ao()}Go(){this.Xo(this.Po),this.Xo(this.yo)}Jo(){this.Fo(this.Po),this.Fo(this.yo),this.dl.forEach(e=>{this.Un(e)&&this.Fo(e.Ft())}),this.Ao(),this.ts.ar()}Dt(){return this.pl===null&&(this.pl=Kh(this.dl)),this.pl}Qo(e,t){t=Ms(t,0,this.dl.length-1);const n=this.dl.indexOf(e);Ge(n!==-1,"setSeriesOrder: invalid data source"),this.dl.splice(n,1),this.dl.splice(t,0,e),this.dl.forEach((r,a)=>r.ls(a)),this.pl=null;for(const r of[this.Po,this.yo])r.Ql(),r.ga();this.ts.ar()}It(){return this.Dt().filter(wl)}t_(){return this.xo}i_(){return this.Co}ua(e){this.kh.push(new M0(e))}ca(e){this.kh=this.kh.filter(t=>t.oh()!==e),e.detached&&e.detached(),this.ts.ar()}s_(){return this.kh}sa(e,t){return this.kh.map(n=>n.jn(e,t)).filter(n=>n!==null)}Xo(e){const t=e.do();if(t&&t.length>0&&!this.uh.Ki()){const n=this.uh.Pe();n!==null&&e.fo(n)}e.Ns()}No(e,t,n){let r=this.Do(t);if(r===null&&(r=this.ko(t,this.ts.N().overlayPriceScales)),this.dl.splice(n,0,e),!qn(t)){const a=this.wo.get(t)||[];a.push(e),this.wo.set(t,a)}e.ls(n),r.Jl(e),e._s(r),this.Fo(r),this.pl=null}To(e,t,n){t.ie!==n.ie&&this.Xo(e)}ko(e,t){const n={visible:!0,autoScale:!0,...Mt(t)},r=new Q0(e,n,this.ts.N().layout,this.ts.N().localization,this.ts.Xi());return r.zl(this.$t()),r}}function Wi(s){return{n_:s.n_,e_:{Kn:s.r_.externalId},h_:s.r_.cursorStyle}}function K0(s,e,t,n){for(const r of s){const a=r.Tt(n);if(a!==null&&a.jn){const o=a.jn(e,t);if(o!==null)return{a_:r,e_:o}}}return null}function J0(s){return s.Fs!==void 0}function Jh(s,e,t){const n=[s,...s.Dt()],r=function(a,o,l){var x;let c,h;for(const b of a){const p=((x=b.sa)==null?void 0:x.call(b,o,l))??[];for(const g of p)d=g.zOrder,m=c==null?void 0:c.zOrder,(!m||d==="top"&&m!=="top"||d==="normal"&&m==="bottom")&&(c=g,h=b)}var d,m;return c&&h?{r_:c,n_:h}:null}(n,e,t);if((r==null?void 0:r.r_.zOrder)==="top")return Wi(r);for(const a of n){if(r&&r.n_===a&&r.r_.zOrder!=="bottom"&&!r.r_.isBackground)return Wi(r);if(J0(a)){const o=K0(a.Fs(s),e,t,s);if(o!==null)return{n_:a,a_:o.a_,e_:o.e_}}if(r&&r.n_===a&&r.r_.zOrder!=="bottom"&&r.r_.isBackground)return Wi(r)}return r!=null&&r.r_?Wi(r):null}class X0{constructor(e,t,n=50){this.kn=0,this.yn=1,this.Tn=1,this.Dn=new Map,this.Rn=new Map,this.l_=e,this.o_=t,this.Vn=n}__(e){const t=e.time,n=this.o_.cacheKey(t),r=this.Dn.get(n);if(r!==void 0)return r.u_;if(this.kn===this.Vn){const o=this.Rn.get(this.Tn);this.Rn.delete(this.Tn),this.Dn.delete(ct(o)),this.Tn++,this.kn--}const a=this.l_(e);return this.Dn.set(n,{u_:a,An:this.yn}),this.Rn.set(this.yn,n),this.kn++,this.yn++,a}}class ci{constructor(e,t){Ge(e<=t,"right should be >= left"),this.c_=e,this.d_=t}Uh(){return this.c_}bi(){return this.d_}f_(){return this.d_-this.c_+1}Te(e){return this.c_<=e&&e<=this.d_}He(e){return this.c_===e.Uh()&&this.d_===e.bi()}}function Sl(s,e){return s===null||e===null?s===e:s.He(e)}class Z0{constructor(){this.p_=new Map,this.Dn=null,this.v_=!1}m_(e){this.v_=e,this.Dn=null}w_(e,t){this.g_(t),this.Dn=null;for(let n=t;n<e.length;++n){const r=e[n];let a=this.p_.get(r.timeWeight);a===void 0&&(a=[],this.p_.set(r.timeWeight,a)),a.push({index:n,time:r.time,weight:r.timeWeight,originalTime:r.originalTime})}}M_(e,t,n,r,a){const o=Math.ceil(t/e);return this.Dn!==null&&this.Dn.b_===o&&a===this.Dn.S_&&n===this.Dn.x_||(this.Dn={S_:a,x_:n,Va:this.C_(o,n,r),b_:o}),this.Dn.Va}g_(e){if(e===0)return void this.p_.clear();const t=[];this.p_.forEach((n,r)=>{e<=n[0].index?t.push(r):n.splice(Ds(n,e,a=>a.index<e),1/0)});for(const n of t)this.p_.delete(n)}C_(e,t,n){let r=[];const a=o=>!t||n.has(o.index);for(const o of Array.from(this.p_.keys()).sort((l,c)=>c-l)){if(!this.p_.get(o))continue;const l=r;r=[];const c=l.length;let h=0;const d=ct(this.p_.get(o)),m=d.length;let x=1/0,b=-1/0;for(let p=0;p<m;p++){const g=d[p],f=g.index;for(;h<c;){const y=l[h],S=y.index;if(!(S<f&&a(y))){x=S;break}h++,r.push(y),b=S,x=1/0}if(x-f>=e&&f-b>=e&&a(g))r.push(g),b=f;else if(this.v_)return l}for(;h<c;h++)a(l[h])&&r.push(l[h])}return r}}class Rs{constructor(e){this.P_=e}k_(){return this.P_===null?null:new ci(Math.floor(this.P_.Uh()),Math.ceil(this.P_.bi()))}y_(){return this.P_}static T_(){return new Rs(null)}}function ev(s,e){return s.weight>e.weight?s:e}class tv{constructor(e,t,n,r){this.Mo=0,this.R_=null,this.D_=[],this.wl=null,this.ml=null,this.V_=new Z0,this.I_=new Map,this.B_=Rs.T_(),this.E_=!0,this.A_=new Be,this.z_=new Be,this.L_=new Be,this.O_=null,this.N_=null,this.F_=new Map,this.W_=-1,this.H_=[],this.Ps=t,this.Sl=n,this.U_=t.rightOffset,this.q_=t.barSpacing,this.ts=e,this.o_=r,this.Y_(),this.V_.m_(t.uniformDistribution),this.j_()}N(){return this.Ps}K_(e){dt(this.Sl,e),this.X_(),this.Y_()}hr(e,t){dt(this.Ps,e),this.Ps.fixLeftEdge&&this.Z_(),this.Ps.fixRightEdge&&this.G_(),e.barSpacing!==void 0&&this.ts.dn(e.barSpacing),e.rightOffset!==void 0&&this.ts.fn(e.rightOffset),e.minBarSpacing===void 0&&e.maxBarSpacing===void 0||this.ts.dn(e.barSpacing??this.q_),e.ignoreWhitespaceIndices!==void 0&&e.ignoreWhitespaceIndices!==this.Ps.ignoreWhitespaceIndices&&this.j_(),this.X_(),this.Y_(),this.L_.p()}Rs(e){var t;return((t=this.D_[e])==null?void 0:t.time)??null}ss(e){return this.D_[e]??null}J_(e,t){if(this.D_.length<1)return null;if(this.o_.key(e)>this.o_.key(this.D_[this.D_.length-1].time))return t?this.D_.length-1:null;const n=Ds(this.D_,this.o_.key(e),(r,a)=>this.o_.key(r.time)<a);return this.o_.key(e)<this.o_.key(this.D_[n].time)?t?n:null:n}Ki(){return this.Mo===0||this.D_.length===0||this.R_===null}Q_(){return this.D_.length>0}Pe(){return this.tu(),this.B_.k_()}iu(){return this.tu(),this.B_.y_()}su(){const e=this.Pe();if(e===null)return null;const t={from:e.Uh(),to:e.bi()};return this.nu(t)}nu(e){const t=Math.round(e.from),n=Math.round(e.to),r=Q(this.eu()),a=Q(this.ru());return{from:Q(this.ss(Math.max(r,t))),to:Q(this.ss(Math.min(a,n)))}}hu(e){return{from:Q(this.J_(e.from,!0)),to:Q(this.J_(e.to,!0))}}Qi(){return this.Mo}Eo(e){if(!isFinite(e)||e<=0||this.Mo===e)return;const t=this.iu(),n=this.Mo;if(this.Mo=e,this.E_=!0,this.Ps.lockVisibleTimeRangeOnResize&&n!==0){const r=this.q_*e/n;this.q_=r}if(this.Ps.fixLeftEdge&&t!==null&&t.Uh()<=0){const r=n-e;this.U_-=Math.round(r/this.q_)+1,this.E_=!0}this.au(),this.lu()}qt(e){if(this.Ki()||!yi(e))return 0;const t=this.ou()+this.U_-e;return this.Mo-(t+.5)*this.q_-1}_u(e,t){const n=this.ou(),r=t===void 0?0:t.from,a=t===void 0?e.length:t.to;for(let o=r;o<a;o++){const l=e[o].wt,c=n+this.U_-l,h=this.Mo-(c+.5)*this.q_-1;e[o]._t=h}}uu(e,t){const n=Math.ceil(this.cu(e));return t&&this.Ps.ignoreWhitespaceIndices&&!this.du(n)?this.fu(n):n}fn(e){this.E_=!0,this.U_=e,this.lu(),this.ts.pu(),this.ts.ar()}vu(){return this.q_}dn(e){this.mu(e),this.lu(),this.ts.pu(),this.ts.ar()}wu(){return this.U_}Va(){if(this.Ki())return null;if(this.N_!==null)return this.N_;const e=this.q_,t=5*(this.ts.N().layout.fontSize+4)/8*(this.Ps.tickMarkMaxCharacterLength||8),n=Math.round(t/e),r=Q(this.Pe()),a=Math.max(r.Uh(),r.Uh()-n),o=Math.max(r.bi(),r.bi()-n),l=this.V_.M_(e,t,this.Ps.ignoreWhitespaceIndices,this.F_,this.W_),c=this.eu()+n,h=this.ru()-n,d=this.gu(),m=this.Ps.fixLeftEdge||d,x=this.Ps.fixRightEdge||d;let b=0;for(const p of l){if(!(a<=p.index&&p.index<=o))continue;let g;b<this.H_.length?(g=this.H_[b],g.coord=this.qt(p.index),g.label=this.Mu(p),g.weight=p.weight):(g={needAlignCoordinate:!1,coord:this.qt(p.index),label:this.Mu(p),weight:p.weight},this.H_.push(g)),this.q_>t/2&&!d?g.needAlignCoordinate=!1:g.needAlignCoordinate=m&&p.index<=c||x&&p.index>=h,b++}return this.H_.length=b,this.N_=this.H_,this.H_}bu(){this.E_=!0,this.dn(this.Ps.barSpacing),this.fn(this.Ps.rightOffset)}Su(e){this.E_=!0,this.R_=e,this.lu(),this.Z_()}xu(e,t){const n=this.cu(e),r=this.vu(),a=r+t*(r/10);this.dn(a),this.Ps.rightBarStaysOnScroll||this.fn(this.wu()+(n-this.cu(e)))}eo(e){this.wl&&this.oo(),this.ml===null&&this.O_===null&&(this.Ki()||(this.ml=e,this.Cu()))}ro(e){if(this.O_===null)return;const t=Ms(this.Mo-e,0,this.Mo),n=Ms(this.Mo-Q(this.ml),0,this.Mo);t!==0&&n!==0&&this.dn(this.O_.vu*t/n)}ho(){this.ml!==null&&(this.ml=null,this.Pu())}ao(e){this.wl===null&&this.O_===null&&(this.Ki()||(this.wl=e,this.Cu()))}lo(e){if(this.wl===null)return;const t=(this.wl-e)/this.vu();this.U_=Q(this.O_).wu+t,this.E_=!0,this.lu()}oo(){this.wl!==null&&(this.wl=null,this.Pu())}ku(){this.yu(this.Ps.rightOffset)}yu(e,t=400){if(!isFinite(e))throw new RangeError("offset is required and must be finite number");if(!isFinite(t)||t<=0)throw new RangeError("animationDuration (optional) must be finite positive number");const n=this.U_,r=performance.now();this.ts._n({Tu:a=>(a-r)/t>=1,Ru:a=>{const o=(a-r)/t;return o>=1?e:n+(e-n)*o}})}kt(e,t){this.E_=!0,this.D_=e,this.V_.w_(e,t),this.lu()}Du(){return this.A_}Vu(){return this.z_}Iu(){return this.L_}ou(){return this.R_||0}Bu(e){const t=e.f_();this.mu(this.Mo/t),this.U_=e.bi()-this.ou(),this.lu(),this.E_=!0,this.ts.pu(),this.ts.ar()}Eu(){const e=this.eu(),t=this.ru();e!==null&&t!==null&&this.Bu(new ci(e,t+this.Ps.rightOffset))}Au(e){const t=new ci(e.from,e.to);this.Bu(t)}ns(e){return this.Sl.timeFormatter!==void 0?this.Sl.timeFormatter(e.originalTime):this.o_.formatHorzItem(e.time)}j_(){if(!this.Ps.ignoreWhitespaceIndices)return;this.F_.clear();const e=this.ts.js();for(const t of e)for(const n of t.ma())this.F_.set(n,!0);this.W_++}gu(){const e=this.ts.N().handleScroll,t=this.ts.N().handleScale;return!(e.horzTouchDrag||e.mouseWheel||e.pressedMouseMove||e.vertTouchDrag||t.axisDoubleClickReset.time||t.axisPressedMouseMove.time||t.mouseWheel||t.pinch)}eu(){return this.D_.length===0?null:0}ru(){return this.D_.length===0?null:this.D_.length-1}zu(e){return(this.Mo-1-e)/this.q_}cu(e){const t=this.zu(e),n=this.ou()+this.U_-t;return Math.round(1e6*n)/1e6}mu(e){const t=this.q_;this.q_=e,this.au(),t!==this.q_&&(this.E_=!0,this.Lu())}tu(){if(!this.E_)return;if(this.E_=!1,this.Ki())return void this.Ou(Rs.T_());const e=this.ou(),t=this.Mo/this.q_,n=this.U_+e,r=new ci(n-t+1,n);this.Ou(new Rs(r))}au(){const e=Ms(this.q_,this.Nu(),this.Fu());this.q_!==e&&(this.q_=e,this.E_=!0)}Fu(){return this.Ps.maxBarSpacing>0?this.Ps.maxBarSpacing:.5*this.Mo}Nu(){return this.Ps.fixLeftEdge&&this.Ps.fixRightEdge&&this.D_.length!==0?this.Mo/this.D_.length:this.Ps.minBarSpacing}lu(){const e=this.Wu();e!==null&&this.U_<e&&(this.U_=e,this.E_=!0);const t=this.Hu();this.U_>t&&(this.U_=t,this.E_=!0)}Wu(){const e=this.eu(),t=this.R_;return e===null||t===null?null:e-t-1+(this.Ps.fixLeftEdge?this.Mo/this.q_:Math.min(2,this.D_.length))}Hu(){return this.Ps.fixRightEdge?0:this.Mo/this.q_-Math.min(2,this.D_.length)}Cu(){this.O_={vu:this.vu(),wu:this.wu()}}Pu(){this.O_=null}Mu(e){let t=this.I_.get(e.weight);return t===void 0&&(t=new X0(n=>this.Uu(n),this.o_),this.I_.set(e.weight,t)),t.__(e)}Uu(e){return this.o_.formatTickmark(e,this.Sl)}Ou(e){const t=this.B_;this.B_=e,Sl(t.k_(),this.B_.k_())||this.A_.p(),Sl(t.y_(),this.B_.y_())||this.z_.p(),this.Lu()}Lu(){this.N_=null}X_(){this.Lu(),this.I_.clear()}Y_(){this.o_.updateFormatter(this.Sl)}Z_(){if(!this.Ps.fixLeftEdge)return;const e=this.eu();if(e===null)return;const t=this.Pe();if(t===null)return;const n=t.Uh()-e;if(n<0){const r=this.U_-n-1;this.fn(r)}this.au()}G_(){this.lu(),this.au()}du(e){return!this.Ps.ignoreWhitespaceIndices||this.F_.get(e)||!1}fu(e){const t=function*(r){const a=Math.round(r),o=a<r;let l=1;for(;;)o?(yield a+l,yield a-l):(yield a-l,yield a+l),l++}(e),n=this.ru();for(;n;){const r=t.next().value;if(this.F_.get(r))return r;if(r<0||r>n)break}return e}}var Nl,kl,Cl,wa,Pl;(function(s){s[s.OnTouchEnd=0]="OnTouchEnd",s[s.OnNextTap=1]="OnNextTap"})(Nl||(Nl={}));class sv{constructor(e,t,n){this.$u=[],this.qu=[],this.Mo=0,this.Yu=null,this.ju=new Be,this.Ku=new Be,this.Xu=null,this.Zu=e,this.Ps=t,this.o_=n,this.xl=new s0(this.Ps.layout.colorParsers),this.Gu=new t0(this),this.uh=new tv(this,t.timeScale,this.Ps.localization,n),this.Ct=new m0(this,t.crosshair),this.Ju=new W0(t.crosshair),t.addDefaultPane&&(this.Qu(0),this.$u[0].Bo(2)),this.tc=this.sc(0),this.nc=this.sc(1)}Bh(){this.ec(qe.gn())}ar(){this.ec(qe.wn())}Zh(){this.ec(new qe(1))}Eh(e){const t=this.rc(e);this.ec(t)}hc(){return this.Yu}ac(e){var n,r,a,o;if(((n=this.Yu)==null?void 0:n.n_)===(e==null?void 0:e.n_)&&((a=(r=this.Yu)==null?void 0:r.e_)==null?void 0:a.Kn)===((o=e==null?void 0:e.e_)==null?void 0:o.Kn))return;const t=this.Yu;this.Yu=e,t!==null&&this.Eh(t.n_),e!==null&&e.n_!==(t==null?void 0:t.n_)&&this.Eh(e.n_)}N(){return this.Ps}hr(e){dt(this.Ps,e),this.$u.forEach(t=>t.Ro(e)),e.timeScale!==void 0&&this.uh.hr(e.timeScale),e.localization!==void 0&&this.uh.K_(e.localization),(e.leftPriceScale||e.rightPriceScale)&&this.ju.p(),this.tc=this.sc(0),this.nc=this.sc(1),this.Bh()}lc(e,t,n=0){const r=this.$u[n];if(r===void 0)return;if(e==="left")return dt(this.Ps,{leftPriceScale:t}),r.Ro({leftPriceScale:t}),this.ju.p(),void this.Bh();if(e==="right")return dt(this.Ps,{rightPriceScale:t}),r.Ro({rightPriceScale:t}),this.ju.p(),void this.Bh();const a=this.oc(e,n);a!==null&&(a.Ft.hr(t),this.ju.p())}oc(e,t){const n=this.$u[t];if(n===void 0)return null;const r=n.Do(e);return r!==null?{Us:n,Ft:r}:null}Et(){return this.uh}$s(){return this.$u}_c(){return this.Ct}uc(){return this.Ku}cc(e,t){e.zl(t),this.pu()}Eo(e){this.Mo=e,this.uh.Eo(this.Mo),this.$u.forEach(t=>t.Eo(e)),this.pu()}dc(e){this.$u.length!==1&&(Ge(e>=0&&e<this.$u.length,"Invalid pane index"),this.$u.splice(e,1),this.Bh())}fc(e,t){if(this.$u.length<2)return;Ge(e>=0&&e<this.$u.length,"Invalid pane index");const n=this.$u[e],r=this.$u.reduce((m,x)=>m+x.Io(),0),a=this.$u.reduce((m,x)=>m+x.$t(),0),o=a-30*(this.$u.length-1);t=Math.min(o,Math.max(30,t));const l=r/a,c=n.$t();n.Bo(t*l);let h=t-c,d=this.$u.length-1;for(const m of this.$u)if(m!==n){const x=Math.min(o,Math.max(30,m.$t()-h/d));h-=m.$t()-x,d-=1;const b=x*l;m.Bo(b)}this.Bh()}vc(e,t){Ge(e>=0&&e<this.$u.length&&t>=0&&t<this.$u.length,"Invalid pane index");const n=this.$u[e],r=this.$u[t];this.$u[e]=r,this.$u[t]=n,this.Bh()}mc(e,t){if(Ge(e>=0&&e<this.$u.length&&t>=0&&t<this.$u.length,"Invalid pane index"),e===t)return;const[n]=this.$u.splice(e,1);this.$u.splice(t,0,n),this.Bh()}Uo(e,t,n){e.Uo(t,n)}$o(e,t,n){e.$o(t,n),this.Ah(),this.ec(this.wc(e,2))}qo(e,t){e.qo(t),this.ec(this.wc(e,2))}Yo(e,t,n){t.Rl()||e.Yo(t,n)}jo(e,t,n){t.Rl()||(e.jo(t,n),this.Ah(),this.ec(this.wc(e,2)))}Ko(e,t){t.Rl()||(e.Ko(t),this.ec(this.wc(e,2)))}Zo(e,t){e.Zo(t),this.ec(this.wc(e,2))}gc(e){this.uh.eo(e)}Mc(e,t){const n=this.Et();if(n.Ki()||t===0)return;const r=n.Qi();e=Math.max(1,Math.min(e,r)),n.xu(e,t),this.pu()}bc(e){this.Sc(0),this.xc(e),this.Cc()}Pc(e){this.uh.ro(e),this.pu()}kc(){this.uh.ho(),this.ar()}Sc(e){this.uh.ao(e)}xc(e){this.uh.lo(e),this.pu()}Cc(){this.uh.oo(),this.ar()}js(){return this.qu}yc(e,t,n,r,a){this.Ct.Vs(e,t);let o=NaN,l=this.uh.uu(e,!0);const c=this.uh.Pe();c!==null&&(l=Math.min(Math.max(c.Uh(),l),c.bi()));const h=r.ys(),d=h.zt();if(d!==null&&(o=h.Ts(t,d)),o=this.Ju.Ma(o,l,r),this.Ct.As(l,o,r),this.Zh(),!a){const m=Jh(r,e,t);this.ac(m&&{n_:m.n_,e_:m.e_,h_:m.h_||null}),this.Ku.p(this.Ct.Bt(),{x:e,y:t},n)}}Tc(e,t,n){const r=n.ys(),a=r.zt(),o=r.Nt(e,Q(a)),l=this.uh.J_(t,!0),c=this.uh.qt(Q(l));this.yc(c,o,null,n,!0)}Rc(e){this._c().Ls(),this.Zh(),e||this.Ku.p(null,null,null)}Ah(){const e=this.Ct.Us();if(e!==null){const t=this.Ct.Bs(),n=this.Ct.Es();this.yc(t,n,null,e)}this.Ct.Ns()}Dc(e,t,n){const r=this.uh.Rs(0);t!==void 0&&n!==void 0&&this.uh.kt(t,n);const a=this.uh.Rs(0),o=this.uh.ou(),l=this.uh.Pe();if(l!==null&&r!==null&&a!==null){const c=l.Te(o),h=this.o_.key(r)>this.o_.key(a),d=e!==null&&e>o&&!h,m=this.uh.N().allowShiftVisibleRangeOnWhitespaceReplacement,x=c&&(n!==void 0||m)&&this.uh.N().shiftVisibleRangeOnNewBar;if(d&&!x){const b=e-o;this.uh.fn(this.uh.wu()-b)}}this.uh.Su(e)}Lh(e){e!==null&&e.Jo()}Hn(e){if(function(n){return n instanceof jl}(e))return e;const t=this.$u.find(n=>n.Dt().includes(e));return t===void 0?null:t}pu(){this.$u.forEach(e=>e.Jo()),this.Ah()}m(){this.$u.forEach(e=>e.m()),this.$u.length=0,this.Ps.localization.priceFormatter=void 0,this.Ps.localization.percentageFormatter=void 0,this.Ps.localization.timeFormatter=void 0}Vc(){return this.Gu}Yn(){return this.Gu.N()}Vo(){return this.ju}Ic(e,t){const n=this.Qu(t);this.Bc(e,n),this.qu.push(e),this.qu.length===1?this.Bh():this.ar()}Ec(e){const t=this.Hn(e),n=this.qu.indexOf(e);Ge(n!==-1,"Series not found");const r=Q(t);this.qu.splice(n,1),r.io(e),e.m&&e.m(),this.uh.j_(),this.Ac(r)}Ih(e,t){const n=Q(this.Hn(e));n.io(e,!0),n.Jl(e,t,!0)}Eu(){const e=qe.wn();e.rn(),this.ec(e)}zc(e){const t=qe.wn();t.ln(e),this.ec(t)}cn(){const e=qe.wn();e.cn(),this.ec(e)}dn(e){const t=qe.wn();t.dn(e),this.ec(t)}fn(e){const t=qe.wn();t.fn(e),this.ec(t)}_n(e){const t=qe.wn();t._n(e),this.ec(t)}hn(){const e=qe.wn();e.hn(),this.ec(e)}Lc(){return this.Ps.rightPriceScale.visible?"right":"left"}Oc(e,t){if(Ge(t>=0,"Index should be greater or equal to 0"),t===this.Nc(e))return;const n=Q(this.Hn(e));n.io(e);const r=this.Qu(t);this.Bc(e,r),n.ba().length===0&&this.Ac(n),this.Bh()}Fc(){return this.nc}$(){return this.tc}Ut(e){const t=this.nc,n=this.tc;if(t===n)return t;if(e=Math.max(0,Math.min(100,Math.round(100*e))),this.Xu===null||this.Xu.mr!==n||this.Xu.wr!==t)this.Xu={mr:n,wr:t,Wc:new Map};else{const a=this.Xu.Wc.get(e);if(a!==void 0)return a}const r=this.xl.tt(n,t,e/100);return this.Xu.Wc.set(e,r),r}Hc(e){return this.$u.indexOf(e)}Xi(){return this.xl}Uc(){return this.$c()}$c(e){const t=new jl(this.uh,this);this.$u.push(t);const n=e??this.$u.length-1,r=qe.gn();return r.Qs(n,{tn:0,sn:!0}),this.ec(r),t}Qu(e){return Ge(e>=0,"Index should be greater or equal to 0"),(e=Math.min(this.$u.length,e))<this.$u.length?this.$u[e]:this.$c(e)}Nc(e){return this.$u.findIndex(t=>t.Oo().includes(e))}wc(e,t){const n=new qe(t);if(e!==null){const r=this.$u.indexOf(e);n.Qs(r,{tn:t})}return n}rc(e,t){return t===void 0&&(t=2),this.wc(this.Hn(e),t)}ec(e){this.Zu&&this.Zu(e),this.$u.forEach(t=>t.i_().lr().kt())}Bc(e,t){const n=e.N().priceScaleId,r=n!==void 0?n:this.Lc();t.Jl(e,r),qn(r)||e.hr(e.N())}sc(e){const t=this.Ps.layout;return t.background.type==="gradient"?e===0?t.background.topColor:t.background.bottomColor:t.background.color}Ac(e){!e.Lo()&&e.ba().length===0&&this.$u.length>1&&this.$u.splice(this.Hc(e),1)}}function ja(s){return!Bs(s)&&!Ti(s)}function Xh(s){return Bs(s)}(function(s){s[s.Disabled=0]="Disabled",s[s.Continuous=1]="Continuous",s[s.OnDataUpdate=2]="OnDataUpdate"})(kl||(kl={})),function(s){s[s.LastBar=0]="LastBar",s[s.LastVisible=1]="LastVisible"}(Cl||(Cl={})),function(s){s.Solid="solid",s.VerticalGradient="gradient"}(wa||(wa={})),function(s){s[s.Year=0]="Year",s[s.Month=1]="Month",s[s.DayOfMonth=2]="DayOfMonth",s[s.Time=3]="Time",s[s.TimeWithSeconds=4]="TimeWithSeconds"}(Pl||(Pl={}));const Tl=s=>s.getUTCFullYear();function iv(s,e,t){return e.replace(/yyyy/g,(n=>Rt(Tl(n),4))(s)).replace(/yy/g,(n=>Rt(Tl(n)%100,2))(s)).replace(/MMMM/g,((n,r)=>new Date(n.getUTCFullYear(),n.getUTCMonth(),1).toLocaleString(r,{month:"long"}))(s,t)).replace(/MMM/g,((n,r)=>new Date(n.getUTCFullYear(),n.getUTCMonth(),1).toLocaleString(r,{month:"short"}))(s,t)).replace(/MM/g,(n=>Rt((r=>r.getUTCMonth()+1)(n),2))(s)).replace(/dd/g,(n=>Rt((r=>r.getUTCDate())(n),2))(s))}class Zh{constructor(e="yyyy-MM-dd",t="default"){this.qc=e,this.Yc=t}__(e){return iv(e,this.qc,this.Yc)}}class nv{constructor(e){this.jc=e||"%h:%m:%s"}__(e){return this.jc.replace("%h",Rt(e.getUTCHours(),2)).replace("%m",Rt(e.getUTCMinutes(),2)).replace("%s",Rt(e.getUTCSeconds(),2))}}const rv={Kc:"yyyy-MM-dd",Xc:"%h:%m:%s",Zc:" ",Gc:"default"};class av{constructor(e={}){const t={...rv,...e};this.Jc=new Zh(t.Kc,t.Gc),this.Qc=new nv(t.Xc),this.td=t.Zc}__(e){return`${this.Jc.__(e)}${this.td}${this.Qc.__(e)}`}}function Vi(s){return 60*s*60*1e3}function _r(s){return 60*s*1e3}const Hi=[{sd:(El=1,1e3*El),nd:10},{sd:_r(1),nd:20},{sd:_r(5),nd:21},{sd:_r(30),nd:22},{sd:Vi(1),nd:30},{sd:Vi(3),nd:31},{sd:Vi(6),nd:32},{sd:Vi(12),nd:33}];var El;function Il(s,e){if(s.getUTCFullYear()!==e.getUTCFullYear())return 70;if(s.getUTCMonth()!==e.getUTCMonth())return 60;if(s.getUTCDate()!==e.getUTCDate())return 50;for(let t=Hi.length-1;t>=0;--t)if(Math.floor(e.getTime()/Hi[t].sd)!==Math.floor(s.getTime()/Hi[t].sd))return Hi[t].nd;return 0}function Lr(s){let e=s;if(Ti(s)&&(e=Ja(s)),!ja(e))throw new Error("time must be of type BusinessDay");const t=new Date(Date.UTC(e.year,e.month-1,e.day,0,0,0,0));return{ed:Math.round(t.getTime()/1e3),rd:e}}function _l(s){if(!Xh(s))throw new Error("time must be of type isUTCTimestamp");return{ed:s}}function Ja(s){const e=new Date(s);if(isNaN(e.getTime()))throw new Error(`Invalid date string=${s}, expected format=yyyy-mm-dd`);return{day:e.getUTCDate(),month:e.getUTCMonth()+1,year:e.getUTCFullYear()}}function Ll(s){Ti(s.time)&&(s.time=Ja(s.time))}class Ml{options(){return this.Ps}setOptions(e){this.Ps=e,this.updateFormatter(e.localization)}preprocessData(e){Array.isArray(e)?function(t){t.forEach(Ll)}(e):Ll(e)}createConverterToInternalObj(e){return Q(function(t){return t.length===0?null:ja(t[0].time)||Ti(t[0].time)?Lr:_l}(e))}key(e){return typeof e=="object"&&"ed"in e?e.ed:this.key(this.convertHorzItemToInternal(e))}cacheKey(e){const t=e;return t.rd===void 0?new Date(1e3*t.ed).getTime():new Date(Date.UTC(t.rd.year,t.rd.month-1,t.rd.day)).getTime()}convertHorzItemToInternal(e){return Xh(t=e)?_l(t):ja(t)?Lr(t):Lr(Ja(t));var t}updateFormatter(e){if(!this.Ps)return;const t=e.dateFormat;this.Ps.timeScale.timeVisible?this.hd=new av({Kc:t,Xc:this.Ps.timeScale.secondsVisible?"%h:%m:%s":"%h:%m",Zc:"   ",Gc:e.locale}):this.hd=new Zh(t,e.locale)}formatHorzItem(e){const t=e;return this.hd.__(new Date(1e3*t.ed))}formatTickmark(e,t){const n=function(a,o,l){switch(a){case 0:case 10:return o?l?4:3:2;case 20:case 21:case 22:case 30:case 31:case 32:case 33:return o?3:2;case 50:return 2;case 60:return 1;case 70:return 0}}(e.weight,this.Ps.timeScale.timeVisible,this.Ps.timeScale.secondsVisible),r=this.Ps.timeScale;if(r.tickMarkFormatter!==void 0){const a=r.tickMarkFormatter(e.originalTime,n,t.locale);if(a!==null)return a}return function(a,o,l){const c={};switch(o){case 0:c.year="numeric";break;case 1:c.month="short";break;case 2:c.day="numeric";break;case 3:c.hour12=!1,c.hour="2-digit",c.minute="2-digit";break;case 4:c.hour12=!1,c.hour="2-digit",c.minute="2-digit",c.second="2-digit"}const h=a.rd===void 0?new Date(1e3*a.ed):new Date(Date.UTC(a.rd.year,a.rd.month-1,a.rd.day));return new Date(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate(),h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()).toLocaleString(l,c)}(e.time,n,t.locale)}maxTickMarkWeight(e){let t=e.reduce(ev,e[0]).weight;return t>30&&t<50&&(t=30),t}fillWeightsForPoints(e,t){(function(n,r=0){if(n.length===0)return;let a=r===0?null:n[r-1].time.ed,o=a!==null?new Date(1e3*a):null,l=0;for(let c=r;c<n.length;++c){const h=n[c],d=new Date(1e3*h.time.ed);o!==null&&(h.timeWeight=Il(d,o)),l+=h.time.ed-(a||h.time.ed),a=h.time.ed,o=d}if(r===0&&n.length>1){const c=Math.ceil(l/(n.length-1)),h=new Date(1e3*(n[0].time.ed-c));n[0].timeWeight=Il(new Date(1e3*n[0].time.ed),h)}})(e,t)}static ad(e){return dt({localization:{dateFormat:"dd MMM 'yy"}},e??{})}}const $s=typeof window<"u";function Rl(){return!!$s&&window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}function Mr(){return!!$s&&/iPhone|iPad|iPod/.test(window.navigator.platform)}function Sa(s){return s+s%2}function ov(s){$s&&window.chrome!==void 0&&s.addEventListener("mousedown",e=>{if(e.button===1)return e.preventDefault(),!1})}class Kn{constructor(e,t,n){this.ld=0,this.od=null,this._d={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.ud=0,this.dd=null,this.fd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY},this.pd=null,this.vd=!1,this.md=null,this.wd=null,this.gd=!1,this.Md=!1,this.bd=!1,this.Sd=null,this.xd=null,this.Cd=null,this.Pd=null,this.kd=null,this.yd=null,this.Td=null,this.Rd=0,this.Dd=!1,this.Vd=!1,this.Id=!1,this.Bd=0,this.Ed=null,this.Ad=!Mr(),this.zd=r=>{this.Ld(r)},this.Od=r=>{if(this.Nd(r)){const a=this.Fd(r);if(++this.ud,this.dd&&this.ud>1){const{Wd:o}=this.Hd(Tt(r),this.fd);o<30&&!this.bd&&this.Ud(a,this.qd.$d),this.Yd()}}else{const a=this.Fd(r);if(++this.ld,this.od&&this.ld>1){const{Wd:o}=this.Hd(Tt(r),this._d);o<5&&!this.Md&&this.jd(a,this.qd.Kd),this.Xd()}}},this.Zd=e,this.qd=t,this.Ps=n,this.Gd()}m(){this.Sd!==null&&(this.Sd(),this.Sd=null),this.xd!==null&&(this.xd(),this.xd=null),this.Pd!==null&&(this.Pd(),this.Pd=null),this.kd!==null&&(this.kd(),this.kd=null),this.yd!==null&&(this.yd(),this.yd=null),this.Cd!==null&&(this.Cd(),this.Cd=null),this.Jd(),this.Xd()}Qd(e){this.Pd&&this.Pd();const t=this.tf.bind(this);if(this.Pd=()=>{this.Zd.removeEventListener("mousemove",t)},this.Zd.addEventListener("mousemove",t),this.Nd(e))return;const n=this.Fd(e);this.jd(n,this.qd.if),this.Ad=!0}Xd(){this.od!==null&&clearTimeout(this.od),this.ld=0,this.od=null,this._d={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}Yd(){this.dd!==null&&clearTimeout(this.dd),this.ud=0,this.dd=null,this.fd={_t:Number.NEGATIVE_INFINITY,ut:Number.POSITIVE_INFINITY}}tf(e){if(this.Id||this.wd!==null||this.Nd(e))return;const t=this.Fd(e);this.jd(t,this.qd.sf),this.Ad=!0}nf(e){const t=Rr(e.changedTouches,Q(this.Ed));if(t===null||(this.Bd=Yi(e),this.Td!==null)||this.Vd)return;this.Dd=!0;const n=this.Hd(Tt(t),Q(this.wd)),{ef:r,rf:a,Wd:o}=n;if(this.gd||!(o<5)){if(!this.gd){const l=.5*r,c=a>=l&&!this.Ps.hf(),h=l>a&&!this.Ps.af();c||h||(this.Vd=!0),this.gd=!0,this.bd=!0,this.Jd(),this.Yd()}if(!this.Vd){const l=this.Fd(e,t);this.Ud(l,this.qd.lf),Es(e)}}}_f(e){if(e.button!==0)return;const t=this.Hd(Tt(e),Q(this.md)),{Wd:n}=t;if(n>=5&&(this.Md=!0,this.Xd()),this.Md){const r=this.Fd(e);this.jd(r,this.qd.uf)}}Hd(e,t){const n=Math.abs(t._t-e._t),r=Math.abs(t.ut-e.ut);return{ef:n,rf:r,Wd:n+r}}cf(e){let t=Rr(e.changedTouches,Q(this.Ed));if(t===null&&e.touches.length===0&&(t=e.changedTouches[0]),t===null)return;this.Ed=null,this.Bd=Yi(e),this.Jd(),this.wd=null,this.yd&&(this.yd(),this.yd=null);const n=this.Fd(e,t);if(this.Ud(n,this.qd.df),++this.ud,this.dd&&this.ud>1){const{Wd:r}=this.Hd(Tt(t),this.fd);r<30&&!this.bd&&this.Ud(n,this.qd.$d),this.Yd()}else this.bd||(this.Ud(n,this.qd.ff),this.qd.ff&&Es(e));this.ud===0&&Es(e),e.touches.length===0&&this.vd&&(this.vd=!1,Es(e))}Ld(e){if(e.button!==0)return;const t=this.Fd(e);if(this.md=null,this.Id=!1,this.kd&&(this.kd(),this.kd=null),Rl()&&this.Zd.ownerDocument.documentElement.removeEventListener("mouseleave",this.zd),!this.Nd(e))if(this.jd(t,this.qd.pf),++this.ld,this.od&&this.ld>1){const{Wd:n}=this.Hd(Tt(e),this._d);n<5&&!this.Md&&this.jd(t,this.qd.Kd),this.Xd()}else this.Md||this.jd(t,this.qd.vf)}Jd(){this.pd!==null&&(clearTimeout(this.pd),this.pd=null)}mf(e){if(this.Ed!==null)return;const t=e.changedTouches[0];this.Ed=t.identifier,this.Bd=Yi(e);const n=this.Zd.ownerDocument.documentElement;this.bd=!1,this.gd=!1,this.Vd=!1,this.wd=Tt(t),this.yd&&(this.yd(),this.yd=null);{const a=this.nf.bind(this),o=this.cf.bind(this);this.yd=()=>{n.removeEventListener("touchmove",a),n.removeEventListener("touchend",o)},n.addEventListener("touchmove",a,{passive:!1}),n.addEventListener("touchend",o,{passive:!1}),this.Jd(),this.pd=setTimeout(this.wf.bind(this,e),240)}const r=this.Fd(e,t);this.Ud(r,this.qd.gf),this.dd||(this.ud=0,this.dd=setTimeout(this.Yd.bind(this),500),this.fd=Tt(t))}Mf(e){if(e.button!==0)return;const t=this.Zd.ownerDocument.documentElement;Rl()&&t.addEventListener("mouseleave",this.zd),this.Md=!1,this.md=Tt(e),this.kd&&(this.kd(),this.kd=null);{const r=this._f.bind(this),a=this.Ld.bind(this);this.kd=()=>{t.removeEventListener("mousemove",r),t.removeEventListener("mouseup",a)},t.addEventListener("mousemove",r),t.addEventListener("mouseup",a)}if(this.Id=!0,this.Nd(e))return;const n=this.Fd(e);this.jd(n,this.qd.bf),this.od||(this.ld=0,this.od=setTimeout(this.Xd.bind(this),500),this._d=Tt(e))}Gd(){this.Zd.addEventListener("mouseenter",this.Qd.bind(this)),this.Zd.addEventListener("touchcancel",this.Jd.bind(this));{const e=this.Zd.ownerDocument,t=n=>{this.qd.Sf&&(n.composed&&this.Zd.contains(n.composedPath()[0])||n.target&&this.Zd.contains(n.target)||this.qd.Sf())};this.xd=()=>{e.removeEventListener("touchstart",t)},this.Sd=()=>{e.removeEventListener("mousedown",t)},e.addEventListener("mousedown",t),e.addEventListener("touchstart",t,{passive:!0})}Mr()&&(this.Cd=()=>{this.Zd.removeEventListener("dblclick",this.Od)},this.Zd.addEventListener("dblclick",this.Od)),this.Zd.addEventListener("mouseleave",this.xf.bind(this)),this.Zd.addEventListener("touchstart",this.mf.bind(this),{passive:!0}),ov(this.Zd),this.Zd.addEventListener("mousedown",this.Mf.bind(this)),this.Cf(),this.Zd.addEventListener("touchmove",()=>{},{passive:!1})}Cf(){this.qd.Pf===void 0&&this.qd.kf===void 0&&this.qd.yf===void 0||(this.Zd.addEventListener("touchstart",e=>this.Tf(e.touches),{passive:!0}),this.Zd.addEventListener("touchmove",e=>{if(e.touches.length===2&&this.Td!==null&&this.qd.kf!==void 0){const t=Al(e.touches[0],e.touches[1])/this.Rd;this.qd.kf(this.Td,t),Es(e)}},{passive:!1}),this.Zd.addEventListener("touchend",e=>{this.Tf(e.touches)}))}Tf(e){e.length===1&&(this.Dd=!1),e.length!==2||this.Dd||this.vd?this.Rf():this.Df(e)}Df(e){const t=this.Zd.getBoundingClientRect()||{left:0,top:0};this.Td={_t:(e[0].clientX-t.left+(e[1].clientX-t.left))/2,ut:(e[0].clientY-t.top+(e[1].clientY-t.top))/2},this.Rd=Al(e[0],e[1]),this.qd.Pf!==void 0&&this.qd.Pf(),this.Jd()}Rf(){this.Td!==null&&(this.Td=null,this.qd.yf!==void 0&&this.qd.yf())}xf(e){if(this.Pd&&this.Pd(),this.Nd(e)||!this.Ad)return;const t=this.Fd(e);this.jd(t,this.qd.Vf),this.Ad=!Mr()}wf(e){const t=Rr(e.touches,Q(this.Ed));if(t===null)return;const n=this.Fd(e,t);this.Ud(n,this.qd.If),this.bd=!0,this.vd=!0}Nd(e){return e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents!==void 0?e.sourceCapabilities.firesTouchEvents:Yi(e)<this.Bd+500}Ud(e,t){t&&t.call(this.qd,e)}jd(e,t){t&&t.call(this.qd,e)}Fd(e,t){const n=t||e,r=this.Zd.getBoundingClientRect()||{left:0,top:0};return{clientX:n.clientX,clientY:n.clientY,pageX:n.pageX,pageY:n.pageY,screenX:n.screenX,screenY:n.screenY,localX:n.clientX-r.left,localY:n.clientY-r.top,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,Bf:!e.type.startsWith("mouse")&&e.type!=="contextmenu"&&e.type!=="click",Ef:e.type,Af:n.target,a_:e.view,zf:()=>{e.type!=="touchstart"&&Es(e)}}}}function Al(s,e){const t=s.clientX-e.clientX,n=s.clientY-e.clientY;return Math.sqrt(t*t+n*n)}function Es(s){s.cancelable&&s.preventDefault()}function Tt(s){return{_t:s.pageX,ut:s.pageY}}function Yi(s){return s.timeStamp||performance.now()}function Rr(s,e){for(let t=0;t<s.length;++t)if(s[t].identifier===e)return s[t];return null}class lv{constructor(e,t,n){this.Lf=null,this.Of=null,this.Nf=!0,this.Ff=null,this.Wf=e,this.Hf=e.Uf()[t],this.$f=e.Uf()[n],this.qf=document.createElement("tr"),this.qf.style.height="1px",this.Yf=document.createElement("td"),this.Yf.style.position="relative",this.Yf.style.padding="0",this.Yf.style.margin="0",this.Yf.setAttribute("colspan","3"),this.jf(),this.qf.appendChild(this.Yf),this.Nf=this.Wf.N().layout.panes.enableResize,this.Nf?this.Kf():(this.Lf=null,this.Of=null)}m(){this.Of!==null&&this.Of.m()}Xf(){return this.qf}Zf(){return Ie({width:this.Hf.Zf().width,height:1})}Gf(){return Ie({width:this.Hf.Gf().width,height:1*window.devicePixelRatio})}Jf(e,t,n){const r=this.Gf();e.fillStyle=this.Wf.N().layout.panes.separatorColor,e.fillRect(t,n,r.width,r.height)}kt(){this.jf(),this.Wf.N().layout.panes.enableResize!==this.Nf&&(this.Nf=this.Wf.N().layout.panes.enableResize,this.Nf?this.Kf():(this.Lf!==null&&(this.Yf.removeChild(this.Lf.Qf),this.Yf.removeChild(this.Lf.tp),this.Lf=null),this.Of!==null&&(this.Of.m(),this.Of=null)))}Kf(){const e=document.createElement("div"),t=e.style;t.position="fixed",t.display="none",t.zIndex="49",t.top="0",t.left="0",t.width="100%",t.height="100%",t.cursor="row-resize",this.Yf.appendChild(e);const n=document.createElement("div"),r=n.style;r.position="absolute",r.zIndex="50",r.top="-4px",r.height="9px",r.width="100%",r.backgroundColor="",r.cursor="row-resize",this.Yf.appendChild(n);const a={if:this.ip.bind(this),Vf:this.sp.bind(this),bf:this.np.bind(this),gf:this.np.bind(this),uf:this.ep.bind(this),lf:this.ep.bind(this),pf:this.rp.bind(this),df:this.rp.bind(this)};this.Of=new Kn(n,a,{hf:()=>!1,af:()=>!0}),this.Lf={tp:n,Qf:e}}jf(){this.Yf.style.background=this.Wf.N().layout.panes.separatorColor}ip(e){this.Lf!==null&&(this.Lf.tp.style.backgroundColor=this.Wf.N().layout.panes.separatorHoverColor)}sp(e){this.Lf!==null&&this.Ff===null&&(this.Lf.tp.style.backgroundColor="")}np(e){if(this.Lf===null)return;const t=this.Hf.hp().Io()+this.$f.hp().Io(),n=t/(this.Hf.Zf().height+this.$f.Zf().height),r=30*n;t<=2*r||(this.Ff={ap:e.pageY,lp:this.Hf.hp().Io(),op:t-r,_p:t,up:n,cp:r},this.Lf.Qf.style.display="block")}ep(e){const t=this.Ff;if(t===null)return;const n=(e.pageY-t.ap)*t.up,r=Ms(t.lp+n,t.cp,t.op);this.Hf.hp().Bo(r),this.$f.hp().Bo(t._p-r),this.Wf.Qt().Bh()}rp(e){this.Ff!==null&&this.Lf!==null&&(this.Ff=null,this.Lf.Qf.style.display="none")}}function Ar(s,e){return s.dp-e.dp}function Or(s,e,t){const n=(s.dp-e.dp)/(s.wt-e.wt);return Math.sign(n)*Math.min(Math.abs(n),t)}class cv{constructor(e,t,n,r){this.fp=null,this.pp=null,this.vp=null,this.mp=null,this.wp=null,this.gp=0,this.Mp=0,this.bp=e,this.Sp=t,this.xp=n,this.Mn=r}Cp(e,t){if(this.fp!==null){if(this.fp.wt===t)return void(this.fp.dp=e);if(Math.abs(this.fp.dp-e)<this.Mn)return}this.mp=this.vp,this.vp=this.pp,this.pp=this.fp,this.fp={wt:t,dp:e}}le(e,t){if(this.fp===null||this.pp===null||t-this.fp.wt>50)return;let n=0;const r=Or(this.fp,this.pp,this.Sp),a=Ar(this.fp,this.pp),o=[r],l=[a];if(n+=a,this.vp!==null){const h=Or(this.pp,this.vp,this.Sp);if(Math.sign(h)===Math.sign(r)){const d=Ar(this.pp,this.vp);if(o.push(h),l.push(d),n+=d,this.mp!==null){const m=Or(this.vp,this.mp,this.Sp);if(Math.sign(m)===Math.sign(r)){const x=Ar(this.vp,this.mp);o.push(m),l.push(x),n+=x}}}}let c=0;for(let h=0;h<o.length;++h)c+=l[h]/n*o[h];Math.abs(c)<this.bp||(this.wp={dp:e,wt:t},this.Mp=c,this.gp=function(h,d){const m=Math.log(d);return Math.log(1*m/-h)/m}(Math.abs(c),this.xp))}Ru(e){const t=Q(this.wp),n=e-t.wt;return t.dp+this.Mp*(Math.pow(this.xp,n)-1)/Math.log(this.xp)}Tu(e){return this.wp===null||this.Pp(e)===this.gp}Pp(e){const t=e-Q(this.wp).wt;return Math.min(t,this.gp)}}class hv{constructor(e,t){this.kp=void 0,this.yp=void 0,this.Tp=void 0,this.ps=!1,this.Rp=e,this.Dp=t,this.Vp()}kt(){this.Vp()}Ip(){this.kp&&this.Rp.removeChild(this.kp),this.yp&&this.Rp.removeChild(this.yp),this.kp=void 0,this.yp=void 0}Bp(){return this.ps!==this.Ep()||this.Tp!==this.Ap()}Ap(){return this.Dp.Qt().Xi().J(this.Dp.N().layout.textColor)>160?"dark":"light"}Ep(){return this.Dp.N().layout.attributionLogo}zp(){const e=new URL(location.href);return e.hostname?"&utm_source="+e.hostname+e.pathname:""}Vp(){this.Bp()&&(this.Ip(),this.ps=this.Ep(),this.ps&&(this.Tp=this.Ap(),this.yp=document.createElement("style"),this.yp.innerText="a#tv-attr-logo{--fill:#131722;--stroke:#fff;position:absolute;left:10px;bottom:10px;height:19px;width:35px;margin:0;padding:0;border:0;z-index:3;}a#tv-attr-logo[data-dark]{--fill:#D1D4DC;--stroke:#131722;}",this.kp=document.createElement("a"),this.kp.href=`https://www.tradingview.com/?utm_medium=lwc-link&utm_campaign=lwc-chart${this.zp()}`,this.kp.title="Charting by TradingView",this.kp.id="tv-attr-logo",this.kp.target="_blank",this.kp.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="35" height="19" fill="none"><g fill-rule="evenodd" clip-path="url(#a)" clip-rule="evenodd"><path fill="var(--stroke)" d="M2 0H0v10h6v9h21.4l.5-1.3 6-15 1-2.7H23.7l-.5 1.3-.2.6a5 5 0 0 0-7-.9V0H2Zm20 17h4l5.2-13 .8-2h-7l-1 2.5-.2.5-1.5 3.8-.3.7V17Zm-.8-10a3 3 0 0 0 .7-2.7A3 3 0 1 0 16.8 7h4.4ZM14 7V2H2v6h6v9h4V7h2Z"/><path fill="var(--fill)" d="M14 2H2v6h6v9h6V2Zm12 15h-7l6-15h7l-6 15Zm-7-9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></g><defs><clipPath id="a"><path fill="var(--stroke)" d="M0 0h35v19H0z"/></clipPath></defs></svg>',this.kp.toggleAttribute("data-dark",this.Tp==="dark"),this.Rp.appendChild(this.yp),this.Rp.appendChild(this.kp)))}}function bs(s,e){const t=Q(s.ownerDocument).createElement("canvas");s.appendChild(t);const n=Ky(t,{options:{allowResizeObserver:!0},transform:(r,a)=>({width:Math.max(r.width,a.width),height:Math.max(r.height,a.height)})});return n.resizeCanvasElement(e),n}function ws(s){var e;s.width=1,s.height=1,(e=s.getContext("2d"))==null||e.clearRect(0,0,1,1)}function Na(s,e,t,n){s.ih&&s.ih(e,t,n)}function rn(s,e,t,n){s.nt(e,t,n)}function ka(s,e,t,n){const r=s(t,n);for(const a of r){const o=a.Tt(n);o!==null&&e(o)}}function Fr(s,e){return t=>{var n,r;return function(a){return a.Ft!==void 0}(t)?(((n=t.Ft())==null?void 0:n.wa())??"")!==e?[]:((r=t.ta)==null?void 0:r.call(t,s))??[]:[]}}function Ol(s,e,t,n){if(!s.length)return;let r=0;const a=s[0].$t(n,!0);let o=e===1?t/2-(s[0].Fi()-a/2):s[0].Fi()-a/2-t/2;o=Math.max(0,o);for(let l=1;l<s.length;l++){const c=s[l],h=s[l-1],d=h.$t(n,!1),m=c.Fi(),x=h.Fi();if(e===1?m>x-d:m<x+d){const b=x-d*e;c.Wi(b);const p=b-e*d/2;if((e===1?p<0:p>t)&&o>0){const g=e===1?-1-p:p-t,f=Math.min(g,o);for(let y=r;y<s.length;y++)s[y].Wi(s[y].Fi()+e*f);o-=f}}else r=l,o=e===1?x-d-m:m-(x+d)}}class Fl{constructor(e,t,n,r){this.Yi=null,this.Lp=null,this.Op=!1,this.Np=new vn(200),this.Fp=null,this.Wp=0,this.Hp=!1,this.Up=()=>{this.Hp||this.Pt.$p().Qt().ar()},this.qp=()=>{this.Hp||this.Pt.$p().Qt().ar()},this.Pt=e,this.Ps=t,this.bl=t.layout,this.Gu=n,this.Yp=r==="left",this.jp=Fr("normal",r),this.Kp=Fr("top",r),this.Xp=Fr("bottom",r),this.Yf=document.createElement("div"),this.Yf.style.height="100%",this.Yf.style.overflow="hidden",this.Yf.style.width="25px",this.Yf.style.left="0",this.Yf.style.position="relative",this.Zp=bs(this.Yf,Ie({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up);const a=this.Zp.canvasElement;a.style.position="absolute",a.style.zIndex="1",a.style.left="0",a.style.top="0",this.Gp=bs(this.Yf,Ie({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.qp);const o=this.Gp.canvasElement;o.style.position="absolute",o.style.zIndex="2",o.style.left="0",o.style.top="0";const l={bf:this.np.bind(this),gf:this.np.bind(this),uf:this.ep.bind(this),lf:this.ep.bind(this),Sf:this.Jp.bind(this),pf:this.rp.bind(this),df:this.rp.bind(this),Kd:this.Qp.bind(this),$d:this.Qp.bind(this),if:this.tv.bind(this),Vf:this.sp.bind(this)};this.Of=new Kn(this.Gp.canvasElement,l,{hf:()=>!this.Ps.handleScroll.vertTouchDrag,af:()=>!0})}m(){this.Of.m(),this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.qp),ws(this.Gp.canvasElement),this.Gp.dispose(),this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),ws(this.Zp.canvasElement),this.Zp.dispose(),this.Yi!==null&&this.Yi.no().u(this),this.Yi=null}Xf(){return this.Yf}P(){return this.bl.fontSize}iv(){const e=this.Gu.N();return this.Fp!==e.k&&(this.Np.In(),this.Fp=e.k),e}sv(){if(this.Yi===null)return 0;let e=0;const t=this.iv(),n=Q(this.Zp.canvasElement.getContext("2d",{colorSpace:this.Pt.$p().N().layout.colorSpace}));n.save();const r=this.Yi.Va();n.font=this.nv(),r.length>0&&(e=Math.max(this.Np.Vi(n,r[0].Ga),this.Np.Vi(n,r[r.length-1].Ga)));const a=this.ev();for(let h=a.length;h--;){const d=this.Np.Vi(n,a[h].ri());d>e&&(e=d)}const o=this.Yi.zt();if(o!==null&&this.Lp!==null&&(l=this.Ps.crosshair).mode!==2&&l.horzLine.visible&&l.horzLine.labelVisible){const h=this.Yi.Ts(1,o),d=this.Yi.Ts(this.Lp.height-2,o);e=Math.max(e,this.Np.Vi(n,this.Yi.Zi(Math.floor(Math.min(h,d))+.11111111111111,o)),this.Np.Vi(n,this.Yi.Zi(Math.ceil(Math.max(h,d))-.11111111111111,o)))}var l;n.restore();const c=e||34;return Sa(Math.ceil(t.S+t.C+t.I+t.B+5+c))}rv(e){this.Lp!==null&&us(this.Lp,e)||(this.Lp=e,this.Hp=!0,this.Zp.resizeCanvasElement(e),this.Gp.resizeCanvasElement(e),this.Hp=!1,this.Yf.style.width=`${e.width}px`,this.Yf.style.height=`${e.height}px`)}hv(){return Q(this.Lp).width}_s(e){this.Yi!==e&&(this.Yi!==null&&this.Yi.no().u(this),this.Yi=e,e.no().i(this.ul.bind(this),this))}Ft(){return this.Yi}In(){const e=this.Pt.hp();this.Pt.$p().Qt().Zo(e,Q(this.Ft()))}av(e){if(this.Lp===null)return;const t={colorSpace:this.Pt.$p().N().layout.colorSpace};if(e!==1){this.lv(),this.Zp.applySuggestedBitmapSize();const r=vs(this.Zp,t);r!==null&&(r.useBitmapCoordinateSpace(a=>{this.ov(a),this._v(a)}),this.Pt.uv(r,this.Xp),this.cv(r),this.Pt.uv(r,this.jp),this.dv(r))}this.Gp.applySuggestedBitmapSize();const n=vs(this.Gp,t);n!==null&&(n.useBitmapCoordinateSpace(({context:r,bitmapSize:a})=>{r.clearRect(0,0,a.width,a.height)}),this.fv(n),this.Pt.uv(n,this.Kp))}Gf(){return this.Zp.bitmapSize}Jf(e,t,n){const r=this.Gf();r.width>0&&r.height>0&&e.drawImage(this.Zp.canvasElement,t,n)}kt(){var e;(e=this.Yi)==null||e.Va()}np(e){if(this.Yi===null||this.Yi.Ki()||!this.Ps.handleScale.axisPressedMouseMove.price)return;const t=this.Pt.$p().Qt(),n=this.Pt.hp();this.Op=!0,t.Uo(n,this.Yi,e.localY)}ep(e){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const t=this.Pt.$p().Qt(),n=this.Pt.hp(),r=this.Yi;t.$o(n,r,e.localY)}Jp(){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const e=this.Pt.$p().Qt(),t=this.Pt.hp(),n=this.Yi;this.Op&&(this.Op=!1,e.qo(t,n))}rp(e){if(this.Yi===null||!this.Ps.handleScale.axisPressedMouseMove.price)return;const t=this.Pt.$p().Qt(),n=this.Pt.hp();this.Op=!1,t.qo(n,this.Yi)}Qp(e){this.Ps.handleScale.axisDoubleClickReset.price&&this.In()}tv(e){this.Yi!==null&&(!this.Pt.$p().Qt().N().handleScale.axisPressedMouseMove.price||this.Yi.Le()||this.Yi.Vl()||this.pv(1))}sp(e){this.pv(0)}ev(){const e=[],t=this.Yi===null?void 0:this.Yi;return(n=>{for(let r=0;r<n.length;++r){const a=n[r].Ws(this.Pt.hp(),t);for(let o=0;o<a.length;o++)e.push(a[o])}})(this.Pt.hp().Dt()),e}ov({context:e,bitmapSize:t}){const{width:n,height:r}=t,a=this.Pt.hp().Qt(),o=a.$(),l=a.Fc();o===l?Hn(e,0,0,n,r,o):$h(e,0,0,n,r,o,l)}_v({context:e,bitmapSize:t,horizontalPixelRatio:n}){if(this.Lp===null||this.Yi===null||!this.Yi.N().borderVisible)return;e.fillStyle=this.Yi.N().borderColor;const r=Math.max(1,Math.floor(this.iv().S*n));let a;a=this.Yp?t.width-r:0,e.fillRect(a,0,r,t.height)}cv(e){if(this.Lp===null||this.Yi===null)return;const t=this.Yi.Va(),n=this.Yi.N(),r=this.iv(),a=this.Yp?this.Lp.width-r.C:0;n.borderVisible&&n.ticksVisible&&e.useBitmapCoordinateSpace(({context:o,horizontalPixelRatio:l,verticalPixelRatio:c})=>{o.fillStyle=n.borderColor;const h=Math.max(1,Math.floor(c)),d=Math.floor(.5*c),m=Math.round(r.C*l);o.beginPath();for(const x of t)o.rect(Math.floor(a*l),Math.round(x.ka*c)-d,m,h);o.fill()}),e.useMediaCoordinateSpace(({context:o})=>{o.font=this.nv(),o.fillStyle=n.textColor??this.bl.textColor,o.textAlign=this.Yp?"right":"left",o.textBaseline="middle";const l=this.Yp?Math.round(a-r.I):Math.round(a+r.C+r.I),c=t.map(h=>this.Np.Di(o,h.Ga));for(let h=t.length;h--;){const d=t[h];o.fillText(d.Ga,l,d.ka+c[h])}})}lv(){if(this.Lp===null||this.Yi===null)return;let e=this.Lp.height/2;const t=[],n=this.Yi.Dt().slice(),r=this.Pt.hp(),a=this.iv();this.Yi===r.$n()&&this.Pt.hp().Dt().forEach(c=>{r.Un(c)&&n.push(c)});const o=this.Yi.ba()[0],l=this.Yi;n.forEach(c=>{const h=c.Ws(r,l);h.forEach(d=>{d.Wi(null),d.Hi()&&t.push(d)}),o===c&&h.length>0&&(e=h[0].Bi())}),t.forEach(c=>c.Wi(c.Bi())),this.Yi.N().alignLabels&&this.vv(t,a,e)}vv(e,t,n){if(this.Lp===null)return;const r=e.filter(o=>o.Bi()<=n),a=e.filter(o=>o.Bi()>n);r.sort((o,l)=>l.Bi()-o.Bi()),r.length&&a.length&&a.push(r[0]),a.sort((o,l)=>o.Bi()-l.Bi());for(const o of e){const l=Math.floor(o.$t(t)/2),c=o.Bi();c>-l&&c<l&&o.Wi(l),c>this.Lp.height-l&&c<this.Lp.height+l&&o.Wi(this.Lp.height-l)}Ol(r,1,this.Lp.height,t),Ol(a,-1,this.Lp.height,t)}dv(e){if(this.Lp===null)return;const t=this.ev(),n=this.iv(),r=this.Yp?"right":"left";t.forEach(a=>{a.Ui()&&a.Tt(Q(this.Yi)).nt(e,n,this.Np,r)})}fv(e){if(this.Lp===null||this.Yi===null)return;const t=this.Pt.$p().Qt(),n=[],r=this.Pt.hp(),a=t._c().Ws(r,this.Yi);a.length&&n.push(a);const o=this.iv(),l=this.Yp?"right":"left";n.forEach(c=>{c.forEach(h=>{h.Tt(Q(this.Yi)).nt(e,o,this.Np,l)})})}pv(e){this.Yf.style.cursor=e===1?"ns-resize":"default"}ul(){const e=this.sv();this.Wp<e&&this.Pt.$p().Qt().Bh(),this.Wp=e}nv(){return yn(this.bl.fontSize,this.bl.fontFamily)}}function dv(s,e){var t;return((t=s.Jh)==null?void 0:t.call(s,e))??[]}function Bl(s,e){var t;return((t=s.Fs)==null?void 0:t.call(s,e))??[]}function Dl(s,e){var t;return((t=s.us)==null?void 0:t.call(s,e))??[]}function uv(s,e){var t;return((t=s.Xh)==null?void 0:t.call(s,e))??[]}class Xa{constructor(e,t){this.Lp=Ie({width:0,height:0}),this.mv=null,this.wv=null,this.gv=null,this.Mv=null,this.bv=!1,this.Sv=new Be,this.xv=new Be,this.Cv=0,this.Pv=!1,this.kv=null,this.yv=!1,this.Tv=null,this.Rv=null,this.Hp=!1,this.Up=()=>{this.Hp||this.Dv===null||this.ts().ar()},this.qp=()=>{this.Hp||this.Dv===null||this.ts().ar()},this.Dp=e,this.Dv=t,this.Dv.t_().i(this.Vv.bind(this),this,!0),this.Iv=document.createElement("td"),this.Iv.style.padding="0",this.Iv.style.position="relative";const n=document.createElement("div");n.style.width="100%",n.style.height="100%",n.style.position="relative",n.style.overflow="hidden",this.Bv=document.createElement("td"),this.Bv.style.padding="0",this.Ev=document.createElement("td"),this.Ev.style.padding="0",this.Iv.appendChild(n),this.Zp=bs(n,Ie({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up);const r=this.Zp.canvasElement;r.style.position="absolute",r.style.zIndex="1",r.style.left="0",r.style.top="0",this.Gp=bs(n,Ie({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.qp);const a=this.Gp.canvasElement;a.style.position="absolute",a.style.zIndex="2",a.style.left="0",a.style.top="0",this.qf=document.createElement("tr"),this.qf.appendChild(this.Bv),this.qf.appendChild(this.Iv),this.qf.appendChild(this.Ev),this.Av(),this.Of=new Kn(this.Gp.canvasElement,this,{hf:()=>this.kv===null&&!this.Dp.N().handleScroll.vertTouchDrag,af:()=>this.kv===null&&!this.Dp.N().handleScroll.horzTouchDrag})}m(){this.mv!==null&&this.mv.m(),this.wv!==null&&this.wv.m(),this.gv=null,this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.qp),ws(this.Gp.canvasElement),this.Gp.dispose(),this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),ws(this.Zp.canvasElement),this.Zp.dispose(),this.Dv!==null&&(this.Dv.t_().u(this),this.Dv.m()),this.Of.m()}hp(){return Q(this.Dv)}zv(e){var t;this.Dv!==null&&this.Dv.t_().u(this),this.Dv=e,this.Dv!==null&&this.Dv.t_().i(Xa.prototype.Vv.bind(this),this,!0),this.Av(),this.Dp.Uf().indexOf(this)===this.Dp.Uf().length-1?(this.gv=this.gv??new hv(this.Iv,this.Dp),this.gv.kt()):((t=this.gv)==null||t.Ip(),this.gv=null)}$p(){return this.Dp}Xf(){return this.qf}Av(){if(this.Dv!==null&&(this.Lv(),this.ts().js().length!==0)){if(this.mv!==null){const e=this.Dv.Wo();this.mv._s(Q(e))}if(this.wv!==null){const e=this.Dv.Ho();this.wv._s(Q(e))}}}Ov(){this.mv!==null&&this.mv.kt(),this.wv!==null&&this.wv.kt()}Io(){return this.Dv!==null?this.Dv.Io():0}Bo(e){this.Dv&&this.Dv.Bo(e)}if(e){if(!this.Dv)return;this.Nv();const t=e.localX,n=e.localY;this.Fv(t,n,e)}bf(e){this.Nv(),this.Wv(),this.Fv(e.localX,e.localY,e)}sf(e){if(!this.Dv)return;this.Nv();const t=e.localX,n=e.localY;this.Fv(t,n,e)}vf(e){this.Dv!==null&&(this.Nv(),this.Hv(e))}Kd(e){this.Dv!==null&&this.Uv(this.xv,e)}$d(e){this.Kd(e)}uf(e){this.Nv(),this.$v(e),this.Fv(e.localX,e.localY,e)}pf(e){this.Dv!==null&&(this.Nv(),this.Pv=!1,this.qv(e))}ff(e){this.Dv!==null&&this.Hv(e)}If(e){if(this.Pv=!0,this.kv===null){const t={x:e.localX,y:e.localY};this.Yv(t,t,e)}}Vf(e){this.Dv!==null&&(this.Nv(),this.Dv.Qt().ac(null),this.jv())}Kv(){return this.Sv}Xv(){return this.xv}Pf(){this.Cv=1,this.ts().hn()}kf(e,t){if(!this.Dp.N().handleScale.pinch)return;const n=5*(t-this.Cv);this.Cv=t,this.ts().Mc(e._t,n)}gf(e){this.Pv=!1,this.yv=this.kv!==null,this.Wv();const t=this.ts()._c();this.kv!==null&&t.Vt()&&(this.Tv={x:t.si(),y:t.ni()},this.kv={x:e.localX,y:e.localY})}lf(e){if(this.Dv===null)return;const t=e.localX,n=e.localY;if(this.kv===null)this.$v(e);else{this.yv=!1;const r=Q(this.Tv),a=r.x+(t-this.kv.x),o=r.y+(n-this.kv.y);this.Fv(a,o,e)}}df(e){this.$p().N().trackingMode.exitMode===0&&(this.yv=!0),this.Zv(),this.qv(e)}jn(e,t){const n=this.Dv;return n===null?null:Jh(n,e,t)}Gv(e,t){Q(t==="left"?this.mv:this.wv).rv(Ie({width:e,height:this.Lp.height}))}Zf(){return this.Lp}rv(e){us(this.Lp,e)||(this.Lp=e,this.Hp=!0,this.Zp.resizeCanvasElement(e),this.Gp.resizeCanvasElement(e),this.Hp=!1,this.Iv.style.width=e.width+"px",this.Iv.style.height=e.height+"px")}Jv(){const e=Q(this.Dv);e.Fo(e.Wo()),e.Fo(e.Ho());for(const t of e.ba())if(e.Un(t)){const n=t.Ft();n!==null&&e.Fo(n),t.Ns()}for(const t of e.s_())t.Ns()}Gf(){return this.Zp.bitmapSize}Jf(e,t,n){const r=this.Gf();r.width>0&&r.height>0&&e.drawImage(this.Zp.canvasElement,t,n)}av(e){if(e===0||this.Dv===null)return;e>1&&this.Jv(),this.mv!==null&&this.mv.av(e),this.wv!==null&&this.wv.av(e);const t={colorSpace:this.Dp.N().layout.colorSpace};if(e!==1){this.Zp.applySuggestedBitmapSize();const r=vs(this.Zp,t);r!==null&&(r.useBitmapCoordinateSpace(a=>{this.ov(a)}),this.Dv&&(this.Qv(r,dv),this.tm(r),this.Qv(r,Bl),this.Qv(r,Dl)))}this.Gp.applySuggestedBitmapSize();const n=vs(this.Gp,t);n!==null&&(n.useBitmapCoordinateSpace(({context:r,bitmapSize:a})=>{r.clearRect(0,0,a.width,a.height)}),this.im(n),this.Qv(n,uv),this.Qv(n,Dl))}sm(){return this.mv}nm(){return this.wv}uv(e,t){this.Qv(e,t)}Vv(){this.Dv!==null&&this.Dv.t_().u(this),this.Dv=null}Hv(e){this.Uv(this.Sv,e)}Uv(e,t){const n=t.localX,r=t.localY;e.v()&&e.p(this.ts().Et().uu(n),{x:n,y:r},t)}ov({context:e,bitmapSize:t}){const{width:n,height:r}=t,a=this.ts(),o=a.$(),l=a.Fc();o===l?Hn(e,0,0,n,r,l):$h(e,0,0,n,r,o,l)}tm(e){const t=Q(this.Dv),n=t.i_().lr().Tt(t);n!==null&&n.nt(e,!1)}im(e){this.rm(e,Bl,rn,this.ts()._c())}Qv(e,t){const n=Q(this.Dv),r=n.Dt(),a=n.s_();for(const o of a)this.rm(e,t,Na,o);for(const o of r)this.rm(e,t,Na,o);for(const o of a)this.rm(e,t,rn,o);for(const o of r)this.rm(e,t,rn,o)}rm(e,t,n,r){const a=Q(this.Dv),o=a.Qt().hc(),l=o!==null&&o.n_===r,c=o!==null&&l&&o.e_!==void 0?o.e_.Xn:void 0;ka(t,h=>n(h,e,l,c),r,a)}Lv(){if(this.Dv===null)return;const e=this.Dp,t=this.Dv.Wo().N().visible,n=this.Dv.Ho().N().visible;t||this.mv===null||(this.Bv.removeChild(this.mv.Xf()),this.mv.m(),this.mv=null),n||this.wv===null||(this.Ev.removeChild(this.wv.Xf()),this.wv.m(),this.wv=null);const r=e.Qt().Vc();t&&this.mv===null&&(this.mv=new Fl(this,e.N(),r,"left"),this.Bv.appendChild(this.mv.Xf())),n&&this.wv===null&&(this.wv=new Fl(this,e.N(),r,"right"),this.Ev.appendChild(this.wv.Xf()))}hm(e){return e.Bf&&this.Pv||this.kv!==null}am(e){return Math.max(0,Math.min(e,this.Lp.width-1))}lm(e){return Math.max(0,Math.min(e,this.Lp.height-1))}Fv(e,t,n){this.ts().yc(this.am(e),this.lm(t),n,Q(this.Dv))}jv(){this.ts().Rc()}Zv(){this.yv&&(this.kv=null,this.jv())}Yv(e,t,n){this.kv=e,this.yv=!1,this.Fv(t.x,t.y,n);const r=this.ts()._c();this.Tv={x:r.si(),y:r.ni()}}ts(){return this.Dp.Qt()}qv(e){if(!this.bv)return;const t=this.ts(),n=this.hp();if(t.Ko(n,n.ys()),this.Mv=null,this.bv=!1,t.Cc(),this.Rv!==null){const r=performance.now(),a=t.Et();this.Rv.le(a.wu(),r),this.Rv.Tu(r)||t._n(this.Rv)}}Nv(){this.kv=null}Wv(){if(this.Dv){if(this.ts().hn(),document.activeElement!==document.body&&document.activeElement!==document.documentElement)Q(document.activeElement).blur();else{const e=document.getSelection();e!==null&&e.removeAllRanges()}!this.Dv.ys().Ki()&&this.ts().Et().Ki()}}$v(e){if(this.Dv===null)return;const t=this.ts(),n=t.Et();if(n.Ki())return;const r=this.Dp.N(),a=r.handleScroll,o=r.kineticScroll;if((!a.pressedMouseMove||e.Bf)&&(!a.horzTouchDrag&&!a.vertTouchDrag||!e.Bf))return;const l=this.Dv.ys(),c=performance.now();if(this.Mv!==null||this.hm(e)||(this.Mv={x:e.clientX,y:e.clientY,ed:c,om:e.localX,_m:e.localY}),this.Mv!==null&&!this.bv&&(this.Mv.x!==e.clientX||this.Mv.y!==e.clientY)){if(e.Bf&&o.touch||!e.Bf&&o.mouse){const h=n.vu();this.Rv=new cv(.2/h,7/h,.997,15/h),this.Rv.Cp(n.wu(),this.Mv.ed)}else this.Rv=null;l.Ki()||t.Yo(this.Dv,l,e.localY),t.Sc(e.localX),this.bv=!0}this.bv&&(l.Ki()||t.jo(this.Dv,l,e.localY),t.xc(e.localX),this.Rv!==null&&this.Rv.Cp(n.wu(),c))}}class $l{constructor(e,t,n,r,a){this.xt=!0,this.Lp=Ie({width:0,height:0}),this.Up=()=>this.av(3),this.Yp=e==="left",this.Gu=n.Vc,this.Ps=t,this.um=r,this.dm=a,this.Yf=document.createElement("div"),this.Yf.style.width="25px",this.Yf.style.height="100%",this.Yf.style.overflow="hidden",this.Zp=bs(this.Yf,Ie({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up)}m(){this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),ws(this.Zp.canvasElement),this.Zp.dispose()}Xf(){return this.Yf}Zf(){return this.Lp}rv(e){us(this.Lp,e)||(this.Lp=e,this.Zp.resizeCanvasElement(e),this.Yf.style.width=`${e.width}px`,this.Yf.style.height=`${e.height}px`,this.xt=!0)}av(e){if(e<3&&!this.xt||this.Lp.width===0||this.Lp.height===0)return;this.xt=!1,this.Zp.applySuggestedBitmapSize();const t=vs(this.Zp,{colorSpace:this.Ps.layout.colorSpace});t!==null&&t.useBitmapCoordinateSpace(n=>{this.ov(n),this._v(n)})}Gf(){return this.Zp.bitmapSize}Jf(e,t,n){const r=this.Gf();r.width>0&&r.height>0&&e.drawImage(this.Zp.canvasElement,t,n)}_v({context:e,bitmapSize:t,horizontalPixelRatio:n,verticalPixelRatio:r}){if(!this.um())return;e.fillStyle=this.Ps.timeScale.borderColor;const a=Math.floor(this.Gu.N().S*n),o=Math.floor(this.Gu.N().S*r),l=this.Yp?t.width-a:0;e.fillRect(l,0,a,o)}ov({context:e,bitmapSize:t}){Hn(e,0,0,t.width,t.height,this.dm())}}function Za(s){return e=>{var t;return((t=e.ia)==null?void 0:t.call(e,s))??[]}}const mv=Za("normal"),fv=Za("top"),pv=Za("bottom");class gv{constructor(e,t){this.fm=null,this.pm=null,this.M=null,this.vm=!1,this.Lp=Ie({width:0,height:0}),this.wm=new Be,this.Np=new vn(5),this.Hp=!1,this.Up=()=>{this.Hp||this.Dp.Qt().ar()},this.qp=()=>{this.Hp||this.Dp.Qt().ar()},this.Dp=e,this.o_=t,this.Ps=e.N().layout,this.kp=document.createElement("tr"),this.gm=document.createElement("td"),this.gm.style.padding="0",this.Mm=document.createElement("td"),this.Mm.style.padding="0",this.Yf=document.createElement("td"),this.Yf.style.height="25px",this.Yf.style.padding="0",this.bm=document.createElement("div"),this.bm.style.width="100%",this.bm.style.height="100%",this.bm.style.position="relative",this.bm.style.overflow="hidden",this.Yf.appendChild(this.bm),this.Zp=bs(this.bm,Ie({width:16,height:16})),this.Zp.subscribeSuggestedBitmapSizeChanged(this.Up);const n=this.Zp.canvasElement;n.style.position="absolute",n.style.zIndex="1",n.style.left="0",n.style.top="0",this.Gp=bs(this.bm,Ie({width:16,height:16})),this.Gp.subscribeSuggestedBitmapSizeChanged(this.qp);const r=this.Gp.canvasElement;r.style.position="absolute",r.style.zIndex="2",r.style.left="0",r.style.top="0",this.kp.appendChild(this.gm),this.kp.appendChild(this.Yf),this.kp.appendChild(this.Mm),this.Sm(),this.Dp.Qt().Vo().i(this.Sm.bind(this),this),this.Of=new Kn(this.Gp.canvasElement,this,{hf:()=>!0,af:()=>!this.Dp.N().handleScroll.horzTouchDrag})}m(){this.Of.m(),this.fm!==null&&this.fm.m(),this.pm!==null&&this.pm.m(),this.Gp.unsubscribeSuggestedBitmapSizeChanged(this.qp),ws(this.Gp.canvasElement),this.Gp.dispose(),this.Zp.unsubscribeSuggestedBitmapSizeChanged(this.Up),ws(this.Zp.canvasElement),this.Zp.dispose()}Xf(){return this.kp}xm(){return this.fm}Cm(){return this.pm}bf(e){if(this.vm)return;this.vm=!0;const t=this.Dp.Qt();!t.Et().Ki()&&this.Dp.N().handleScale.axisPressedMouseMove.time&&t.gc(e.localX)}gf(e){this.bf(e)}Sf(){const e=this.Dp.Qt();!e.Et().Ki()&&this.vm&&(this.vm=!1,this.Dp.N().handleScale.axisPressedMouseMove.time&&e.kc())}uf(e){const t=this.Dp.Qt();!t.Et().Ki()&&this.Dp.N().handleScale.axisPressedMouseMove.time&&t.Pc(e.localX)}lf(e){this.uf(e)}pf(){this.vm=!1;const e=this.Dp.Qt();e.Et().Ki()&&!this.Dp.N().handleScale.axisPressedMouseMove.time||e.kc()}df(){this.pf()}Kd(){this.Dp.N().handleScale.axisDoubleClickReset.time&&this.Dp.Qt().cn()}$d(){this.Kd()}if(){this.Dp.Qt().N().handleScale.axisPressedMouseMove.time&&this.pv(1)}Vf(){this.pv(0)}Zf(){return this.Lp}Pm(){return this.wm}km(e,t,n){us(this.Lp,e)||(this.Lp=e,this.Hp=!0,this.Zp.resizeCanvasElement(e),this.Gp.resizeCanvasElement(e),this.Hp=!1,this.Yf.style.width=`${e.width}px`,this.Yf.style.height=`${e.height}px`,this.wm.p(e)),this.fm!==null&&this.fm.rv(Ie({width:t,height:e.height})),this.pm!==null&&this.pm.rv(Ie({width:n,height:e.height}))}ym(){const e=this.Tm();return Math.ceil(e.S+e.C+e.P+e.A+e.V+e.Rm)}kt(){this.Dp.Qt().Et().Va()}Gf(){return this.Zp.bitmapSize}Jf(e,t,n){const r=this.Gf();r.width>0&&r.height>0&&e.drawImage(this.Zp.canvasElement,t,n)}av(e){if(e===0)return;const t={colorSpace:this.Ps.colorSpace};if(e!==1){this.Zp.applySuggestedBitmapSize();const r=vs(this.Zp,t);r!==null&&(r.useBitmapCoordinateSpace(a=>{this.ov(a),this._v(a),this.Dm(r,pv)}),this.cv(r),this.Dm(r,mv)),this.fm!==null&&this.fm.av(e),this.pm!==null&&this.pm.av(e)}this.Gp.applySuggestedBitmapSize();const n=vs(this.Gp,t);n!==null&&(n.useBitmapCoordinateSpace(({context:r,bitmapSize:a})=>{r.clearRect(0,0,a.width,a.height)}),this.Vm([...this.Dp.Qt().js(),this.Dp.Qt()._c()],n),this.Dm(n,fv))}Dm(e,t){const n=this.Dp.Qt().js();for(const r of n)ka(t,a=>Na(a,e,!1,void 0),r,void 0);for(const r of n)ka(t,a=>rn(a,e,!1,void 0),r,void 0)}ov({context:e,bitmapSize:t}){Hn(e,0,0,t.width,t.height,this.Dp.Qt().Fc())}_v({context:e,bitmapSize:t,verticalPixelRatio:n}){if(this.Dp.N().timeScale.borderVisible){e.fillStyle=this.Im();const r=Math.max(1,Math.floor(this.Tm().S*n));e.fillRect(0,0,t.width,r)}}cv(e){const t=this.Dp.Qt().Et(),n=t.Va();if(!n||n.length===0)return;const r=this.o_.maxTickMarkWeight(n),a=this.Tm(),o=t.N();o.borderVisible&&o.ticksVisible&&e.useBitmapCoordinateSpace(({context:l,horizontalPixelRatio:c,verticalPixelRatio:h})=>{l.strokeStyle=this.Im(),l.fillStyle=this.Im();const d=Math.max(1,Math.floor(c)),m=Math.floor(.5*c);l.beginPath();const x=Math.round(a.C*h);for(let b=n.length;b--;){const p=Math.round(n[b].coord*c);l.rect(p-m,0,d,x)}l.fill()}),e.useMediaCoordinateSpace(({context:l})=>{const c=a.S+a.C+a.A+a.P/2;l.textAlign="center",l.textBaseline="middle",l.fillStyle=this.H(),l.font=this.nv();for(const h of n)if(h.weight<r){const d=h.needAlignCoordinate?this.Bm(l,h.coord,h.label):h.coord;l.fillText(h.label,d,c)}this.Dp.N().timeScale.allowBoldLabels&&(l.font=this.Em());for(const h of n)if(h.weight>=r){const d=h.needAlignCoordinate?this.Bm(l,h.coord,h.label):h.coord;l.fillText(h.label,d,c)}})}Bm(e,t,n){const r=this.Np.Vi(e,n),a=r/2,o=Math.floor(t-a)+.5;return o<0?t+=Math.abs(0-o):o+r>this.Lp.width&&(t-=Math.abs(this.Lp.width-(o+r))),t}Vm(e,t){const n=this.Tm();for(const r of e)for(const a of r.cs())a.Tt().nt(t,n)}Im(){return this.Dp.N().timeScale.borderColor}H(){return this.Ps.textColor}F(){return this.Ps.fontSize}nv(){return yn(this.F(),this.Ps.fontFamily)}Em(){return yn(this.F(),this.Ps.fontFamily,"bold")}Tm(){this.M===null&&(this.M={S:1,L:NaN,A:NaN,V:NaN,Ji:NaN,C:5,P:NaN,k:"",Gi:new vn,Rm:0});const e=this.M,t=this.nv();if(e.k!==t){const n=this.F();e.P=n,e.k=t,e.A=3*n/12,e.V=3*n/12,e.Ji=9*n/12,e.L=0,e.Rm=4*n/12,e.Gi.In()}return this.M}pv(e){this.Yf.style.cursor=e===1?"ew-resize":"default"}Sm(){const e=this.Dp.Qt(),t=e.N();t.leftPriceScale.visible||this.fm===null||(this.gm.removeChild(this.fm.Xf()),this.fm.m(),this.fm=null),t.rightPriceScale.visible||this.pm===null||(this.Mm.removeChild(this.pm.Xf()),this.pm.m(),this.pm=null);const n={Vc:this.Dp.Qt().Vc()},r=()=>t.leftPriceScale.borderVisible&&e.Et().N().borderVisible,a=()=>e.Fc();t.leftPriceScale.visible&&this.fm===null&&(this.fm=new $l("left",t,n,r,a),this.gm.appendChild(this.fm.Xf())),t.rightPriceScale.visible&&this.pm===null&&(this.pm=new $l("right",t,n,r,a),this.Mm.appendChild(this.pm.Xf()))}}var gc;const yv=!!$s&&!!navigator.userAgentData&&navigator.userAgentData.brands.some(s=>s.brand.includes("Chromium"))&&!!$s&&((gc=navigator==null?void 0:navigator.userAgentData)!=null&&gc.platform?navigator.userAgentData.platform==="Windows":navigator.userAgent.toLowerCase().indexOf("win")>=0);class vv{constructor(e,t,n){var r;this.Am=[],this.zm=[],this.Lm=0,this.sl=0,this.Mo=0,this.Om=0,this.Nm=0,this.Fm=null,this.Wm=!1,this.Sv=new Be,this.xv=new Be,this.Ku=new Be,this.Hm=null,this.Um=null,this.Rp=e,this.Ps=t,this.o_=n,this.kp=document.createElement("div"),this.kp.classList.add("tv-lightweight-charts"),this.kp.style.overflow="hidden",this.kp.style.direction="ltr",this.kp.style.width="100%",this.kp.style.height="100%",(r=this.kp).style.userSelect="none",r.style.webkitUserSelect="none",r.style.msUserSelect="none",r.style.MozUserSelect="none",r.style.webkitTapHighlightColor="transparent",this.$m=document.createElement("table"),this.$m.setAttribute("cellspacing","0"),this.kp.appendChild(this.$m),this.qm=this.Ym.bind(this),Br(this.Ps)&&this.jm(!0),this.ts=new sv(this.Zu.bind(this),this.Ps,n),this.Qt().uc().i(this.Km.bind(this),this),this.Xm=new gv(this,this.o_),this.$m.appendChild(this.Xm.Xf());const a=t.autoSize&&this.Zm();let o=this.Ps.width,l=this.Ps.height;if(a||o===0||l===0){const c=e.getBoundingClientRect();o=o||c.width,l=l||c.height}this.Gm(o,l),this.Jm(),e.appendChild(this.kp),this.Qm(),this.ts.Et().Iu().i(this.ts.Bh.bind(this.ts),this),this.ts.Vo().i(this.ts.Bh.bind(this.ts),this)}Qt(){return this.ts}N(){return this.Ps}Uf(){return this.Am}tw(){return this.Xm}m(){this.jm(!1),this.Lm!==0&&window.cancelAnimationFrame(this.Lm),this.ts.uc().u(this),this.ts.Et().Iu().u(this),this.ts.Vo().u(this),this.ts.m();for(const e of this.Am)this.$m.removeChild(e.Xf()),e.Kv().u(this),e.Xv().u(this),e.m();this.Am=[];for(const e of this.zm)this.iw(e);this.zm=[],Q(this.Xm).m(),this.kp.parentElement!==null&&this.kp.parentElement.removeChild(this.kp),this.Ku.m(),this.Sv.m(),this.xv.m(),this.sw()}Gm(e,t,n=!1){if(this.sl===t&&this.Mo===e)return;const r=function(l){const c=Math.floor(l.width),h=Math.floor(l.height);return Ie({width:c-c%2,height:h-h%2})}(Ie({width:e,height:t}));this.sl=r.height,this.Mo=r.width;const a=this.sl+"px",o=this.Mo+"px";Q(this.kp).style.height=a,Q(this.kp).style.width=o,this.$m.style.height=a,this.$m.style.width=o,n?this.nw(qe.gn(),performance.now()):this.ts.Bh()}av(e){e===void 0&&(e=qe.gn());for(let t=0;t<this.Am.length;t++)this.Am[t].av(e.en(t).tn);this.Ps.timeScale.visible&&this.Xm.av(e.nn())}hr(e){var r;const t=Br(this.Ps);this.ts.hr(e);const n=Br(this.Ps);n!==t&&this.jm(n),(r=e.layout)!=null&&r.panes&&this.ew(),this.Qm(),this.rw(e)}Kv(){return this.Sv}Xv(){return this.xv}uc(){return this.Ku}hw(){this.Fm!==null&&(this.nw(this.Fm,performance.now()),this.Fm=null);const e=this.aw(null),t=document.createElement("canvas");t.width=e.width,t.height=e.height;const n=Q(t.getContext("2d"));return this.aw(n),t}lw(e){return e==="left"&&!this.ow()||e==="right"&&!this._w()||this.Am.length===0?0:Q(e==="left"?this.Am[0].sm():this.Am[0].nm()).hv()}uw(){return this.Ps.autoSize&&this.Hm!==null}tp(){return this.kp}cw(e){this.Um=e,this.Um?this.tp().style.setProperty("cursor",e):this.tp().style.removeProperty("cursor")}dw(){return this.Um}fw(e){return ct(this.Am[e]).Zf()}ew(){this.zm.forEach(e=>{e.kt()})}rw(e){(e.autoSize!==void 0||!this.Hm||e.width===void 0&&e.height===void 0)&&(e.autoSize&&!this.Hm&&this.Zm(),e.autoSize===!1&&this.Hm!==null&&this.sw(),e.autoSize||e.width===void 0&&e.height===void 0||this.Gm(e.width||this.Mo,e.height||this.sl))}aw(e){let t=0,n=0;const r=this.Am[0],a=(l,c)=>{let h=0;for(let d=0;d<this.Am.length;d++){const m=this.Am[d],x=Q(l==="left"?m.sm():m.nm()),b=x.Gf();if(e!==null&&x.Jf(e,c,h),h+=b.height,d<this.Am.length-1){const p=this.zm[d],g=p.Gf();e!==null&&p.Jf(e,c,h),h+=g.height}}};this.ow()&&(a("left",0),t+=Q(r.sm()).Gf().width);for(let l=0;l<this.Am.length;l++){const c=this.Am[l],h=c.Gf();if(e!==null&&c.Jf(e,t,n),n+=h.height,l<this.Am.length-1){const d=this.zm[l],m=d.Gf();e!==null&&d.Jf(e,t,n),n+=m.height}}t+=r.Gf().width,this._w()&&(a("right",t),t+=Q(r.nm()).Gf().width);const o=(l,c,h)=>{Q(l==="left"?this.Xm.xm():this.Xm.Cm()).Jf(Q(e),c,h)};if(this.Ps.timeScale.visible){const l=this.Xm.Gf();if(e!==null){let c=0;this.ow()&&(o("left",c,n),c=Q(r.sm()).Gf().width),this.Xm.Jf(e,c,n),c+=l.width,this._w()&&o("right",c,n)}n+=l.height}return Ie({width:t,height:n})}pw(){let e=0,t=0,n=0;for(const f of this.Am)this.ow()&&(t=Math.max(t,Q(f.sm()).sv(),this.Ps.leftPriceScale.minimumWidth)),this._w()&&(n=Math.max(n,Q(f.nm()).sv(),this.Ps.rightPriceScale.minimumWidth)),e+=f.Io();t=Sa(t),n=Sa(n);const r=this.Mo,a=this.sl,o=Math.max(r-t-n,0),l=1*this.zm.length,c=this.Ps.timeScale.visible;let h=c?Math.max(this.Xm.ym(),this.Ps.timeScale.minimumHeight):0;var d;h=(d=h)+d%2;const m=l+h,x=a<m?0:a-m,b=x/e;let p=0;const g=window.devicePixelRatio||1;for(let f=0;f<this.Am.length;++f){const y=this.Am[f];y.zv(this.ts.$s()[f]);let S=0,k=0;k=f===this.Am.length-1?Math.ceil((x-p)*g)/g:Math.round(y.Io()*b*g)/g,S=Math.max(k,2),p+=S,y.rv(Ie({width:o,height:S})),this.ow()&&y.Gv(t,"left"),this._w()&&y.Gv(n,"right"),y.hp()&&this.ts.cc(y.hp(),S)}this.Xm.km(Ie({width:c?o:0,height:h}),c?t:0,c?n:0),this.ts.Eo(o),this.Om!==t&&(this.Om=t),this.Nm!==n&&(this.Nm=n)}jm(e){e?this.kp.addEventListener("wheel",this.qm,{passive:!1}):this.kp.removeEventListener("wheel",this.qm)}mw(e){switch(e.deltaMode){case e.DOM_DELTA_PAGE:return 120;case e.DOM_DELTA_LINE:return 32}return yv?1/window.devicePixelRatio:1}Ym(e){if(!(e.deltaX!==0&&this.Ps.handleScroll.mouseWheel||e.deltaY!==0&&this.Ps.handleScale.mouseWheel))return;const t=this.mw(e),n=t*e.deltaX/100,r=-t*e.deltaY/100;if(e.cancelable&&e.preventDefault(),r!==0&&this.Ps.handleScale.mouseWheel){const a=Math.sign(r)*Math.min(1,Math.abs(r)),o=e.clientX-this.kp.getBoundingClientRect().left;this.Qt().Mc(o,a)}n!==0&&this.Ps.handleScroll.mouseWheel&&this.Qt().bc(-80*n)}nw(e,t){var r;const n=e.nn();n===3&&this.ww(),n!==3&&n!==2||(this.gw(e),this.Mw(e,t),this.Xm.kt(),this.Am.forEach(a=>{a.Ov()}),((r=this.Fm)==null?void 0:r.nn())===3&&(this.Fm.vn(e),this.ww(),this.gw(this.Fm),this.Mw(this.Fm,t),e=this.Fm,this.Fm=null)),this.av(e)}Mw(e,t){for(const n of e.pn())this.mn(n,t)}gw(e){const t=this.ts.$s();for(let n=0;n<t.length;n++)e.en(n).sn&&t[n].Go()}mn(e,t){const n=this.ts.Et();switch(e.an){case 0:n.Eu();break;case 1:n.Au(e.Wt);break;case 2:n.dn(e.Wt);break;case 3:n.fn(e.Wt);break;case 4:n.bu();break;case 5:e.Wt.Tu(t)||n.fn(e.Wt.Ru(t))}}Zu(e){this.Fm!==null?this.Fm.vn(e):this.Fm=e,this.Wm||(this.Wm=!0,this.Lm=window.requestAnimationFrame(t=>{if(this.Wm=!1,this.Lm=0,this.Fm!==null){const n=this.Fm;this.Fm=null,this.nw(n,t);for(const r of n.pn())if(r.an===5&&!r.Wt.Tu(t)){this.Qt()._n(r.Wt);break}}}))}ww(){this.Jm()}iw(e){this.$m.removeChild(e.Xf()),e.m()}Jm(){const e=this.ts.$s(),t=e.length,n=this.Am.length;for(let r=t;r<n;r++){const a=ct(this.Am.pop());this.$m.removeChild(a.Xf()),a.Kv().u(this),a.Xv().u(this),a.m();const o=this.zm.pop();o!==void 0&&this.iw(o)}for(let r=n;r<t;r++){const a=new Xa(this,e[r]);if(a.Kv().i(this.bw.bind(this,a),this),a.Xv().i(this.Sw.bind(this,a),this),this.Am.push(a),r>0){const o=new lv(this,r-1,r);this.zm.push(o),this.$m.insertBefore(o.Xf(),this.Xm.Xf())}this.$m.insertBefore(a.Xf(),this.Xm.Xf())}for(let r=0;r<t;r++){const a=e[r],o=this.Am[r];o.hp()!==a?o.zv(a):o.Av()}this.Qm(),this.pw()}xw(e,t,n,r){var m;const a=new Map;e!==null&&this.ts.js().forEach(x=>{const b=x.Xs().Fr(e);b!==null&&a.set(x,b)});let o;if(e!==null){const x=(m=this.ts.Et().ss(e))==null?void 0:m.originalTime;x!==void 0&&(o=x)}const l=this.Qt().hc(),c=l!==null&&l.n_ instanceof Qn?l.n_:void 0,h=l!==null&&l.e_!==void 0?l.e_.Kn:void 0,d=this.Cw(r);return{Pw:o,Re:e??void 0,kw:t??void 0,yw:d!==-1?d:void 0,Tw:c,Rw:a,Dw:h,Vw:n??void 0}}Cw(e){let t=-1;if(e)t=this.Am.indexOf(e);else{const n=this.Qt()._c().Us();n!==null&&(t=this.Qt().$s().indexOf(n))}return t}bw(e,t,n,r){this.Sv.p(()=>this.xw(t,n,r,e))}Sw(e,t,n,r){this.xv.p(()=>this.xw(t,n,r,e))}Km(e,t,n){var r;this.cw(((r=this.Qt().hc())==null?void 0:r.h_)??null),this.Ku.p(()=>this.xw(e,t,n))}Qm(){const e=this.Ps.timeScale.visible?"":"none";this.Xm.Xf().style.display=e}ow(){return this.Am[0].hp().Wo().N().visible}_w(){return this.Am[0].hp().Ho().N().visible}Zm(){return"ResizeObserver"in window&&(this.Hm=new ResizeObserver(e=>{const t=e[e.length-1];t&&this.Gm(t.contentRect.width,t.contentRect.height)}),this.Hm.observe(this.Rp,{box:"border-box"}),!0)}sw(){this.Hm!==null&&this.Hm.disconnect(),this.Hm=null}}function Br(s){return!!(s.handleScroll.mouseWheel||s.handleScale.mouseWheel)}function xv(s){return s.open===void 0&&s.value===void 0}function bv(s){return function(e){return e.open!==void 0}(s)||function(e){return e.value!==void 0}(s)}function zl(s,e,t,n){const r=t.value,a={Re:e,wt:s,Wt:[r,r,r,r],Pw:n};return t.color!==void 0&&(a.R=t.color),a}function wv(s,e,t,n){const r=t.value,a={Re:e,wt:s,Wt:[r,r,r,r],Pw:n};return t.lineColor!==void 0&&(a.vt=t.lineColor),t.topColor!==void 0&&(a.mr=t.topColor),t.bottomColor!==void 0&&(a.wr=t.bottomColor),a}function jv(s,e,t,n){const r=t.value,a={Re:e,wt:s,Wt:[r,r,r,r],Pw:n};return t.topLineColor!==void 0&&(a.gr=t.topLineColor),t.bottomLineColor!==void 0&&(a.Mr=t.bottomLineColor),t.topFillColor1!==void 0&&(a.br=t.topFillColor1),t.topFillColor2!==void 0&&(a.Sr=t.topFillColor2),t.bottomFillColor1!==void 0&&(a.Cr=t.bottomFillColor1),t.bottomFillColor2!==void 0&&(a.Pr=t.bottomFillColor2),a}function Sv(s,e,t,n){const r={Re:e,wt:s,Wt:[t.open,t.high,t.low,t.close],Pw:n};return t.color!==void 0&&(r.R=t.color),r}function Nv(s,e,t,n){const r={Re:e,wt:s,Wt:[t.open,t.high,t.low,t.close],Pw:n};return t.color!==void 0&&(r.R=t.color),t.borderColor!==void 0&&(r.Ht=t.borderColor),t.wickColor!==void 0&&(r.vr=t.wickColor),r}function kv(s,e,t,n,r){const a=ct(r)(t),o=Math.max(...a),l=Math.min(...a),c=a[a.length-1],h=[c,o,l,c],{time:d,color:m,...x}=t;return{Re:e,wt:s,Wt:h,Pw:n,se:x,R:m}}function Xs(s){return s.Wt!==void 0}function Ul(s,e){return e.customValues!==void 0&&(s.Iw=e.customValues),s}function ss(s){return(e,t,n,r,a,o)=>function(l,c){return c?c(l):xv(l)}(n,o)?Ul({wt:e,Re:t,Pw:r},n):Ul(s(e,t,n,r,a),n)}function Wl(s){return{Candlestick:ss(Nv),Bar:ss(Sv),Area:ss(wv),Baseline:ss(jv),Histogram:ss(zl),Line:ss(zl),Custom:ss(kv)}[s]}function Vl(s){return{Re:0,Bw:new Map,Hh:s}}function Hl(s,e){if(s!==void 0&&s.length!==0)return{Ew:e.key(s[0].wt),Aw:e.key(s[s.length-1].wt)}}function Yl(s){let e;return s.forEach(t=>{e===void 0&&(e=t.Pw)}),ct(e)}class Cv{constructor(e){this.zw=new Map,this.Lw=new Map,this.Ow=new Map,this.Nw=[],this.o_=e}m(){this.zw.clear(),this.Lw.clear(),this.Ow.clear(),this.Nw=[]}Fw(e,t){let n=this.zw.size!==0,r=!1;const a=this.Lw.get(e);if(a!==void 0)if(this.Lw.size===1)n=!1,r=!0,this.zw.clear();else for(const c of this.Nw)c.pointData.Bw.delete(e)&&(r=!0);let o=[];if(t.length!==0){const c=t.map(b=>b.time),h=this.o_.createConverterToInternalObj(t),d=Wl(e.Rr()),m=e.da(),x=e.pa();o=t.map((b,p)=>{const g=h(b.time),f=this.o_.key(g);let y=this.zw.get(f);y===void 0&&(y=Vl(g),this.zw.set(f,y),r=!0);const S=d(g,y.Re,b,c[p],m,x);return y.Bw.set(e,S),S})}n&&this.Ww(),this.Hw(e,o);let l=-1;if(r){const c=[];this.zw.forEach(h=>{c.push({timeWeight:0,time:h.Hh,pointData:h,originalTime:Yl(h.Bw)})}),c.sort((h,d)=>this.o_.key(h.time)-this.o_.key(d.time)),l=this.Uw(c)}return this.$w(e,l,function(c,h,d){const m=Hl(c,d),x=Hl(h,d);if(m!==void 0&&x!==void 0)return{qw:!1,zh:m.Aw>=x.Aw&&m.Ew>=x.Ew}}(this.Lw.get(e),a,this.o_))}Ec(e){return this.Fw(e,[])}Yw(e,t,n){const r=t;(function(f){f.Pw===void 0&&(f.Pw=f.time)})(r),this.o_.preprocessData(t);const a=this.o_.createConverterToInternalObj([t])(t.time),o=this.Ow.get(e);if(!n&&o!==void 0&&this.o_.key(a)<this.o_.key(o))throw new Error(`Cannot update oldest data, last time=${o}, new time=${a}`);let l=this.zw.get(this.o_.key(a));if(n&&l===void 0)throw new Error("Cannot update non-existing data point when historicalUpdate is true");const c=l===void 0;l===void 0&&(l=Vl(a),this.zw.set(this.o_.key(a),l));const h=Wl(e.Rr()),d=e.da(),m=e.pa(),x=h(a,l.Re,t,r.Pw,d,m);l.Bw.set(e,x),n?this.jw(e,x,l.Re):this.Kw(e,x);const b={zh:Xs(x),qw:n};if(!c)return this.$w(e,-1,b);const p={timeWeight:0,time:l.Hh,pointData:l,originalTime:Yl(l.Bw)},g=Ds(this.Nw,this.o_.key(p.time),(f,y)=>this.o_.key(f.time)<y);this.Nw.splice(g,0,p);for(let f=g;f<this.Nw.length;++f)Dr(this.Nw[f].pointData,f);return this.o_.fillWeightsForPoints(this.Nw,g),this.$w(e,g,b)}Kw(e,t){let n=this.Lw.get(e);n===void 0&&(n=[],this.Lw.set(e,n));const r=n.length!==0?n[n.length-1]:null;r===null||this.o_.key(t.wt)>this.o_.key(r.wt)?Xs(t)&&n.push(t):Xs(t)?n[n.length-1]=t:n.splice(-1,1),this.Ow.set(e,t.wt)}jw(e,t,n){const r=this.Lw.get(e);if(r===void 0)return;const a=Ds(r,n,(o,l)=>o.Re<l);Xs(t)?r[a]=t:r.splice(a,1)}Hw(e,t){t.length!==0?(this.Lw.set(e,t.filter(Xs)),this.Ow.set(e,t[t.length-1].wt)):(this.Lw.delete(e),this.Ow.delete(e))}Ww(){for(const e of this.Nw)e.pointData.Bw.size===0&&this.zw.delete(this.o_.key(e.time))}Uw(e){let t=-1;for(let n=0;n<this.Nw.length&&n<e.length;++n){const r=this.Nw[n],a=e[n];if(this.o_.key(r.time)!==this.o_.key(a.time)){t=n;break}a.timeWeight=r.timeWeight,Dr(a.pointData,n)}if(t===-1&&this.Nw.length!==e.length&&(t=Math.min(this.Nw.length,e.length)),t===-1)return-1;for(let n=t;n<e.length;++n)Dr(e[n].pointData,n);return this.o_.fillWeightsForPoints(e,t),this.Nw=e,t}Xw(){if(this.Lw.size===0)return null;let e=0;return this.Lw.forEach(t=>{t.length!==0&&(e=Math.max(e,t[t.length-1].Re))}),e}$w(e,t,n){const r={Oo:new Map,Et:{ou:this.Xw()}};if(t!==-1)this.Lw.forEach((a,o)=>{r.Oo.set(o,{se:a,Zw:o===e?n:void 0})}),this.Lw.has(e)||r.Oo.set(e,{se:[],Zw:n}),r.Et.Gw=this.Nw,r.Et.Jw=t;else{const a=this.Lw.get(e);r.Oo.set(e,{se:a||[],Zw:n})}return r}}function Dr(s,e){s.Re=e,s.Bw.forEach(t=>{t.Re=e})}function Pv(s,e){return s.wt<e}function Tv(s,e){return e<s.wt}function Ev(s,e,t){const n=e.Uh(),r=e.bi(),a=Ds(s,n,Pv),o=qh(s,r,Tv);if(!t)return{from:a,to:o};let l=a,c=o;return a>0&&a<s.length&&s[a].wt>=n&&(l=a-1),o>0&&o<s.length&&s[o-1].wt<=r&&(c=o+1),{from:l,to:c}}class eo{constructor(e,t,n){this.Qw=!0,this.tg=!0,this.ig=!0,this.sg=[],this.ng=null,this.Jn=e,this.Qn=t,this.eg=n}kt(e){this.Qw=!0,e==="data"&&(this.tg=!0),e==="options"&&(this.ig=!0)}Tt(){return this.Jn.Vt()?(this.rg(),this.ng===null?null:this.hg):null}ag(){this.sg=this.sg.map(e=>({...e,...this.Jn.Rh().Dr(e.wt)}))}lg(){this.ng=null}rg(){this.tg&&(this.og(),this.tg=!1),this.ig&&(this.ag(),this.ig=!1),this.Qw&&(this._g(),this.Qw=!1)}_g(){const e=this.Jn.Ft(),t=this.Qn.Et();if(this.lg(),t.Ki()||e.Ki())return;const n=t.Pe();if(n===null||this.Jn.Xs().zr()===0)return;const r=this.Jn.zt();r!==null&&(this.ng=Ev(this.sg,n,this.eg),this.ug(e,t,r.Wt),this.cg())}}class Iv{constructor(e,t){this.dg=e,this.Yi=t}nt(e,t,n){this.dg.draw(e,this.Yi,t,n)}}class _v extends eo{constructor(e,t,n){super(e,t,!1),this.sh=n,this.hg=new Iv(this.sh.renderer(),r=>{const a=e.zt();return a===null?null:e.Ft().Nt(r,a.Wt)})}fa(e){return this.sh.priceValueBuilder(e)}va(e){return this.sh.isWhitespace(e)}og(){const e=this.Jn.Rh();this.sg=this.Jn.Xs().Hr().map(t=>({wt:t.Re,_t:NaN,...e.Dr(t.Re),fg:t.se}))}ug(e,t){t._u(this.sg,vi(this.ng))}cg(){this.sh.update({bars:this.sg.map(Lv),barSpacing:this.Qn.Et().vu(),visibleRange:this.ng},this.Jn.N())}}function Lv(s){return{x:s._t,time:s.wt,originalData:s.fg,barColor:s.cr}}const Mv={color:"#2196f3"},Rv=(s,e,t)=>{const n=Yt(t);return new _v(s,e,n)};function to(s){const e={value:s.Wt[3],time:s.Pw};return s.Iw!==void 0&&(e.customValues=s.Iw),e}function ql(s){const e=to(s);return s.R!==void 0&&(e.color=s.R),e}function Av(s){const e=to(s);return s.vt!==void 0&&(e.lineColor=s.vt),s.mr!==void 0&&(e.topColor=s.mr),s.wr!==void 0&&(e.bottomColor=s.wr),e}function Ov(s){const e=to(s);return s.gr!==void 0&&(e.topLineColor=s.gr),s.Mr!==void 0&&(e.bottomLineColor=s.Mr),s.br!==void 0&&(e.topFillColor1=s.br),s.Sr!==void 0&&(e.topFillColor2=s.Sr),s.Cr!==void 0&&(e.bottomFillColor1=s.Cr),s.Pr!==void 0&&(e.bottomFillColor2=s.Pr),e}function ed(s){const e={open:s.Wt[0],high:s.Wt[1],low:s.Wt[2],close:s.Wt[3],time:s.Pw};return s.Iw!==void 0&&(e.customValues=s.Iw),e}function Fv(s){const e=ed(s);return s.R!==void 0&&(e.color=s.R),e}function Bv(s){const e=ed(s),{R:t,Ht:n,vr:r}=s;return t!==void 0&&(e.color=t),n!==void 0&&(e.borderColor=n),r!==void 0&&(e.wickColor=r),e}function Ca(s){return{Area:Av,Line:ql,Baseline:Ov,Histogram:ql,Bar:Fv,Candlestick:Bv,Custom:Dv}[s]}function Dv(s){const e=s.Pw;return{...s.se,time:e}}const $v={vertLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},horzLine:{color:"#9598A1",width:1,style:3,visible:!0,labelVisible:!0,labelBackgroundColor:"#131722"},mode:1},zv={vertLines:{color:"#D6DCDE",style:0,visible:!0},horzLines:{color:"#D6DCDE",style:0,visible:!0}},Uv={background:{type:"solid",color:"#FFFFFF"},textColor:"#191919",fontSize:12,fontFamily:Bh,panes:{enableResize:!0,separatorColor:"#E0E3EB",separatorHoverColor:"rgba(178, 181, 189, 0.2)"},attributionLogo:!0,colorSpace:"srgb",colorParsers:[]},$r={autoScale:!0,mode:0,invertScale:!1,alignLabels:!0,borderVisible:!0,borderColor:"#2B2B43",entireTextOnly:!1,visible:!1,ticksVisible:!1,scaleMargins:{bottom:.1,top:.2},minimumWidth:0,ensureEdgeTickMarksVisible:!1},Wv={rightOffset:0,barSpacing:6,minBarSpacing:.5,maxBarSpacing:0,fixLeftEdge:!1,fixRightEdge:!1,lockVisibleTimeRangeOnResize:!1,rightBarStaysOnScroll:!1,borderVisible:!0,borderColor:"#2B2B43",visible:!0,timeVisible:!1,secondsVisible:!0,shiftVisibleRangeOnNewBar:!0,allowShiftVisibleRangeOnWhitespaceReplacement:!1,ticksVisible:!1,uniformDistribution:!1,minimumHeight:0,allowBoldLabels:!0,ignoreWhitespaceIndices:!1};function Gl(){return{addDefaultPane:!0,width:0,height:0,autoSize:!1,layout:Uv,crosshair:$v,grid:zv,overlayPriceScales:{...$r},leftPriceScale:{...$r,visible:!1},rightPriceScale:{...$r,visible:!0},timeScale:Wv,localization:{locale:$s?navigator.language:"",dateFormat:"dd MMM 'yy"},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{axisPressedMouseMove:{time:!0,price:!0},axisDoubleClickReset:{time:!0,price:!0},mouseWheel:!0,pinch:!0},kineticScroll:{mouse:!1,touch:!0},trackingMode:{exitMode:1}}}class td{constructor(e,t,n){this.Wf=e,this.pg=t,this.vg=n??0}applyOptions(e){this.Wf.Qt().lc(this.pg,e,this.vg)}options(){return this.Yi().N()}width(){return qn(this.pg)?this.Wf.lw(this.pg):0}setVisibleRange(e){this.setAutoScale(!1),this.Yi().Wl(new it(e.from,e.to))}getVisibleRange(){const e=this.Yi().Qe();return e===null?null:{from:e.$e(),to:e.qe()}}setAutoScale(e){this.applyOptions({autoScale:e})}Yi(){return Q(this.Wf.Qt().oc(this.pg,this.vg)).Ft}}class Vv{constructor(e,t,n,r){this.Wf=e,this.Pt=n,this.mg=t,this.wg=r}getHeight(){return this.Pt.$t()}setHeight(e){const t=this.Wf.Qt(),n=t.Hc(this.Pt);t.fc(n,e)}getStretchFactor(){return this.Pt.Io()}setStretchFactor(e){this.Pt.Bo(e),this.Wf.Qt().Bh()}paneIndex(){return this.Wf.Qt().Hc(this.Pt)}moveTo(e){const t=this.paneIndex();t!==e&&(Ge(e>=0&&e<this.Wf.Uf().length,"Invalid pane index"),this.Wf.Qt().mc(t,e))}getSeries(){return this.Pt.Oo().map(e=>this.mg(e))??[]}getHTMLElement(){const e=this.Wf.Uf();return e&&e.length!==0&&e[this.paneIndex()]?e[this.paneIndex()].Xf():null}attachPrimitive(e){this.Pt.ua(e),e.attached&&e.attached({chart:this.wg,requestUpdate:()=>this.Pt.Qt().Bh()})}detachPrimitive(e){this.Pt.ca(e)}priceScale(e){if(this.Pt.Do(e)===null)throw new Error(`Cannot find price scale with id: ${e}`);return new td(this.Wf,e,this.paneIndex())}setPreserveEmptyPane(e){this.Pt.zo(e)}preserveEmptyPane(){return this.Pt.Lo()}addCustomSeries(e,t={},n=0){return this.wg.addCustomSeries(e,t,n)}addSeries(e,t={}){return this.wg.addSeries(e,t,this.paneIndex())}}const Hv={color:"#FF0000",price:0,lineStyle:2,lineWidth:1,lineVisible:!0,axisLabelVisible:!0,title:"",axisLabelColor:"",axisLabelTextColor:""};class Ql{constructor(e){this.ir=e}applyOptions(e){this.ir.hr(e)}options(){return this.ir.N()}gg(){return this.ir}}class Yv{constructor(e,t,n,r,a,o){this.Mg=new Be,this.Jn=e,this.bg=t,this.Sg=n,this.o_=a,this.wg=r,this.xg=o}m(){this.Mg.m()}priceFormatter(){return this.Jn.ra()}priceToCoordinate(e){const t=this.Jn.zt();return t===null?null:this.Jn.Ft().Nt(e,t.Wt)}coordinateToPrice(e){const t=this.Jn.zt();return t===null?null:this.Jn.Ft().Ts(e,t.Wt)}barsInLogicalRange(e){if(e===null)return null;const t=new Rs(new ci(e.from,e.to)).k_(),n=this.Jn.Xs();if(n.Ki())return null;const r=n.Fr(t.Uh(),1),a=n.Fr(t.bi(),-1),o=Q(n.Lr()),l=Q(n.Ks());if(r!==null&&a!==null&&r.Re>a.Re)return{barsBefore:e.from-o,barsAfter:l-e.to};const c={barsBefore:r===null||r.Re===o?e.from-o:r.Re-o,barsAfter:a===null||a.Re===l?l-e.to:l-a.Re};return r!==null&&a!==null&&(c.from=r.Pw,c.to=a.Pw),c}setData(e){this.o_,this.Jn.Rr(),this.bg.Cg(this.Jn,e),this.Pg("full")}update(e,t=!1){this.Jn.Rr(),this.bg.kg(this.Jn,e,t),this.Pg("update")}dataByIndex(e,t){const n=this.Jn.Xs().Fr(e,t);return n===null?null:Ca(this.seriesType())(n)}data(){const e=Ca(this.seriesType());return this.Jn.Xs().Hr().map(t=>e(t))}subscribeDataChanged(e){this.Mg.i(e)}unsubscribeDataChanged(e){this.Mg._(e)}applyOptions(e){this.Jn.hr(e)}options(){return Mt(this.Jn.N())}priceScale(){return this.Sg.priceScale(this.Jn.Ft().wa(),this.getPane().paneIndex())}createPriceLine(e){const t=dt(Mt(Hv),e),n=this.Jn.Oh(t);return new Ql(n)}removePriceLine(e){this.Jn.Nh(e.gg())}priceLines(){return this.Jn.Fh().map(e=>new Ql(e))}seriesType(){return this.Jn.Rr()}attachPrimitive(e){this.Jn.ua(e),e.attached&&e.attached({chart:this.wg,series:this,requestUpdate:()=>this.Jn.Qt().Bh(),horzScaleBehavior:this.o_})}detachPrimitive(e){this.Jn.ca(e),e.detached&&e.detached(),this.Jn.Qt().Bh()}getPane(){const e=this.Jn,t=Q(this.Jn.Qt().Hn(e));return this.xg(t)}moveToPane(e){this.Jn.Qt().Oc(this.Jn,e)}seriesOrder(){const e=this.Jn.Qt().Hn(this.Jn);return e===null?-1:e.Oo().indexOf(this.Jn)}setSeriesOrder(e){const t=this.Jn.Qt().Hn(this.Jn);t!==null&&t.Qo(this.Jn,e)}Pg(e){this.Mg.v()&&this.Mg.p(e)}}class qv{constructor(e,t,n){this.yg=new Be,this.z_=new Be,this.wm=new Be,this.ts=e,this.uh=e.Et(),this.Xm=t,this.uh.Du().i(this.Tg.bind(this)),this.uh.Vu().i(this.Rg.bind(this)),this.Xm.Pm().i(this.Dg.bind(this)),this.o_=n}m(){this.uh.Du().u(this),this.uh.Vu().u(this),this.Xm.Pm().u(this),this.yg.m(),this.z_.m(),this.wm.m()}scrollPosition(){return this.uh.wu()}scrollToPosition(e,t){t?this.uh.yu(e,1e3):this.ts.fn(e)}scrollToRealTime(){this.uh.ku()}getVisibleRange(){const e=this.uh.su();return e===null?null:{from:e.from.originalTime,to:e.to.originalTime}}setVisibleRange(e){const t={from:this.o_.convertHorzItemToInternal(e.from),to:this.o_.convertHorzItemToInternal(e.to)},n=this.uh.hu(t);this.ts.zc(n)}getVisibleLogicalRange(){const e=this.uh.iu();return e===null?null:{from:e.Uh(),to:e.bi()}}setVisibleLogicalRange(e){Ge(e.from<=e.to,"The from index cannot be after the to index."),this.ts.zc(e)}resetTimeScale(){this.ts.cn()}fitContent(){this.ts.Eu()}logicalToCoordinate(e){const t=this.ts.Et();return t.Ki()?null:t.qt(e)}coordinateToLogical(e){return this.uh.Ki()?null:this.uh.uu(e)}timeToIndex(e,t){const n=this.o_.convertHorzItemToInternal(e);return this.uh.J_(n,t)}timeToCoordinate(e){const t=this.timeToIndex(e,!1);return t===null?null:this.uh.qt(t)}coordinateToTime(e){const t=this.ts.Et(),n=t.uu(e),r=t.ss(n);return r===null?null:r.originalTime}width(){return this.Xm.Zf().width}height(){return this.Xm.Zf().height}subscribeVisibleTimeRangeChange(e){this.yg.i(e)}unsubscribeVisibleTimeRangeChange(e){this.yg._(e)}subscribeVisibleLogicalRangeChange(e){this.z_.i(e)}unsubscribeVisibleLogicalRangeChange(e){this.z_._(e)}subscribeSizeChange(e){this.wm.i(e)}unsubscribeSizeChange(e){this.wm._(e)}applyOptions(e){this.uh.hr(e)}options(){return{...Mt(this.uh.N()),barSpacing:this.uh.vu()}}Tg(){this.yg.v()&&this.yg.p(this.getVisibleRange())}Rg(){this.z_.v()&&this.z_.p(this.getVisibleLogicalRange())}Dg(e){this.wm.p(e.width,e.height)}}function Gv(s){if(s===void 0||s.type==="custom")return;const e=s;e.minMove!==void 0&&e.precision===void 0&&(e.precision=function(t){if(t>=1)return 0;let n=0;for(;n<8;n++){const r=Math.round(t);if(Math.abs(r-t)<1e-8)return n;t*=10}return n}(e.minMove))}function Kl(s){return function(e){if($i(e.handleScale)){const n=e.handleScale;e.handleScale={axisDoubleClickReset:{time:n,price:n},axisPressedMouseMove:{time:n,price:n},mouseWheel:n,pinch:n}}else if(e.handleScale!==void 0){const{axisPressedMouseMove:n,axisDoubleClickReset:r}=e.handleScale;$i(n)&&(e.handleScale.axisPressedMouseMove={time:n,price:n}),$i(r)&&(e.handleScale.axisDoubleClickReset={time:r,price:r})}const t=e.handleScroll;$i(t)&&(e.handleScroll={horzTouchDrag:t,vertTouchDrag:t,mouseWheel:t,pressedMouseMove:t})}(s),s}class Qv{constructor(e,t,n){this.Vg=new Map,this.Ig=new Map,this.Bg=new Be,this.Eg=new Be,this.Ag=new Be,this.$u=new WeakMap,this.zg=new Cv(t);const r=n===void 0?Mt(Gl()):dt(Mt(Gl()),Kl(n));this.Lg=t,this.Wf=new vv(e,r,t),this.Wf.Kv().i(o=>{this.Bg.v()&&this.Bg.p(this.Og(o()))},this),this.Wf.Xv().i(o=>{this.Eg.v()&&this.Eg.p(this.Og(o()))},this),this.Wf.uc().i(o=>{this.Ag.v()&&this.Ag.p(this.Og(o()))},this);const a=this.Wf.Qt();this.Ng=new qv(a,this.Wf.tw(),this.Lg)}remove(){this.Wf.Kv().u(this),this.Wf.Xv().u(this),this.Wf.uc().u(this),this.Ng.m(),this.Wf.m(),this.Vg.clear(),this.Ig.clear(),this.Bg.m(),this.Eg.m(),this.Ag.m(),this.zg.m()}resize(e,t,n){this.autoSizeActive()||this.Wf.Gm(e,t,n)}addCustomSeries(e,t={},n=0){const r=(a=>({type:"Custom",isBuiltIn:!1,defaultOptions:{...Mv,...a.defaultOptions()},Fg:Rv,Wg:a}))(Yt(e));return this.Hg(r,t,n)}addSeries(e,t={},n=0){return this.Hg(e,t,n)}removeSeries(e){const t=ct(this.Vg.get(e)),n=this.zg.Ec(t);this.Wf.Qt().Ec(t),this.Ug(n),this.Vg.delete(e),this.Ig.delete(t)}Cg(e,t){this.Ug(this.zg.Fw(e,t))}kg(e,t,n){this.Ug(this.zg.Yw(e,t,n))}subscribeClick(e){this.Bg.i(e)}unsubscribeClick(e){this.Bg._(e)}subscribeCrosshairMove(e){this.Ag.i(e)}unsubscribeCrosshairMove(e){this.Ag._(e)}subscribeDblClick(e){this.Eg.i(e)}unsubscribeDblClick(e){this.Eg._(e)}priceScale(e,t=0){return new td(this.Wf,e,t)}timeScale(){return this.Ng}applyOptions(e){this.Wf.hr(Kl(e))}options(){return this.Wf.N()}takeScreenshot(){return this.Wf.hw()}addPane(e=!1){const t=this.Wf.Qt().Uc();return t.zo(e),this.$g(t)}removePane(e){this.Wf.Qt().dc(e)}swapPanes(e,t){this.Wf.Qt().vc(e,t)}autoSizeActive(){return this.Wf.uw()}chartElement(){return this.Wf.tp()}panes(){return this.Wf.Qt().$s().map(e=>this.$g(e))}paneSize(e=0){const t=this.Wf.fw(e);return{height:t.height,width:t.width}}setCrosshairPosition(e,t,n){const r=this.Vg.get(n);if(r===void 0)return;const a=this.Wf.Qt().Hn(r);a!==null&&this.Wf.Qt().Tc(e,t,a)}clearCrosshairPosition(){this.Wf.Qt().Rc(!0)}horzBehaviour(){return this.Lg}Hg(e,t={},n=0){Ge(e.Fg!==void 0),Gv(t.priceFormat),e.type==="Candlestick"&&function(c){c.borderColor!==void 0&&(c.borderUpColor=c.borderColor,c.borderDownColor=c.borderColor),c.wickColor!==void 0&&(c.wickUpColor=c.wickColor,c.wickDownColor=c.wickColor)}(t);const r=dt(Mt(Oh),Mt(e.defaultOptions),t),a=e.Fg,o=new Qn(this.Wf.Qt(),e.type,r,a,e.Wg);this.Wf.Qt().Ic(o,n);const l=new Yv(o,this,this,this,this.Lg,c=>this.$g(c));return this.Vg.set(l,o),this.Ig.set(o,l),l}Ug(e){const t=this.Wf.Qt();t.Dc(e.Et.ou,e.Et.Gw,e.Et.Jw),e.Oo.forEach((n,r)=>r.ht(n.se,n.Zw)),t.Et().j_(),t.pu()}qg(e){return ct(this.Ig.get(e))}Og(e){const t=new Map;e.Rw.forEach((r,a)=>{const o=a.Rr(),l=Ca(o)(r);if(o!=="Custom")Ge(bv(l));else{const c=a.pa();Ge(!c||c(l)===!1)}t.set(this.qg(a),l)});const n=e.Tw!==void 0&&this.Ig.has(e.Tw)?this.qg(e.Tw):void 0;return{time:e.Pw,logical:e.Re,point:e.kw,paneIndex:e.yw,hoveredSeries:n,hoveredObjectId:e.Dw,seriesData:t,sourceEvent:e.Vw}}$g(e){let t=this.$u.get(e);return t||(t=new Vv(this.Wf,n=>this.qg(n),e,this),this.$u.set(e,t)),t}}function Kv(s){if(Ti(s)){const e=document.getElementById(s);return Ge(e!==null,`Cannot find element in DOM with id=${s}`),e}return s}function Jv(s,e,t){const n=Kv(s),r=new Qv(n,e,t);return e.setOptions(r.options()),r}function Xv(s,e){return Jv(s,new Ml,Ml.ad(e))}class so extends eo{constructor(e,t){super(e,t,!0)}ug(e,t,n){t._u(this.sg,vi(this.ng)),e.$l(this.sg,n,vi(this.ng))}Yg(e,t){return{wt:e,gt:t,_t:NaN,ut:NaN}}og(){const e=this.Jn.Rh();this.sg=this.Jn.Xs().Hr().map(t=>{const n=t.Wt[3];return this.jg(t.Re,n,e)})}}function sd(s,e,t,n,r,a,o){if(e.length===0||n.from>=e.length||n.to<=0)return;const{context:l,horizontalPixelRatio:c,verticalPixelRatio:h}=s,d=e[n.from];let m=a(s,d),x=d;if(n.to-n.from<2){const b=r/2;l.beginPath();const p={_t:d._t-b,ut:d.ut},g={_t:d._t+b,ut:d.ut};l.moveTo(p._t*c,p.ut*h),l.lineTo(g._t*c,g.ut*h),o(s,m,p,g)}else{const b=(g,f)=>{o(s,m,x,f),l.beginPath(),m=g,x=f};let p=x;l.beginPath(),l.moveTo(d._t*c,d.ut*h);for(let g=n.from+1;g<n.to;++g){p=e[g];const f=a(s,p);switch(t){case 0:l.lineTo(p._t*c,p.ut*h);break;case 1:l.lineTo(p._t*c,e[g-1].ut*h),f!==m&&(b(f,p),l.lineTo(p._t*c,e[g-1].ut*h)),l.lineTo(p._t*c,p.ut*h);break;case 2:{const[y,S]=Zv(e,g-1,g);l.bezierCurveTo(y._t*c,y.ut*h,S._t*c,S.ut*h,p._t*c,p.ut*h);break}}t!==1&&f!==m&&(b(f,p),l.moveTo(p._t*c,p.ut*h))}(x!==p||x===p&&t===1)&&o(s,m,x,p)}}const Jl=6;function zr(s,e){return{_t:s._t-e._t,ut:s.ut-e.ut}}function Xl(s,e){return{_t:s._t/e,ut:s.ut/e}}function Zv(s,e,t){const n=Math.max(0,e-1),r=Math.min(s.length-1,t+1);var a,o;return[(a=s[e],o=Xl(zr(s[t],s[n]),Jl),{_t:a._t+o._t,ut:a.ut+o.ut}),zr(s[t],Xl(zr(s[r],s[e]),Jl))]}function ex(s,e){const t=s.context;t.strokeStyle=e,t.stroke()}class tx extends zt{constructor(){super(...arguments),this.rt=null}ht(e){this.rt=e}et(e){if(this.rt===null)return;const{ot:t,lt:n,Kg:r,Xg:a,ct:o,Xt:l,Zg:c}=this.rt;if(n===null)return;const h=e.context;h.lineCap="butt",h.lineWidth=o*e.verticalPixelRatio,xs(h,l),h.lineJoin="round";const d=this.Gg.bind(this);a!==void 0&&sd(e,t,a,n,r,d,ex),c&&function(m,x,b,p,g){if(p.to-p.from<=0)return;const{horizontalPixelRatio:f,verticalPixelRatio:y,context:S}=m;let k=null;const C=Math.max(1,Math.floor(f))%2/2,N=b*y+C;for(let T=p.to-1;T>=p.from;--T){const I=x[T];if(I){const P=g(m,I);P!==k&&(S.beginPath(),k!==null&&S.fill(),S.fillStyle=P,k=P);const L=Math.round(I._t*f)+C,M=I.ut*y;S.moveTo(L,M),S.arc(L,M,N,0,2*Math.PI)}}S.fill()}(e,t,c,n,d)}}class id extends tx{Gg(e,t){return t.vt}}class sx extends so{constructor(){super(...arguments),this.hg=new id}jg(e,t,n){return{...this.Yg(e,t),...n.Dr(e)}}cg(){const e=this.Jn.N(),t={ot:this.sg,Xt:e.lineStyle,Xg:e.lineVisible?e.lineType:void 0,ct:e.lineWidth,Zg:e.pointMarkersVisible?e.pointMarkersRadius||e.lineWidth/2+2:void 0,lt:this.ng,Kg:this.Qn.Et().vu()};this.hg.ht(t)}}const ix={type:"Line",isBuiltIn:!0,defaultOptions:{color:"#2196f3",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Fg:(s,e)=>new sx(s,e)};function nx(s,e,t,n,r){const{context:a,horizontalPixelRatio:o,verticalPixelRatio:l}=e;a.lineTo(r._t*o,s*l),a.lineTo(n._t*o,s*l),a.closePath(),a.fillStyle=t,a.fill()}class rx extends zt{constructor(){super(...arguments),this.rt=null}ht(e){this.rt=e}et(e){if(this.rt===null)return;const{ot:t,lt:n,Kg:r,ct:a,Xt:o,Xg:l}=this.rt,c=this.rt.eM??(this.rt.rM?0:e.mediaSize.height);if(n===null)return;const h=e.context;h.lineCap="butt",h.lineJoin="round",h.lineWidth=a,xs(h,o),h.lineWidth=1,sd(e,t,l,n,r,this.hM.bind(this),nx.bind(null,c))}}class ax{aM(e,t){const n=this.lM,{oM:r,_M:a,uM:o,cM:l,eM:c,dM:h,fM:d}=t;if(this.pM===void 0||n===void 0||n.oM!==r||n._M!==a||n.uM!==o||n.cM!==l||n.eM!==c||n.dM!==h||n.fM!==d){const{verticalPixelRatio:m}=e,x=c||h>0?m:1,b=h*x,p=d===e.bitmapSize.height?d:d*x,g=(c??0)*x,f=e.context.createLinearGradient(0,b,0,p);if(f.addColorStop(0,r),c!=null){const y=Ms((g-b)/(p-b),0,1);f.addColorStop(y,a),f.addColorStop(y,o)}f.addColorStop(1,l),this.pM=f,this.lM=t}return this.pM}}class ox extends rx{constructor(){super(...arguments),this.vM=new ax}hM(e,t){var n;return this.vM.aM(e,{oM:t.mr,_M:"",uM:"",cM:t.wr,dM:((n=this.rt)==null?void 0:n.dM)??0,fM:e.bitmapSize.height})}}class lx extends so{constructor(e,t){super(e,t),this.hg=new Dh,this.MM=new ox,this.bM=new id,this.hg.st([this.MM,this.bM])}jg(e,t,n){return{...this.Yg(e,t),...n.Dr(e)}}cg(){const e=this.Jn.N();if(this.ng===null||this.sg.length===0)return;let t;if(e.relativeGradient){t=this.sg[this.ng.from].ut;for(let n=this.ng.from;n<this.ng.to;n++){const r=this.sg[n];r.ut<t&&(t=r.ut)}}this.MM.ht({Xg:e.lineType,ot:this.sg,Xt:e.lineStyle,ct:e.lineWidth,eM:null,dM:t,rM:e.invertFilledArea,lt:this.ng,Kg:this.Qn.Et().vu()}),this.bM.ht({Xg:e.lineVisible?e.lineType:void 0,ot:this.sg,Xt:e.lineStyle,ct:e.lineWidth,lt:this.ng,Kg:this.Qn.Et().vu(),Zg:e.pointMarkersVisible?e.pointMarkersRadius||e.lineWidth/2+2:void 0})}}const cx={type:"Area",isBuiltIn:!0,defaultOptions:{topColor:"rgba( 46, 220, 135, 0.4)",bottomColor:"rgba( 40, 221, 100, 0)",invertFilledArea:!1,relativeGradient:!1,lineColor:"#33D778",lineStyle:0,lineWidth:3,lineType:0,lineVisible:!0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4,crosshairMarkerBorderColor:"",crosshairMarkerBorderWidth:2,crosshairMarkerBackgroundColor:"",lastPriceAnimation:0,pointMarkersVisible:!1},Fg:(s,e)=>new lx(s,e)};class hx extends eo{constructor(e,t){super(e,t,!1)}ug(e,t,n){t._u(this.sg,vi(this.ng)),e.Yl(this.sg,n,vi(this.ng))}yM(e,t,n){return{wt:e,qh:t.Wt[0],Yh:t.Wt[1],jh:t.Wt[2],Kh:t.Wt[3],_t:NaN,jl:NaN,Kl:NaN,Xl:NaN,Zl:NaN}}og(){const e=this.Jn.Rh();this.sg=this.Jn.Xs().Hr().map(t=>this.jg(t.Re,t,e))}}class dx extends zt{constructor(){super(...arguments),this.Yt=null,this.SM=0}ht(e){this.Yt=e}et(e){if(this.Yt===null||this.Yt.Xs.length===0||this.Yt.lt===null)return;const{horizontalPixelRatio:t}=e;this.SM=function(a,o){if(a>=2.5&&a<=4)return Math.floor(3*o);const l=1-.2*Math.atan(Math.max(4,a)-4)/(.5*Math.PI),c=Math.floor(a*l*o),h=Math.floor(a*o),d=Math.min(c,h);return Math.max(Math.floor(o),d)}(this.Yt.vu,t),this.SM>=2&&Math.floor(t)%2!=this.SM%2&&this.SM--;const n=this.Yt.Xs;this.Yt.TM&&this.RM(e,n,this.Yt.lt),this.Yt.Mi&&this._v(e,n,this.Yt.lt);const r=this.DM(t);(!this.Yt.Mi||this.SM>2*r)&&this.VM(e,n,this.Yt.lt)}RM(e,t,n){if(this.Yt===null)return;const{context:r,horizontalPixelRatio:a,verticalPixelRatio:o}=e;let l="",c=Math.min(Math.floor(a),Math.floor(this.Yt.vu*a));c=Math.max(Math.floor(a),Math.min(c,this.SM));const h=Math.floor(.5*c);let d=null;for(let m=n.from;m<n.to;m++){const x=t[m];x.pr!==l&&(r.fillStyle=x.pr,l=x.pr);const b=Math.round(Math.min(x.jl,x.Zl)*o),p=Math.round(Math.max(x.jl,x.Zl)*o),g=Math.round(x.Kl*o),f=Math.round(x.Xl*o);let y=Math.round(a*x._t)-h;const S=y+c-1;d!==null&&(y=Math.max(d+1,y),y=Math.min(y,S));const k=S-y+1;r.fillRect(y,g,k,b-g),r.fillRect(y,p+1,k,f-p),d=S}}DM(e){let t=Math.floor(1*e);this.SM<=2*t&&(t=Math.floor(.5*(this.SM-1)));const n=Math.max(Math.floor(e),t);return this.SM<=2*n?Math.max(Math.floor(e),Math.floor(1*e)):n}_v(e,t,n){if(this.Yt===null)return;const{context:r,horizontalPixelRatio:a,verticalPixelRatio:o}=e;let l="";const c=this.DM(a);let h=null;for(let d=n.from;d<n.to;d++){const m=t[d];m.dr!==l&&(r.fillStyle=m.dr,l=m.dr);let x=Math.round(m._t*a)-Math.floor(.5*this.SM);const b=x+this.SM-1,p=Math.round(Math.min(m.jl,m.Zl)*o),g=Math.round(Math.max(m.jl,m.Zl)*o);if(h!==null&&(x=Math.max(h+1,x),x=Math.min(x,b)),this.Yt.vu*a>2*c)c0(r,x,p,b-x+1,g-p+1,c);else{const f=b-x+1;r.fillRect(x,p,f,g-p+1)}h=b}}VM(e,t,n){if(this.Yt===null)return;const{context:r,horizontalPixelRatio:a,verticalPixelRatio:o}=e;let l="";const c=this.DM(a);for(let h=n.from;h<n.to;h++){const d=t[h];let m=Math.round(Math.min(d.jl,d.Zl)*o),x=Math.round(Math.max(d.jl,d.Zl)*o),b=Math.round(d._t*a)-Math.floor(.5*this.SM),p=b+this.SM-1;if(d.cr!==l){const g=d.cr;r.fillStyle=g,l=g}this.Yt.Mi&&(b+=c,m+=c,p-=c,x-=c),m>x||r.fillRect(b,m,p-b+1,x-m+1)}}}class ux extends hx{constructor(){super(...arguments),this.hg=new dx}jg(e,t,n){return{...this.yM(e,t,n),...n.Dr(e)}}cg(){const e=this.Jn.N();this.hg.ht({Xs:this.sg,vu:this.Qn.Et().vu(),TM:e.wickVisible,Mi:e.borderVisible,lt:this.ng})}}const mx={type:"Candlestick",isBuiltIn:!0,defaultOptions:{upColor:"#26a69a",downColor:"#ef5350",wickVisible:!0,borderVisible:!0,borderColor:"#378658",borderUpColor:"#26a69a",borderDownColor:"#ef5350",wickColor:"#737375",wickUpColor:"#26a69a",wickDownColor:"#ef5350"},Fg:(s,e)=>new ux(s,e)};class fx extends zt{constructor(){super(...arguments),this.Yt=null,this.IM=[]}ht(e){this.Yt=e,this.IM=[]}et({context:e,horizontalPixelRatio:t,verticalPixelRatio:n}){if(this.Yt===null||this.Yt.ot.length===0||this.Yt.lt===null)return;this.IM.length||this.BM(t);const r=Math.max(1,Math.floor(n)),a=Math.round(this.Yt.EM*n)-Math.floor(r/2),o=a+r;for(let l=this.Yt.lt.from;l<this.Yt.lt.to;l++){const c=this.Yt.ot[l],h=this.IM[l-this.Yt.lt.from],d=Math.round(c.ut*n);let m,x;e.fillStyle=c.cr,d<=a?(m=d,x=o):(m=a,x=d-Math.floor(r/2)+r),e.fillRect(h.Uh,m,h.bi-h.Uh+1,x-m)}}BM(e){if(this.Yt===null||this.Yt.ot.length===0||this.Yt.lt===null)return void(this.IM=[]);const t=Math.ceil(this.Yt.vu*e)<=1?0:Math.max(1,Math.floor(e)),n=Math.round(this.Yt.vu*e)-t;this.IM=new Array(this.Yt.lt.to-this.Yt.lt.from);for(let a=this.Yt.lt.from;a<this.Yt.lt.to;a++){const o=this.Yt.ot[a],l=Math.round(o._t*e);let c,h;if(n%2){const d=(n-1)/2;c=l-d,h=l+d}else{const d=n/2;c=l-d,h=l+d-1}this.IM[a-this.Yt.lt.from]={Uh:c,bi:h,AM:l,ne:o._t*e,wt:o.wt}}for(let a=this.Yt.lt.from+1;a<this.Yt.lt.to;a++){const o=this.IM[a-this.Yt.lt.from],l=this.IM[a-this.Yt.lt.from-1];o.wt===l.wt+1&&o.Uh-l.bi!==t+1&&(l.AM>l.ne?l.bi=o.Uh-t-1:o.Uh=l.bi+t+1)}let r=Math.ceil(this.Yt.vu*e);for(let a=this.Yt.lt.from;a<this.Yt.lt.to;a++){const o=this.IM[a-this.Yt.lt.from];o.bi<o.Uh&&(o.bi=o.Uh);const l=o.bi-o.Uh+1;r=Math.min(l,r)}if(t>0&&r<4)for(let a=this.Yt.lt.from;a<this.Yt.lt.to;a++){const o=this.IM[a-this.Yt.lt.from];o.bi-o.Uh+1>r&&(o.AM>o.ne?o.bi-=1:o.Uh+=1)}}}class px extends so{constructor(){super(...arguments),this.hg=new fx}jg(e,t,n){return{...this.Yg(e,t),...n.Dr(e)}}cg(){const e={ot:this.sg,vu:this.Qn.Et().vu(),lt:this.ng,EM:this.Jn.Ft().Nt(this.Jn.N().base,Q(this.Jn.zt()).Wt)};this.hg.ht(e)}}const gx={type:"Histogram",isBuiltIn:!0,defaultOptions:{color:"#26a69a",base:0},Fg:(s,e)=>new px(s,e)};({...Oh});const qi="http://localhost:5001";class yx{constructor(){this.intervals=new Map,this.subscribers=new Map,this.lastUpdateTimes=new Map}startLiveUpdates(e,t,n=6e4){console.log(`🔄 Starting live updates for ${e} every ${n}ms`),this.stopLiveUpdates(e),this.subscribers.set(e,t),this.fetchLatestCandle(e);const r=this.getSmartInterval(e),a=setInterval(()=>{this.fetchLatestCandle(e)},r);return this.intervals.set(e,a),console.log(`📊 Live updates for ${e} set to ${r/1e3}s intervals`),a}getSmartInterval(e){const n=new Date().getHours();if(e.endsWith(".NS")||e.endsWith(".BO")){const a=new Date().toLocaleString("en-US",{timeZone:"Asia/Kolkata"}),l=new Date(a).getHours();return l>=9&&l<=15?6e4:l>=8&&l<9||l>15&&l<=17?3e5:9e5}else return n>=9&&n<=16?6e4:n>=7&&n<9||n>16&&n<=20?3e5:9e5}stopLiveUpdates(e){const t=this.intervals.get(e);t&&(console.log(`⏹️ Stopping live updates for ${e}`),clearInterval(t),this.intervals.delete(e),this.subscribers.delete(e),this.lastUpdateTimes.delete(e))}stopAllUpdates(){console.log("⏹️ Stopping all live updates"),this.intervals.forEach((e,t)=>{clearInterval(e)}),this.intervals.clear(),this.subscribers.clear(),this.lastUpdateTimes.clear()}async fetchLatestCandle(e){try{const t=await xe.get(`${qi}/api/live-charts/latest/${e}`,{timeout:1e4});if(t.data.success&&t.data.latest){const n=t.data.latest,r=this.subscribers.get(e),a=this.lastUpdateTimes.get(e),o=n.time;!a||o>a?(console.log(`📈 New candle for ${e}:`,{time:new Date(o*1e3).toLocaleTimeString(),close:n.close,volume:n.volume}),this.lastUpdateTimes.set(e,o),r&&r({type:"update",data:n,marketOpen:t.data.marketOpen,exchange:t.data.exchange,timestamp:t.data.timestamp})):r&&r({type:"price_update",data:n,marketOpen:t.data.marketOpen,exchange:t.data.exchange,timestamp:t.data.timestamp})}}catch(t){console.warn(`⚠️ Failed to fetch latest candle for ${e}:`,t.message);const n=this.subscribers.get(e);n&&n({type:"error",error:t.message,symbol:e})}}async fetchInitialData(e,t=null){try{console.log(`📊 Fetching initial chart data for ${e}`);const n=t?{from:t}:{},r=await xe.get(`${qi}/api/live-charts/live/${e}`,{params:n,timeout:15e3});if(r.data.success)return console.log(`✅ Initial data loaded for ${e}: ${r.data.count} candles`),{success:!0,data:r.data.data,latest:r.data.latest,marketOpen:r.data.marketOpen,exchange:r.data.exchange,count:r.data.count};throw new Error(r.data.message||"Failed to fetch initial data")}catch(n){return console.error(`❌ Error fetching initial data for ${e}:`,n.message),{success:!1,error:n.message,data:[]}}}async checkMarketStatus(e="NSE"){try{return(await xe.get(`${qi}/api/live-charts/market-status/${e}`,{timeout:5e3})).data}catch(t){return console.warn(`⚠️ Failed to check market status for ${e}:`,t.message),{success:!1,marketOpen:!1,exchange:e.toUpperCase(),error:t.message}}}getActiveSymbols(){return Array.from(this.subscribers.keys())}isTracking(e){return this.subscribers.has(e)}getUpdateInterval(e){return this.intervals.get(e)}async fetchBatchCandles(e){try{console.log(`📊 Batch fetching candles for ${e.length} symbols`);const t=await xe.post(`${qi}/api/live-charts/batch`,{symbols:e},{timeout:15e3});if(t.data.success)return console.log(`✅ Batch fetch successful: ${t.data.count} results`),{success:!0,results:t.data.results,timestamp:t.data.timestamp};throw new Error(t.data.message||"Batch fetch failed")}catch(t){return console.error("❌ Error in batch fetch:",t.message),{success:!1,error:t.message,results:[]}}}startBatchLiveUpdates(e,t,n=6e4){console.log(`🔄 Starting batch live updates for ${e.length} symbols every ${n}ms`),e.forEach(o=>this.stopLiveUpdates(o)),e.forEach(o=>this.subscribers.set(o,t)),this.fetchBatchCandles(e).then(o=>{o.success&&o.results.forEach(l=>{if(l.success){const c=this.subscribers.get(l.symbol);c&&c({type:"update",data:l.latest,marketOpen:l.marketOpen,exchange:l.exchange,timestamp:l.timestamp,symbol:l.symbol})}})});const r=setInterval(()=>{this.fetchBatchCandles(e).then(o=>{o.success&&o.results.forEach(l=>{if(l.success){const c=this.subscribers.get(l.symbol);c&&c({type:"update",data:l.latest,marketOpen:l.marketOpen,exchange:l.exchange,timestamp:l.timestamp,symbol:l.symbol})}})})},n),a=`batch_${e.join("_")}`;return this.intervals.set(a,r),r}}const wt=new yx;typeof window<"u"&&window.addEventListener("beforeunload",()=>{wt.stopAllUpdates()});const vx=({data:s=[],symbol:e="RELIANCE.NS",timeframe:t="1D",chartType:n="candlestick",theme:r="dark",onRefresh:a,loading:o=!1,height:l=500,enableLiveUpdates:c=!0})=>{const h=v.useRef(),d=v.useRef(),m=v.useRef(),x=v.useRef(),b=v.useRef(),p=v.useRef(),[g,f]=v.useState(!1),[y,S]=v.useState(!0),[k,C]=v.useState({sma:!1,ema:!1,rsi:!1,macd:!1}),[N,T]=v.useState(c&&t==="1D"),[I,P]=v.useState(null),[L,M]=v.useState(!1),[O,B]=v.useState(null),[R,A]=v.useState(null),V=()=>({layout:{background:{type:wa.Solid,color:r==="dark"?"#0F172A":"#FFFFFF"},textColor:r==="dark"?"#F8FAFC":"#1E293B",fontSize:12,fontFamily:"Inter, -apple-system, BlinkMacSystemFont, sans-serif"},grid:{vertLines:{color:r==="dark"?"#1E293B":"#E2E8F0",style:1},horzLines:{color:r==="dark"?"#1E293B":"#E2E8F0",style:1}},crosshair:{mode:1,vertLine:{color:r==="dark"?"#64748B":"#475569",width:1,style:3},horzLine:{color:r==="dark"?"#64748B":"#475569",width:1,style:3}},priceScale:{borderColor:r==="dark"?"#334155":"#CBD5E1",textColor:r==="dark"?"#94A3B8":"#64748B"},timeScale:{borderColor:r==="dark"?"#334155":"#CBD5E1",textColor:r==="dark"?"#94A3B8":"#64748B",timeVisible:!0,secondsVisible:!1},watermark:{visible:!0,fontSize:48,horzAlign:"center",vertAlign:"center",color:r==="dark"?"rgba(248, 250, 252, 0.05)":"rgba(30, 41, 59, 0.05)",text:e},rightPriceScale:{scaleMargins:{top:.1,bottom:y?.4:.1}}}),z=()=>({upColor:"#10B981",downColor:"#EF4444",borderDownColor:"#EF4444",borderUpColor:"#10B981",wickDownColor:"#EF4444",wickUpColor:"#10B981"}),q=()=>({color:"#3B82F6",lineWidth:2,lineStyle:0,crosshairMarkerVisible:!0,crosshairMarkerRadius:4}),Y=()=>({topColor:"rgba(59, 130, 246, 0.4)",bottomColor:"rgba(59, 130, 246, 0.0)",lineColor:"#3B82F6",lineWidth:2}),te=()=>({color:r==="dark"?"#475569":"#94A3B8",priceFormat:{type:"volume"},priceScaleId:"volume",scaleMargins:{top:.7,bottom:0}}),ne=$=>{if(!d.current)return;const{type:U,data:X,marketOpen:ce,error:ye}=$;if(ye){console.warn("Live update error:",ye);return}M(ce),P(new Date),U==="update"&&X?(m.current&&n==="candlestick"?(m.current.update(X),console.log("📊 Updated candlestick with new candle:",X)):x.current&&n==="line"?x.current.update({time:X.time,value:X.close}):b.current&&n==="area"&&b.current.update({time:X.time,value:X.close}),y&&p.current&&X.volume&&p.current.update({time:X.time,value:X.volume,color:X.close>=X.open?"#26a69a":"#ef5350"}),B(X.close),A({direction:"update",timestamp:Date.now()}),setTimeout(()=>A(null),1e3)):U==="price_update"&&X&&(m.current&&n==="candlestick"&&m.current.update(X),B(X.close))},re=()=>{N?(wt.stopLiveUpdates(e),T(!1),console.log("⏹️ Live updates stopped")):(wt.startLiveUpdates(e,ne,5e3),T(!0),console.log("▶️ Live updates started"))};v.useEffect(()=>{if(!h.current)return;const $=Xv(h.current,{...V(),width:h.current.clientWidth,height:g?window.innerHeight-100:l});d.current=$;try{n==="candlestick"?m.current=$.addSeries(mx,z()):n==="line"?x.current=$.addSeries(ix,q()):n==="area"&&(b.current=$.addSeries(cx,Y()))}catch(X){console.error("Error creating chart series:",X),console.log("Available chart methods:",Object.getOwnPropertyNames($))}y&&(p.current=$.addSeries(gx,te()),$.priceScale("volume").applyOptions({scaleMargins:{top:.7,bottom:0}}));const U=()=>{d.current&&h.current&&d.current.applyOptions({width:h.current.clientWidth,height:g?window.innerHeight-100:l})};return window.addEventListener("resize",U),()=>{window.removeEventListener("resize",U),d.current&&d.current.remove()}},[n,r,y,g,l]),v.useEffect(()=>{if(!h.current)return;const $=new ResizeObserver(U=>{for(let X of U)if(d.current){const{width:ce}=X.contentRect;d.current.applyOptions({width:ce,height:g?window.innerHeight-100:l}),d.current.timeScale().fitContent()}});return $.observe(h.current),()=>{$.disconnect()}},[g,l]),v.useEffect(()=>{if(!(!s||s.length===0))try{const $=le=>{if(!le)return new Date().toISOString().split("T")[0];if(typeof le=="number")return le;if(typeof le=="string"){const Qe=new Date(le);return isNaN(Qe.getTime())?le.split(" ")[0]||new Date().toISOString().split("T")[0]:Qe.toISOString().split("T")[0]}return new Date().toISOString().split("T")[0]},U=s.map(le=>({time:$(le.time||le.date),open:parseFloat(le.open),high:parseFloat(le.high),low:parseFloat(le.low),close:parseFloat(le.close),value:parseFloat(le.close)})),X=s.map(le=>({time:$(le.time||le.date),value:parseInt(le.volume||0),color:le.close>=le.open?"#10B981":"#EF4444"})),ce=[],ye=new Set;U.sort((le,Qe)=>new Date(le.time)-new Date(Qe.time)).forEach(le=>{ye.has(le.time)||(ye.add(le.time),ce.push(le))});const pe=[],Ae=new Set;X.sort((le,Qe)=>new Date(le.time)-new Date(Qe.time)).forEach(le=>{Ae.has(le.time)||(Ae.add(le.time),pe.push(le))}),n==="candlestick"&&m.current?m.current.setData(ce):n==="line"&&x.current?x.current.setData(ce):n==="area"&&b.current&&b.current.setData(ce),y&&p.current&&pe.length>0&&p.current.setData(pe),d.current&&d.current.timeScale().fitContent()}catch($){console.error("Error updating chart data:",$)}},[s,n,y]),v.useEffect(()=>{if(t!=="1D"){N&&(T(!1),wt.stopLiveUpdates(e));return}return N?(console.log(`🔄 Starting live updates for ${e}`),wt.startLiveUpdates(e,ne),wt.checkMarketStatus(e.includes(".NS")?"NSE":"NASDAQ").then($=>{M($.marketOpen)})):wt.stopLiveUpdates(e),()=>{wt.stopLiveUpdates(e)}},[N,e,t]),v.useEffect(()=>(wt.stopLiveUpdates(e),t==="1D"&&c?(T(!0),wt.startLiveUpdates(e,ne)):T(!1),()=>{wt.stopLiveUpdates(e)}),[e,t]),v.useEffect(()=>{const $=U=>{U.key==="Escape"&&g&&oe(),(U.key==="f"||U.key==="F")&&(U.ctrlKey||U.metaKey)&&(U.preventDefault(),oe())};return document.addEventListener("keydown",$),()=>{document.removeEventListener("keydown",$),g&&(document.body.style.overflow="",document.body.classList.remove("chart-fullscreen-active"))}},[g]);const oe=()=>{const $=!g;f($),$?(document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.height="100%",document.body.style.top="0",document.body.style.left="0",document.body.classList.add("chart-fullscreen-active"),document.documentElement.style.overflow="hidden"):(document.body.style.overflow="",document.body.style.position="",document.body.style.width="",document.body.style.height="",document.body.style.top="",document.body.style.left="",document.body.classList.remove("chart-fullscreen-active"),document.documentElement.style.overflow=""),setTimeout(()=>{if(d.current&&h.current){const U=$?window.innerWidth:h.current.clientWidth,X=$?window.innerHeight-h.current.offsetTop-60:l;d.current.applyOptions({width:U,height:X}),d.current.timeScale().fitContent()}},150)},ie=()=>{S(!y)},D=()=>{if(d.current){const $=h.current.querySelector("canvas");if($){const U=document.createElement("a");U.download=`${e}_${t}_chart.png`,U.href=$.toDataURL(),U.click()}}};return i.jsxs(F.div,{className:`tradingview-chart-container ${g?"fullscreen":""}`,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},children:[i.jsxs("div",{className:"chart-header",children:[i.jsxs("div",{className:"chart-title",children:[i.jsxs("h3",{children:[e," - ",t]}),i.jsx("span",{className:"chart-type",children:n.charAt(0).toUpperCase()+n.slice(1)}),N&&i.jsxs("div",{className:"live-indicators",children:[O&&i.jsxs("span",{className:`live-price ${R?`price-${R.direction}`:""}`,children:["₹",O.toFixed(2)]}),i.jsxs("span",{className:`market-status ${L?"open":"closed"}`,children:[i.jsx(vt,{size:14,className:"status-icon"}),L?"Market Open":"Market Closed"]}),I&&i.jsxs("span",{className:"last-update",children:["Updated: ",I.toLocaleTimeString()]})]})]}),i.jsxs("div",{className:"chart-controls",children:[i.jsx("button",{className:`chart-control-btn ${y?"active":""}`,onClick:ie,title:"Toggle Volume Display",children:"📊"}),i.jsx("button",{className:"chart-control-btn",onClick:a,disabled:o,title:"Refresh Chart Data",children:"🔄"}),t==="1D"&&c&&i.jsx("button",{onClick:re,className:`chart-control-btn ${N?"live-active":""}`,title:N?"Stop Live Updates":"Start Live Updates",children:N?"⏸️":"▶️"}),i.jsx("button",{className:"chart-control-btn",onClick:D,title:"Download Chart as PNG",children:"💾"}),i.jsx("button",{className:`chart-control-btn ${g?"fullscreen-active":""}`,onClick:oe,title:g?"Exit Fullscreen (Esc)":"Enter Fullscreen (F)",children:g?"🔲":"⛶"})]})]}),i.jsxs("div",{ref:h,className:"chart-wrapper",style:{position:"relative",width:"100%",height:g?"100%":`${l}px`,flex:g?"1":"none"},children:[o&&i.jsx("div",{className:"chart-loading-overlay",children:i.jsxs("div",{className:"loading-content",children:[i.jsx(Ue,{size:32,className:"animate-spin"}),i.jsx("p",{children:"Loading chart data..."})]})}),s.length===0&&!o&&i.jsx("div",{className:"chart-empty-overlay",children:i.jsxs("div",{className:"empty-content",children:[i.jsx("p",{children:"No chart data available"}),i.jsxs("button",{onClick:a,className:"btn-primary",children:[i.jsx(Ue,{size:16}),"Refresh"]})]})})]}),i.jsx("div",{className:"chart-footer",children:i.jsxs("div",{className:"chart-info",children:[i.jsxs("span",{children:["Data Points: ",s.length]}),i.jsx("span",{children:"•"}),i.jsxs("span",{children:["Last Updated: ",new Date().toLocaleTimeString()]})]})})]})},xx=(s,e)=>{const[t,n]=v.useState(s);return v.useEffect(()=>{const r=setTimeout(()=>{n(s)},e);return()=>{clearTimeout(r)}},[s,e]),t},nd=({onStockSelect:s,selectedStock:e,className:t="",popularStocks:n,onUpdatePopularStocks:r})=>{const[a,o]=v.useState(""),[l,c]=v.useState([]),[h,d]=v.useState(!1),[m,x]=v.useState(!1),[b,p]=v.useState("all"),[g,f]=v.useState(!1),y=v.useRef(null),S=xx(a,300),[k,C]=v.useState(n||[{symbol:"RELIANCE",name:"Reliance Industries Ltd",price:2847.65,change:23.45,changePercent:.83,volume:2847392,marketCap:1925e9,sector:"Energy",isWatchlisted:!1},{symbol:"TCS",name:"Tata Consultancy Services",price:3567.8,change:-12.4,changePercent:-.35,volume:1234567,marketCap:13e11,sector:"IT",isWatchlisted:!0},{symbol:"HDFCBANK",name:"HDFC Bank Limited",price:1687.9,change:15.6,changePercent:.93,volume:3456789,marketCap:93e10,sector:"Banking",isWatchlisted:!1},{symbol:"INFY",name:"Infosys Limited",price:1456.25,change:8.75,changePercent:.6,volume:2345678,marketCap:62e10,sector:"IT",isWatchlisted:!1},{symbol:"HINDUNILVR",name:"Hindustan Unilever Ltd",price:2789.45,change:-5.3,changePercent:-.19,volume:876543,marketCap:65e10,sector:"FMCG",isWatchlisted:!0},{symbol:"ICICIBANK",name:"ICICI Bank Limited",price:1098.7,change:12.85,changePercent:1.18,volume:4567890,marketCap:77e10,sector:"Banking",isWatchlisted:!1},{symbol:"KOTAKBANK",name:"Kotak Mahindra Bank",price:1876.2,change:-8.45,changePercent:-.45,volume:1987654,marketCap:37e10,sector:"Banking",isWatchlisted:!1},{symbol:"BHARTIARTL",name:"Bharti Airtel Limited",price:1234.55,change:18.9,changePercent:1.55,volume:3210987,marketCap:68e10,sector:"Telecom",isWatchlisted:!0},{symbol:"ITC",name:"ITC Limited",price:456.8,change:-2.15,changePercent:-.47,volume:5432109,marketCap:57e10,sector:"FMCG",isWatchlisted:!1}]),N=async P=>{if(!P.trim()){c([]);return}d(!0);try{console.log(`🔍 StockSearchPanel: Searching for "${P}"`);const L=await Wt.searchStocks(P,10);if(console.log("📊 StockSearchPanel: FMP API response:",L),L.success&&L.results){const O=L.results.sort((B,R)=>{const A=B.exchange==="NSE"||B.exchange==="BSE"||B.symbol.endsWith(".NS")||B.symbol.endsWith(".BO"),V=R.exchange==="NSE"||R.exchange==="BSE"||R.symbol.endsWith(".NS")||R.symbol.endsWith(".BO");return A&&!V?-1:!A&&V?1:0}).slice(0,8).map(B=>({symbol:B.symbol,name:B.name,exchange:B.exchange,currency:B.currency,type:B.type,price:B.exchange==="NSE"||B.exchange==="BSE"?Math.random()*2e3+100:Math.random()*500+50,change:(Math.random()-.5)*40,changePercent:(Math.random()-.5)*8,sector:"Unknown"}));console.log(`✅ StockSearchPanel: Found ${O.length} results with price data`),c(O)}else console.warn("⚠️ StockSearchPanel: No results from FMP API"),c([])}catch(L){console.error("❌ StockSearchPanel: Search error:",L);const M=k.filter(O=>O.symbol.toLowerCase().includes(P.toLowerCase())||O.name.toLowerCase().includes(P.toLowerCase()));console.log(`🔄 StockSearchPanel: Using fallback results: ${M.length} found`),c(M)}finally{d(!1)}},T=v.useMemo(()=>{let P=[...k];switch(b){case"gainers":P=P.filter(L=>L.change>0).sort((L,M)=>M.changePercent-L.changePercent);break;case"losers":P=P.filter(L=>L.change<0).sort((L,M)=>L.changePercent-M.changePercent);break;case"watchlist":P=P.filter(L=>L.isWatchlisted);break;case"volume":P=P.sort((L,M)=>M.volume-L.volume);break;default:P=P.sort((L,M)=>M.marketCap-L.marketCap)}return P},[k,b]);v.useEffect(()=>{S&&S.trim().length>=2?(console.log(`🔍 StockSearchPanel: Triggering search for "${S}"`),N(S)):(console.log("🔍 StockSearchPanel: Clearing search results"),c([]))},[S]);const I=P=>{s==null||s(P),o(""),c([])};return i.jsxs("div",{className:`stock-search-panel ${t}`,children:[i.jsxs("div",{className:"stock-search",children:[i.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:i.jsx("h3",{className:"search-title",children:"Search Stocks"})}),i.jsxs("div",{className:"search-input-container",children:[i.jsx(As,{className:"search-icon",size:18}),i.jsx("input",{ref:y,type:"text",placeholder:"Search stocks...",value:a,onChange:P=>o(P.target.value)}),a&&i.jsx("button",{className:"clear-search-btn",onClick:()=>{o(""),c([])},children:i.jsx(We,{size:16})}),h&&i.jsx("div",{className:"search-loading",children:i.jsx("div",{className:"loading-spinner"})})]}),i.jsxs(Se,{children:[l.length>0&&i.jsxs(F.div,{className:"search-results",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:[i.jsx("div",{className:"results-header",children:"Search Results"}),l.map((P,L)=>{var M,O;return i.jsxs(F.div,{className:"search-result-item",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:L*.05},onClick:()=>I(P),children:[i.jsxs("div",{className:"search-result-left",children:[i.jsx("div",{className:"symbol",children:P.symbol}),i.jsx("div",{className:"name",children:P.name})]}),i.jsxs("div",{className:"search-result-right",children:[i.jsx("div",{className:"search-result-price",children:Re(P.price)}),i.jsxs("div",{className:`search-result-change ${P.change>=0?"positive":"negative"}`,children:[P.change>=0?"+":"",(M=P.change)==null?void 0:M.toFixed(2),"(",(O=P.changePercent)==null?void 0:O.toFixed(2),"%)"]})]}),i.jsx("div",{className:"search-result-actions",onClick:B=>{B.stopPropagation();const R={...P,isWatchlisted:!P.isWatchlisted};c(A=>A.map(V=>V.symbol===P.symbol?R:V))},children:P.isWatchlisted?"⭐":"☆"}),P.exchange&&i.jsx("div",{className:"exchange",children:P.exchange})]},P.symbol)})]}),S&&S.trim().length>=2&&l.length===0&&!h&&i.jsx(F.div,{className:"search-results",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:i.jsxs("div",{className:"no-results",children:[i.jsx(As,{size:24}),i.jsxs("p",{children:['No stocks found for "',S,'"']}),i.jsx("small",{children:"Try searching with different keywords or stock symbols"})]})})]})]}),i.jsxs("div",{className:"popular-stocks-section",children:[i.jsx("div",{className:"popular-stocks-header",children:i.jsx("h3",{className:"popular-stocks-title",children:"Popular Stocks"})}),i.jsx("div",{className:"popular-stocks-list",children:i.jsx(Se,{children:T.map((P,L)=>{var M,O;return i.jsxs(F.div,{className:`popular-stock-item ${(e==null?void 0:e.symbol)===P.symbol?"selected":""}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,delay:L*.05},onClick:()=>I(P),whileHover:{scale:1.02},whileTap:{scale:.98},children:[i.jsxs("div",{className:"popular-stock-info",children:[i.jsx("div",{className:"popular-stock-symbol",children:P.symbol}),i.jsx("div",{className:"popular-stock-name",children:P.name})]}),i.jsxs("div",{className:"popular-stock-price",children:[i.jsx("div",{className:"popular-stock-value",children:Re(P.price)}),i.jsxs("div",{className:`popular-stock-change ${P.change>=0?"positive":"negative"}`,children:[P.change>=0?"+":"",(M=P.change)==null?void 0:M.toFixed(2),"(",(O=P.changePercent)==null?void 0:O.toFixed(2),"%)"]})]}),i.jsx("div",{className:"popular-stock-actions",onClick:B=>{B.stopPropagation();const R=k.map(A=>A.symbol===P.symbol?{...A,isWatchlisted:!A.isWatchlisted}:A);C(R),r==null||r(R)},children:P.isWatchlisted?"⭐":"☆"})]},P.symbol)})})})]})]})},bx=({user:s,theme:e})=>{const{isCollapsed:t}=Yy(),[n,r]=v.useState("RELIANCE"),[a,o]=v.useState("1D"),[l,c]=v.useState("candlestick"),[h,d]=v.useState(!1),[m,x]=v.useState([]),[b,p]=v.useState([]),[g,f]=v.useState(null),[y,S]=v.useState(!1),[k,C]=v.useState(null),[N,T]=v.useState(!0),[I,P]=v.useState(null),[L,M]=v.useState(null),[O,B]=v.useState(null),[R,A]=v.useState(null),{query:V,setQuery:z,results:q,loading:Y,recentSearches:te,clearSearch:ne}=Ya({limit:10,debounceMs:300});console.log("🔍 Charts - Search Query:",V),console.log("📊 Charts - Search Results:",q),console.log("⏳ Charts - Is Searching:",Y);const re=ee=>ee.replace(/\.(NS|BO)$/,""),oe=["1D","5D","1M","3M","6M","1Y","5Y"],ie=[{id:"candlestick",name:"Candlestick",icon:rt},{id:"line",name:"Line",icon:vt},{id:"area",name:"Area",icon:Cf}],D=[{id:"sma",name:"SMA (20)",color:"#3B82F6"},{id:"ema",name:"EMA (12)",color:"#10B981"},{id:"rsi",name:"RSI (14)",color:"#F59E0B"},{id:"macd",name:"MACD",color:"#EF4444"},{id:"bollinger",name:"Bollinger Bands",color:"#8B5CF6"}],$=ee=>{if(!ee||ee.length===0)return[];const de=ee.map(ue=>({time:ue.date||ue.time,open:parseFloat(ue.open),high:parseFloat(ue.high),low:parseFloat(ue.low),close:parseFloat(ue.close),volume:parseInt(ue.volume||0)})),ke=[],Oe=new Set;return de.sort((ue,Fe)=>new Date(ue.time)-new Date(Fe.time)).forEach(ue=>{Oe.has(ue.time)||(Oe.add(ue.time),ke.push(ue))}),ke},U=async(ee,de)=>{S(!0),C(null);try{console.log(`📊 Fetching chart data for ${ee} (${de})`);const ke=re(ee);console.log(`🔄 Using API symbol: ${ke}`);const Oe=await jr.chart.getHistoricalData(ke,de);if(console.log("📈 Historical response:",Oe),Oe&&Oe.success&&Oe.data&&Oe.data.length>0){const ue=$(Oe.data);p(ue),console.log(`✅ Chart data loaded: ${ue.length} points`)}else{console.warn("⚠️ Using mock chart data for",ee);const ue=X(ee,de);p(ue)}try{const ue=await jr.stock.getStockQuote(ke);ue.success&&(f(ue.data),console.log(`✅ Stock info loaded for ${ee}`))}catch{console.warn("⚠️ Quote fetch failed, using default stock info");const Fe={symbol:"RELIANCE",name:"Reliance Industries Ltd",price:2847.5,change:15.25,changePercent:.54};Fe&&f({symbol:Fe.symbol,name:Fe.name,price:Fe.price,change:Fe.change,changesPercentage:Fe.changePercent})}}catch(ke){console.error("❌ Error fetching chart data:",ke),console.log("🎭 Using mock data as fallback");const Oe=X(ee,de);p(Oe);const ue={symbol:"RELIANCE",name:"Reliance Industries Ltd",price:2847.5,change:15.25,changePercent:.54};ue&&f({symbol:ue.symbol,name:ue.name,price:ue.price,change:ue.change,changesPercentage:ue.changePercent})}finally{S(!1)}},X=(ee,de)=>{const Oe=de==="1D"?100:de==="5D"?500:1e3,ue=[];let Fe=1e3;const pt=new Date;for(let Kt=Oe;Kt>=0;Kt--){const Te=new Date(pt.getTime()-Kt*(de==="1D"?3e5:864e5)),Ys=(Math.random()-.5)*.02*Fe,Jt=Fe,xt=Fe+Ys,Ii=Math.max(Jt,xt)+Math.random()*.01*Fe,Ps=Math.min(Jt,xt)-Math.random()*.01*Fe;ue.push({time:Te.toISOString().split("T")[0],open:parseFloat(Jt.toFixed(2)),high:parseFloat(Ii.toFixed(2)),low:parseFloat(Ps.toFixed(2)),close:parseFloat(xt.toFixed(2)),volume:Math.floor(Math.random()*1e6)+1e5}),Fe=xt}return ue},ce=async ee=>{try{console.log(`📈 Fetching live quote for ${ee}`);const de=await jr.stock.getStockQuote(ee);if(de.success&&de.data){const ke=de.data.price,Oe=L;if(M(ke),f(de.data),P(new Date),Oe&&ke!==Oe&&(B({direction:ke>Oe?"up":"down",amount:ke-Oe,timestamp:Date.now()}),a==="1D"&&b.length>0)){const ue={...b[b.length-1]},Fe={...ue,close:ke,high:Math.max(ue.high,ke),low:Math.min(ue.low,ke),time:new Date().toISOString()};p(pt=>[...pt.slice(0,-1),Fe])}return console.log(`✅ Live price updated: ₹${ke}`),de.data}}catch(de){console.warn("⚠️ Failed to fetch live quote:",de.message)}return null},ye=async()=>{d(!0),await U(n,a),d(!1)},pe=async ee=>{console.log("🎯 Stock selected:",ee);const de=ee.replace(/\.(NS|BO)$/,"");console.log("🔄 Clean symbol:",de),r(de),await U(de,a)},Ae=async ee=>{o(ee),await U(n,ee)},le=ee=>{x(de=>de.includes(ee)?de.filter(ke=>ke!==ee):[...de,ee])},[Qe,Cs]=v.useState([{symbol:"RELIANCE",name:"Reliance Industries Ltd",price:2847.5,change:15.25,changePercent:.54,isWatchlisted:!1},{symbol:"TCS",name:"Tata Consultancy Services",price:4125.8,change:-12.4,changePercent:-.3,isWatchlisted:!0},{symbol:"HDFCBANK",name:"HDFC Bank Limited",price:1687.9,change:8.75,changePercent:.52,isWatchlisted:!1},{symbol:"INFY",name:"Infosys Limited",price:1842.35,change:22.15,changePercent:1.22,isWatchlisted:!1},{symbol:"HINDUNILVR",name:"Hindustan Unilever Ltd",price:2456.7,change:-5.3,changePercent:-.22,isWatchlisted:!0},{symbol:"ICICIBANK",name:"ICICI Bank Limited",price:1287.45,change:18.9,changePercent:1.49,isWatchlisted:!1}]),Qt=ee=>{Cs(ee)},Xe=Qe.find(ee=>ee.symbol===n)||Qe[0]||{symbol:"RELIANCE",name:"Reliance Industries Ltd",price:2847.5,change:15.25,changePercent:.54,isWatchlisted:!1};return v.useEffect(()=>{const ee=re(n);if(U(ee,a),N){const de=setInterval(()=>{if(!h){const ke=re(n);ce(ke)}},3e4);return A(de),()=>{de&&clearInterval(de)}}},[]),v.useEffect(()=>{const ee=re(n);U(ee,a),M(null),B(null)},[n,a]),v.useEffect(()=>{if(N&&!R){const ee=setInterval(()=>{if(!h){const de=re(n);ce(de)}},3e4);A(ee)}else!N&&R&&(clearInterval(R),A(null));return()=>{R&&clearInterval(R)}},[N,n,h]),v.useEffect(()=>()=>{R&&clearInterval(R)},[]),i.jsx("div",{className:`charts-page ${t?"sidebar-collapsed":"sidebar-expanded"}`,children:i.jsxs("div",{className:"charts-container",children:[i.jsxs(F.div,{className:"charts-header",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[i.jsxs("div",{className:"header-left",children:[i.jsxs("div",{className:"page-title",children:[i.jsx(rt,{size:24}),i.jsx("h1",{children:"Charts"})]}),i.jsxs("div",{className:"stock-info",children:[i.jsx("h2",{children:Xe.name}),i.jsxs("span",{className:"symbol",children:["(",Xe.symbol,")"]}),i.jsx(ys,{price:Xe.price,change:Xe.change,changePercent:Xe.changePercent}),i.jsx("div",{className:"stock-actions-row",children:i.jsx("button",{className:"watchlist-btn",title:Xe.isWatchlisted?"Remove from Watchlist":"Add to Watchlist",onClick:()=>{const ee={...Xe,isWatchlisted:!Xe.isWatchlisted};Qt(Qe.map(de=>de.symbol===Xe.symbol?ee:de))},children:Xe.isWatchlisted?"⭐ Remove":"☆ Add to Watchlist"})})]})]}),i.jsx("div",{className:"header-actions",children:i.jsxs("button",{className:"btn-premium btn-secondary",onClick:ye,disabled:h,children:[i.jsx(Ue,{size:16,className:h?"animate-spin":""}),"Refresh"]})})]}),i.jsxs("div",{className:"charts-content",children:[i.jsxs(F.div,{className:"charts-sidebar",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},children:[i.jsx(nd,{onStockSelect:ee=>{console.log("🎯 Selected stock from panel:",ee),pe(ee.symbol||ee)},selectedStock:{symbol:n},className:"charts-stock-search",popularStocks:Qe,onUpdatePopularStocks:Qt}),i.jsxs("div",{className:"sidebar-section",children:[i.jsx("h3",{children:"Timeframe"}),i.jsx("div",{className:"timeframe-buttons",children:oe.map(ee=>i.jsx("button",{className:`timeframe-btn ${a===ee?"active":""}`,onClick:()=>Ae(ee),children:ee},ee))})]}),i.jsxs("div",{className:"sidebar-section",children:[i.jsx("h3",{children:"Chart Type"}),i.jsx("div",{className:"chart-type-buttons",children:ie.map(ee=>i.jsxs("button",{className:`chart-type-btn ${l===ee.id?"active":""}`,onClick:()=>c(ee.id),children:[i.jsx(ee.icon,{size:16}),ee.name]},ee.id))})]}),i.jsxs("div",{className:"sidebar-section",children:[i.jsx("h3",{children:"Technical Indicators"}),i.jsx("div",{className:"indicators-list",children:D.map(ee=>i.jsxs("div",{className:`indicator-item ${m.includes(ee.id)?"active":""}`,onClick:()=>le(ee.id),children:[i.jsx("div",{className:"indicator-color",style:{backgroundColor:ee.color}}),i.jsx("span",{children:ee.name})]},ee.id))})]})]}),i.jsxs(F.div,{className:"chart-main",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.6,delay:.2},children:[i.jsx(vx,{data:b,symbol:n,timeframe:a,chartType:l,theme:e,onRefresh:ye,loading:y,height:600}),i.jsxs("div",{className:"chart-footer",children:[i.jsxs("div",{className:"footer-left",children:[i.jsxs("div",{className:"volume-info",children:[i.jsx($c,{size:16}),i.jsxs("span",{children:["Volume: ",g!=null&&g.volume?g.volume.toLocaleString():"N/A"]})]}),i.jsxs("div",{className:"market-cap-info",children:[i.jsx(pi,{size:16}),i.jsxs("span",{children:["Market Cap: ",g!=null&&g.marketCap?"₹"+(g.marketCap/1e7).toFixed(1)+" Cr":"N/A"]})]})]}),i.jsx("div",{className:"footer-right",children:i.jsxs("div",{className:"last-updated",children:[i.jsx(st,{size:16}),i.jsxs("span",{children:["Last updated: ",g!=null&&g.timestamp?new Date(g.timestamp*1e3).toLocaleTimeString():"N/A"]})]})})]})]})]})]})})},wx=({user:s,theme:e})=>{const t=Ve(),{portfolioData:n}=ft(),{watchlists:r,loading:a,addToWatchlist:o,createWatchlist:l,refreshWatchlists:c}=_h(),[h,d]=v.useState("all"),[m,x]=v.useState("list"),[b,p]=v.useState("symbol"),[g,f]=v.useState("asc"),[y,S]=v.useState(""),[k,C]=v.useState(!1),[N,T]=v.useState(!1),[I,P]=v.useState(""),[L,M]=v.useState(""),[O,B]=v.useState(!1),{isOpen:R,currentStock:A,defaultQuantity:V,closeSlideToBuy:z}=Vn(),q=v.useMemo(()=>h==="all"?{name:"All Watchlists",stocks:r.reduce(($,U)=>[...$,...U.stocks||[]],[])}:r.find(D=>D._id===h)||{name:"Unknown",stocks:[]},[r,h]),Y=v.useMemo(()=>{let D=q.stocks||[];return y&&(D=D.filter($=>$.symbol.toLowerCase().includes(y.toLowerCase())||$.name.toLowerCase().includes(y.toLowerCase()))),D.sort(($,U)=>{let X=$[b],ce=U[b];return typeof X=="string"&&(X=X.toLowerCase(),ce=ce.toLowerCase()),g==="asc"?X>ce?1:-1:X<ce?1:-1})},[q.stocks,y,b,g]),te=v.useMemo(()=>{const D=q.stocks||[];return{gainers:D.filter($=>($.change||0)>0).length,losers:D.filter($=>($.change||0)<0).length,neutral:D.filter($=>($.change||0)===0).length}},[q.stocks]),ne=()=>r.reduce((D,$)=>{var U;return D+(((U=$.stocks)==null?void 0:U.length)||0)},0),re=async()=>{C(!0);try{await c(),K.success("Watchlists refreshed successfully")}catch{K.error("Failed to refresh watchlists")}finally{C(!1)}},oe=async()=>{if(I.trim()){B(!0);try{await l({name:I.trim(),description:L.trim()}),P(""),M(""),T(!1),K.success("Watchlist created successfully")}catch{K.error("Failed to create watchlist")}finally{B(!1)}}},ie=async D=>{if(h==="all"){K.warning("Please select a specific watchlist to add stocks");return}try{await o(h,D),K.success(`Added ${D} to watchlist`)}catch{K.error("Failed to add stock to watchlist")}};return v.useEffect(()=>{r.length>0&&h==="all"&&d(r[0]._id)},[r]),a?i.jsx("div",{className:"watchlist-page",children:i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Loading watchlists..."})]})}):i.jsxs("div",{className:"watchlist-page",children:[i.jsxs("div",{className:"watchlist-container",children:[i.jsxs(F.div,{className:"watchlist-header",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[i.jsxs("div",{className:"watchlist-header-top",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("div",{className:"header-icon",children:i.jsx(fs,{})}),i.jsxs("div",{className:"header-text",children:[i.jsx("h1",{children:"My Watchlists"}),i.jsx("p",{children:"Track and manage your favorite stocks"})]})]}),i.jsxs("div",{className:"header-actions",children:[i.jsxs("button",{className:`action-btn ${k?"loading":""}`,onClick:re,disabled:k,children:[i.jsx(Ue,{className:k?"spinning":""}),k?"Refreshing...":"Refresh"]}),i.jsxs("button",{className:"action-btn primary",onClick:()=>T(!0),children:[i.jsx(Ht,{}),"New Watchlist"]})]})]}),i.jsxs("div",{className:"stats-overview",children:[i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:i.jsx(rt,{})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:ne()}),i.jsx("div",{className:"stat-label",children:"Total Stocks"})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon positive",children:i.jsx(Pe,{})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:te.gainers}),i.jsx("div",{className:"stat-label",children:"Gainers"})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon negative",children:i.jsx($e,{})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:te.losers}),i.jsx("div",{className:"stat-label",children:"Losers"})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:i.jsx(Fs,{})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:r.length}),i.jsx("div",{className:"stat-label",children:"Watchlists"})]})]})]})]}),i.jsxs("div",{className:"watchlist-content",children:[i.jsxs(F.div,{className:"watchlist-sidebar",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},children:[i.jsx(nd,{onStockSelect:D=>{console.log("🎯 Selected stock from panel:",D),ie(D.symbol||D)},selectedStock:null,className:"watchlist-stock-search"}),i.jsxs("div",{className:"sidebar-section",children:[i.jsx("h3",{children:"My Watchlists"}),i.jsxs("div",{className:"watchlist-list",children:[i.jsxs("button",{className:`watchlist-tab ${h==="all"?"active":""}`,onClick:()=>d("all"),children:[i.jsx(vt,{}),"All Watchlists",i.jsx("span",{className:"tab-count",children:ne()})]}),r.map(D=>{var $;return i.jsxs("button",{className:`watchlist-tab ${h===D._id?"active":""}`,onClick:()=>d(D._id),children:[i.jsx(cs,{}),D.name,i.jsx("span",{className:"tab-count",children:(($=D.stocks)==null?void 0:$.length)||0})]},D._id)})]})]}),i.jsxs("div",{className:"sidebar-section",children:[i.jsx("h3",{children:"Quick Actions"}),i.jsxs("div",{className:"quick-actions",children:[i.jsxs("button",{className:"action-btn",onClick:()=>T(!0),children:[i.jsx(Ht,{}),"New Watchlist"]}),i.jsxs("button",{className:"action-btn",onClick:re,disabled:k,children:[i.jsx(Ue,{className:k?"spinning":""}),"Refresh Data"]})]})]})]}),i.jsxs(F.div,{className:"watchlist-main",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.6,delay:.2},children:[i.jsxs("div",{className:"watchlist-tabs",children:[i.jsxs("button",{className:`watchlist-tab ${h==="all"?"active":""}`,onClick:()=>d("all"),children:[i.jsx(vt,{}),"All Watchlists",i.jsx("span",{className:"tab-count",children:ne()})]}),r.map(D=>{var $;return i.jsxs("button",{className:`watchlist-tab ${h===D._id?"active":""}`,onClick:()=>d(D._id),children:[i.jsx(cs,{}),D.name,i.jsx("span",{className:"tab-count",children:(($=D.stocks)==null?void 0:$.length)||0})]},D._id)})]}),i.jsxs("div",{className:"main-header",children:[i.jsxs("div",{className:"main-title",children:[i.jsxs("h2",{children:[i.jsx(fs,{}),q.name]}),i.jsxs("div",{className:"main-controls",children:[i.jsxs("div",{className:"view-toggle","data-active":m,children:[i.jsxs("button",{className:m==="list"?"active":"",onClick:()=>x("list"),children:[i.jsx(_c,{}),"List"]}),i.jsxs("button",{className:m==="grid"?"active":"",onClick:()=>x("grid"),children:[i.jsx(Sf,{}),"Grid"]})]}),i.jsx("div",{className:"sort-dropdown",children:i.jsxs("button",{className:"sort-btn",children:[i.jsx(_n,{}),"Sort by ",b,i.jsx(rs,{})]})})]})]}),i.jsx("div",{className:"search-section",children:i.jsx(Ci,{value:y,onChange:S,placeholder:"Search stocks in watchlist...",className:"watchlist-search"})})]}),i.jsx("div",{className:"stocks-section",children:Y.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"empty-icon",children:i.jsx(cs,{})}),i.jsx("h3",{children:"No stocks found"}),i.jsx("p",{children:y?`No stocks found matching "${y}" in your watchlist`:q.stocks.length===0?"Start building your watchlist by adding stocks you want to track":"Use the search above to add new stocks to your watchlist"}),!y&&q.stocks.length===0&&i.jsxs("button",{className:"action-btn primary",onClick:()=>T(!0),children:[i.jsx(Ht,{}),"Add Your First Stock"]})]}):i.jsx("div",{className:"stock-list",children:Y.map((D,$)=>i.jsxs(F.div,{className:"stock-item",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:$*.03},onClick:()=>t(`/stock/${D.symbol}`),children:[i.jsxs("div",{className:"stock-info",children:[i.jsx("div",{className:"stock-symbol",children:D.symbol}),i.jsx("div",{className:"stock-name",children:D.name})]}),i.jsx("div",{className:"stock-price",children:i.jsx(ys,{symbol:D.symbol,showChange:!0,size:"medium"})}),i.jsx("div",{className:"stock-actions",children:i.jsx(Pi,{stockData:D,size:"small",variant:"simple",showText:!1,onSuccess:(U,X)=>{X==="removed"?(K.success(`Removed ${D.symbol} from watchlist`),c()):X==="added"&&(K.success(`Added ${D.symbol} to watchlist`),c())},onError:U=>{K.error(U||"Failed to update watchlist")}})})]},D.symbol))})})]})]})]}),i.jsx(Se,{children:N&&i.jsx(F.div,{className:"modal-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>T(!1),children:i.jsxs(F.div,{className:"modal-content",initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},onClick:D=>D.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Create New Watchlist"}),i.jsx("button",{className:"close-btn",onClick:()=>T(!1),children:i.jsx(We,{})})]}),i.jsx("div",{className:"modal-body",children:i.jsxs("div",{className:"form-group",children:[i.jsx("label",{htmlFor:"watchlist-name",children:"Watchlist Name"}),i.jsx("input",{id:"watchlist-name",type:"text",value:I,onChange:D=>P(D.target.value),placeholder:"Enter watchlist name...",className:"form-input",autoFocus:!0})]})}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{className:"action-btn",onClick:()=>T(!1),children:"Cancel"}),i.jsx("button",{className:"action-btn primary",onClick:oe,disabled:!I.trim()||O,children:O?i.jsxs(i.Fragment,{children:[i.jsx(Ue,{className:"spinning"}),"Creating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ht,{}),"Create Watchlist"]})})]})]})})}),i.jsx(Wn,{stockData:A,isOpen:R,onClose:z,defaultQuantity:V,onSuccess:()=>{}})]})},jx=({user:s,theme:e})=>{const[t,n]=v.useState("all"),[r,a]=v.useState("all"),[o,l]=v.useState(!1),{portfolioData:c}=ft(),{query:h,setQuery:d,results:m,recentSearches:x,showHistory:b,handleHistoryClick:p,loading:g,clearSearch:f,hasResults:y}=Fg({enableSuggestions:!1,enableHistory:!0,limit:50,debounceMs:300,filters:{status:t!=="all"?t:null,type:r!=="all"?r:null}}),S=c.transactions||[],k=[{id:"all",name:"All Orders",count:25},{id:"pending",name:"Pending",count:3},{id:"completed",name:"Completed",count:18},{id:"cancelled",name:"Cancelled",count:4}],C=[{id:"all",name:"All Types"},{id:"buy",name:"Buy Orders"},{id:"sell",name:"Sell Orders"}],N=async()=>{l(!0),await new Promise(O=>setTimeout(O,1500)),l(!1)},T=O=>{switch(O){case"completed":return i.jsx(kt,{className:"status-icon completed"});case"pending":return i.jsx(st,{className:"status-icon pending"});case"cancelled":return i.jsx(ps,{className:"status-icon cancelled"});default:return i.jsx(st,{className:"status-icon"})}},I=O=>{switch(O){case"completed":return"#10B981";case"pending":return"#F59E0B";case"cancelled":return"#EF4444";default:return"#6B7280"}},P=O=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(O),L=O=>{const B=new Date(O);return{date:B.toLocaleDateString("en-IN"),time:B.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})}},M=S.filter(O=>{const B=O.symbol.toLowerCase().includes(h.toLowerCase())||O.name.toLowerCase().includes(h.toLowerCase())||O.id.toLowerCase().includes(h.toLowerCase()),R=t==="all"||O.status===t,A=r==="all"||O.type.toLowerCase()===r;return B&&R&&A});return i.jsxs("div",{className:"orders-page",children:[i.jsx(ks,{icon:tt,title:"Orders",subtitle:"Track and manage your trading orders",borderColor:"warning",actions:[{label:"Refresh",icon:Ue,onClick:N,variant:"secondary",disabled:o},{label:"Export",icon:wf,onClick:()=>{},variant:"outline"}]}),i.jsxs("div",{className:"orders-container",children:[i.jsxs(F.div,{className:"orders-controls",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:[i.jsxs("div",{className:"controls-left",children:[i.jsx("div",{className:"search-container",children:i.jsx(Ci,{placeholder:"Search orders by stock symbol...",value:h,onChange:d,onClear:f,recentSearches:x,onHistoryClick:p,showHistory:b,loading:g,size:"md",showSuggestions:!1,enableHistory:!0,className:"orders-search-input"})}),i.jsxs("div",{className:"filter-group",children:[i.jsx("select",{value:t,onChange:O=>n(O.target.value),className:"filter-select",children:k.map(O=>i.jsxs("option",{value:O.id,children:[O.name," (",O.count,")"]},O.id))}),i.jsx("select",{value:r,onChange:O=>a(O.target.value),className:"filter-select",children:C.map(O=>i.jsx("option",{value:O.id,children:O.name},O.id))})]})]}),i.jsx("div",{className:"controls-right",children:i.jsxs("button",{className:"btn-premium btn-ghost",children:[i.jsx(_n,{size:16}),"More Filters"]})})]}),i.jsxs(F.div,{className:"orders-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{className:"card-title",children:[i.jsx(tt,{className:"card-icon"}),"Order History (",M.length,")"]})}),i.jsx("div",{className:"card-content",children:i.jsxs("div",{className:"orders-table",children:[i.jsxs("div",{className:"table-header",children:[i.jsx("div",{className:"col-order",children:"Order Details"}),i.jsx("div",{className:"col-type",children:"Type"}),i.jsx("div",{className:"col-quantity",children:"Quantity"}),i.jsx("div",{className:"col-price",children:"Price"}),i.jsx("div",{className:"col-total",children:"Total"}),i.jsx("div",{className:"col-status",children:"Status"}),i.jsx("div",{className:"col-time",children:"Time"}),i.jsx("div",{className:"col-actions",children:"Actions"})]}),i.jsx("div",{className:"table-body",children:M.map((O,B)=>{const R=L(O.timestamp);return i.jsxs(F.div,{className:"table-row",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:B*.05},children:[i.jsx("div",{className:"col-order",children:i.jsxs("div",{className:"order-info",children:[i.jsxs("div",{className:"order-id",children:["#",O.id]}),i.jsx("div",{className:"stock-symbol",children:O.symbol}),i.jsx("div",{className:"stock-name",children:O.name})]})}),i.jsxs("div",{className:"col-type",children:[i.jsxs("div",{className:`order-type ${O.type.toLowerCase()}`,children:[O.type==="BUY"?i.jsx(Pe,{size:14}):i.jsx($e,{size:14}),O.type]}),i.jsx("div",{className:"order-subtype",children:O.orderType})]}),i.jsx("div",{className:"col-quantity",children:O.quantity}),i.jsx("div",{className:"col-price",children:i.jsxs("div",{className:"price-info",children:[i.jsx("div",{className:"order-price",children:P(O.price)}),O.executedPrice&&O.executedPrice!==O.price&&i.jsxs("div",{className:"executed-price",children:["Exec: ",P(O.executedPrice)]})]})}),i.jsxs("div",{className:"col-total",children:[i.jsx("div",{className:"total-amount",children:P(O.total)}),O.fees>0&&i.jsxs("div",{className:"fees",children:["Fees: ",P(O.fees)]})]}),i.jsx("div",{className:"col-status",children:i.jsxs("div",{className:"status-container",children:[T(O.status),i.jsx("span",{className:`status-text ${O.status}`,style:{color:I(O.status)},children:O.status.charAt(0).toUpperCase()+O.status.slice(1)})]})}),i.jsx("div",{className:"col-time",children:i.jsxs("div",{className:"time-info",children:[i.jsx("div",{className:"order-date",children:R.date}),i.jsx("div",{className:"order-time",children:R.time})]})}),i.jsx("div",{className:"col-actions",children:i.jsxs("div",{className:"action-buttons",children:[O.status==="pending"&&i.jsx("button",{className:"action-btn",title:"Edit Order",children:i.jsx(Ic,{size:14})}),O.status==="pending"&&i.jsx("button",{className:"action-btn cancel",title:"Cancel Order",children:i.jsx(ps,{size:14})}),i.jsx("button",{className:"action-btn",title:"More Options",children:i.jsx(Tf,{size:14})})]})})]},O.id)})})]})})]})]})]})},Sx=({user:s,theme:e})=>{var q;const t=Ve(),{portfolioData:n,getTransactionHistory:r}=ft(),[a,o]=v.useState([]),[l,c]=v.useState(!0),[h,d]=v.useState(""),[m,x]=v.useState("all"),[b,p]=v.useState("all"),[g,f]=v.useState("all"),[y,S]=v.useState("date"),[k,C]=v.useState("desc"),[N,T]=v.useState(null),[I,P]=v.useState(!1),[L,M]=v.useState(!1),O=[{id:"txn_001",type:"buy",symbol:"RELIANCE",name:"Reliance Industries Ltd",quantity:10,price:2847.65,totalAmount:28476.5,fees:14.24,netAmount:28490.74,status:"completed",timestamp:new Date("2024-01-15T10:30:00"),orderId:"ORD_001",exchange:"NSE",sector:"Energy"},{id:"txn_002",type:"sell",symbol:"TCS",name:"Tata Consultancy Services",quantity:5,price:3892.4,totalAmount:19462,fees:9.73,netAmount:19452.27,status:"completed",timestamp:new Date("2024-01-14T14:45:00"),orderId:"ORD_002",exchange:"NSE",sector:"IT",gainLoss:1847.3,gainLossPercent:10.5},{id:"txn_003",type:"buy",symbol:"HDFC",name:"HDFC Bank Ltd",quantity:15,price:1734.85,totalAmount:26022.75,fees:13.01,netAmount:26035.76,status:"pending",timestamp:new Date("2024-01-13T09:15:00"),orderId:"ORD_003",exchange:"NSE",sector:"Banking"},{id:"txn_004",type:"buy",symbol:"INFY",name:"Infosys Ltd",quantity:8,price:1456.2,totalAmount:11649.6,fees:5.82,netAmount:11655.42,status:"completed",timestamp:new Date("2024-01-12T11:20:00"),orderId:"ORD_004",exchange:"NSE",sector:"IT"},{id:"txn_005",type:"sell",symbol:"WIPRO",name:"Wipro Ltd",quantity:20,price:432.85,totalAmount:8657,fees:4.33,netAmount:8652.67,status:"failed",timestamp:new Date("2024-01-11T16:30:00"),orderId:"ORD_005",exchange:"NSE",sector:"IT",gainLoss:-245.8,gainLossPercent:-2.8,failureReason:"Insufficient shares"}];v.useEffect(()=>{(async()=>{c(!0);try{setTimeout(()=>{o(O),c(!1)},1e3)}catch(te){console.error("Error loading transaction history:",te),K.error("Failed to load transaction history"),c(!1)}})()},[]);const B=v.useMemo(()=>{let Y=[...a];if(h&&(Y=Y.filter(te=>te.symbol.toLowerCase().includes(h.toLowerCase())||te.name.toLowerCase().includes(h.toLowerCase())||te.orderId.toLowerCase().includes(h.toLowerCase()))),m!=="all"&&(Y=Y.filter(te=>te.type===m)),b!=="all"&&(Y=Y.filter(te=>te.status===b)),g!=="all"){const te=new Date,ne=new Date;switch(g){case"today":ne.setHours(0,0,0,0);break;case"week":ne.setDate(te.getDate()-7);break;case"month":ne.setMonth(te.getMonth()-1);break;case"year":ne.setFullYear(te.getFullYear()-1);break}Y=Y.filter(re=>re.timestamp>=ne)}return Y.sort((te,ne)=>{let re,oe;switch(y){case"date":re=te.timestamp,oe=ne.timestamp;break;case"symbol":re=te.symbol,oe=ne.symbol;break;case"amount":re=te.totalAmount,oe=ne.totalAmount;break;case"quantity":re=te.quantity,oe=ne.quantity;break;case"status":re=te.status,oe=ne.status;break;default:re=te.timestamp,oe=ne.timestamp}return re instanceof Date&&oe instanceof Date?k==="asc"?re-oe:oe-re:typeof re=="string"?k==="asc"?re.localeCompare(oe):oe.localeCompare(re):k==="asc"?re-oe:oe-re}),Y},[a,h,m,b,g,y,k]),R=v.useMemo(()=>{const Y=B.length,te=B.filter(U=>U.status==="completed"),ne=te.filter(U=>U.type==="buy"),re=te.filter(U=>U.type==="sell"),oe=ne.reduce((U,X)=>U+X.totalAmount,0),ie=re.reduce((U,X)=>U+X.totalAmount,0),D=te.reduce((U,X)=>U+(X.fees||0),0),$=re.reduce((U,X)=>U+(X.gainLoss||0),0);return{totalTransactions:Y,completedTransactions:te.length,buyTransactions:ne.length,sellTransactions:re.length,totalBuyAmount:oe,totalSellAmount:ie,totalFees:D,totalGainLoss:$,successRate:Y>0?te.length/Y*100:0}},[B]),A=Y=>{y===Y?C(k==="asc"?"desc":"asc"):(S(Y),C("desc"))},V=Y=>{switch(Y){case"completed":return i.jsx(kt,{className:"status-icon completed"});case"pending":return i.jsx(et,{className:"status-icon pending"});case"failed":return i.jsx(ps,{className:"status-icon failed"});default:return i.jsx(st,{className:"status-icon"})}},z=Y=>Y==="buy"?i.jsx(Pe,{className:"type-icon buy"}):i.jsx($e,{className:"type-icon sell"});return l?i.jsx("div",{className:"history-page",children:i.jsx("div",{className:"history-container",children:i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Loading transaction history..."})]})})}):i.jsxs("div",{className:"history-page",children:[i.jsxs("div",{className:"history-header",children:[i.jsxs("div",{className:"header-content",children:[i.jsxs("div",{className:"header-left",children:[i.jsx("div",{className:"header-icon",children:i.jsx(st,{})}),i.jsxs("div",{className:"header-text",children:[i.jsx("h1",{children:"Transaction History"}),i.jsx("p",{children:"Track all your trading activities and portfolio changes"})]})]}),i.jsx("div",{className:"header-actions",children:i.jsxs("button",{className:`action-btn ${I?"active":""}`,onClick:()=>P(!I),children:[i.jsx(_n,{}),"Filters"]})})]}),i.jsxs("div",{className:"stats-overview",children:[i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:i.jsx(vt,{})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:R.totalTransactions}),i.jsx("div",{className:"stat-label",children:"Total Transactions"})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon positive",children:i.jsx(Pe,{})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:Ee(R.totalBuyAmount)}),i.jsx("div",{className:"stat-label",children:"Total Invested"})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon negative",children:i.jsx($e,{})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:Ee(R.totalSellAmount)}),i.jsx("div",{className:"stat-label",children:"Total Sold"})]})]}),i.jsxs("div",{className:"stat-card",children:[i.jsx("div",{className:"stat-icon",children:i.jsx(pi,{})}),i.jsxs("div",{className:"stat-content",children:[i.jsxs("div",{className:"stat-value",children:[R.successRate.toFixed(1),"%"]}),i.jsx("div",{className:"stat-label",children:"Success Rate"})]})]})]})]}),i.jsxs("div",{className:"history-container",children:[i.jsx(Se,{children:I&&i.jsx(F.div,{className:"filters-panel",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:i.jsxs("div",{className:"filters-content",children:[i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Search"}),i.jsxs("div",{className:"search-wrapper",children:[i.jsx(As,{className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Search by symbol, name, or order ID...",value:h,onChange:Y=>d(Y.target.value),className:"search-input"}),h&&i.jsx("button",{className:"clear-search",onClick:()=>d(""),children:i.jsx(We,{})})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Transaction Type"}),i.jsxs("select",{value:m,onChange:Y=>x(Y.target.value),className:"filter-select",children:[i.jsx("option",{value:"all",children:"All Types"}),i.jsx("option",{value:"buy",children:"Buy Orders"}),i.jsx("option",{value:"sell",children:"Sell Orders"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Status"}),i.jsxs("select",{value:b,onChange:Y=>p(Y.target.value),className:"filter-select",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"completed",children:"Completed"}),i.jsx("option",{value:"pending",children:"Pending"}),i.jsx("option",{value:"failed",children:"Failed"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Date Range"}),i.jsxs("select",{value:g,onChange:Y=>f(Y.target.value),className:"filter-select",children:[i.jsx("option",{value:"all",children:"All Time"}),i.jsx("option",{value:"today",children:"Today"}),i.jsx("option",{value:"week",children:"Last 7 Days"}),i.jsx("option",{value:"month",children:"Last Month"}),i.jsx("option",{value:"year",children:"Last Year"})]})]}),i.jsx("div",{className:"filter-actions",children:i.jsx("button",{className:"clear-filters-btn",onClick:()=>{d(""),x("all"),p("all"),f("all")},children:"Clear All"})})]})})}),i.jsx("div",{className:"transactions-section",children:B.length===0?i.jsxs("div",{className:"empty-state",children:[i.jsx("div",{className:"empty-icon",children:i.jsx(st,{})}),i.jsx("h3",{children:"No transactions found"}),i.jsx("p",{children:h||m!=="all"||b!=="all"||g!=="all"?"No transactions match your current filters":"Start trading to see your transaction history here"}),(h||m!=="all"||b!=="all"||g!=="all")&&i.jsx("button",{className:"clear-filters-btn",onClick:()=>{d(""),x("all"),p("all"),f("all")},children:"Clear Filters"})]}):i.jsxs("div",{className:"transactions-table",children:[i.jsx("div",{className:"table-header",children:i.jsxs("div",{className:"table-row header",children:[i.jsxs("div",{className:"col-date sortable",onClick:()=>A("date"),children:["Date & Time",y==="date"&&(k==="asc"?i.jsx(Is,{}):i.jsx(rs,{}))]}),i.jsxs("div",{className:"col-stock sortable",onClick:()=>A("symbol"),children:["Stock",y==="symbol"&&(k==="asc"?i.jsx(Is,{}):i.jsx(rs,{}))]}),i.jsx("div",{className:"col-type",children:"Type"}),i.jsxs("div",{className:"col-quantity sortable",onClick:()=>A("quantity"),children:["Quantity",y==="quantity"&&(k==="asc"?i.jsx(Is,{}):i.jsx(rs,{}))]}),i.jsx("div",{className:"col-price",children:"Price"}),i.jsxs("div",{className:"col-amount sortable",onClick:()=>A("amount"),children:["Total Amount",y==="amount"&&(k==="asc"?i.jsx(Is,{}):i.jsx(rs,{}))]}),i.jsx("div",{className:"col-gain-loss",children:"Gain/Loss"}),i.jsxs("div",{className:"col-status sortable",onClick:()=>A("status"),children:["Status",y==="status"&&(k==="asc"?i.jsx(Is,{}):i.jsx(rs,{}))]}),i.jsx("div",{className:"col-actions",children:"Actions"})]})}),i.jsx("div",{className:"table-body",children:B.map((Y,te)=>{var ne;return i.jsxs(F.div,{className:"table-row clickable",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:te*.05},onClick:()=>T(Y),children:[i.jsx("div",{className:"col-date",children:i.jsxs("div",{className:"date-info",children:[i.jsx("span",{className:"date",children:Nr(Y.timestamp,"MMM DD, YYYY")}),i.jsx("span",{className:"time",children:Nr(Y.timestamp,"HH:mm")})]})}),i.jsx("div",{className:"col-stock",children:i.jsxs("div",{className:"stock-info",children:[i.jsx("span",{className:"symbol",children:Y.symbol}),i.jsx("span",{className:"name",children:Y.name}),i.jsx("span",{className:"exchange",children:Y.exchange})]})}),i.jsx("div",{className:"col-type",children:i.jsxs("div",{className:`type-badge ${Y.type}`,children:[z(Y.type),i.jsx("span",{children:Y.type.toUpperCase()})]})}),i.jsx("div",{className:"col-quantity",children:i.jsx("span",{className:"quantity",children:ba(Y.quantity)})}),i.jsx("div",{className:"col-price",children:i.jsx("span",{className:"price",children:Ee(Y.price)})}),i.jsx("div",{className:"col-amount",children:i.jsxs("div",{className:"amount-info",children:[i.jsx("span",{className:"total",children:Ee(Y.totalAmount)}),i.jsxs("span",{className:"fees",children:["Fees: ",Ee(Y.fees||0)]})]})}),i.jsx("div",{className:"col-gain-loss",children:Y.gainLoss!==void 0?i.jsxs("div",{className:`gain-loss ${Y.gainLoss>=0?"positive":"negative"}`,children:[i.jsxs("span",{className:"amount",children:[Y.gainLoss>=0?"+":"",Ee(Y.gainLoss)]}),i.jsxs("span",{className:"percent",children:["(",Y.gainLoss>=0?"+":"",(ne=Y.gainLossPercent)==null?void 0:ne.toFixed(2),"%)"]})]}):i.jsx("span",{className:"no-data",children:"-"})}),i.jsx("div",{className:"col-status",children:i.jsxs("div",{className:`status-badge ${Y.status}`,children:[V(Y.status),i.jsx("span",{children:Y.status})]})}),i.jsx("div",{className:"col-actions",children:i.jsx("button",{className:"action-btn-small",onClick:re=>{re.stopPropagation(),T(Y)},title:"View Details",children:i.jsx(fs,{})})})]},Y.id)})})]})})]}),i.jsx(Se,{children:N&&i.jsx(F.div,{className:"modal-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>T(null),children:i.jsxs(F.div,{className:"modal-content transaction-detail-modal",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:Y=>Y.stopPropagation(),children:[i.jsxs("div",{className:"modal-header",children:[i.jsx("h3",{children:"Transaction Details"}),i.jsx("button",{className:"modal-close",onClick:()=>T(null),children:i.jsx(We,{})})]}),i.jsx("div",{className:"modal-body",children:i.jsxs("div",{className:"transaction-details",children:[i.jsxs("div",{className:"detail-section",children:[i.jsx("h4",{children:"Basic Information"}),i.jsxs("div",{className:"detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Transaction ID"}),i.jsx("span",{children:N.id})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Order ID"}),i.jsx("span",{children:N.orderId})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Date & Time"}),i.jsx("span",{children:Nr(N.timestamp,"MMM DD, YYYY HH:mm:ss")})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Status"}),i.jsxs("div",{className:`status-badge ${N.status}`,children:[V(N.status),i.jsx("span",{children:N.status})]})]})]})]}),i.jsxs("div",{className:"detail-section",children:[i.jsx("h4",{children:"Stock Information"}),i.jsxs("div",{className:"detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Symbol"}),i.jsx("span",{children:N.symbol})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Company Name"}),i.jsx("span",{children:N.name})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Exchange"}),i.jsx("span",{children:N.exchange})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Sector"}),i.jsx("span",{children:N.sector})]})]})]}),i.jsxs("div",{className:"detail-section",children:[i.jsx("h4",{children:"Transaction Details"}),i.jsxs("div",{className:"detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Type"}),i.jsxs("div",{className:`type-badge ${N.type}`,children:[z(N.type),i.jsx("span",{children:N.type.toUpperCase()})]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Quantity"}),i.jsxs("span",{children:[ba(N.quantity)," shares"]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Price per Share"}),i.jsx("span",{children:Ee(N.price)})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Total Amount"}),i.jsx("span",{children:Ee(N.totalAmount)})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Fees & Charges"}),i.jsx("span",{children:Ee(N.fees||0)})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Net Amount"}),i.jsx("span",{className:"net-amount",children:Ee(N.netAmount)})]})]})]}),N.gainLoss!==void 0&&i.jsxs("div",{className:"detail-section",children:[i.jsx("h4",{children:"Performance"}),i.jsxs("div",{className:"detail-grid",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Gain/Loss Amount"}),i.jsxs("span",{className:`gain-loss ${N.gainLoss>=0?"positive":"negative"}`,children:[N.gainLoss>=0?"+":"",Ee(N.gainLoss)]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("label",{children:"Gain/Loss Percentage"}),i.jsxs("span",{className:`gain-loss ${N.gainLoss>=0?"positive":"negative"}`,children:[N.gainLoss>=0?"+":"",(q=N.gainLossPercent)==null?void 0:q.toFixed(2),"%"]})]})]})]}),N.status==="failed"&&N.failureReason&&i.jsxs("div",{className:"detail-section",children:[i.jsx("h4",{children:"Failure Information"}),i.jsxs("div",{className:"failure-reason",children:[i.jsx(ps,{className:"failure-icon"}),i.jsx("span",{children:N.failureReason})]})]})]})}),i.jsxs("div",{className:"modal-footer",children:[i.jsx("button",{className:"btn secondary",onClick:()=>T(null),children:"Close"}),i.jsx("button",{className:"btn primary",onClick:()=>t(`/stock/${N.symbol}`),children:"View Stock"})]})]})})})]})},Nx=({user:s,theme:e})=>{const[t,n]=v.useState("all"),[r,a]=v.useState(!1),[o,l]=v.useState([]),{query:c,setQuery:h,results:d,recentSearches:m,showHistory:x,handleHistoryClick:b,loading:p,clearSearch:g,hasResults:f}=wh({enableSuggestions:!1,enableHistory:!0,limit:30,debounceMs:500}),y=[{id:"all",name:"All News",count:45},{id:"market",name:"Market",count:12},{id:"stocks",name:"Stocks",count:8},{id:"economy",name:"Economy",count:10},{id:"policy",name:"Policy",count:6},{id:"earnings",name:"Earnings",count:9}],S=[{id:1,title:"Sensex Surges 500 Points as Banking Stocks Rally on RBI Policy Optimism",summary:"Indian benchmark indices closed higher on Tuesday as banking and financial stocks led the rally following positive sentiment around the upcoming RBI monetary policy meeting.",content:"The BSE Sensex gained 501.92 points to close at 65,953.48, while the NSE Nifty 50 advanced 145.30 points to end at 19,674.25. Banking stocks were the top performers with HDFC Bank, ICICI Bank, and Kotak Mahindra Bank leading the gains.",category:"market",source:"Economic Times",author:"Rajesh Kumar",publishedAt:"2024-01-15T10:30:00Z",imageUrl:"https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3?w=400",readTime:"3 min read",tags:["Sensex","Banking","RBI","Market Rally"],isBookmarked:!1},{id:2,title:"Reliance Industries Reports Strong Q3 Results, Beats Estimates",summary:"Reliance Industries Ltd reported better-than-expected quarterly results driven by strong performance in its retail and digital services segments.",content:"The oil-to-telecom conglomerate posted a net profit of ₹18,549 crore for the quarter ended December 2023, up 8.5% year-on-year. Revenue from operations increased to ₹2.35 lakh crore.",category:"earnings",source:"Business Standard",author:"Priya Sharma",publishedAt:"2024-01-15T09:15:00Z",imageUrl:"https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=400",readTime:"4 min read",tags:["Reliance","Earnings","Q3 Results"],isBookmarked:!0},{id:3,title:"IT Stocks Under Pressure as US Fed Signals Hawkish Stance",summary:"Indian IT stocks declined in early trade as the US Federal Reserve indicated a more aggressive approach to interest rate hikes.",content:"TCS, Infosys, and Wipro were among the top losers as investors worried about the impact of higher interest rates on IT spending by US clients. The Nifty IT index fell 2.3%.",category:"stocks",source:"Mint",author:"Amit Verma",publishedAt:"2024-01-15T08:45:00Z",imageUrl:"https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=400",readTime:"2 min read",tags:["IT Stocks","Fed Policy","TCS","Infosys"],isBookmarked:!1},{id:4,title:"Government Announces New PLI Scheme for Electronics Manufacturing",summary:"The government unveiled a new Production Linked Incentive scheme worth ₹76,000 crore to boost electronics manufacturing in India.",content:"The scheme aims to attract global electronics manufacturers and create employment opportunities. Companies like Apple, Samsung, and Foxconn are expected to benefit from this initiative.",category:"policy",source:"Financial Express",author:"Neha Gupta",publishedAt:"2024-01-15T07:30:00Z",imageUrl:"https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=400",readTime:"5 min read",tags:["PLI Scheme","Electronics","Manufacturing","Policy"],isBookmarked:!1},{id:5,title:"Crude Oil Prices Rise on Middle East Tensions, OMCs in Focus",summary:"Oil marketing companies gained as crude oil prices surged due to escalating tensions in the Middle East region.",content:"Brent crude futures rose 2.5% to $85.40 per barrel. Indian Oil Corporation, BPCL, and HPCL were among the top gainers in the energy sector.",category:"market",source:"Reuters",author:"Global Desk",publishedAt:"2024-01-15T06:00:00Z",imageUrl:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400",readTime:"3 min read",tags:["Crude Oil","OMCs","Energy Sector"],isBookmarked:!1},{id:6,title:"FII Inflows Continue as India Remains Attractive Investment Destination",summary:"Foreign institutional investors pumped in ₹12,500 crore into Indian equities last week, showing continued confidence in the market.",content:"The sustained FII inflows reflect positive sentiment towards Indian markets amid global uncertainties. Experts believe India's growth prospects remain strong.",category:"economy",source:"Moneycontrol",author:"Investment Desk",publishedAt:"2024-01-14T16:20:00Z",imageUrl:"https://images.unsplash.com/photo-1559526324-4b87b5e36e44?w=400",readTime:"4 min read",tags:["FII","Investment","Market Flows"],isBookmarked:!0}],k=async()=>{a(!0),await new Promise(P=>setTimeout(P,1500)),a(!1)},C=P=>{l(L=>L.includes(P)?L.filter(M=>M!==P):[...L,P])},N=P=>{navigator.share?navigator.share({title:P.title,text:P.summary,url:window.location.href}):navigator.clipboard.writeText(window.location.href)},T=P=>{const L=new Date,M=new Date(P),O=Math.floor((L-M)/(1e3*60*60));return O<1?"Just now":O<24?`${O}h ago`:`${Math.floor(O/24)}d ago`},I=S.filter(P=>{const L=P.title.toLowerCase().includes(c.toLowerCase())||P.summary.toLowerCase().includes(c.toLowerCase())||P.tags.some(O=>O.toLowerCase().includes(c.toLowerCase())),M=t==="all"||P.category===t;return L&&M});return i.jsxs("div",{className:"news-page",children:[i.jsx(ks,{icon:Aa,title:"Market News",subtitle:"Stay updated with the latest market news and analysis from trusted sources",borderColor:"info",actions:[{label:"Refresh",icon:Ue,onClick:k,variant:"secondary",disabled:r},{label:"Bookmarks",icon:cs,onClick:()=>{},variant:"primary"}]}),i.jsxs("div",{className:"news-container",children:[i.jsxs(F.div,{className:"news-controls",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:[i.jsxs("div",{className:"controls-left",children:[i.jsx("div",{className:"search-container",children:i.jsx(Ci,{placeholder:"Search news articles...",value:c,onChange:h,onClear:g,recentSearches:m,onHistoryClick:b,showHistory:x,loading:p,size:"md",showSuggestions:!1,enableHistory:!0,className:"news-search-input"})}),i.jsx("div",{className:"category-filter",children:y.map(P=>i.jsxs("button",{className:`category-btn ${t===P.id?"active":""}`,onClick:()=>n(P.id),children:[P.name,i.jsx("span",{className:"category-count",children:P.count})]},P.id))})]}),i.jsx("div",{className:"controls-right",children:i.jsxs("button",{className:"btn-premium btn-ghost",children:[i.jsx(_n,{size:16}),"Filter"]})})]}),i.jsx(F.div,{className:"news-grid",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:I.map((P,L)=>i.jsxs(F.article,{className:"news-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:L*.1},children:[i.jsxs("div",{className:"news-image",children:[i.jsx("img",{src:P.imageUrl,alt:P.title}),i.jsx("div",{className:"news-category",children:i.jsx("span",{className:`category-tag ${P.category}`,children:P.category.toUpperCase()})})]}),i.jsxs("div",{className:"news-content",children:[i.jsxs("div",{className:"news-meta",children:[i.jsxs("div",{className:"meta-left",children:[i.jsxs("span",{className:"news-source",children:[i.jsx(ht,{size:12}),P.source]}),i.jsxs("span",{className:"news-time",children:[i.jsx(st,{size:12}),T(P.publishedAt)]})]}),i.jsx("div",{className:"meta-right",children:i.jsx("span",{className:"read-time",children:P.readTime})})]}),i.jsx("h3",{className:"news-title",children:P.title}),i.jsx("p",{className:"news-summary",children:P.summary}),i.jsx("div",{className:"news-tags",children:P.tags.slice(0,3).map(M=>i.jsxs("span",{className:"news-tag",children:[i.jsx(Lf,{size:10}),M]},M))}),i.jsxs("div",{className:"news-actions",children:[i.jsx("div",{className:"actions-left",children:i.jsxs("button",{className:"news-author",children:["By ",P.author]})}),i.jsxs("div",{className:"actions-right",children:[i.jsx("button",{className:`action-btn ${o.includes(P.id)||P.isBookmarked?"bookmarked":""}`,onClick:()=>C(P.id),title:"Bookmark",children:i.jsx(cs,{size:16})}),i.jsx("button",{className:"action-btn",onClick:()=>N(P),title:"Share",children:i.jsx(If,{size:16})}),i.jsx("button",{className:"action-btn",title:"Read Full Article",children:i.jsx(In,{size:16})})]})]})]})]},P.id))}),i.jsx(F.div,{className:"load-more-section",initial:{opacity:0},animate:{opacity:1},transition:{duration:.6,delay:.4},children:i.jsx("button",{className:"btn-premium btn-secondary btn-lg",children:"Load More Articles"})})]})]})},kx=({user:s,theme:e})=>{const[t,n]=v.useState(""),[r,a]=v.useState(new Set),[o,l]=v.useState(!1),[c,h]=v.useState(!1),{notifications:d,unreadCount:m,loading:x,error:b,filters:p,pagination:g,connectionStatus:f,fetchNotifications:y,markAsRead:S,markAllAsRead:k,deleteNotification:C,setFilters:N,loadMore:T}=zn();v.useEffect(()=>{y()},[y]);const I=d.filter(A=>{if(t){const V=t.toLowerCase();if(!A.title.toLowerCase().includes(V)&&!A.message.toLowerCase().includes(V))return!1}return!(p.type!=="all"&&A.type!==p.type||p.read==="read"&&!A.read||p.read==="unread"&&A.read)}),P=A=>{const V=new Set(r);V.has(A)?V.delete(A):V.add(A),a(V)},L=()=>{r.size===I.length?a(new Set):a(new Set(I.map(A=>A.id)))},M=async()=>{const A=Array.from(r).map(V=>S(V));await Promise.all(A),a(new Set)},O=async()=>{const A=Array.from(r).map(V=>C(V));await Promise.all(A),a(new Set)},B=(A,V)=>{N({[A]:V})},R=()=>{y()};return i.jsxs("div",{className:"notifications-page",children:[i.jsx(ks,{icon:ls,title:"Notifications",subtitle:`${m} unread • ${f==="connected"?"LIVE":"OFFLINE"}`,borderColor:"primary",showNotifications:!1,actions:[{label:"Refresh",icon:Ue,onClick:R,variant:"secondary",disabled:x},{label:"Settings",icon:Os,onClick:()=>{},variant:"outline"}]}),i.jsxs("div",{className:"notifications-content",children:[i.jsx("div",{className:"notifications-actions",children:m>0&&i.jsxs(F.button,{className:"action-btn mark-all",onClick:k,whileHover:{scale:1.05},whileTap:{scale:.95},children:[i.jsx(Ot,{}),"Mark all read"]})}),i.jsxs("div",{className:"notifications-controls",children:[i.jsxs("div",{className:"search-container",children:[i.jsx(As,{className:"search-icon"}),i.jsx("input",{type:"text",placeholder:"Search notifications...",value:t,onChange:A=>n(A.target.value),className:"search-input"})]}),i.jsx(Se,{children:o&&i.jsxs(F.div,{className:"filters-container",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Type:"}),i.jsxs("select",{value:p.type,onChange:A=>B("type",A.target.value),children:[i.jsx("option",{value:"all",children:"All Types"}),i.jsx("option",{value:"info",children:"Info"}),i.jsx("option",{value:"success",children:"Success"}),i.jsx("option",{value:"warning",children:"Warning"}),i.jsx("option",{value:"error",children:"Error"}),i.jsx("option",{value:"alert",children:"Alert"})]})]}),i.jsxs("div",{className:"filter-group",children:[i.jsx("label",{children:"Status:"}),i.jsxs("select",{value:p.read,onChange:A=>B("read",A.target.value),children:[i.jsx("option",{value:"all",children:"All"}),i.jsx("option",{value:"unread",children:"Unread"}),i.jsx("option",{value:"read",children:"Read"})]})]})]})})]}),i.jsx(Se,{children:r.size>0&&i.jsxs(F.div,{className:"bulk-actions",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[i.jsxs("div",{className:"bulk-info",children:[i.jsx("input",{type:"checkbox",checked:r.size===I.length,onChange:L}),i.jsxs("span",{children:[r.size," selected"]})]}),i.jsxs("div",{className:"bulk-buttons",children:[i.jsxs("button",{onClick:M,children:[i.jsx(Ot,{})," Mark as read"]}),i.jsxs("button",{onClick:O,className:"danger",children:[i.jsx(Mf,{})," Delete"]})]})]})}),i.jsx("div",{className:"notifications-list",children:b?i.jsxs("div",{className:"error-state",children:[i.jsx("h3",{children:"Failed to load notifications"}),i.jsx("p",{children:b}),i.jsx("button",{onClick:R,children:"Try again"})]}):I.length>0?i.jsxs(i.Fragment,{children:[I.map((A,V)=>i.jsxs(F.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:V*.05},className:"notification-wrapper",children:[c&&i.jsx("input",{type:"checkbox",checked:r.has(A.id),onChange:()=>P(A.id),className:"notification-checkbox"}),i.jsx(Ih,{notification:A,onClick:()=>S(A.id),onDelete:()=>C(A.id),onMarkAsRead:S,compact:!1,showActions:!0})]},A.id)),g.hasMore&&i.jsx("div",{className:"load-more-container",children:i.jsx(F.button,{className:"load-more-btn",onClick:T,disabled:x,whileHover:{scale:1.02},whileTap:{scale:.98},children:x?"Loading...":"Load More"})})]}):i.jsxs("div",{className:"empty-state",children:[i.jsx(ls,{size:48}),i.jsx("h3",{children:"No notifications found"}),i.jsx("p",{children:t||p.type!=="all"||p.read!=="all"?"Try adjusting your search or filters":"You're all caught up! New notifications will appear here."})]})})]})]})},Cx=({user:s,theme:e})=>{const t=()=>{console.log("Toggle theme")},[n,r]=v.useState("profile"),[a,o]=v.useState(!1),[l,c]=v.useState(!1),h=[{id:"profile",name:"Profile",icon:ht},{id:"notifications",name:"Notifications",icon:ls},{id:"security",name:"Security",icon:Ft},{id:"preferences",name:"Preferences",icon:Os}],[d,m]=v.useState({firstName:"John",lastName:"Doe",email:"john.doe@example.com",phone:"+91 98765 43210",bio:"Passionate trader and investor",location:"Mumbai, India"}),[x,b]=v.useState({emailNotifications:!0,pushNotifications:!0,smsNotifications:!1,priceAlerts:!0,newsAlerts:!0,portfolioUpdates:!0,marketOpen:!1,weeklyReports:!0}),[p,g]=v.useState({twoFactorAuth:!1,loginAlerts:!0,sessionTimeout:"30",allowedDevices:3}),[f,y]=v.useState({theme:e,language:"en",currency:"INR",timezone:"Asia/Kolkata",dateFormat:"DD/MM/YYYY",numberFormat:"Indian",defaultPage:"dashboard"}),S=async()=>{o(!0),await new Promise(B=>setTimeout(B,1500)),o(!1)},k=(B,R)=>{m(A=>({...A,[B]:R}))},C=B=>{b(R=>({...R,[B]:!R[B]}))},N=(B,R)=>{g(A=>({...A,[B]:R}))},T=(B,R)=>{y(A=>({...A,[B]:R})),B==="theme"&&R!==e&&t()},I=()=>i.jsxs("div",{className:"settings-section",children:[i.jsx("h3",{className:"section-title",children:"Profile Information"}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"First Name"}),i.jsx("input",{type:"text",className:"form-input",value:d.firstName,onChange:B=>k("firstName",B.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Last Name"}),i.jsx("input",{type:"text",className:"form-input",value:d.lastName,onChange:B=>k("lastName",B.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Email Address"}),i.jsx("input",{type:"email",className:"form-input",value:d.email,onChange:B=>k("email",B.target.value)})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Phone Number"}),i.jsx("input",{type:"tel",className:"form-input",value:d.phone,onChange:B=>k("phone",B.target.value)})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Bio"}),i.jsx("textarea",{className:"form-textarea",rows:"3",value:d.bio,onChange:B=>k("bio",B.target.value)})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Location"}),i.jsx("input",{type:"text",className:"form-input",value:d.location,onChange:B=>k("location",B.target.value)})]})]})]}),P=()=>i.jsxs("div",{className:"settings-section",children:[i.jsx("h3",{className:"section-title",children:"Notification Preferences"}),i.jsxs("div",{className:"notification-groups",children:[i.jsxs("div",{className:"notification-group",children:[i.jsx("h4",{className:"group-title",children:"Communication"}),i.jsxs("div",{className:"toggle-list",children:[i.jsxs("div",{className:"toggle-item",children:[i.jsxs("div",{className:"toggle-info",children:[i.jsx(Ln,{className:"toggle-icon"}),i.jsxs("div",{children:[i.jsx("div",{className:"toggle-label",children:"Email Notifications"}),i.jsx("div",{className:"toggle-description",children:"Receive updates via email"})]})]}),i.jsx("div",{className:`toggle-switch ${x.emailNotifications?"on":"off"}`,onClick:()=>C("emailNotifications"),children:i.jsx("div",{className:"toggle-thumb"})})]}),i.jsxs("div",{className:"toggle-item",children:[i.jsxs("div",{className:"toggle-info",children:[i.jsx(ls,{className:"toggle-icon"}),i.jsxs("div",{children:[i.jsx("div",{className:"toggle-label",children:"Push Notifications"}),i.jsx("div",{className:"toggle-description",children:"Browser push notifications"})]})]}),i.jsx("div",{className:`toggle-switch ${x.pushNotifications?"on":"off"}`,onClick:()=>C("pushNotifications"),children:i.jsx("div",{className:"toggle-thumb"})})]}),i.jsxs("div",{className:"toggle-item",children:[i.jsxs("div",{className:"toggle-info",children:[i.jsx(_f,{className:"toggle-icon"}),i.jsxs("div",{children:[i.jsx("div",{className:"toggle-label",children:"SMS Notifications"}),i.jsx("div",{className:"toggle-description",children:"Text message alerts"})]})]}),i.jsx("div",{className:`toggle-switch ${x.smsNotifications?"on":"off"}`,onClick:()=>C("smsNotifications"),children:i.jsx("div",{className:"toggle-thumb"})})]})]})]}),i.jsxs("div",{className:"notification-group",children:[i.jsx("h4",{className:"group-title",children:"Market Alerts"}),i.jsxs("div",{className:"toggle-list",children:[i.jsxs("div",{className:"toggle-item",children:[i.jsxs("div",{className:"toggle-info",children:[i.jsx(Je,{className:"toggle-icon"}),i.jsxs("div",{children:[i.jsx("div",{className:"toggle-label",children:"Price Alerts"}),i.jsx("div",{className:"toggle-description",children:"Stock price movement alerts"})]})]}),i.jsx("div",{className:`toggle-switch ${x.priceAlerts?"on":"off"}`,onClick:()=>C("priceAlerts"),children:i.jsx("div",{className:"toggle-thumb"})})]}),i.jsxs("div",{className:"toggle-item",children:[i.jsxs("div",{className:"toggle-info",children:[i.jsx(Aa,{className:"toggle-icon"}),i.jsxs("div",{children:[i.jsx("div",{className:"toggle-label",children:"News Alerts"}),i.jsx("div",{className:"toggle-description",children:"Market news and updates"})]})]}),i.jsx("div",{className:`toggle-switch ${x.newsAlerts?"on":"off"}`,onClick:()=>C("newsAlerts"),children:i.jsx("div",{className:"toggle-thumb"})})]}),i.jsxs("div",{className:"toggle-item",children:[i.jsxs("div",{className:"toggle-info",children:[i.jsx(ht,{className:"toggle-icon"}),i.jsxs("div",{children:[i.jsx("div",{className:"toggle-label",children:"Portfolio Updates"}),i.jsx("div",{className:"toggle-description",children:"Portfolio performance updates"})]})]}),i.jsx("div",{className:`toggle-switch ${x.portfolioUpdates?"on":"off"}`,onClick:()=>C("portfolioUpdates"),children:i.jsx("div",{className:"toggle-thumb"})})]})]})]})]})]}),L=()=>i.jsxs("div",{className:"settings-section",children:[i.jsx("h3",{className:"section-title",children:"Security & Privacy"}),i.jsxs("div",{className:"security-groups",children:[i.jsxs("div",{className:"security-group",children:[i.jsx("h4",{className:"group-title",children:"Authentication"}),i.jsxs("div",{className:"security-item",children:[i.jsxs("div",{className:"security-info",children:[i.jsx(Ft,{className:"security-icon"}),i.jsxs("div",{children:[i.jsx("div",{className:"security-label",children:"Two-Factor Authentication"}),i.jsx("div",{className:"security-description",children:"Add an extra layer of security"})]})]}),i.jsx("div",{className:`toggle-switch ${p.twoFactorAuth?"on":"off"}`,onClick:()=>N("twoFactorAuth",!p.twoFactorAuth),children:i.jsx("div",{className:"toggle-thumb"})})]}),i.jsxs("div",{className:"security-item",children:[i.jsxs("div",{className:"security-info",children:[i.jsx(ls,{className:"security-icon"}),i.jsxs("div",{children:[i.jsx("div",{className:"security-label",children:"Login Alerts"}),i.jsx("div",{className:"security-description",children:"Get notified of new logins"})]})]}),i.jsx("div",{className:`toggle-switch ${p.loginAlerts?"on":"off"}`,onClick:()=>N("loginAlerts",!p.loginAlerts),children:i.jsx("div",{className:"toggle-thumb"})})]})]}),i.jsxs("div",{className:"security-group",children:[i.jsx("h4",{className:"group-title",children:"Session Management"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Session Timeout (minutes)"}),i.jsxs("select",{className:"form-select",value:p.sessionTimeout,onChange:B=>N("sessionTimeout",B.target.value),children:[i.jsx("option",{value:"15",children:"15 minutes"}),i.jsx("option",{value:"30",children:"30 minutes"}),i.jsx("option",{value:"60",children:"1 hour"}),i.jsx("option",{value:"120",children:"2 hours"}),i.jsx("option",{value:"0",children:"Never"})]})]})]}),i.jsxs("div",{className:"security-group",children:[i.jsx("h4",{className:"group-title",children:"Password"}),i.jsxs("div",{className:"password-section",children:[i.jsxs("button",{className:"btn-premium btn-secondary",children:[i.jsx(kf,{size:16}),"Change Password"]}),i.jsxs("button",{className:"btn-premium btn-ghost",children:[i.jsx(Ue,{size:16}),"Reset All Sessions"]})]})]})]})]}),M=()=>i.jsxs("div",{className:"settings-section",children:[i.jsx("h3",{className:"section-title",children:"Application Preferences"}),i.jsxs("div",{className:"preferences-groups",children:[i.jsxs("div",{className:"preferences-group",children:[i.jsx("h4",{className:"group-title",children:"Appearance"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Theme"}),i.jsxs("div",{className:"theme-selector",children:[i.jsxs("button",{className:`theme-option ${f.theme==="light"?"active":""}`,onClick:()=>T("theme","light"),children:[i.jsx(Bc,{size:16}),"Light"]}),i.jsxs("button",{className:`theme-option ${f.theme==="dark"?"active":""}`,onClick:()=>T("theme","dark"),children:[i.jsx(Rc,{size:16}),"Dark"]})]})]})]}),i.jsxs("div",{className:"preferences-group",children:[i.jsx("h4",{className:"group-title",children:"Localization"}),i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Language"}),i.jsxs("select",{className:"form-select",value:f.language,onChange:B=>T("language",B.target.value),children:[i.jsx("option",{value:"en",children:"English"}),i.jsx("option",{value:"hi",children:"Hindi"}),i.jsx("option",{value:"mr",children:"Marathi"}),i.jsx("option",{value:"gu",children:"Gujarati"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Currency"}),i.jsxs("select",{className:"form-select",value:f.currency,onChange:B=>T("currency",B.target.value),children:[i.jsx("option",{value:"INR",children:"Indian Rupee (₹)"}),i.jsx("option",{value:"USD",children:"US Dollar ($)"}),i.jsx("option",{value:"EUR",children:"Euro (€)"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Timezone"}),i.jsxs("select",{className:"form-select",value:f.timezone,onChange:B=>T("timezone",B.target.value),children:[i.jsx("option",{value:"Asia/Kolkata",children:"Asia/Kolkata (IST)"}),i.jsx("option",{value:"America/New_York",children:"America/New_York (EST)"}),i.jsx("option",{value:"Europe/London",children:"Europe/London (GMT)"})]})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Date Format"}),i.jsxs("select",{className:"form-select",value:f.dateFormat,onChange:B=>T("dateFormat",B.target.value),children:[i.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),i.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),i.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD"})]})]})]})]}),i.jsxs("div",{className:"preferences-group",children:[i.jsx("h4",{className:"group-title",children:"Default Settings"}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Default Page"}),i.jsxs("select",{className:"form-select",value:f.defaultPage,onChange:B=>T("defaultPage",B.target.value),children:[i.jsx("option",{value:"dashboard",children:"Dashboard"}),i.jsx("option",{value:"portfolio",children:"Portfolio"}),i.jsx("option",{value:"trading",children:"Trading"}),i.jsx("option",{value:"watchlist",children:"Watchlist"})]})]})]})]})]}),O=()=>{switch(n){case"profile":return I();case"notifications":return P();case"security":return L();case"preferences":return M();default:return I()}};return i.jsxs("div",{className:"settings-page",children:[i.jsx(ks,{icon:Os,title:"Settings",subtitle:"Manage your account preferences and security settings",borderColor:"success",actions:[{label:a?"Saving...":"Save Changes",icon:a?Ue:Oc,onClick:S,variant:"primary",disabled:a}]}),i.jsx("div",{className:"settings-container",children:i.jsxs("div",{className:"settings-layout",children:[i.jsx(F.div,{className:"settings-tabs",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.1},children:h.map(B=>{const R=B.icon;return i.jsxs("button",{className:`tab-button ${n===B.id?"active":""}`,onClick:()=>r(B.id),children:[i.jsx(R,{size:20}),B.name]},B.id)})}),i.jsx(F.div,{className:"settings-content",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:O()},n)]})})]})},Px=()=>{var y,S;const[s,e]=v.useState(!1),[t,n]=v.useState(!1),{portfolioData:r}=ft(),{user:a,updateProfile:o,logout:l}=Bt(),[c,h]=v.useState({firstName:"",lastName:"",email:"",phone:"",location:"",bio:"",joinDate:"",avatar:null});v.useEffect(()=>{if(a){const C=(a.fullName||a.name||"").split(" "),N=C[0]||"",T=C.slice(1).join(" ")||"";h({firstName:N,lastName:T,email:a.email||"",phone:a.phoneNumber||a.phone||"",location:a.location||"",bio:a.bio||"Welcome to TradeBro! Start your trading journey today.",joinDate:a.createdAt?new Date(a.createdAt).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],avatar:a.profilePicture||a.profileImage||a.avatar||null})}},[a]);const d=k=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(k),m=[{title:"Portfolio Value",value:d((r==null?void 0:r.totalValue)||0),change:r!=null&&r.totalGainLossPercentage?`${r.totalGainLossPercentage>=0?"+":""}${r.totalGainLossPercentage.toFixed(2)}%`:"0.00%",icon:Je,color:((r==null?void 0:r.totalGainLoss)||0)>=0?"#10B981":"#EF4444"},{title:"Available Cash",value:d((r==null?void 0:r.availableCash)||0),change:"Available",icon:Je,color:"#3B82F6"},{title:"Total Invested",value:d((r==null?void 0:r.totalInvested)||0),change:`${((y=r==null?void 0:r.holdings)==null?void 0:y.length)||0} holdings`,icon:Pe,color:"#F59E0B"},{title:"Total Transactions",value:((S=r==null?void 0:r.transactions)==null?void 0:S.length)||0,change:"Completed",icon:vt,color:"#8B5CF6"}],x=[{title:"First Trade",description:"Completed your first trade",earned:!0},{title:"Profit Maker",description:"Made profit for 7 consecutive days",earned:!0},{title:"Risk Manager",description:"Maintained stop-loss on 50 trades",earned:!0},{title:"Market Expert",description:"Achieved 80% success rate",earned:!1},{title:"Portfolio Builder",description:"Diversified across 10+ sectors",earned:!1},{title:"Long Term Investor",description:"Held positions for 6+ months",earned:!1}],b=async()=>{n(!0);try{const k={...a,fullName:`${c.firstName} ${c.lastName}`.trim(),firstName:c.firstName,lastName:c.lastName,email:c.email,phoneNumber:c.phone,phone:c.phone,location:c.location,bio:c.bio};o(k),await new Promise(C=>setTimeout(C,1e3)),e(!1),n(!1)}catch(k){console.error("Error saving profile:",k),n(!1)}},p=()=>{if(a){const C=(a.fullName||a.name||"").split(" "),N=C[0]||"",T=C.slice(1).join(" ")||"";h({firstName:N,lastName:T,email:a.email||"",phone:a.phoneNumber||a.phone||"",location:a.location||"",bio:a.bio||"Welcome to TradeBro! Start your trading journey today.",joinDate:a.createdAt?new Date(a.createdAt).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],avatar:a.profileImage||a.avatar||null})}e(!1)},g=(k,C)=>{h(N=>({...N,[k]:C}))},f=k=>new Date(k).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric"});return i.jsxs("div",{className:"profile-page",children:[i.jsx(ks,{icon:ht,title:"Profile",subtitle:"Manage your account information and trading preferences",borderColor:"purple",actions:s?[{label:"Cancel",icon:ht,onClick:p,variant:"secondary"},{label:t?"Saving...":"Save Changes",icon:Oc,onClick:b,variant:"primary",disabled:t}]:[{label:"Edit Profile",icon:Ic,onClick:()=>e(!0),variant:"primary"}]}),i.jsx("div",{className:"profile-container",children:i.jsxs("div",{className:"profile-layout",children:[i.jsxs(F.div,{className:"profile-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},children:[i.jsx("div",{className:"card-header",children:i.jsx("h3",{className:"card-title",children:"Personal Information"})}),i.jsxs("div",{className:"card-content",children:[i.jsxs("div",{className:"profile-avatar-section",children:[i.jsxs("div",{className:"avatar-container",children:[i.jsxs("div",{className:"avatar",children:[c.avatar?i.jsx("img",{src:c.avatar,alt:`${c.firstName} ${c.lastName}`,onError:k=>{k.target.style.display="none",k.target.nextSibling.style.display="flex"}}):null,i.jsx("div",{className:"avatar-placeholder",style:{display:c.avatar?"none":"flex"},children:c.firstName?i.jsxs("span",{className:"avatar-initial",children:[c.firstName.charAt(0).toUpperCase(),c.lastName?c.lastName.charAt(0).toUpperCase():""]}):i.jsx(ht,{size:48})})]}),s&&i.jsx("button",{className:"avatar-edit-btn",children:i.jsx(yf,{size:16})})]}),i.jsxs("div",{className:"profile-basic-info",children:[i.jsxs("h2",{className:"profile-name",children:[c.firstName," ",c.lastName]}),i.jsx("p",{className:"profile-email",children:c.email}),i.jsx("div",{className:"profile-meta",children:i.jsxs("span",{className:"join-date",children:[i.jsx(Ec,{size:14}),"Joined ",f(c.joinDate)]})})]})]}),i.jsx("div",{className:"profile-form",children:i.jsxs("div",{className:"form-grid",children:[i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"First Name"}),s?i.jsx("input",{type:"text",className:"form-input",value:c.firstName,onChange:k=>g("firstName",k.target.value)}):i.jsx("div",{className:"form-display",children:c.firstName})]}),i.jsxs("div",{className:"form-group",children:[i.jsx("label",{className:"form-label",children:"Last Name"}),s?i.jsx("input",{type:"text",className:"form-input",value:c.lastName,onChange:k=>g("lastName",k.target.value)}):i.jsx("div",{className:"form-display",children:c.lastName})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{className:"form-label",children:[i.jsx(Ln,{size:16}),"Email Address"]}),s?i.jsx("input",{type:"email",className:"form-input",value:c.email,onChange:k=>g("email",k.target.value)}):i.jsx("div",{className:"form-display",children:c.email})]}),i.jsxs("div",{className:"form-group",children:[i.jsxs("label",{className:"form-label",children:[i.jsx(Ef,{size:16}),"Phone Number"]}),s?i.jsx("input",{type:"tel",className:"form-input",value:c.phone,onChange:k=>g("phone",k.target.value)}):i.jsx("div",{className:"form-display",children:c.phone})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsxs("label",{className:"form-label",children:[i.jsx(Pf,{size:16}),"Location"]}),s?i.jsx("input",{type:"text",className:"form-input",value:c.location,onChange:k=>g("location",k.target.value)}):i.jsx("div",{className:"form-display",children:c.location})]}),i.jsxs("div",{className:"form-group full-width",children:[i.jsx("label",{className:"form-label",children:"Bio"}),s?i.jsx("textarea",{className:"form-textarea",rows:"3",value:c.bio,onChange:k=>g("bio",k.target.value)}):i.jsx("div",{className:"form-display",children:c.bio})]})]})})]})]}),i.jsxs(F.div,{className:"stats-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{className:"card-title",children:[i.jsx(Pe,{className:"card-icon"}),"Trading Performance"]})}),i.jsx("div",{className:"card-content",children:i.jsx("div",{className:"stats-grid",children:m.map((k,C)=>{const N=k.icon;return i.jsxs("div",{className:"stat-item",children:[i.jsx("div",{className:"stat-icon",style:{color:k.color},children:i.jsx(N,{size:24})}),i.jsxs("div",{className:"stat-content",children:[i.jsx("div",{className:"stat-value",children:k.value}),i.jsx("div",{className:"stat-title",children:k.title}),i.jsx("div",{className:"stat-change",style:{color:k.color},children:k.change})]})]},k.title)})})})]}),i.jsxs(F.div,{className:"achievements-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},children:[i.jsx("div",{className:"card-header",children:i.jsxs("h3",{className:"card-title",children:[i.jsx(ha,{className:"card-icon"}),"Achievements"]})}),i.jsx("div",{className:"card-content",children:i.jsx("div",{className:"achievements-grid",children:x.map((k,C)=>i.jsxs("div",{className:`achievement-item ${k.earned?"earned":"locked"}`,children:[i.jsx("div",{className:"achievement-icon",children:i.jsx(ha,{size:20})}),i.jsxs("div",{className:"achievement-content",children:[i.jsx("h4",{className:"achievement-title",children:k.title}),i.jsx("p",{className:"achievement-description",children:k.description})]}),k.earned&&i.jsx("div",{className:"achievement-badge",children:i.jsx(Ft,{size:16})})]},k.title))})})]}),i.jsxs(F.div,{className:"actions-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},children:[i.jsx("div",{className:"card-header",children:i.jsx("h3",{className:"card-title",children:"Quick Actions"})}),i.jsx("div",{className:"card-content",children:i.jsxs("div",{className:"action-buttons",children:[i.jsxs("button",{className:"action-btn",children:[i.jsx(Os,{size:20}),i.jsx("span",{children:"Settings"})]}),i.jsxs("button",{className:"action-btn",children:[i.jsx(Ft,{size:20}),i.jsx("span",{children:"Security"})]}),i.jsxs("button",{className:"action-btn logout",onClick:l,children:[i.jsx(Lc,{size:20}),i.jsx("span",{children:"Logout"})]})]})})]})]})})]})};class Tx{constructor(){this.initializePatterns()}initializePatterns(){this.commandPatterns=[{pattern:/(?:open|show|display)\s+(?:chart|charts|graph)\s+(?:for|of)\s+([A-Za-z0-9]+)/i,action:"openChart",extract:e=>({symbol:this.normalizeSymbol(e[1])})},{pattern:/(?:chart|charts)\s+(?:for|of)\s+([A-Za-z0-9]+)/i,action:"openChart",extract:e=>({symbol:this.normalizeSymbol(e[1])})},{pattern:/([A-Za-z0-9]+)\s+chart/i,action:"openChart",extract:e=>({symbol:this.normalizeSymbol(e[1])})},{pattern:/(?:what|show|tell)\s+(?:is|me)?\s*(?:the)?\s*(?:price|quote)\s+(?:of|for)\s+([A-Za-z0-9]+)/i,action:"getStockPrice",extract:e=>({symbol:this.normalizeSymbol(e[1])})},{pattern:/([A-Za-z0-9]+)\s+(?:stock\s+)?price/i,action:"getStockPrice",extract:e=>({symbol:this.normalizeSymbol(e[1])})},{pattern:/price\s+(?:of|for)\s+([A-Za-z0-9]+)/i,action:"getStockPrice",extract:e=>({symbol:this.normalizeSymbol(e[1])})},{pattern:/(?:buy|purchase)\s+([A-Za-z0-9]+)(?:\s+stock)?/i,action:"buyStock",extract:e=>({symbol:this.normalizeSymbol(e[1])})},{pattern:/(?:sell)\s+([A-Za-z0-9]+)(?:\s+stock)?/i,action:"sellStock",extract:e=>({symbol:this.normalizeSymbol(e[1])})},{pattern:/(?:go\s+to|open|navigate\s+to)\s+(dashboard|portfolio|watchlist|news|trading|charts)/i,action:"navigate",extract:e=>({page:e[1].toLowerCase()})},{pattern:/(?:show|get|display)\s+(?:top\s+)?(gainers|losers|movers)/i,action:"getMarketMovers",extract:e=>({type:e[1].toLowerCase()})},{pattern:/(?:show|get|latest)\s+(?:market\s+)?news(?:\s+for\s+([A-Za-z]+))?/i,action:"getNews",extract:e=>{var t;return{symbol:((t=e[1])==null?void 0:t.toUpperCase())||null}}},{pattern:/(?:show|display|open)\s+(?:my\s+)?portfolio/i,action:"showPortfolio",extract:()=>({})},{pattern:/(?:add|put)\s+([A-Za-z0-9]+)\s+(?:to\s+)?(?:watchlist|watch\s+list)/i,action:"addToWatchlist",extract:e=>({symbol:this.normalizeSymbol(e[1])})}]}processCommand(e){console.log("Processing voice command:",e);for(const t of this.commandPatterns){const n=e.match(t.pattern);if(n){const r=t.extract(n);return console.log("Matched pattern:",t.action,r),{action:t.action,data:r,originalText:e,confidence:this.calculateConfidence(n)}}}return{action:"generalQuery",data:{query:e},originalText:e,confidence:.5}}normalizeSymbol(e){const t={zomato:"ZOMATO",reliance:"RELIANCE",tcs:"TCS",infosys:"INFY",hdfc:"HDFCBANK",icici:"ICICIBANK",sbi:"SBIN",wipro:"WIPRO",bharti:"BHARTIARTL",airtel:"BHARTIARTL",maruti:"MARUTI",titan:"TITAN",asian:"ASIANPAINT",bajaj:"BAJFINANCE",kotak:"KOTAKBANK",axis:"AXISBANK"},n=e.toLowerCase();return t[n]||e.toUpperCase()}calculateConfidence(e){const t=e[0].length,n=e.input.length;return Math.min(.9,t/n+.3)}async executeCommand(e,t){const{action:n,data:r}=e;switch(n){case"openChart":return this.handleChartCommand(r,t);case"getStockPrice":return this.handleStockPriceCommand(r,t);case"buyStock":return this.handleBuyCommand(r,t);case"sellStock":return this.handleSellCommand(r,t);case"navigate":return this.handleNavigationCommand(r,t);case"getMarketMovers":return this.handleMarketMoversCommand(r,t);case"getNews":return this.handleNewsCommand(r,t);case"showPortfolio":return this.handlePortfolioCommand(r,t);case"addToWatchlist":return this.handleWatchlistCommand(r,t);default:return this.handleGeneralQuery(r,t)}}async handleChartCommand(e,t){const{symbol:n}=e;return t.navigate&&t.navigate(`/charts?symbol=${n}`),t.sendMessage&&await t.sendMessage(`Show me ${n} chart and price data`),{success:!0,message:`Opening ${n} chart...`,action:"chart_opened",symbol:n}}async handleStockPriceCommand(e,t){const{symbol:n}=e;return t.sendMessage&&await t.sendMessage(`Get ${n} stock price and details`),{success:!0,message:`Getting ${n} stock price...`,action:"price_requested",symbol:n}}async handleBuyCommand(e,t){const{symbol:n}=e;return t.sendMessage&&await t.sendMessage(`I want to buy ${n} stock`),{success:!0,message:`Initiating buy order for ${n}...`,action:"buy_initiated",symbol:n}}async handleSellCommand(e,t){const{symbol:n}=e;return t.sendMessage&&await t.sendMessage(`I want to sell ${n} stock`),{success:!0,message:`Initiating sell order for ${n}...`,action:"sell_initiated",symbol:n}}async handleNavigationCommand(e,t){const{page:n}=e,r={dashboard:"/dashboard",portfolio:"/portfolio",watchlist:"/watchlist",news:"/news",trading:"/trading",charts:"/charts"};return t.navigate&&r[n]&&t.navigate(r[n]),{success:!0,message:`Navigating to ${n}...`,action:"navigation",page:n}}async handleMarketMoversCommand(e,t){const{type:n}=e;return t.sendMessage&&await t.sendMessage(`Show me top ${n} in the market`),{success:!0,message:`Getting top ${n}...`,action:"market_movers",type:n}}async handleNewsCommand(e,t){const{symbol:n}=e,r=n?`Latest news for ${n}`:"Latest market news";return t.sendMessage&&await t.sendMessage(r),{success:!0,message:n?`Getting ${n} news...`:"Getting market news...",action:"news_requested",symbol:n}}async handlePortfolioCommand(e,t){return t.navigate&&t.navigate("/portfolio"),t.sendMessage&&await t.sendMessage("Show my portfolio performance"),{success:!0,message:"Opening your portfolio...",action:"portfolio_opened"}}async handleWatchlistCommand(e,t){const{symbol:n}=e;return t.sendMessage&&await t.sendMessage(`Add ${n} to my watchlist`),{success:!0,message:`Adding ${n} to watchlist...`,action:"watchlist_add",symbol:n}}async handleGeneralQuery(e,t){const{query:n}=e;return t.sendMessage&&await t.sendMessage(n),{success:!0,message:"Processing your request...",action:"general_query",query:n}}}const Ex=(s=!1)=>{const e=Ve(),[t,n]=v.useState([]),[r,a]=v.useState(""),[o,l]=v.useState(!1),[c,h]=v.useState(!1),[d,m]=v.useState(!1),[x,b]=v.useState(null),[p,g]=v.useState(null),[f,y]=v.useState("high"),[S,k]=v.useState(!0),[C,N]=v.useState("casual"),T=v.useRef(null),I=v.useRef(null),P=v.useRef(null),L=v.useRef(new Tx);v.useEffect(()=>{O(),B(),R()},[]),v.useEffect(()=>{M()},[t]),v.useEffect(()=>()=>{if(P.current&&P.current.cancel(),I.current)try{I.current.stop()}catch{console.log("Recognition cleanup")}m(!1),h(!1)},[]),v.useEffect(()=>{!o&&c&&h(!1)},[o,c]);const M=()=>{var ie;(ie=T.current)==null||ie.scrollIntoView({behavior:"smooth"})},O=()=>{const ie={id:"welcome_"+Date.now(),type:"assistant",content:`🚀 Hello! I'm Saytrix, your AI-powered stock market assistant. I can help you with:

📊 Real-time stock prices and data
📈 Market analysis and trends
🏢 Company information and fundamentals
⭐ Top gainers and losers
📰 Latest market news
🎓 Stock market education

What would you like to know about the stock market today?

💡 Currently running in demo mode with sample data for showcase`,timestamp:new Date,suggestions:["Show me NIFTY performance","What are today's top gainers?","Tell me about RELIANCE stock","Latest market news"],confidence:"high",cardType:"welcome"};n([ie]),b("offline_session_"+Date.now()),console.log("Saytrix initialized in offline demo mode")},B=()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const ie=window.SpeechRecognition||window.webkitSpeechRecognition;I.current=new ie,I.current.continuous=!1,I.current.interimResults=!1,I.current.lang="en-US",I.current.onstart=()=>{console.log("Speech recognition started"),h(!0),g(null)},I.current.onend=()=>{console.log("Speech recognition ended"),h(!1)},I.current.onresult=async D=>{const $=D.results[0][0].transcript,U=D.results[0][0].confidence;a($),y(U>.8?"high":U>.6?"medium":"low"),h(!1),setTimeout(async()=>{$.trim()&&await Y($)},300)},I.current.onerror=D=>{console.error("Speech recognition error:",D.error),h(!1),g("Voice recognition failed. Please try again.")}}},R=()=>{"speechSynthesis"in window&&(P.current=window.speechSynthesis)},A=v.useCallback(async(ie=r)=>{var $;if(!ie.trim()||o)return;const D={id:Date.now(),type:"user",content:ie,timestamp:new Date,confidence:f};n(U=>[...U,D]),a(""),l(!0),g(null),h(!1);try{const U=await yh.sendMessage(ie,x);if(U.success){const X={id:Date.now()+1,type:"assistant",content:U.data.response,timestamp:new Date,confidence:"high",cardType:U.data.stockData?"stock-price":"text",suggestions:U.data.suggestions||[],stockData:U.data.stockData};n(ce=>[...ce,X]),b(U.data.sessionId),P.current&&X.content&&s&&V(X.content)}else throw new Error("Backend response failed")}catch(U){console.warn("Backend API failed, using fallback:",U),(U.code==="ERR_NETWORK"||(($=U.response)==null?void 0:$.status)===404)&&g("Server connection failed. Using offline mode."),await new Promise(ce=>setTimeout(ce,500));const X={id:Date.now()+1,type:"assistant",content:re(ie),timestamp:new Date,confidence:"medium",cardType:ne(ie),suggestions:oe(ie)};n(ce=>[...ce,X]),P.current&&X.content&&s&&V(X.content)}finally{l(!1)}},[r,x,o,f]),V=ie=>{if(P.current&&ie){m(!0);const D=ie.replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/₹/g,"rupees").replace(/[•]/g,"").replace(/\n+/g,". ").substring(0,200),$=new SpeechSynthesisUtterance(D);$.rate=.9,$.pitch=1,$.volume=.8,$.onend=()=>{m(!1)},$.onerror=()=>{m(!1)},P.current.cancel(),P.current.speak($)}},z=v.useCallback(()=>{if(I.current&&!c)try{I.current.continuous!==void 0&&I.current.abort(),setTimeout(()=>{I.current.start()},100),setTimeout(()=>{if(I.current&&c)try{I.current.stop()}catch{console.log("Auto-stop recognition")}},1e4)}catch(ie){console.error("Failed to start voice recognition:",ie),g("Voice recognition failed. Please try again."),h(!1)}},[c]),q=v.useCallback(()=>{if(I.current){try{I.current.stop()}catch{console.log("Recognition already stopped")}h(!1)}},[]),Y=v.useCallback(async ie=>{try{const D=L.current.processCommand(ie);console.log("Voice command processed:",D);const $={navigate:e,sendMessage:async X=>{await A(X)},setMessages:n,setError:g},U=await L.current.executeCommand(D,$);if(console.log("Command execution result:",U),U.success&&U.message){const X={id:Date.now(),type:"assistant",content:`🎤 **Voice Command Executed**

${U.message}`,timestamp:new Date,cardType:"text",suggestions:["Continue with voice","Type a message","Clear chat"]};n(ce=>[...ce,X])}}catch(D){console.error("Voice command processing error:",D),g("Failed to process voice command. Please try again.")}},[e,A,n,g]),te=v.useCallback(()=>{n([]),g(null),O()},[]),ne=ie=>{const D=ie.toLowerCase();return D.includes("price")||D.includes("quote")||D.includes("₹")?"stock-price":D.includes("chart")||D.includes("graph")||D.includes("technical")?"chart":D.includes("company")||D.includes("about")||D.includes("info")?"company-info":D.includes("buy")||D.includes("sell")||D.includes("recommend")?"recommendation":"text"},re=ie=>{const D=ie.toLowerCase();return D.includes("reliance")||D.includes("ril")?`**Reliance Industries (RELIANCE)**

**Current Price:** ₹2,465 *(demo data)*

**Company Overview:**
Reliance Industries is one of India's largest conglomerates with diversified business interests across multiple sectors.

**Key Business Segments:**
• Petrochemicals and Oil Refining
• Telecommunications (Jio)
• Retail (Reliance Retail)
• Digital Services

**Investment Highlights:**
• Strong market position in each segment
• Consistent dividend history
• Blue-chip investment with long-term growth potential
• Strategic focus on digital transformation

Would you like to explore its **fundamentals** or **recent performance** in detail?`:D.includes("tcs")?`**Tata Consultancy Services (TCS)**

**Current Price:** ₹3,185 *(demo data)*

**Company Profile:**
India's largest IT services company with a strong global presence and reputation for excellence.

**Key Strengths:**
• Market leader in IT services and consulting
• Consistent revenue growth and profitability
• Strong client relationships across industries
• Robust dividend track record

**Investment Appeal:**
• Stability in volatile markets
• Growth prospects in digital transformation
• Strong balance sheet and cash flows
• Popular choice for long-term investors`:D.includes("nifty")||D.includes("sensex")?`**Market Indices Overview**

**Current Levels:** *(demo data)*
• NIFTY 50: ~19,750
• SENSEX: ~66,500

**Market Performance:**
Both indices have shown **resilience** despite global uncertainties and continue to attract investor interest.

**Key Driving Sectors:**
• Banking and Financial Services
• Information Technology
• Consumer Goods and FMCG

**Market Sentiment:**
*Cautiously optimistic* with focus on domestic consumption and policy support measures.`:D.includes("portfolio")?`**Portfolio Analysis** *(demo data)*

**Current Allocation:**
• Large Cap: 40%
• Mid Cap: 30%
• Small Cap: 20%
• Bonds: 10%

**Portfolio Metrics:**
• **Total Value:** ₹2,84,765
• **Overall Gain:** +12.5%
• **Risk Level:** Moderate

**Recommendations:**
1. **Rebalance** if any sector exceeds 25% allocation
2. **Review** small cap exposure for risk management
3. **Consider** adding defensive stocks for stability

Would you like **specific recommendations** for optimization?`:D.includes("news")||D.includes("market")?`**Today's Market Highlights** *(demo data)*

**Sector Performance:**
• **Banking:** Rally on RBI policy optimism
• **IT Sector:** Facing headwinds from global slowdown
• **Auto Sector:** Mixed signals with EV adoption trends

**Investment Flows:**
• **FII Activity:** Cautious approach continues
• **DII Buying:** Strong domestic institutional support

**Overall Trend:**
Market sentiment remains **cautiously optimistic** with focus on domestic growth drivers.`:D.includes("buy")||D.includes("sell")?`**Trading Recommendations** *(demo analysis)*

**BUY Recommendations:**
• **Banking Stocks** - Policy support and credit growth
• **Infrastructure** - Government capex focus

**HOLD Positions:**
• **IT Stocks** - Long-term digital transformation play
• **FMCG** - Defensive characteristics

**SELL/REDUCE:**
• **Overvalued Small Caps** - Risk management
• **Cyclical Stocks** - Economic uncertainty

**Important Disclaimer:**
*Always conduct your own research and consider your risk tolerance. This is for educational purposes only.*`:D.includes("gainers")||D.includes("top")?`**Market Movers Today** *(demo data)*

**Top Gainers:**
• HDFCBANK: +3.2%
• ICICIBANK: +2.8%
• BAJFINANCE: +2.5%

**Top Losers:**
• TECHM: -2.1%
• WIPRO: -1.8%
• INFY: -1.2%

**Sector Trends:**
• **Banking Sector:** Outperforming on policy optimism
• **IT Sector:** Under pressure from global concerns

The **banking rally** is driving overall market sentiment today.`:`**Welcome to Saytrix!** 🚀

I'm your AI-powered trading assistant here to help you navigate the Indian stock markets with confidence.

What I Can Help You With:
• Stock Analysis - Detailed company research and insights
• Market Insights - Real-time market trends and news
• Portfolio Management - Optimization and risk analysis
• Trading Strategies - Data-driven investment recommendations

Quick Start Commands:
• "Tell me about Reliance"
• "Show me top gainers today"
• "Analyze my portfolio"
• "What's the market sentiment?"

Note: Currently displaying demo data for illustration purposes.

Ready to start your trading journey? Ask me anything about the markets!`},oe=ie=>{const D=ie.toLowerCase();return D.includes("reliance")||D.includes("ril")?["Tell me about TCS","Show HDFC Bank info","Compare IT stocks"]:D.includes("nifty")||D.includes("sensex")?["Top gainers today","Banking stocks","IT sector performance"]:D.includes("portfolio")?["Risk analysis","Sector allocation","Diversification tips"]:["Market overview","Top stocks","Sector analysis","Trading tips"]};return{messages:t,inputText:r,isProcessing:o,isListening:c,isSpeaking:d,error:p,confidence:f,onlyIndianStocks:S,aiMode:C,messagesEndRef:T,setInputText:a,setMessages:n,sendMessage:A,startListening:z,stopListening:q,clearChat:te,setOnlyIndianStocks:k,setAiMode:N,setError:g}},Ix=({message:s,onSuggestionClick:e,onBuyClick:t,onSellClick:n,onAlertDismiss:r})=>{const{cardType:a,content:o,stockData:l,suggestions:c}=s,h=()=>{var f,y,S,k,C,N;if(!l)return d();const g=l.change>=0;return i.jsxs(F.div,{className:"saytrix-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[i.jsxs("div",{className:"card-header",children:[i.jsxs("div",{className:"stock-symbol",children:[i.jsx(rt,{className:"symbol-icon"}),i.jsx("span",{children:l.symbol})]}),i.jsxs("div",{className:`stock-change ${g?"positive":"negative"}`,children:[g?i.jsx(Pe,{}):i.jsx($e,{}),(f=l.changesPercentage)==null?void 0:f.toFixed(2),"%"]})]}),i.jsxs("div",{className:"stock-price",children:[i.jsx("span",{className:"currency",children:"₹"}),i.jsx("span",{className:"price",children:(y=l.price)==null?void 0:y.toFixed(2)})]}),i.jsxs("div",{className:"stock-details",children:[i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"label",children:"Change"}),i.jsxs("span",{className:`value ${g?"positive":"negative"}`,children:[g?"+":"",(S=l.change)==null?void 0:S.toFixed(2)]})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"label",children:"Volume"}),i.jsx("span",{className:"value",children:(k=l.volume)==null?void 0:k.toLocaleString()})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"label",children:"Day High"}),i.jsx("span",{className:"value",children:(C=l.dayHigh)==null?void 0:C.toFixed(2)})]}),i.jsxs("div",{className:"detail-item",children:[i.jsx("span",{className:"label",children:"Day Low"}),i.jsx("span",{className:"value",children:(N=l.dayLow)==null?void 0:N.toFixed(2)})]})]}),i.jsxs("div",{className:"card-actions",children:[i.jsxs("button",{className:"action-btn buy-btn",onClick:()=>t==null?void 0:t(l),children:[i.jsx(ui,{}),"Buy"]}),i.jsxs("button",{className:"action-btn sell-btn",onClick:()=>n==null?void 0:n(l),children:[i.jsx(di,{}),"Sell"]})]}),c&&b()]})},d=()=>i.jsxs(F.div,{className:"saytrix-card text-card",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[i.jsx("div",{className:"text-content",children:m(o)}),c&&b()]}),m=g=>g?g.split(`
`).map((f,y)=>f.trim()===""?i.jsx("br",{},y):f.startsWith("**")&&f.endsWith("**")?i.jsx("div",{className:"text-header",children:f.replace(/\*\*/g,"")},y):f.startsWith("•")||f.startsWith("-")?i.jsxs("div",{className:"text-bullet",children:[i.jsx("span",{className:"bullet-icon",children:"•"}),i.jsx("span",{className:"bullet-text",children:f.substring(1).trim()})]},y):i.jsx("div",{className:"text-line",children:x(f)},y)):null,x=g=>g.split(/\*\*(.*?)\*\*/g).map((f,y)=>y%2===1?i.jsx("strong",{children:f},y):f),b=()=>!c||c.length===0?null:i.jsxs("div",{className:"text-suggestions",children:[i.jsx("div",{className:"suggestions-title",children:"Quick Actions"}),i.jsx("div",{className:"suggestion-chips",children:c.map((g,f)=>i.jsx("button",{className:"suggestion-chip",onClick:()=>e==null?void 0:e(g),children:g},f))})]}),p=()=>i.jsxs(F.div,{className:"saytrix-card",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},children:[i.jsx("div",{className:"card-header",children:i.jsxs("div",{className:"company-name",children:[i.jsx(kt,{className:"company-icon"}),i.jsx("span",{children:"Welcome to Saytrix"})]})}),i.jsx("div",{className:"text-content",children:m(o)}),c&&b()]});switch(a){case"stock-price":case"stock_data":return h();case"welcome":return p();case"error":return i.jsxs(F.div,{className:"saytrix-card",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},children:[i.jsx("div",{className:"card-header",children:i.jsxs("div",{className:"company-name",children:[i.jsx(qt,{className:"company-icon",style:{color:"#EF4444"}}),i.jsx("span",{children:"Error"})]})}),i.jsx("div",{className:"text-content",children:m(o)})]});default:return d()}},_x=()=>{const{isListening:s,stopListening:e,startWakeWordDetection:t}=Un(),n=()=>{s?e():t()};return i.jsxs("button",{className:`audio-toggle-btn ${s?"enabled":"disabled"}`,onClick:n,title:s?"Turn Off Microphone":"Turn On Microphone",style:{marginRight:"1rem"},children:[s?i.jsx(Us,{}):i.jsx(Ba,{}),i.jsx("span",{children:s?"Mic On":"Mic Off"})]})},Lx=({user:s,theme:e})=>{const[t,n]=v.useState(!1),[r]=v.useState(["Show me NIFTY performance","What are today's top gainers?","Tell me about RELIANCE stock","Latest market news","Portfolio analysis"]),{messages:a,inputText:o,isProcessing:l,isListening:c,isSpeaking:h,error:d,aiMode:m,messagesEndRef:x,setInputText:b,setMessages:p,sendMessage:g,startListening:f,stopListening:y,clearChat:S,setAiMode:k,setError:C}=Ex(t),N=v.useCallback(()=>{if(c)y();else{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){C("Voice input is not supported in this browser.");return}navigator.mediaDevices.getUserMedia({audio:!0}).then(()=>{f()}).catch(A=>{console.error("Microphone access denied:",A),C("Microphone access is required for voice input. Please allow microphone access and try again.")})}},[c,f,y,C]),T=v.useCallback(()=>{g()},[g]),I=v.useCallback(A=>{A.key==="Enter"&&!A.shiftKey?(A.preventDefault(),T()):A.key==="Escape"?(b(""),C(null)):A.ctrlKey&&A.key==="k"?(A.preventDefault(),S()):A.ctrlKey&&A.key==="m"&&(A.preventDefault(),N())},[T,b,C,S,N]),P=v.useCallback(A=>{b(A)},[b]),L=v.useCallback(A=>{b(A),setTimeout(()=>{g(A)},100)},[b,g]),M=v.useCallback(A=>{k(A);const V={id:Date.now(),type:"assistant",content:`🤖 **AI Mode Changed**

Switched to **${A.charAt(0).toUpperCase()+A.slice(1)} Mode**

${A==="expert"?"🎯 Expert mode provides detailed technical analysis and advanced trading insights.":"😊 Casual mode offers friendly, easy-to-understand market information."}`,timestamp:new Date,cardType:"text",suggestions:A==="expert"?["Technical analysis","Market trends","Risk assessment"]:["Stock basics","Simple explanations","Market overview"]};p(z=>[...z,V])},[k,p]),O=v.useCallback(A=>{if(!A)return;const V={symbol:A.symbol,type:"buy",quantity:1,price:A.price,orderType:"market"},z={id:Date.now(),type:"user",content:`Buy ${A.symbol} at ₹${A.price}`,timestamp:new Date,confidence:"high"},q={id:Date.now()+1,type:"assistant",content:`💰 **Buy Order Initiated**

**Stock:** ${A.symbol}
**Price:** ₹${A.price}
**Quantity:** 1 share

✅ Order would be placed in a real trading environment.`,timestamp:new Date,cardType:"text",suggestions:["Show portfolio","Check order status","Buy more stocks"]};p(Y=>[...Y,z,q]),console.log("Buy order:",V)},[p]),B=v.useCallback(A=>{if(!A)return;const V={symbol:A.symbol,type:"sell",quantity:1,price:A.price,orderType:"market"},z={id:Date.now(),type:"user",content:`Sell ${A.symbol} at ₹${A.price}`,timestamp:new Date,confidence:"high"},q={id:Date.now()+1,type:"assistant",content:`💸 **Sell Order Initiated**

**Stock:** ${A.symbol}
**Price:** ₹${A.price}
**Quantity:** 1 share

✅ Order would be placed in a real trading environment.`,timestamp:new Date,cardType:"text",suggestions:["Show portfolio","Check order status","Find more stocks"]};p(Y=>[...Y,z,q]),console.log("Sell order:",V)},[p]),R=v.useCallback(A=>{C(null),console.log("Alert dismissed:",A)},[C]);return i.jsxs("div",{className:"saytrix-page",children:[i.jsxs("div",{className:"saytrix-navbar",children:[i.jsx("div",{className:"navbar-left",children:i.jsxs("div",{className:"tradebro-brand",children:[i.jsx(hs,{className:"brand-icon"}),i.jsx("span",{className:"brand-text",children:"TradeBro"})]})}),i.jsx("div",{className:"navbar-center",children:i.jsxs("div",{className:"ai-mode-toggle",children:[i.jsx("button",{className:`mode-btn ${m==="casual"?"active":""}`,onClick:()=>M("casual"),children:"Casual"}),i.jsx("button",{className:`mode-btn ${m==="expert"?"active":""}`,onClick:()=>M("expert"),children:"Expert"})]})}),i.jsxs("div",{className:"navbar-right",children:[i.jsx(_x,{}),i.jsxs("button",{className:"profile-btn",onClick:S,title:"Clear Chat",style:{marginRight:"1rem"},children:[i.jsx(Ue,{}),i.jsx("span",{children:"Clear"})]}),i.jsxs("button",{className:"profile-btn",children:[i.jsx(ht,{}),i.jsx("span",{children:(s==null?void 0:s.name)||"User"})]})]})]}),i.jsxs("div",{className:"saytrix-container",children:[i.jsx("div",{className:"saytrix-layout",children:i.jsxs("div",{className:"saytrix-main",children:[a.length<=1&&i.jsxs(F.div,{className:"recent-questions",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[i.jsx("h3",{children:"Recent Questions"}),i.jsx("div",{className:"question-chips",children:r.map((A,V)=>i.jsx(F.button,{className:"question-chip",onClick:()=>L(A),whileHover:{scale:1.02},whileTap:{scale:.98},children:A},V))})]}),i.jsxs("div",{className:"messages-container",children:[i.jsx(Se,{children:a.map(A=>i.jsxs(F.div,{className:`message-wrapper ${A.type}`,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[i.jsx("div",{className:"message-avatar",children:A.type==="user"?i.jsx(ht,{size:20}):i.jsx(ri,{size:20})}),i.jsx("div",{className:"message-content",children:A.type==="user"?i.jsxs("div",{className:"user-message",children:[i.jsx("p",{children:A.content}),i.jsxs("div",{className:"message-meta",children:[i.jsx("span",{className:"message-time",children:A.timestamp.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})}),A.confidence&&i.jsxs("span",{className:`confidence-badge ${A.confidence}`,children:[A.confidence," confidence"]})]})]}):i.jsx(Ix,{message:A,onSuggestionClick:P,onBuyClick:O,onSellClick:B,onAlertDismiss:R})})]},A.id))}),l&&i.jsxs(F.div,{className:"message-wrapper assistant processing",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[i.jsx("div",{className:"message-avatar",children:i.jsx(ri,{size:20})}),i.jsx("div",{className:"message-content",children:i.jsxs("div",{className:"typing-indicator",children:[i.jsx("span",{}),i.jsx("span",{}),i.jsx("span",{})]})})]}),i.jsx("div",{ref:x})]}),d&&i.jsxs(F.div,{className:"error-banner",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},children:[i.jsx(qt,{size:16}),i.jsx("span",{children:d}),i.jsx("button",{onClick:()=>C(null),children:i.jsx(We,{size:16})})]})]})}),i.jsxs(F.div,{className:"floating-input",initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:[i.jsxs("div",{className:"input-container",children:[i.jsx("button",{className:`voice-btn ${c?"listening":""}`,onClick:N,title:c?"Stop listening":"Start voice input",children:i.jsx(Se,{mode:"wait",children:c?i.jsx(F.div,{initial:{scale:1},animate:{scale:[1,1.2,1]},exit:{scale:1},transition:{duration:1,repeat:1/0},children:i.jsx(Us,{size:20})},"listening"):i.jsx(F.div,{initial:{scale:1},animate:{scale:1},exit:{scale:1},children:i.jsx(Ba,{size:20})},"not-listening")})}),i.jsx("input",{type:"text",className:"message-input",placeholder:"Ask Saytrix about stocks, portfolio, or market trends... (Ctrl+M for voice, Ctrl+K to clear)",value:o,onChange:A=>b(A.target.value),onKeyDown:I,autoFocus:!0}),i.jsx("button",{className:"send-btn",onClick:T,disabled:!o.trim()||l,title:"Send message",children:l?i.jsx(Ue,{size:20,className:"animate-spin"}):i.jsx(Fc,{size:20})})]}),i.jsxs(Se,{children:[c&&i.jsxs(F.div,{className:"voice-indicator listening",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.2},children:[i.jsxs("div",{className:"listening-animation",children:[i.jsx("div",{className:"wave"}),i.jsx("div",{className:"wave"}),i.jsx("div",{className:"wave"})]}),i.jsx("span",{children:"Listening... Speak now"})]}),h&&i.jsxs(F.div,{className:"voice-indicator speaking",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.2},children:[i.jsx($c,{size:16}),i.jsx("span",{children:"Saytrix is speaking..."})]})]})]})]})]})},Mx=()=>{const{symbol:s}=wm(),e=Ve(),{portfolioData:t,buyStock:n,isLoading:r}=ft(),{user:a}=Bt(),[o,l]=v.useState(null),[c,h]=v.useState(!0),[d,m]=v.useState(null),[x,b]=v.useState(1),[p,g]=v.useState(!1),[f,y]=v.useState(0),[S,k]=v.useState(!1),[C,N]=v.useState(!1),[T,I]=v.useState(!1);v.useEffect(()=>{s&&P()},[s]);const P=async()=>{try{h(!0),m(null),console.log("📊 Fetching stock data for:",s);const z={RELIANCE:{name:"Reliance Industries Ltd",price:2847.65,sector:"Energy",industry:"Oil & Gas",description:"Reliance Industries Limited is an Indian multinational conglomerate, headquartered in Mumbai. It has diverse businesses including energy, petrochemicals, natural gas, retail, telecommunications, mass media, and textiles."},TCS:{name:"Tata Consultancy Services",price:4125.8,sector:"Information Technology",industry:"IT Services",description:"Tata Consultancy Services is an Indian multinational information technology services and consulting company headquartered in Mumbai. It is a part of the Tata Group and operates in 149 locations across 46 countries."},HDFCBANK:{name:"HDFC Bank Limited",price:1687.9,sector:"Financial Services",industry:"Banking",description:"HDFC Bank Limited is an Indian banking and financial services company headquartered in Mumbai. It is one of the largest private sector banks in India by assets and market capitalization."},INFY:{name:"Infosys Limited",price:1842.35,sector:"Information Technology",industry:"IT Services",description:"Infosys Limited is an Indian multinational information technology company that provides business consulting, information technology and outsourcing services."},HINDUNILVR:{name:"Hindustan Unilever Ltd",price:2456.7,sector:"FMCG",industry:"Consumer Goods",description:"Hindustan Unilever Limited is an Indian consumer goods company headquartered in Mumbai. It is a subsidiary of the British company Unilever."},ICICIBANK:{name:"ICICI Bank Limited",price:1287.45,sector:"Financial Services",industry:"Banking",description:"ICICI Bank Limited is an Indian multinational bank and financial services company headquartered in Mumbai with its registered office in Vadodara."}}[s.toUpperCase()]||{name:`${s.toUpperCase()} Corporation`,price:1e3+Math.random()*2e3,sector:"Technology",industry:"Software",description:`${s.toUpperCase()} Corporation is a leading company in its sector with strong fundamentals and growth prospects.`},q=z.price,Y=(Math.random()-.5)*q*.05,te=Y/q*100,ne={symbol:s.toUpperCase(),name:z.name,price:q,change:Y,changePercent:te,volume:Math.floor(Math.random()*2e6)+5e5,marketCap:Math.floor(q*1e9+Math.random()*5e11),pe:Math.floor(Math.random()*25)+15,high52w:q*1.3,low52w:q*.7,dayHigh:q*1.02,dayLow:q*.98,avgVolume:Math.floor(Math.random()*1e6)+3e5,beta:.8+Math.random()*.8,eps:q*.05,dividend:Math.random()*3+1,sector:z.sector,industry:z.industry,description:z.description,lastUpdated:new Date().toISOString()};console.log("✅ Stock data loaded:",ne),l(ne)}catch(V){console.error("❌ Error fetching stock data:",V),m("Failed to fetch stock data")}finally{h(!1)}},L=async()=>{I(!0),await P(),I(!1),K.success("Stock data refreshed")},M=V=>{if(!R||S)return;V.preventDefault(),V.stopPropagation();const z=V.currentTarget.closest(".slide-to-buy");if(!z)return;const q=z.getBoundingClientRect(),Y=52,te=q.width-Y-8;let ne=!0;const re=ie=>{if(!ne)return;ie.preventDefault();const $=(ie.touches?ie.touches[0].clientX:ie.clientX)-q.left-Y/2,U=Math.min(Math.max($/te*100,0),100);y(U)},oe=async()=>{ne=!1,f>80?(y(100),await O()):y(0),document.removeEventListener("mousemove",re,{passive:!1}),document.removeEventListener("mouseup",oe),document.removeEventListener("touchmove",re,{passive:!1}),document.removeEventListener("touchend",oe)};document.addEventListener("mousemove",re,{passive:!1}),document.addEventListener("mouseup",oe),document.addEventListener("touchmove",re,{passive:!1}),document.addEventListener("touchend",oe)},O=async()=>{if(!(!o||!x||S)){k(!0);try{const V=await n(o.symbol,x,o.price,o);V.success?(K.success(`Successfully bought ${x} shares of ${o.symbol}!`),y(100),setTimeout(()=>{e("/portfolio",{state:{purchasedStock:{symbol:o.symbol,name:o.name,quantity:x,price:o.price,totalCost:x*o.price},showPurchaseSuccess:!0}})},1500)):(K.error(V.message||"Failed to buy stock"),y(0))}catch(V){console.error("Error buying stock:",V),K.error("Failed to buy stock"),y(0)}finally{k(!1)}}};if(c)return i.jsxs("div",{className:"stock-detail-loading",children:[i.jsx("div",{className:"loading-spinner"}),i.jsx("p",{children:"Loading stock details..."})]});if(d||!o)return i.jsxs("div",{className:"stock-detail-error",children:[i.jsx(et,{size:48}),i.jsx("h2",{children:"Error Loading Stock"}),i.jsx("p",{children:d||"Stock not found"}),i.jsx("button",{onClick:()=>e(-1),className:"back-btn",children:"Go Back"})]});const B=x*o.price,R=t.availableCash>=B,A=o.change>=0;return i.jsxs("div",{className:"stock-detail-page",children:[i.jsxs("div",{className:"stock-detail-header",children:[i.jsx("button",{onClick:()=>e(-1),className:"back-button",children:i.jsx(En,{})}),i.jsxs("div",{className:"header-info",children:[i.jsx("h1",{children:o.symbol}),i.jsx("p",{children:o.name})]}),i.jsxs("div",{className:"header-actions",children:[i.jsx("button",{onClick:L,className:`refresh-btn ${T?"spinning":""}`,disabled:T,children:i.jsx(Ue,{})}),i.jsx(Pi,{stockData:o,size:"small",variant:"icon",showText:!1})]})]}),i.jsxs("div",{className:"price-section",children:[i.jsxs("div",{className:"current-price",children:[i.jsx("span",{className:"price-value",children:Ee(o.price)}),i.jsxs("div",{className:`price-change ${A?"positive":"negative"}`,children:[A?i.jsx(Pe,{}):i.jsx($e,{}),i.jsxs("span",{children:[Ee(o.change)," (",o.changePercent.toFixed(2),"%)"]})]})]}),i.jsxs("div",{className:"price-range",children:[i.jsxs("div",{className:"range-item",children:[i.jsx("span",{className:"label",children:"Day Range"}),i.jsxs("span",{className:"value",children:[Ee(o.dayLow)," - ",Ee(o.dayHigh)]})]}),i.jsxs("div",{className:"range-item",children:[i.jsx("span",{className:"label",children:"52W Range"}),i.jsxs("span",{className:"value",children:[Ee(o.low52w)," - ",Ee(o.high52w)]})]})]})]}),i.jsxs("div",{className:"key-stats",children:[i.jsxs("div",{className:"stat-item",children:[i.jsx(vt,{className:"stat-icon"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("span",{className:"stat-label",children:"Volume"}),i.jsx("span",{className:"stat-value",children:ba(o.volume)})]})]}),i.jsxs("div",{className:"stat-item",children:[i.jsx(fi,{className:"stat-icon"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("span",{className:"stat-label",children:"Market Cap"}),i.jsx("span",{className:"stat-value",children:Ee(o.marketCap)})]})]}),i.jsxs("div",{className:"stat-item",children:[i.jsx(rt,{className:"stat-icon"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("span",{className:"stat-label",children:"P/E Ratio"}),i.jsx("span",{className:"stat-value",children:o.pe})]})]}),i.jsxs("div",{className:"stat-item",children:[i.jsx(Je,{className:"stat-icon"}),i.jsxs("div",{className:"stat-info",children:[i.jsx("span",{className:"stat-label",children:"EPS"}),i.jsx("span",{className:"stat-value",children:Ee(o.eps)})]})]})]}),i.jsxs("div",{className:"trading-section",children:[i.jsxs("h3",{children:["Buy ",o.symbol]}),i.jsxs("div",{className:"quantity-section",children:[i.jsx("label",{children:"Quantity"}),i.jsxs("div",{className:"quantity-controls",children:[i.jsx("button",{onClick:()=>b(Math.max(1,x-1)),className:"quantity-btn",children:"-"}),i.jsx("input",{type:"number",value:x,onChange:V=>b(Math.max(1,parseInt(V.target.value)||1)),className:"quantity-input",min:"1"}),i.jsx("button",{onClick:()=>b(x+1),className:"quantity-btn",children:"+"})]})]}),i.jsxs("div",{className:"order-summary",children:[i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Price per share"}),i.jsx("span",{children:Ee(o.price)})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Quantity"}),i.jsxs("span",{children:[x," shares"]})]}),i.jsxs("div",{className:"summary-row total",children:[i.jsx("span",{children:"Total Cost"}),i.jsx("span",{children:Ee(B)})]}),i.jsxs("div",{className:"summary-row",children:[i.jsx("span",{children:"Available Cash"}),i.jsx("span",{className:R?"positive":"negative",children:Ee(t.availableCash)})]})]}),i.jsxs("div",{className:"slide-to-buy-container",children:[!R&&i.jsxs("div",{className:"insufficient-funds-warning",children:[i.jsx(et,{}),i.jsx("span",{children:"Insufficient funds"})]}),i.jsxs("div",{className:`slide-to-buy ${R?"":"disabled"} ${S?"processing":""}`,children:[i.jsx("div",{className:"slide-track",style:{background:`linear-gradient(to right, #10B981 ${f}%, #E5E7EB ${f}%)`},children:i.jsx(F.div,{className:"slide-button",style:{left:`${Math.min(f,85)}%`},onMouseDown:R?M:void 0,onTouchStart:R?M:void 0,whileHover:R?{scale:1.05}:{},whileTap:R?{scale:.95}:{},animate:{left:`${Math.min(f,85)}%`},transition:{type:f===0?"spring":"tween",stiffness:300,damping:30,duration:f===0?.5:.1},children:S?i.jsx("div",{className:"loading-spinner small"}):f>80?i.jsx(kt,{}):i.jsx(lt,{})})}),i.jsx("span",{className:"slide-text",children:S?"Processing...":f>80?"Release to Buy!":"Slide to Buy"})]})]})]}),i.jsxs("div",{className:"company-info",children:[i.jsxs("h3",{children:["About ",o.name]}),i.jsxs("div",{className:"company-details",children:[i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"label",children:"Sector"}),i.jsx("span",{className:"value",children:o.sector})]}),i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"label",children:"Industry"}),i.jsx("span",{className:"value",children:o.industry})]}),i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"label",children:"Beta"}),i.jsx("span",{className:"value",children:o.beta})]}),i.jsxs("div",{className:"detail-row",children:[i.jsx("span",{className:"label",children:"Dividend Yield"}),i.jsxs("span",{className:"value",children:[o.dividend,"%"]})]})]}),i.jsx("p",{className:"company-description",children:o.description})]})]})},Rx=()=>i.jsx("div",{className:"legal-page",children:i.jsxs("div",{className:"legal-container",children:[i.jsxs(F.div,{className:"legal-header",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[i.jsxs(be,{to:"/login",className:"back-link",children:[i.jsx(En,{size:20}),"Back to Login"]}),i.jsxs("div",{className:"legal-title-section",children:[i.jsx("div",{className:"legal-icon",children:i.jsx(Ft,{size:32})}),i.jsx("h1",{className:"legal-title",children:"Terms of Service"}),i.jsx("p",{className:"legal-subtitle",children:"Please read these terms carefully before using TradeBro"}),i.jsxs("div",{className:"last-updated",children:["Last updated: ","December 15, 2024"]})]})]}),i.jsxs(F.div,{className:"legal-content",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:[i.jsxs("div",{className:"legal-notice",children:[i.jsx(qt,{size:20}),i.jsxs("div",{children:[i.jsx("strong",{children:"Important Notice:"})," TradeBro is a virtual trading platform for educational purposes only. No real money or actual securities are involved in any transactions."]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"1. Acceptance of Terms"}),i.jsx("p",{children:'By accessing and using TradeBro ("the Platform", "our Service"), you accept and agree to be bound by the terms and provision of this agreement. If you do not agree to abide by the above, please do not use this service.'}),i.jsx("p",{children:'These Terms of Service ("Terms") govern your use of our virtual stock trading platform operated by TradeBro ("us", "we", or "our").'})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"2. Description of Service"}),i.jsx("p",{children:"TradeBro provides:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Virtual stock trading simulation using real market data"}),i.jsx("li",{children:"Educational tools and resources for learning about stock trading"}),i.jsx("li",{children:"Portfolio management and tracking features"}),i.jsx("li",{children:"AI-powered trading assistant (Saytrix)"}),i.jsx("li",{children:"Market news and analysis"}),i.jsx("li",{children:"Social features for connecting with other virtual traders"})]}),i.jsxs("div",{className:"highlight-box",children:[i.jsx(kt,{size:16}),i.jsx("span",{children:"All trading on TradeBro is virtual and for educational purposes only."})]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"3. User Accounts and Registration"}),i.jsx("h3",{children:"3.1 Account Creation"}),i.jsx("p",{children:"To use certain features of our Service, you must register for an account. You may register using your email address or through third-party authentication providers like Google."}),i.jsx("h3",{children:"3.2 Account Security"}),i.jsx("p",{children:"You are responsible for:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Maintaining the confidentiality of your account credentials"}),i.jsx("li",{children:"All activities that occur under your account"}),i.jsx("li",{children:"Notifying us immediately of any unauthorized use"}),i.jsx("li",{children:"Ensuring your account information is accurate and up-to-date"})]}),i.jsx("h3",{children:"3.3 Account Termination"}),i.jsx("p",{children:"We reserve the right to terminate or suspend your account at any time for violations of these Terms or for any other reason at our sole discretion."})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"4. Virtual Trading Rules"}),i.jsx("h3",{children:"4.1 Virtual Currency"}),i.jsx("p",{children:"All users start with virtual currency (₹10,000 by default) for trading purposes. This virtual currency has no real-world value and cannot be exchanged for real money."}),i.jsx("h3",{children:"4.2 Market Data"}),i.jsx("p",{children:"We use real market data from various sources including Financial Modeling Prep (FMP) API. While we strive for accuracy, we do not guarantee the completeness or accuracy of market data."}),i.jsx("h3",{children:"4.3 Trading Limitations"}),i.jsx("p",{children:"Virtual trading is subject to:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Market hours and trading sessions"}),i.jsx("li",{children:"Available virtual funds in your account"}),i.jsx("li",{children:"Platform maintenance and technical limitations"}),i.jsx("li",{children:"Fair usage policies to prevent system abuse"})]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"5. Prohibited Uses"}),i.jsx("p",{children:"You may not use our Service:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"For any unlawful purpose or to solicit others to unlawful acts"}),i.jsx("li",{children:"To violate any international, federal, provincial, or state regulations, rules, laws, or local ordinances"}),i.jsx("li",{children:"To infringe upon or violate our intellectual property rights or the intellectual property rights of others"}),i.jsx("li",{children:"To harass, abuse, insult, harm, defame, slander, disparage, intimidate, or discriminate"}),i.jsx("li",{children:"To submit false or misleading information"}),i.jsx("li",{children:"To upload or transmit viruses or any other type of malicious code"}),i.jsx("li",{children:"To spam, phish, pharm, pretext, spider, crawl, or scrape"}),i.jsx("li",{children:"For any obscene or immoral purpose"}),i.jsx("li",{children:"To interfere with or circumvent the security features of the Service"})]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"6. Intellectual Property Rights"}),i.jsx("p",{children:"The Service and its original content, features, and functionality are and will remain the exclusive property of TradeBro and its licensors. The Service is protected by copyright, trademark, and other laws."}),i.jsx("p",{children:"Our trademarks and trade dress may not be used in connection with any product or service without our prior written consent."})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"7. Privacy Policy"}),i.jsx("p",{children:"Your privacy is important to us. Please review our Privacy Policy, which also governs your use of the Service, to understand our practices."}),i.jsx(be,{to:"/privacy",className:"inline-link",children:"View Privacy Policy →"})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"8. Disclaimers and Limitations"}),i.jsx("h3",{children:"8.1 Educational Purpose"}),i.jsxs("div",{className:"warning-box",children:[i.jsx(qt,{size:16}),i.jsxs("div",{children:[i.jsx("strong",{children:"Important:"})," TradeBro is for educational purposes only. Virtual trading results do not guarantee real trading success. Past performance does not indicate future results."]})]}),i.jsx("h3",{children:"8.2 No Financial Advice"}),i.jsx("p",{children:"The information provided on TradeBro is not intended as financial advice. We do not provide investment recommendations or advice. Always consult with qualified financial professionals before making real investment decisions."}),i.jsx("h3",{children:"8.3 Service Availability"}),i.jsx("p",{children:"We do not guarantee that the Service will be available at all times. We may experience hardware, software, or other problems or need to perform maintenance related to the Service."})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"9. Limitation of Liability"}),i.jsx("p",{children:"In no event shall TradeBro, nor its directors, employees, partners, agents, suppliers, or affiliates, be liable for any indirect, incidental, special, consequential, or punitive damages, including without limitation, loss of profits, data, use, goodwill, or other intangible losses, resulting from your use of the Service."})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"10. Changes to Terms"}),i.jsx("p",{children:"We reserve the right, at our sole discretion, to modify or replace these Terms at any time. If a revision is material, we will try to provide at least 30 days notice prior to any new terms taking effect."}),i.jsx("p",{children:"What constitutes a material change will be determined at our sole discretion. By continuing to access or use our Service after those revisions become effective, you agree to be bound by the revised terms."})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"11. Contact Information"}),i.jsx("p",{children:"If you have any questions about these Terms of Service, please contact us:"}),i.jsxs("div",{className:"contact-info",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Email:"})," legal@tradebro.com"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Address:"})," TradeBro Legal Department",i.jsx("br",{}),"123 Trading Street",i.jsx("br",{}),"Financial District, Mumbai 400001",i.jsx("br",{}),"India"]})]})]}),i.jsxs("div",{className:"legal-footer",children:[i.jsx("p",{children:"By using TradeBro, you acknowledge that you have read, understood, and agree to be bound by these Terms of Service."}),i.jsxs("div",{className:"legal-actions",children:[i.jsx(be,{to:"/privacy",className:"btn btn-outline",children:"Privacy Policy"}),i.jsx(be,{to:"/login",className:"btn btn-primary",children:"Back to Login"})]})]})]})]})}),Ax=()=>i.jsx("div",{className:"legal-page",children:i.jsxs("div",{className:"legal-container",children:[i.jsxs(F.div,{className:"legal-header",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[i.jsxs(be,{to:"/login",className:"back-link",children:[i.jsx(En,{size:20}),"Back to Login"]}),i.jsxs("div",{className:"legal-title-section",children:[i.jsx("div",{className:"legal-icon",children:i.jsx(mi,{size:32})}),i.jsx("h1",{className:"legal-title",children:"Privacy Policy"}),i.jsx("p",{className:"legal-subtitle",children:"How we collect, use, and protect your personal information"}),i.jsxs("div",{className:"last-updated",children:["Last updated: ","JULY 22, 2025"]})]})]}),i.jsxs(F.div,{className:"legal-content",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},children:[i.jsxs("div",{className:"privacy-commitment",children:[i.jsx(Ft,{size:20}),i.jsxs("div",{children:[i.jsx("strong",{children:"Our Commitment:"})," We are committed to protecting your privacy and ensuring the security of your personal information. This Privacy Policy explains how we collect, use, and safeguard your data."]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsxs("h2",{children:[i.jsx(bf,{size:20})," 1. Information We Collect"]}),i.jsx("h3",{children:"1.1 Personal Information"}),i.jsx("p",{children:"When you register for TradeBro, we may collect:"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Account Information:"})," Name, email address, username"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Profile Information:"})," Profile picture, bio, trading preferences"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Authentication Data:"})," Password (encrypted), OAuth tokens from third-party providers"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Contact Information:"})," Email address for communications"]})]}),i.jsx("h3",{children:"1.2 Trading and Usage Data"}),i.jsx("p",{children:"We collect information about your use of our platform:"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Virtual Trading Activity:"})," Buy/sell orders, portfolio performance, trading history"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Platform Usage:"})," Pages visited, features used, time spent on platform"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Device Information:"})," IP address, browser type, device type, operating system"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Preferences:"})," Theme settings, notification preferences, dashboard customizations"]})]}),i.jsx("h3",{children:"1.3 Automatically Collected Information"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Cookies and Tracking:"})," Session cookies, preference cookies, analytics cookies"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Log Data:"})," Server logs, error logs, access logs"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Analytics Data:"})," User behavior, feature usage, performance metrics"]})]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsxs("h2",{children:[i.jsx(fs,{size:20})," 2. How We Use Your Information"]}),i.jsx("h3",{children:"2.1 Service Provision"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Create and manage your account"}),i.jsx("li",{children:"Process virtual trading transactions"}),i.jsx("li",{children:"Provide personalized trading experience"}),i.jsx("li",{children:"Display portfolio and performance data"}),i.jsx("li",{children:"Enable social features and leaderboards"})]}),i.jsx("h3",{children:"2.2 Communication"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Send account-related notifications"}),i.jsx("li",{children:"Provide customer support"}),i.jsx("li",{children:"Send educational content and market updates"}),i.jsx("li",{children:"Notify about platform updates and new features"})]}),i.jsx("h3",{children:"2.3 Platform Improvement"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Analyze usage patterns to improve our service"}),i.jsx("li",{children:"Develop new features and functionality"}),i.jsx("li",{children:"Ensure platform security and prevent fraud"}),i.jsx("li",{children:"Conduct research and analytics"})]}),i.jsx("h3",{children:"2.4 Legal and Safety"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Comply with legal obligations"}),i.jsx("li",{children:"Protect against fraud and abuse"}),i.jsx("li",{children:"Enforce our Terms of Service"}),i.jsx("li",{children:"Respond to legal requests"})]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsxs("h2",{children:[i.jsx(Dc,{size:20})," 3. Information Sharing and Disclosure"]}),i.jsx("h3",{children:"3.1 We Do Not Sell Your Data"}),i.jsxs("div",{className:"highlight-box",children:[i.jsx(Ft,{size:16}),i.jsx("span",{children:"We do not sell, rent, or trade your personal information to third parties for marketing purposes."})]}),i.jsx("h3",{children:"3.2 Limited Sharing"}),i.jsx("p",{children:"We may share your information only in these circumstances:"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Service Providers:"})," Third-party services that help us operate our platform (hosting, analytics, email)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Legal Requirements:"})," When required by law, court order, or government request"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Safety and Security:"})," To protect the rights, property, or safety of TradeBro, our users, or others"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Business Transfers:"})," In connection with a merger, acquisition, or sale of assets"]})]}),i.jsx("h3",{children:"3.3 Public Information"}),i.jsx("p",{children:"Some information may be publicly visible:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Username and profile picture (if you choose to make them public)"}),i.jsx("li",{children:"Leaderboard rankings (anonymized or with consent)"}),i.jsx("li",{children:"Public posts or comments in community features"})]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"4. Data Security"}),i.jsx("h3",{children:"4.1 Security Measures"}),i.jsx("p",{children:"We implement industry-standard security measures:"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Encryption:"})," Data encrypted in transit and at rest"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Access Controls:"})," Limited access to personal data on need-to-know basis"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Secure Infrastructure:"})," Secure servers and databases"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Regular Audits:"})," Security assessments and vulnerability testing"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Authentication:"})," Secure login with optional two-factor authentication"]})]}),i.jsx("h3",{children:"4.2 Data Retention"}),i.jsx("p",{children:"We retain your information:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"As long as your account is active"}),i.jsx("li",{children:"As necessary to provide our services"}),i.jsx("li",{children:"To comply with legal obligations"}),i.jsx("li",{children:"To resolve disputes and enforce agreements"})]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"5. Your Privacy Rights"}),i.jsx("h3",{children:"5.1 Access and Control"}),i.jsx("p",{children:"You have the right to:"}),i.jsxs("ul",{children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Access:"})," Request a copy of your personal data"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Update:"})," Correct or update your information"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Delete:"})," Request deletion of your account and data"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Export:"})," Download your trading data and history"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Opt-out:"})," Unsubscribe from marketing communications"]})]}),i.jsx("h3",{children:"5.2 Cookie Preferences"}),i.jsx("p",{children:"You can control cookies through:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Browser settings to block or delete cookies"}),i.jsx("li",{children:"Our cookie preference center"}),i.jsx("li",{children:"Opting out of analytics tracking"})]}),i.jsx("h3",{children:"5.3 Account Settings"}),i.jsx("p",{children:"Manage your privacy through your account settings:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Profile visibility settings"}),i.jsx("li",{children:"Notification preferences"}),i.jsx("li",{children:"Data sharing preferences"}),i.jsx("li",{children:"Communication settings"})]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"6. Third-Party Services"}),i.jsx("h3",{children:"6.1 OAuth Providers"}),i.jsx("p",{children:"When you sign in with Google or other OAuth providers:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"We receive limited profile information (name, email, profile picture)"}),i.jsx("li",{children:"We do not access your other accounts or data"}),i.jsx("li",{children:"You can revoke access at any time through the provider's settings"})]}),i.jsx("h3",{children:"6.2 Market Data Providers"}),i.jsx("p",{children:"We use third-party APIs for market data:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Financial Modeling Prep (FMP) for stock prices and data"}),i.jsx("li",{children:"These providers may have their own privacy policies"}),i.jsx("li",{children:"We do not share your personal information with data providers"})]}),i.jsx("h3",{children:"6.3 Analytics Services"}),i.jsx("p",{children:"We may use analytics services to improve our platform:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Google Analytics (anonymized data)"}),i.jsx("li",{children:"Error tracking services"}),i.jsx("li",{children:"Performance monitoring tools"})]})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"7. Children's Privacy"}),i.jsx("p",{children:"TradeBro is not intended for children under 13 years of age. We do not knowingly collect personal information from children under 13. If you are a parent or guardian and believe your child has provided us with personal information, please contact us."}),i.jsx("p",{children:"Users between 13-18 years old should have parental consent before using our service."})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"8. International Data Transfers"}),i.jsx("p",{children:"Your information may be transferred to and processed in countries other than your own. We ensure appropriate safeguards are in place to protect your personal information in accordance with this Privacy Policy."})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"9. Changes to Privacy Policy"}),i.jsx("p",{children:"We may update this Privacy Policy from time to time. We will notify you of any material changes by:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Posting the new Privacy Policy on this page"}),i.jsx("li",{children:"Sending an email notification"}),i.jsx("li",{children:"Providing notice through our platform"})]}),i.jsx("p",{children:"Your continued use of our service after any changes constitutes acceptance of the new Privacy Policy."})]}),i.jsxs("section",{className:"legal-section",children:[i.jsx("h2",{children:"10. Contact Us"}),i.jsx("p",{children:"If you have questions about this Privacy Policy or our privacy practices, please contact us:"}),i.jsxs("div",{className:"contact-info",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Privacy Officer:"})," privacy@tradebro.com"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Data Protection:"})," dpo@tradebro.com"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"General Support:"})," support@tradebro.com"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Address:"})," TradeBro Privacy Department",i.jsx("br",{}),"123 Trading Street",i.jsx("br",{}),"Financial District, Mumbai 400001",i.jsx("br",{}),"India"]})]})]}),i.jsxs("div",{className:"legal-footer",children:[i.jsx("p",{children:"We are committed to protecting your privacy and will continue to update our practices to ensure your data remains secure."}),i.jsxs("div",{className:"legal-actions",children:[i.jsx(be,{to:"/terms",className:"btn btn-outline",children:"Terms of Service"}),i.jsx(be,{to:"/login",className:"btn btn-primary",children:"Back to Login"})]})]})]})]})}),Ox=()=>i.jsx("div",{className:"page",children:i.jsx("div",{className:"page-container",children:i.jsxs(F.div,{className:"not-found-container",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},style:{textAlign:"center",padding:"var(--space-16) var(--space-4)",minHeight:"60vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[i.jsx("div",{style:{fontSize:"6rem",marginBottom:"var(--space-6)"},children:"📈"}),i.jsx("h1",{style:{fontSize:"var(--font-size-4xl)",marginBottom:"var(--space-4)",color:"var(--text-primary)"},children:"404 - Page Not Found"}),i.jsx("p",{style:{fontSize:"var(--font-size-lg)",color:"var(--text-secondary)",marginBottom:"var(--space-8)",maxWidth:"500px"},children:"Oops! The page you're looking for doesn't exist. It might have been moved, deleted, or you entered the wrong URL."}),i.jsxs("div",{style:{display:"flex",gap:"var(--space-4)",flexWrap:"wrap",justifyContent:"center"},children:[i.jsxs(be,{to:"/",className:"btn btn-primary btn-lg",children:[i.jsx(Nf,{size:20}),"Go Home"]}),i.jsxs("button",{onClick:()=>window.history.back(),className:"btn btn-secondary btn-lg",children:[i.jsx(En,{size:20}),"Go Back"]})]})]})})}),Ze=({children:s,isAuthenticated:e,loading:t,user:n})=>{const r=$t();return t?i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"loading-spinner lg"}),i.jsx("p",{className:"loading-text",children:"Verifying authentication..."})]}):e?i.jsx(Sh,{user:n,children:s}):(localStorage.setItem("redirectAfterLogin",r.pathname),i.jsx(Et,{to:"/login",replace:!0}))},Zl=({children:s,isAuthenticated:e})=>{if(e){const t=localStorage.getItem("redirectAfterLogin");return localStorage.removeItem("redirectAfterLogin"),i.jsx(Et,{to:t||"/dashboard",replace:!0})}return s},Fx={initial:{opacity:0,y:20},in:{opacity:1,y:0},out:{opacity:0,y:-20}},Bx={type:"tween",ease:"anticipate",duration:.4},Dx=({isAuthenticated:s=!1,user:e=null,loading:t=!1,onLogin:n,onSignup:r,onLogout:a,onUpdateProfile:o,theme:l,toggleTheme:c})=>{const h=$t();return i.jsx(Se,{mode:"wait",children:i.jsx(F.div,{initial:"initial",animate:"in",exit:"out",variants:Fx,transition:Bx,children:i.jsxs(jm,{children:[i.jsx(Le,{path:"/",element:s?i.jsx(Et,{to:"/dashboard"}):i.jsx(gy,{})}),i.jsx(Le,{path:"/login",element:i.jsx(Zl,{isAuthenticated:s,children:i.jsx(yy,{onLogin:n})})}),i.jsx(Le,{path:"/signup",element:i.jsx(Zl,{isAuthenticated:s,children:i.jsx(vy,{onSignup:r})})}),i.jsx(Le,{path:"/terms",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(Rx,{})})}),i.jsx(Le,{path:"/privacy",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(Ax,{})})}),i.jsx(Le,{path:"/dashboard",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(Lh,{user:e,theme:l})})}),i.jsx(Le,{path:"/portfolio",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(zy,{user:e,theme:l})})}),i.jsx(Le,{path:"/trading",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(Vy,{user:e,theme:l})})}),i.jsx(Le,{path:"/charts",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(bx,{user:e,theme:l})})}),i.jsx(Le,{path:"/watchlist",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(wx,{user:e,theme:l})})}),i.jsx(Le,{path:"/orders",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(jx,{user:e,theme:l})})}),i.jsx(Le,{path:"/history",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(Sx,{user:e,theme:l})})}),i.jsx(Le,{path:"/news",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(Nx,{user:e,theme:l})})}),i.jsx(Le,{path:"/notifications",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(kx,{user:e,theme:l})})}),i.jsx(Le,{path:"/saytrix",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(Lx,{user:e,theme:l})})}),i.jsx(Le,{path:"/settings",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(Cx,{user:e,theme:l,toggleTheme:c,onLogout:a})})}),i.jsx(Le,{path:"/profile",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(Px,{})})}),i.jsx(Le,{path:"/stock/:symbol",element:i.jsx(Ze,{isAuthenticated:s,loading:t,user:e,children:i.jsx(Mx,{user:e,theme:l})})}),i.jsx(Le,{path:"/home",element:i.jsx(Et,{to:"/",replace:!0})}),i.jsx(Le,{path:"/app",element:i.jsx(Et,{to:"/dashboard",replace:!0})}),i.jsx(Le,{path:"/trade",element:i.jsx(Et,{to:"/trading",replace:!0})}),i.jsx(Le,{path:"/stocks",element:i.jsx(Et,{to:"/charts",replace:!0})}),i.jsx(Le,{path:"/chat",element:i.jsx(Et,{to:"/saytrix",replace:!0})}),i.jsx(Le,{path:"/ai",element:i.jsx(Et,{to:"/saytrix",replace:!0})}),i.jsx(Le,{path:"*",element:s?i.jsx(Ox,{}):i.jsx(Et,{to:"/login",replace:!0})})]})},h.pathname)})},$x=v.lazy(()=>lf(()=>import("./PerformanceMonitor-BvXMHQqb.js"),__vite__mapDeps([0,1,2,3])));function zx(){const[s,e]=v.useState(null),[t,n]=v.useState(!1),[r,a]=v.useState("light"),[o,l]=v.useState(!0);ny("App");const{isGlobalSearchOpen:c,handleGlobalSearch:h,closeGlobalSearch:d}=ty(),{orderModalState:m,closeOrderModal:x}=qa(),[b,p]=v.useState({isOpen:!1,orderData:null,stockData:null,orderSummary:null,profitLossEstimate:null,onConfirm:null,isProcessing:!1}),g=v.useCallback(P=>{p({isOpen:!0,...P,isProcessing:!1})},[]),f=v.useCallback(()=>{p(P=>P.isOpen?{...P,isOpen:!1,isProcessing:!1}:P)},[]),y=v.useRef(null),S=v.useCallback(async()=>{const P=y.current;if(P){p(L=>({...L,isProcessing:!0}));try{await P(),setTimeout(()=>{f()},2e3)}catch(L){console.error("Order confirmation failed:",L),p(M=>({...M,isProcessing:!1}))}}},[f]);v.useEffect(()=>{y.current=b.onConfirm},[b.onConfirm]),v.useEffect(()=>{const P=localStorage.getItem("token"),L=localStorage.getItem("user");if(P&&L)try{const M=JSON.parse(L);e(M),n(!0),ay.initialize()}catch(M){console.error("Error parsing user data:",M),localStorage.removeItem("token"),localStorage.removeItem("user")}l(!1)},[]),v.useEffect(()=>{const P=localStorage.getItem("theme")||"light";a(P),document.documentElement.setAttribute("data-theme",P)},[]);const k=v.useCallback(()=>{const P=r==="light"?"dark":"light";a(P),localStorage.setItem("theme",P),document.documentElement.setAttribute("data-theme",P)},[r]),C=v.useCallback((P,L)=>{localStorage.setItem("token",L),localStorage.setItem("user",JSON.stringify(P)),e(P),n(!0),K.success("Welcome back!")},[]),N=v.useCallback(()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),e(null),n(!1),K.info("Logged out successfully")},[]),T=v.useCallback((P,L)=>{localStorage.setItem("token",L),localStorage.setItem("user",JSON.stringify(P)),e(P),n(!0),K.success("Account created successfully!")},[]),I=P=>{e(P),K.success("Profile updated successfully!")};return o?i.jsxs("div",{className:"loading-container",children:[i.jsx("div",{className:"loading-spinner lg"}),i.jsx("p",{className:"loading-text",children:"Loading TradeBro..."})]}):i.jsxs("div",{className:"app",children:[i.jsx(Ux,{isAuthenticated:t,user:s,loading:o,theme:r,onLogin:C,onLogout:N,onSignup:T,onUpdateProfile:I,toggleTheme:k,isGlobalSearchOpen:c,handleGlobalSearch:h,closeGlobalSearch:d,orderModalState:m,closeOrderModal:x,handleShowConfirmation:g,confirmationModalState:b,handleCloseConfirmation:f,handleConfirmOrder:S}),i.jsx(hn,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:r,toastStyle:{background:r==="dark"?"#1F2937":"#FFFFFF",color:r==="dark"?"#F9FAFB":"#111827"}}),i.jsx(v.Suspense,{fallback:null,children:i.jsx($x,{enabled:!1})})]})}const Ux=v.memo(function({isAuthenticated:e,user:t,loading:n,theme:r,onLogin:a,onLogout:o,onSignup:l,onUpdateProfile:c,toggleTheme:h,isGlobalSearchOpen:d,handleGlobalSearch:m,closeGlobalSearch:x,orderModalState:b,closeOrderModal:p,handleShowConfirmation:g,confirmationModalState:f,handleCloseConfirmation:y,handleConfirmOrder:S}){return $t(),i.jsxs(i.Fragment,{children:[i.jsx(Mg,{}),i.jsx("main",{className:"main-content",children:i.jsx(Dx,{isAuthenticated:e,user:t,loading:n,onLogin:a,onSignup:l,onLogout:o,onUpdateProfile:c,theme:r,toggleTheme:h})}),i.jsx(Rg,{isAuthenticated:e,user:t}),i.jsx(Bg,{isOpen:d,onClose:x,onSearch:m}),i.jsx(hn,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:r==="dark"?"dark":"light",toastStyle:{background:r==="dark"?"var(--bg-secondary)":"var(--bg-elevated)",color:"var(--text-primary)",border:"1px solid var(--border-primary)",borderRadius:"var(--radius-lg)",boxShadow:"var(--shadow-lg)"}}),i.jsx(Dg,{}),i.jsx($g,{}),i.jsx(Ch,{isOpen:b.isOpen,onClose:p,stockData:b.stockData,initialOrderType:b.orderType,onOrderPlaced:p,onShowConfirmation:g}),i.jsx(ey,{isOpen:f.isOpen,onClose:y,onConfirm:S,orderData:f.orderData,stockData:f.stockData,orderSummary:f.orderSummary,profitLossEstimate:f.profitLossEstimate,isProcessing:f.isProcessing})]})});function Ye(s){return`Minified Redux error #${s}; visit https://redux.js.org/Errors?code=${s} for the full message or use the non-minified dev environment for full errors. `}var Wx=typeof Symbol=="function"&&Symbol.observable||"@@observable",ec=Wx,Ur=()=>Math.random().toString(36).substring(7).split("").join("."),Vx={INIT:`@@redux/INIT${Ur()}`,REPLACE:`@@redux/REPLACE${Ur()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Ur()}`},wn=Vx;function io(s){if(typeof s!="object"||s===null)return!1;let e=s;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(s)===e||Object.getPrototypeOf(s)===null}function no(s,e,t){if(typeof s!="function")throw new Error(Ye(2));if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(Ye(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(Ye(1));return t(no)(s,e)}let n=s,r=e,a=new Map,o=a,l=0,c=!1;function h(){o===a&&(o=new Map,a.forEach((f,y)=>{o.set(y,f)}))}function d(){if(c)throw new Error(Ye(3));return r}function m(f){if(typeof f!="function")throw new Error(Ye(4));if(c)throw new Error(Ye(5));let y=!0;h();const S=l++;return o.set(S,f),function(){if(y){if(c)throw new Error(Ye(6));y=!1,h(),o.delete(S),a=null}}}function x(f){if(!io(f))throw new Error(Ye(7));if(typeof f.type>"u")throw new Error(Ye(8));if(typeof f.type!="string")throw new Error(Ye(17));if(c)throw new Error(Ye(9));try{c=!0,r=n(r,f)}finally{c=!1}return(a=o).forEach(S=>{S()}),f}function b(f){if(typeof f!="function")throw new Error(Ye(10));n=f,x({type:wn.REPLACE})}function p(){const f=m;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(Ye(11));function S(){const C=y;C.next&&C.next(d())}return S(),{unsubscribe:f(S)}},[ec](){return this}}}return x({type:wn.INIT}),{dispatch:x,subscribe:m,getState:d,replaceReducer:b,[ec]:p}}function Hx(s){Object.keys(s).forEach(e=>{const t=s[e];if(typeof t(void 0,{type:wn.INIT})>"u")throw new Error(Ye(12));if(typeof t(void 0,{type:wn.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ye(13))})}function rd(s){const e=Object.keys(s),t={};for(let a=0;a<e.length;a++){const o=e[a];typeof s[o]=="function"&&(t[o]=s[o])}const n=Object.keys(t);let r;try{Hx(t)}catch(a){r=a}return function(o={},l){if(r)throw r;let c=!1;const h={};for(let d=0;d<n.length;d++){const m=n[d],x=t[m],b=o[m],p=x(b,l);if(typeof p>"u")throw l&&l.type,new Error(Ye(14));h[m]=p,c=c||p!==b}return c=c||n.length!==Object.keys(o).length,c?h:o}}function jn(...s){return s.length===0?e=>e:s.length===1?s[0]:s.reduce((e,t)=>(...n)=>e(t(...n)))}function Yx(...s){return e=>(t,n)=>{const r=e(t,n);let a=()=>{throw new Error(Ye(15))};const o={getState:r.getState,dispatch:(c,...h)=>a(c,...h)},l=s.map(c=>c(o));return a=jn(...l)(r.dispatch),{...r,dispatch:a}}}function qx(s){return io(s)&&"type"in s&&typeof s.type=="string"}var ad=Symbol.for("immer-nothing"),tc=Symbol.for("immer-draftable"),ut=Symbol.for("immer-state");function St(s,...e){throw new Error(`[Immer] minified error nr: ${s}. Full error at: https://bit.ly/3cXEKWf`)}var zs=Object.getPrototypeOf;function js(s){return!!s&&!!s[ut]}function Dt(s){var e;return s?od(s)||Array.isArray(s)||!!s[tc]||!!((e=s.constructor)!=null&&e[tc])||Xn(s)||Zn(s):!1}var Gx=Object.prototype.constructor.toString();function od(s){if(!s||typeof s!="object")return!1;const e=zs(s);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===Gx}function Sn(s,e){Jn(s)===0?Reflect.ownKeys(s).forEach(t=>{e(t,s[t],s)}):s.forEach((t,n)=>e(n,t,s))}function Jn(s){const e=s[ut];return e?e.type_:Array.isArray(s)?1:Xn(s)?2:Zn(s)?3:0}function Pa(s,e){return Jn(s)===2?s.has(e):Object.prototype.hasOwnProperty.call(s,e)}function ld(s,e,t){const n=Jn(s);n===2?s.set(e,t):n===3?s.add(t):s[e]=t}function Qx(s,e){return s===e?s!==0||1/s===1/e:s!==s&&e!==e}function Xn(s){return s instanceof Map}function Zn(s){return s instanceof Set}function ns(s){return s.copy_||s.base_}function Ta(s,e){if(Xn(s))return new Map(s);if(Zn(s))return new Set(s);if(Array.isArray(s))return Array.prototype.slice.call(s);const t=od(s);if(e===!0||e==="class_only"&&!t){const n=Object.getOwnPropertyDescriptors(s);delete n[ut];let r=Reflect.ownKeys(n);for(let a=0;a<r.length;a++){const o=r[a],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:s[o]})}return Object.create(zs(s),n)}else{const n=zs(s);if(n!==null&&t)return{...s};const r=Object.create(n);return Object.assign(r,s)}}function ro(s,e=!1){return er(s)||js(s)||!Dt(s)||(Jn(s)>1&&(s.set=s.add=s.clear=s.delete=Kx),Object.freeze(s),e&&Object.entries(s).forEach(([t,n])=>ro(n,!0))),s}function Kx(){St(2)}function er(s){return Object.isFrozen(s)}var Jx={};function Ss(s){const e=Jx[s];return e||St(0,s),e}var xi;function cd(){return xi}function Xx(s,e){return{drafts_:[],parent_:s,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function sc(s,e){e&&(Ss("Patches"),s.patches_=[],s.inversePatches_=[],s.patchListener_=e)}function Ea(s){Ia(s),s.drafts_.forEach(Zx),s.drafts_=null}function Ia(s){s===xi&&(xi=s.parent_)}function ic(s){return xi=Xx(xi,s)}function Zx(s){const e=s[ut];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function nc(s,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return s!==void 0&&s!==t?(t[ut].modified_&&(Ea(e),St(4)),Dt(s)&&(s=Nn(e,s),e.parent_||kn(e,s)),e.patches_&&Ss("Patches").generateReplacementPatches_(t[ut].base_,s,e.patches_,e.inversePatches_)):s=Nn(e,t,[]),Ea(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),s!==ad?s:void 0}function Nn(s,e,t){if(er(e))return e;const n=e[ut];if(!n)return Sn(e,(r,a)=>rc(s,n,e,r,a,t)),e;if(n.scope_!==s)return e;if(!n.modified_)return kn(s,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const r=n.copy_;let a=r,o=!1;n.type_===3&&(a=new Set(r),r.clear(),o=!0),Sn(a,(l,c)=>rc(s,n,r,l,c,t,o)),kn(s,r,!1),t&&s.patches_&&Ss("Patches").generatePatches_(n,t,s.patches_,s.inversePatches_)}return n.copy_}function rc(s,e,t,n,r,a,o){if(js(r)){const l=a&&e&&e.type_!==3&&!Pa(e.assigned_,n)?a.concat(n):void 0,c=Nn(s,r,l);if(ld(t,n,c),js(c))s.canAutoFreeze_=!1;else return}else o&&t.add(r);if(Dt(r)&&!er(r)){if(!s.immer_.autoFreeze_&&s.unfinalizedDrafts_<1)return;Nn(s,r),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,n)&&kn(s,r)}}function kn(s,e,t=!1){!s.parent_&&s.immer_.autoFreeze_&&s.canAutoFreeze_&&ro(e,t)}function eb(s,e){const t=Array.isArray(s),n={type_:t?1:0,scope_:e?e.scope_:cd(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:s,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=n,a=ao;t&&(r=[n],a=bi);const{revoke:o,proxy:l}=Proxy.revocable(r,a);return n.draft_=l,n.revoke_=o,l}var ao={get(s,e){if(e===ut)return s;const t=ns(s);if(!Pa(t,e))return tb(s,t,e);const n=t[e];return s.finalized_||!Dt(n)?n:n===Wr(s.base_,e)?(Vr(s),s.copy_[e]=La(n,s)):n},has(s,e){return e in ns(s)},ownKeys(s){return Reflect.ownKeys(ns(s))},set(s,e,t){const n=hd(ns(s),e);if(n!=null&&n.set)return n.set.call(s.draft_,t),!0;if(!s.modified_){const r=Wr(ns(s),e),a=r==null?void 0:r[ut];if(a&&a.base_===t)return s.copy_[e]=t,s.assigned_[e]=!1,!0;if(Qx(t,r)&&(t!==void 0||Pa(s.base_,e)))return!0;Vr(s),_a(s)}return s.copy_[e]===t&&(t!==void 0||e in s.copy_)||Number.isNaN(t)&&Number.isNaN(s.copy_[e])||(s.copy_[e]=t,s.assigned_[e]=!0),!0},deleteProperty(s,e){return Wr(s.base_,e)!==void 0||e in s.base_?(s.assigned_[e]=!1,Vr(s),_a(s)):delete s.assigned_[e],s.copy_&&delete s.copy_[e],!0},getOwnPropertyDescriptor(s,e){const t=ns(s),n=Reflect.getOwnPropertyDescriptor(t,e);return n&&{writable:!0,configurable:s.type_!==1||e!=="length",enumerable:n.enumerable,value:t[e]}},defineProperty(){St(11)},getPrototypeOf(s){return zs(s.base_)},setPrototypeOf(){St(12)}},bi={};Sn(ao,(s,e)=>{bi[s]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});bi.deleteProperty=function(s,e){return bi.set.call(this,s,e,void 0)};bi.set=function(s,e,t){return ao.set.call(this,s[0],e,t,s[0])};function Wr(s,e){const t=s[ut];return(t?ns(t):s)[e]}function tb(s,e,t){var r;const n=hd(e,t);return n?"value"in n?n.value:(r=n.get)==null?void 0:r.call(s.draft_):void 0}function hd(s,e){if(!(e in s))return;let t=zs(s);for(;t;){const n=Object.getOwnPropertyDescriptor(t,e);if(n)return n;t=zs(t)}}function _a(s){s.modified_||(s.modified_=!0,s.parent_&&_a(s.parent_))}function Vr(s){s.copy_||(s.copy_=Ta(s.base_,s.scope_.immer_.useStrictShallowCopy_))}var sb=class{constructor(s){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if(typeof e=="function"&&typeof t!="function"){const a=t;t=e;const o=this;return function(c=a,...h){return o.produce(c,d=>t.call(this,d,...h))}}typeof t!="function"&&St(6),n!==void 0&&typeof n!="function"&&St(7);let r;if(Dt(e)){const a=ic(this),o=La(e,void 0);let l=!0;try{r=t(o),l=!1}finally{l?Ea(a):Ia(a)}return sc(a,n),nc(r,a)}else if(!e||typeof e!="object"){if(r=t(e),r===void 0&&(r=e),r===ad&&(r=void 0),this.autoFreeze_&&ro(r,!0),n){const a=[],o=[];Ss("Patches").generateReplacementPatches_(e,r,a,o),n(a,o)}return r}else St(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...l)=>this.produceWithPatches(o,c=>e(c,...l));let n,r;return[this.produce(e,t,(o,l)=>{n=o,r=l}),n,r]},typeof(s==null?void 0:s.autoFreeze)=="boolean"&&this.setAutoFreeze(s.autoFreeze),typeof(s==null?void 0:s.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(s.useStrictShallowCopy)}createDraft(s){Dt(s)||St(8),js(s)&&(s=ib(s));const e=ic(this),t=La(s,void 0);return t[ut].isManual_=!0,Ia(e),t}finishDraft(s,e){const t=s&&s[ut];(!t||!t.isManual_)&&St(9);const{scope_:n}=t;return sc(n,e),nc(void 0,n)}setAutoFreeze(s){this.autoFreeze_=s}setUseStrictShallowCopy(s){this.useStrictShallowCopy_=s}applyPatches(s,e){let t;for(t=e.length-1;t>=0;t--){const r=e[t];if(r.path.length===0&&r.op==="replace"){s=r.value;break}}t>-1&&(e=e.slice(t+1));const n=Ss("Patches").applyPatches_;return js(s)?n(s,e):this.produce(s,r=>n(r,e))}};function La(s,e){const t=Xn(s)?Ss("MapSet").proxyMap_(s,e):Zn(s)?Ss("MapSet").proxySet_(s,e):eb(s,e);return(e?e.scope_:cd()).drafts_.push(t),t}function ib(s){return js(s)||St(10,s),dd(s)}function dd(s){if(!Dt(s)||er(s))return s;const e=s[ut];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=Ta(s,e.scope_.immer_.useStrictShallowCopy_)}else t=Ta(s,!0);return Sn(t,(n,r)=>{ld(t,n,dd(r))}),e&&(e.finalized_=!1),t}var mt=new sb,ud=mt.produce;mt.produceWithPatches.bind(mt);mt.setAutoFreeze.bind(mt);mt.setUseStrictShallowCopy.bind(mt);mt.applyPatches.bind(mt);mt.createDraft.bind(mt);mt.finishDraft.bind(mt);function md(s){return({dispatch:t,getState:n})=>r=>a=>typeof a=="function"?a(t,n,s):r(a)}var nb=md(),rb=md,ab=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?jn:jn.apply(null,arguments)},ob=s=>s&&typeof s.match=="function";function hi(s,e){function t(...n){if(e){let r=e(...n);if(!r)throw new Error(At(0));return{type:s,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:s,payload:n[0]}}return t.toString=()=>`${s}`,t.type=s,t.match=n=>qx(n)&&n.type===s,t}var fd=class si extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,si.prototype)}static get[Symbol.species](){return si}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new si(...e[0].concat(this)):new si(...e.concat(this))}};function ac(s){return Dt(s)?ud(s,()=>{}):s}function Gi(s,e,t){return s.has(e)?s.get(e):s.set(e,t(e)).get(e)}function lb(s){return typeof s=="boolean"}var cb=()=>function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:a=!0}=e??{};let o=new fd;return t&&(lb(t)?o.push(nb):o.push(rb(t.extraArgument))),o},hb="RTK_autoBatch",oc=s=>e=>{setTimeout(e,s)},db=(s={type:"raf"})=>e=>(...t)=>{const n=e(...t);let r=!0,a=!1,o=!1;const l=new Set,c=s.type==="tick"?queueMicrotask:s.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:oc(10):s.type==="callback"?s.queueNotification:oc(s.timeout),h=()=>{o=!1,a&&(a=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const m=()=>r&&d(),x=n.subscribe(m);return l.add(d),()=>{x(),l.delete(d)}},dispatch(d){var m;try{return r=!((m=d==null?void 0:d.meta)!=null&&m[hb]),a=!r,a&&(o||(o=!0,c(h))),n.dispatch(d)}finally{r=!0}}})},ub=s=>function(t){const{autoBatch:n=!0}=t??{};let r=new fd(s);return n&&r.push(db(typeof n=="object"?n:void 0)),r};function mb(s){const e=cb(),{reducer:t=void 0,middleware:n,devTools:r=!0,preloadedState:a=void 0,enhancers:o=void 0}=s||{};let l;if(typeof t=="function")l=t;else if(io(t))l=rd(t);else throw new Error(At(1));let c;typeof n=="function"?c=n(e):c=e();let h=jn;r&&(h=ab({trace:!1,...typeof r=="object"&&r}));const d=Yx(...c),m=ub(d);let x=typeof o=="function"?o(m):m();const b=h(...x);return no(l,a,b)}function pd(s){const e={},t=[];let n;const r={addCase(a,o){const l=typeof a=="string"?a:a.type;if(!l)throw new Error(At(28));if(l in e)throw new Error(At(29));return e[l]=o,r},addMatcher(a,o){return t.push({matcher:a,reducer:o}),r},addDefaultCase(a){return n=a,r}};return s(r),[e,t,n]}function fb(s){return typeof s=="function"}function pb(s,e){let[t,n,r]=pd(e),a;if(fb(s))a=()=>ac(s());else{const l=ac(s);a=()=>l}function o(l=a(),c){let h=[t[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return h.filter(d=>!!d).length===0&&(h=[r]),h.reduce((d,m)=>{if(m)if(js(d)){const b=m(d,c);return b===void 0?d:b}else{if(Dt(d))return ud(d,x=>m(x,c));{const x=m(d,c);if(x===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return x}}return d},l)}return o.getInitialState=a,o}var gb=(s,e)=>ob(s)?s.match(e):s(e);function yb(...s){return e=>s.some(t=>gb(t,e))}var vb="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",xb=(s=21)=>{let e="",t=s;for(;t--;)e+=vb[Math.random()*64|0];return e},bb=["name","message","stack","code"],Hr=class{constructor(s,e){ur(this,"_type");this.payload=s,this.meta=e}},lc=class{constructor(s,e){ur(this,"_type");this.payload=s,this.meta=e}},wb=s=>{if(typeof s=="object"&&s!==null){const e={};for(const t of bb)typeof s[t]=="string"&&(e[t]=s[t]);return e}return{message:String(s)}},cc="External signal was aborted",Ne=(()=>{function s(e,t,n){const r=hi(e+"/fulfilled",(c,h,d,m)=>({payload:c,meta:{...m||{},arg:d,requestId:h,requestStatus:"fulfilled"}})),a=hi(e+"/pending",(c,h,d)=>({payload:void 0,meta:{...d||{},arg:h,requestId:c,requestStatus:"pending"}})),o=hi(e+"/rejected",(c,h,d,m,x)=>({payload:m,error:(n&&n.serializeError||wb)(c||"Rejected"),meta:{...x||{},arg:d,requestId:h,rejectedWithValue:!!m,requestStatus:"rejected",aborted:(c==null?void 0:c.name)==="AbortError",condition:(c==null?void 0:c.name)==="ConditionError"}}));function l(c,{signal:h}={}){return(d,m,x)=>{const b=n!=null&&n.idGenerator?n.idGenerator(c):xb(),p=new AbortController;let g,f;function y(k){f=k,p.abort()}h&&(h.aborted?y(cc):h.addEventListener("abort",()=>y(cc),{once:!0}));const S=async function(){var N,T;let k;try{let I=(N=n==null?void 0:n.condition)==null?void 0:N.call(n,c,{getState:m,extra:x});if(Sb(I)&&(I=await I),I===!1||p.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const P=new Promise((L,M)=>{g=()=>{M({name:"AbortError",message:f||"Aborted"})},p.signal.addEventListener("abort",g)});d(a(b,c,(T=n==null?void 0:n.getPendingMeta)==null?void 0:T.call(n,{requestId:b,arg:c},{getState:m,extra:x}))),k=await Promise.race([P,Promise.resolve(t(c,{dispatch:d,getState:m,extra:x,requestId:b,signal:p.signal,abort:y,rejectWithValue:(L,M)=>new Hr(L,M),fulfillWithValue:(L,M)=>new lc(L,M)})).then(L=>{if(L instanceof Hr)throw L;return L instanceof lc?r(L.payload,b,c,L.meta):r(L,b,c)})])}catch(I){k=I instanceof Hr?o(null,b,c,I.payload,I.meta):o(I,b,c)}finally{g&&p.signal.removeEventListener("abort",g)}return n&&!n.dispatchConditionRejection&&o.match(k)&&k.meta.condition||d(k),k}();return Object.assign(S,{abort:y,requestId:b,arg:c,unwrap(){return S.then(jb)}})}}return Object.assign(l,{pending:a,rejected:o,fulfilled:r,settled:yb(o,r),typePrefix:e})}return s.withTypes=()=>s,s})();function jb(s){if(s.meta&&s.meta.rejectedWithValue)throw s.payload;if(s.error)throw s.error;return s.payload}function Sb(s){return s!==null&&typeof s=="object"&&typeof s.then=="function"}var Nb=Symbol.for("rtk-slice-createasyncthunk");function kb(s,e){return`${s}/${e}`}function Cb({creators:s}={}){var t;const e=(t=s==null?void 0:s.asyncThunk)==null?void 0:t[Nb];return function(r){const{name:a,reducerPath:o=a}=r;if(!a)throw new Error(At(11));const l=(typeof r.reducers=="function"?r.reducers(Tb()):r.reducers)||{},c=Object.keys(l),h={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(C,N){const T=typeof C=="string"?C:C.type;if(!T)throw new Error(At(12));if(T in h.sliceCaseReducersByType)throw new Error(At(13));return h.sliceCaseReducersByType[T]=N,d},addMatcher(C,N){return h.sliceMatchers.push({matcher:C,reducer:N}),d},exposeAction(C,N){return h.actionCreators[C]=N,d},exposeCaseReducer(C,N){return h.sliceCaseReducersByName[C]=N,d}};c.forEach(C=>{const N=l[C],T={reducerName:C,type:kb(a,C),createNotation:typeof r.reducers=="function"};Ib(N)?Lb(T,N,d,e):Eb(T,N,d)});function m(){const[C={},N=[],T=void 0]=typeof r.extraReducers=="function"?pd(r.extraReducers):[r.extraReducers],I={...C,...h.sliceCaseReducersByType};return pb(r.initialState,P=>{for(let L in I)P.addCase(L,I[L]);for(let L of h.sliceMatchers)P.addMatcher(L.matcher,L.reducer);for(let L of N)P.addMatcher(L.matcher,L.reducer);T&&P.addDefaultCase(T)})}const x=C=>C,b=new Map,p=new WeakMap;let g;function f(C,N){return g||(g=m()),g(C,N)}function y(){return g||(g=m()),g.getInitialState()}function S(C,N=!1){function T(P){let L=P[C];return typeof L>"u"&&N&&(L=Gi(p,T,y)),L}function I(P=x){const L=Gi(b,N,()=>new WeakMap);return Gi(L,P,()=>{const M={};for(const[O,B]of Object.entries(r.selectors??{}))M[O]=Pb(B,P,()=>Gi(p,P,y),N);return M})}return{reducerPath:C,getSelectors:I,get selectors(){return I(T)},selectSlice:T}}const k={name:a,reducer:f,actions:h.actionCreators,caseReducers:h.sliceCaseReducersByName,getInitialState:y,...S(o),injectInto(C,{reducerPath:N,...T}={}){const I=N??o;return C.inject({reducerPath:I,reducer:f},T),{...k,...S(I,!0)}}};return k}}function Pb(s,e,t,n){function r(a,...o){let l=e(a);return typeof l>"u"&&n&&(l=t()),s(l,...o)}return r.unwrapped=s,r}var Gt=Cb();function Tb(){function s(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return s.withTypes=()=>s,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}},asyncThunk:s}}function Eb({type:s,reducerName:e,createNotation:t},n,r){let a,o;if("reducer"in n){if(t&&!_b(n))throw new Error(At(17));a=n.reducer,o=n.prepare}else a=n;r.addCase(s,a).exposeCaseReducer(e,a).exposeAction(e,o?hi(s,o):hi(s))}function Ib(s){return s._reducerDefinitionType==="asyncThunk"}function _b(s){return s._reducerDefinitionType==="reducerWithPrepare"}function Lb({type:s,reducerName:e},t,n,r){if(!r)throw new Error(At(18));const{payloadCreator:a,fulfilled:o,pending:l,rejected:c,settled:h,options:d}=t,m=r(s,a,d);n.exposeAction(e,m),o&&n.addCase(m.fulfilled,o),l&&n.addCase(m.pending,l),c&&n.addCase(m.rejected,c),h&&n.addMatcher(m.settled,h),n.exposeCaseReducer(e,{fulfilled:o||Qi,pending:l||Qi,rejected:c||Qi,settled:h||Qi})}function Qi(){}function At(s){return`Minified Redux Toolkit error #${s}; visit https://redux-toolkit.js.org/Errors?code=${s} for the full message or use the non-minified dev environment for full errors. `}var oo="persist:",gd="persist/FLUSH",lo="persist/REHYDRATE",yd="persist/PAUSE",vd="persist/PERSIST",xd="persist/PURGE",bd="persist/REGISTER",Mb=-1;function an(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?an=function(t){return typeof t}:an=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},an(s)}function hc(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,n)}return t}function Rb(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?hc(t,!0).forEach(function(n){Ab(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):hc(t).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function Ab(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Ob(s,e,t,n){n.debug;var r=Rb({},t);return s&&an(s)==="object"&&Object.keys(s).forEach(function(a){a!=="_persist"&&e[a]===t[a]&&(r[a]=s[a])}),r}function Fb(s){var e=s.blacklist||null,t=s.whitelist||null,n=s.transforms||[],r=s.throttle||0,a="".concat(s.keyPrefix!==void 0?s.keyPrefix:oo).concat(s.key),o=s.storage,l;s.serialize===!1?l=function(N){return N}:typeof s.serialize=="function"?l=s.serialize:l=Bb;var c=s.writeFailHandler||null,h={},d={},m=[],x=null,b=null,p=function(N){Object.keys(N).forEach(function(T){y(T)&&h[T]!==N[T]&&m.indexOf(T)===-1&&m.push(T)}),Object.keys(h).forEach(function(T){N[T]===void 0&&y(T)&&m.indexOf(T)===-1&&h[T]!==void 0&&m.push(T)}),x===null&&(x=setInterval(g,r)),h=N};function g(){if(m.length===0){x&&clearInterval(x),x=null;return}var C=m.shift(),N=n.reduce(function(T,I){return I.in(T,C,h)},h[C]);if(N!==void 0)try{d[C]=l(N)}catch(T){console.error("redux-persist/createPersistoid: error serializing state",T)}else delete d[C];m.length===0&&f()}function f(){Object.keys(d).forEach(function(C){h[C]===void 0&&delete d[C]}),b=o.setItem(a,l(d)).catch(S)}function y(C){return!(t&&t.indexOf(C)===-1&&C!=="_persist"||e&&e.indexOf(C)!==-1)}function S(C){c&&c(C)}var k=function(){for(;m.length!==0;)g();return b||Promise.resolve()};return{update:p,flush:k}}function Bb(s){return JSON.stringify(s)}function Db(s){var e=s.transforms||[],t="".concat(s.keyPrefix!==void 0?s.keyPrefix:oo).concat(s.key),n=s.storage;s.debug;var r;return s.deserialize===!1?r=function(o){return o}:typeof s.deserialize=="function"?r=s.deserialize:r=$b,n.getItem(t).then(function(a){if(a)try{var o={},l=r(a);return Object.keys(l).forEach(function(c){o[c]=e.reduceRight(function(h,d){return d.out(h,c,l)},r(l[c]))}),o}catch(c){throw c}else return})}function $b(s){return JSON.parse(s)}function zb(s){var e=s.storage,t="".concat(s.keyPrefix!==void 0?s.keyPrefix:oo).concat(s.key);return e.removeItem(t,Ub)}function Ub(s){}function dc(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,n)}return t}function Lt(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?dc(t,!0).forEach(function(n){Wb(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):dc(t).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function Wb(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Vb(s,e){if(s==null)return{};var t=Hb(s,e),n,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);for(r=0;r<a.length;r++)n=a[r],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(t[n]=s[n])}return t}function Hb(s,e){if(s==null)return{};var t={},n=Object.keys(s),r,a;for(a=0;a<n.length;a++)r=n[a],!(e.indexOf(r)>=0)&&(t[r]=s[r]);return t}var Yb=5e3;function qb(s,e){var t=s.version!==void 0?s.version:Mb;s.debug;var n=s.stateReconciler===void 0?Ob:s.stateReconciler,r=s.getStoredState||Db,a=s.timeout!==void 0?s.timeout:Yb,o=null,l=!1,c=!0,h=function(m){return m._persist.rehydrated&&o&&!c&&o.update(m),m};return function(d,m){var x=d||{},b=x._persist,p=Vb(x,["_persist"]),g=p;if(m.type===vd){var f=!1,y=function(P,L){f||(m.rehydrate(s.key,P,L),f=!0)};if(a&&setTimeout(function(){!f&&y(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(s.key,'"')))},a),c=!1,o||(o=Fb(s)),b)return Lt({},e(g,m),{_persist:b});if(typeof m.rehydrate!="function"||typeof m.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return m.register(s.key),r(s).then(function(I){var P=s.migrate||function(L,M){return Promise.resolve(L)};P(I,t).then(function(L){y(L)},function(L){y(void 0,L)})},function(I){y(void 0,I)}),Lt({},e(g,m),{_persist:{version:t,rehydrated:!1}})}else{if(m.type===xd)return l=!0,m.result(zb(s)),Lt({},e(g,m),{_persist:b});if(m.type===gd)return m.result(o&&o.flush()),Lt({},e(g,m),{_persist:b});if(m.type===yd)c=!0;else if(m.type===lo){if(l)return Lt({},g,{_persist:Lt({},b,{rehydrated:!0})});if(m.key===s.key){var S=e(g,m),k=m.payload,C=n!==!1&&k!==void 0?n(k,d,S,s):S,N=Lt({},C,{_persist:Lt({},b,{rehydrated:!0})});return h(N)}}}if(!b)return e(d,m);var T=e(g,m);return T===g?d:h(Lt({},T,{_persist:b}))}}function uc(s){return Kb(s)||Qb(s)||Gb()}function Gb(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Qb(s){if(Symbol.iterator in Object(s)||Object.prototype.toString.call(s)==="[object Arguments]")return Array.from(s)}function Kb(s){if(Array.isArray(s)){for(var e=0,t=new Array(s.length);e<s.length;e++)t[e]=s[e];return t}}function mc(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(s,r).enumerable})),t.push.apply(t,n)}return t}function Ma(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?mc(t,!0).forEach(function(n){Jb(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):mc(t).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function Jb(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}var wd={registry:[],bootstrapped:!1},Xb=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wd,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case bd:return Ma({},e,{registry:[].concat(uc(e.registry),[t.key])});case lo:var n=e.registry.indexOf(t.key),r=uc(e.registry);return r.splice(n,1),Ma({},e,{registry:r,bootstrapped:r.length===0});default:return e}};function Zb(s,e,t){var n=no(Xb,wd,void 0),r=function(c){n.dispatch({type:bd,key:c})},a=function(c,h,d){var m={type:lo,payload:h,err:d,key:c};s.dispatch(m),n.dispatch(m)},o=Ma({},n,{purge:function(){var c=[];return s.dispatch({type:xd,result:function(d){c.push(d)}}),Promise.all(c)},flush:function(){var c=[];return s.dispatch({type:gd,result:function(d){c.push(d)}}),Promise.all(c)},pause:function(){s.dispatch({type:yd})},persist:function(){s.dispatch({type:vd,register:r,rehydrate:a})}});return o.persist(),o}var co={},ho={};ho.__esModule=!0;ho.default=sw;function on(s){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?on=function(t){return typeof t}:on=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},on(s)}function Yr(){}var ew={getItem:Yr,setItem:Yr,removeItem:Yr};function tw(s){if((typeof self>"u"?"undefined":on(self))!=="object"||!(s in self))return!1;try{var e=self[s],t="redux-persist ".concat(s," test");e.setItem(t,"test"),e.getItem(t),e.removeItem(t)}catch{return!1}return!0}function sw(s){var e="".concat(s,"Storage");return tw(e)?self[e]:ew}co.__esModule=!0;co.default=rw;var iw=nw(ho);function nw(s){return s&&s.__esModule?s:{default:s}}function rw(s){var e=(0,iw.default)(s);return{getItem:function(n){return new Promise(function(r,a){r(e.getItem(n))})},setItem:function(n,r){return new Promise(function(a,o){a(e.setItem(n,r))})},removeItem:function(n){return new Promise(function(r,a){r(e.removeItem(n))})}}}var jd=void 0,aw=ow(co);function ow(s){return s&&s.__esModule?s:{default:s}}var lw=(0,aw.default)("local");jd=lw;const cw={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,isLoading:!1,error:null,virtualMoney:0,registrationBonus:1e4},qr=Ne("auth/loginUser",async(s,{rejectWithValue:e})=>{try{const t=await Ni.login(s);return t.success?(localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data.user)),t.data):e(t.message)}catch(t){return e(t.message||"Login failed")}}),Gr=Ne("auth/registerUser",async(s,{rejectWithValue:e})=>{try{const t=await Ni.register(s);return t.success?(localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data.user)),{...t.data,virtualMoney:1e4}):e(t.message)}catch(t){return e(t.message||"Registration failed")}}),Qr=Ne("auth/googleAuth",async(s,{rejectWithValue:e})=>{try{const t=await Ni.googleAuth(s);return t.success?(localStorage.setItem("token",t.data.token),localStorage.setItem("user",JSON.stringify(t.data.user)),{...t.data,virtualMoney:t.data.isNewUser?1e4:t.data.virtualMoney||0}):e(t.message)}catch(t){return e(t.message||"Google authentication failed")}}),hw=Ne("auth/logoutUser",async(s,{rejectWithValue:e})=>{try{return await Ni.logout(),localStorage.removeItem("token"),localStorage.removeItem("user"),!0}catch{return localStorage.removeItem("token"),localStorage.removeItem("user"),!0}}),dw=Ne("auth/refreshToken",async(s,{rejectWithValue:e})=>{try{const t=await Ni.refreshToken();return t.success?(localStorage.setItem("token",t.data.token),t.data):e(t.message)}catch(t){return e(t.message||"Token refresh failed")}}),Sd=Gt({name:"auth",initialState:cw,reducers:{clearError:s=>{s.error=null},setUser:(s,e)=>{s.user=e.payload,s.isAuthenticated=!!e.payload},updateVirtualMoney:(s,e)=>{s.virtualMoney=e.payload,s.user&&(s.user.virtualMoney=e.payload)},addVirtualMoney:(s,e)=>{s.virtualMoney+=e.payload,s.user&&(s.user.virtualMoney=s.virtualMoney)},subtractVirtualMoney:(s,e)=>{s.virtualMoney=Math.max(0,s.virtualMoney-e.payload),s.user&&(s.user.virtualMoney=s.virtualMoney)},initializeAuth:s=>{const e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e&&t)try{const n=JSON.parse(t);s.token=e,s.user=n,s.isAuthenticated=!0,s.virtualMoney=n.virtualMoney||0}catch{localStorage.removeItem("token"),localStorage.removeItem("user")}}},extraReducers:s=>{s.addCase(qr.pending,e=>{e.isLoading=!0,e.error=null}).addCase(qr.fulfilled,(e,t)=>{e.isLoading=!1,e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,e.virtualMoney=t.payload.user.virtualMoney||0,e.error=null}).addCase(qr.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload,e.isAuthenticated=!1}).addCase(Gr.pending,e=>{e.isLoading=!0,e.error=null}).addCase(Gr.fulfilled,(e,t)=>{e.isLoading=!1,e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,e.virtualMoney=1e4,e.error=null}).addCase(Gr.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload,e.isAuthenticated=!1}).addCase(Qr.pending,e=>{e.isLoading=!0,e.error=null}).addCase(Qr.fulfilled,(e,t)=>{e.isLoading=!1,e.user=t.payload.user,e.token=t.payload.token,e.isAuthenticated=!0,e.virtualMoney=t.payload.virtualMoney||0,e.error=null}).addCase(Qr.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload,e.isAuthenticated=!1}).addCase(hw.fulfilled,e=>{e.user=null,e.token=null,e.isAuthenticated=!1,e.virtualMoney=0,e.error=null,e.isLoading=!1}).addCase(dw.fulfilled,(e,t)=>{e.token=t.payload.token,e.user=t.payload.user,e.virtualMoney=t.payload.user.virtualMoney||e.virtualMoney})}}),{clearError:b1,setUser:w1,updateVirtualMoney:j1,addVirtualMoney:uw,subtractVirtualMoney:mw,initializeAuth:S1}=Sd.actions,fw=Sd.reducer,pw={holdings:[],summary:{totalValue:0,totalInvested:0,totalGains:0,totalGainsPercent:0,dayChange:0,dayChangePercent:0,totalStocks:0},performance:{chartData:[],timeframe:"1D"},isLoading:!1,error:null,lastUpdated:null},Nd=[{id:"holding_1",symbol:"RELIANCE",name:"Reliance Industries Ltd",quantity:0,avgPrice:0,currentPrice:2520,totalValue:0,totalGains:0,gainsPercent:0,dayChange:25,dayChangePercent:1,sector:"Energy"},{id:"holding_2",symbol:"TCS",name:"Tata Consultancy Services",quantity:0,avgPrice:0,currentPrice:3350,totalValue:0,totalGains:0,gainsPercent:0,dayChange:-15,dayChangePercent:-.45,sector:"IT"},{id:"holding_3",symbol:"INFY",name:"Infosys Limited",quantity:0,avgPrice:0,currentPrice:1520,totalValue:0,totalGains:0,gainsPercent:0,dayChange:12,dayChangePercent:.79,sector:"IT"}],Kr=Ne("portfolio/fetchSummary",async(s,{rejectWithValue:e,getState:t})=>{try{const n=await gh.getSummary();return n.success?n.data:e(n.message)}catch{const{portfolio:r}=t();return ln(r.holdings)}}),Jr=Ne("portfolio/fetchHoldings",async(s,{rejectWithValue:e})=>{try{const t=await gh.getHoldings();return t.success?t.data:e(t.message)}catch{return Nd}}),Ra=Ne("portfolio/updateHolding",async({symbol:s,quantity:e,price:t,type:n},{rejectWithValue:r,getState:a})=>{try{const{portfolio:o}=a(),l=o.holdings.find(h=>h.symbol===s);let c;if(n==="BUY")if(l){const h=l.quantity+e,m=(l.avgPrice*l.quantity+t*e)/h;c={...l,quantity:h,avgPrice:m,totalValue:h*l.currentPrice,totalGains:(l.currentPrice-m)*h,gainsPercent:(l.currentPrice-m)/m*100}}else{const h=Nd.find(d=>d.symbol===s);if(!h)return r("Stock not found");c={...h,id:`holding_${Date.now()}`,quantity:e,avgPrice:t,totalValue:e*h.currentPrice,totalGains:(h.currentPrice-t)*e,gainsPercent:(h.currentPrice-t)/t*100}}else if(n==="SELL"){if(!l||l.quantity<e)return r("Insufficient shares to sell");const h=l.quantity-e;h===0?c=null:c={...l,quantity:h,totalValue:h*l.currentPrice,totalGains:(l.currentPrice-l.avgPrice)*h,gainsPercent:(l.currentPrice-l.avgPrice)/l.avgPrice*100}}return{symbol:s,updatedHolding:c,type:n,quantity:e,price:t}}catch(o){return r(o.message||"Failed to update holding")}}),ln=s=>{const e=s.reduce((l,c)=>l+c.totalValue,0),t=s.reduce((l,c)=>l+c.avgPrice*c.quantity,0),n=e-t,r=t>0?n/t*100:0,a=s.reduce((l,c)=>l+c.dayChange*c.quantity,0),o=e>0?a/(e-a)*100:0;return{totalValue:e,totalInvested:t,totalGains:n,totalGainsPercent:r,dayChange:a,dayChangePercent:o,totalStocks:s.filter(l=>l.quantity>0).length}},kd=Gt({name:"portfolio",initialState:pw,reducers:{clearError:s=>{s.error=null},updateCurrentPrices:(s,e)=>{const t=e.payload;s.holdings=s.holdings.map(n=>{const r=t.find(a=>a.symbol===n.symbol);if(r){const a=r.price,o=n.quantity*a,l=(a-n.avgPrice)*n.quantity,c=n.avgPrice>0?(a-n.avgPrice)/n.avgPrice*100:0;return{...n,currentPrice:a,totalValue:o,totalGains:l,gainsPercent:c,dayChange:r.dayChange||n.dayChange,dayChangePercent:r.dayChangePercent||n.dayChangePercent}}return n}),s.summary=ln(s.holdings),s.lastUpdated=new Date().toISOString()},setTimeframe:(s,e)=>{s.performance.timeframe=e.payload}},extraReducers:s=>{s.addCase(Kr.pending,e=>{e.isLoading=!0,e.error=null}).addCase(Kr.fulfilled,(e,t)=>{e.isLoading=!1,e.summary=t.payload,e.lastUpdated=new Date().toISOString()}).addCase(Kr.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(Jr.pending,e=>{e.isLoading=!0,e.error=null}).addCase(Jr.fulfilled,(e,t)=>{e.isLoading=!1,e.holdings=t.payload,e.summary=ln(t.payload),e.lastUpdated=new Date().toISOString()}).addCase(Jr.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(Ra.fulfilled,(e,t)=>{const{symbol:n,updatedHolding:r}=t.payload;if(r===null)e.holdings=e.holdings.filter(a=>a.symbol!==n);else{const a=e.holdings.findIndex(o=>o.symbol===n);a>=0?e.holdings[a]=r:e.holdings.push(r)}e.summary=ln(e.holdings),e.lastUpdated=new Date().toISOString()}).addCase(Ra.rejected,(e,t)=>{e.error=t.payload})}}),{clearError:N1,updateCurrentPrices:k1,setTimeframe:C1}=kd.actions,gw=kd.reducer,yw={recentTrades:[],activeOrders:[],tradeHistory:[],isLoading:!1,error:null,tradingFees:{brokerage:.03,stt:.1,gst:18}},Cd=[{id:"trade_1",symbol:"WIPRO",name:"Wipro Limited",type:"BUY",quantity:50,price:420,totalAmount:21e3,timestamp:new Date("2024-01-15T10:30:00"),status:"completed"},{id:"trade_2",symbol:"BAJFINANCE",name:"Bajaj Finance Limited",type:"SELL",quantity:25,price:6800,totalAmount:17e4,timestamp:new Date("2024-01-15T09:15:00"),status:"completed"}],Pd=(s,e)=>{const t=s*(e.brokerage/100),n=s*(e.stt/100),r=t*(e.gst/100),a=t+n+r;return{brokerage:Math.round(t*100)/100,stt:Math.round(n*100)/100,gst:Math.round(r*100)/100,totalFees:Math.round(a*100)/100}},Xr=Ne("trading/executeTrade",async(s,{dispatch:e,getState:t,rejectWithValue:n})=>{try{const{symbol:r,quantity:a,price:o,type:l}=s,c=t(),{auth:h,trading:d}=c,m=a*o,x=Pd(m,d.tradingFees),b=l==="BUY"?m+x.totalFees:m-x.totalFees;if(l==="BUY"&&h.virtualMoney<b)return n("Insufficient virtual money balance");if(l==="SELL"){const g=c.portfolio.holdings.find(f=>f.symbol===r);if(!g||g.quantity<a)return n("Insufficient shares to sell")}const p={id:`trade_${Date.now()}`,symbol:r,name:s.name||r,type:l,quantity:a,price:o,grossAmount:m,fees:x,netAmount:b,timestamp:new Date().toISOString(),status:"completed"};return e(l==="BUY"?mw(b):uw(b)),e(Ra({symbol:r,quantity:a,price:o,type:l})),p}catch(r){return n(r.message||"Trade execution failed")}}),vw=Ne("trading/fetchRecentTrades",async(s=10,{rejectWithValue:e})=>{try{const t=await Ns.getRecentTrades(s);return t.success?t.data:e(t.message)}catch{return Cd}}),xw=Ne("trading/fetchTradeHistory",async({startDate:s,endDate:e,symbol:t},{rejectWithValue:n})=>{try{const r=await Ns.getTradeHistory({startDate:s,endDate:e,symbol:t});return r.success?r.data:n(r.message)}catch{return Cd}}),Zr=Ne("trading/placeOrder",async(s,{getState:e,rejectWithValue:t})=>{try{const{symbol:n,quantity:r,price:a,type:o,orderType:l}=s,c=e(),{auth:h}=c;if(l==="LIMIT"){const m=r*a,x=Pd(m,c.trading.tradingFees),b=o==="BUY"?m+x.totalFees:m-x.totalFees;if(o==="BUY"&&h.virtualMoney<b)return t("Insufficient virtual money balance")}return{id:`order_${Date.now()}`,symbol:n,name:s.name||n,type:o,orderType:l,quantity:r,price:l==="MARKET"?null:a,status:"pending",timestamp:new Date().toISOString(),expiryDate:s.expiryDate||null}}catch(n){return t(n.message||"Order placement failed")}}),bw=Ne("trading/cancelOrder",async(s,{rejectWithValue:e})=>{try{const t=await Ns.cancelOrder(s);return t.success?s:e(t.message)}catch{return s}}),Td=Gt({name:"trading",initialState:yw,reducers:{clearError:s=>{s.error=null},updateTradingFees:(s,e)=>{s.tradingFees={...s.tradingFees,...e.payload}},addTradeToHistory:(s,e)=>{s.tradeHistory.unshift(e.payload),s.recentTrades.unshift(e.payload),s.recentTrades.length>50&&(s.recentTrades=s.recentTrades.slice(0,50))}},extraReducers:s=>{s.addCase(Xr.pending,e=>{e.isLoading=!0,e.error=null}).addCase(Xr.fulfilled,(e,t)=>{e.isLoading=!1,e.recentTrades.unshift(t.payload),e.tradeHistory.unshift(t.payload),e.recentTrades.length>50&&(e.recentTrades=e.recentTrades.slice(0,50))}).addCase(Xr.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(vw.fulfilled,(e,t)=>{e.recentTrades=t.payload}).addCase(xw.fulfilled,(e,t)=>{e.tradeHistory=t.payload}).addCase(Zr.pending,e=>{e.isLoading=!0,e.error=null}).addCase(Zr.fulfilled,(e,t)=>{e.isLoading=!1,e.activeOrders.push(t.payload)}).addCase(Zr.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(bw.fulfilled,(e,t)=>{const n=t.payload;e.activeOrders=e.activeOrders.filter(r=>r.id!==n)})}}),{clearError:P1,updateTradingFees:T1,addTradeToHistory:E1}=Td.actions,ww=Td.reducer,jw={stocks:[],isLoading:!1,error:null,lastUpdated:null},Sw=[{id:"watch_1",symbol:"RELIANCE",name:"Reliance Industries Ltd",price:2520,change:25,changePercent:1,volume:125e4,marketCap:1705e9,pe:24.5,sector:"Energy",isFavorite:!0,alertPrice:2600,hasAlert:!0,addedAt:new Date("2024-01-10T10:00:00").toISOString()},{id:"watch_2",symbol:"TCS",name:"Tata Consultancy Services",price:3350,change:-15,changePercent:-.45,volume:89e4,marketCap:122e10,pe:28.2,sector:"IT",isFavorite:!1,alertPrice:null,hasAlert:!1,addedAt:new Date("2024-01-12T14:30:00").toISOString()},{id:"watch_3",symbol:"INFY",name:"Infosys Limited",price:1520,change:12,changePercent:.79,volume:11e5,marketCap:645e9,pe:22.8,sector:"IT",isFavorite:!0,alertPrice:1600,hasAlert:!0,addedAt:new Date("2024-01-08T09:15:00").toISOString()}],ea=Ne("watchlist/fetchWatchlist",async(s,{rejectWithValue:e})=>{try{const t=await Hs.getWatchlist();return t.success?t.data:e(t.message)}catch{return Sw}}),fc=Ne("watchlist/addToWatchlist",async(s,{getState:e,rejectWithValue:t})=>{try{const{symbol:n,name:r,price:a,sector:o}=s;if(e().watchlist.stocks.find(d=>d.symbol===n))return t("Stock already in watchlist");const h={id:`watch_${Date.now()}`,symbol:n,name:r,price:a,change:0,changePercent:0,volume:0,marketCap:0,pe:0,sector:o||"Unknown",isFavorite:!1,alertPrice:null,hasAlert:!1,addedAt:new Date().toISOString()};try{const d=await Hs.addStock(h);if(d.success)return d.data}catch{console.warn("API failed, adding to local watchlist")}return h}catch(n){return t(n.message||"Failed to add to watchlist")}}),pc=Ne("watchlist/removeFromWatchlist",async(s,{rejectWithValue:e})=>{try{try{if((await Hs.removeStock(s)).success)return s}catch{console.warn("API failed, removing from local watchlist")}return s}catch(t){return e(t.message||"Failed to remove from watchlist")}}),Nw=Ne("watchlist/toggleFavorite",async(s,{getState:e,rejectWithValue:t})=>{try{const r=e().watchlist.stocks.find(o=>o.id===s);if(!r)return t("Stock not found in watchlist");const a={...r,isFavorite:!r.isFavorite};try{const o=await Hs.updateStock(s,a);if(o.success)return o.data}catch{console.warn("API failed, updating local watchlist")}return a}catch(n){return t(n.message||"Failed to toggle favorite")}}),kw=Ne("watchlist/setPriceAlert",async({stockId:s,alertPrice:e},{getState:t,rejectWithValue:n})=>{try{const a=t().watchlist.stocks.find(l=>l.id===s);if(!a)return n("Stock not found in watchlist");const o={...a,alertPrice:e,hasAlert:e!==null};try{const l=await Hs.updateStock(s,o);if(l.success)return l.data}catch{console.warn("API failed, updating local watchlist")}return o}catch(r){return n(r.message||"Failed to set price alert")}}),Cw=Ne("watchlist/updatePrices",async(s,{rejectWithValue:e})=>{try{return s}catch(t){return e(t.message||"Failed to update prices")}}),Ed=Gt({name:"watchlist",initialState:jw,reducers:{clearError:s=>{s.error=null},updateStockPrices:(s,e)=>{const t=e.payload;s.stocks=s.stocks.map(n=>{const r=t.find(a=>a.symbol===n.symbol);return r?{...n,price:r.price,change:r.change,changePercent:r.changePercent,volume:r.volume||n.volume,dayHigh:r.dayHigh||n.dayHigh,dayLow:r.dayLow||n.dayLow,lastUpdated:Date.now()}:n}),s.lastUpdated=new Date().toISOString()},syncWithStocksData:(s,e)=>{const t=e.payload;s.stocks=s.stocks.map(n=>{const r=t[n.symbol];return r?{...n,...r,lastUpdated:Date.now()}:n}),s.lastUpdated=new Date().toISOString()},sortWatchlist:(s,e)=>{const{sortBy:t,sortOrder:n}=e.payload;s.stocks.sort((r,a)=>{let o,l;switch(t){case"symbol":o=r.symbol,l=a.symbol;break;case"price":o=r.price,l=a.price;break;case"change":o=r.changePercent,l=a.changePercent;break;case"volume":o=r.volume,l=a.volume;break;case"addedAt":o=new Date(r.addedAt),l=new Date(a.addedAt);break;default:return 0}return n==="desc"?l>o?1:-1:o>l?1:-1})}},extraReducers:s=>{s.addCase(ea.pending,e=>{e.isLoading=!0,e.error=null}).addCase(ea.fulfilled,(e,t)=>{e.isLoading=!1,e.stocks=t.payload,e.lastUpdated=new Date().toISOString()}).addCase(ea.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(fc.fulfilled,(e,t)=>{e.stocks.push(t.payload)}).addCase(fc.rejected,(e,t)=>{e.error=t.payload}).addCase(pc.fulfilled,(e,t)=>{const n=t.payload;e.stocks=e.stocks.filter(r=>r.id!==n)}).addCase(pc.rejected,(e,t)=>{e.error=t.payload}).addCase(Nw.fulfilled,(e,t)=>{const n=t.payload,r=e.stocks.findIndex(a=>a.id===n.id);r>=0&&(e.stocks[r]=n)}).addCase(kw.fulfilled,(e,t)=>{const n=t.payload,r=e.stocks.findIndex(a=>a.id===n.id);r>=0&&(e.stocks[r]=n)}).addCase(Cw.fulfilled,(e,t)=>{const n=t.payload;e.stocks=e.stocks.map(r=>{const a=n.find(o=>o.symbol===r.symbol);return a?{...r,price:a.price,change:a.change,changePercent:a.changePercent,volume:a.volume||r.volume}:r}),e.lastUpdated=new Date().toISOString()})}}),{clearError:I1,updateStockPrices:_1,syncWithStocksData:L1,sortWatchlist:M1}=Ed.actions,Pw=Ed.reducer,Tw={orders:[],orderHistory:[],isLoading:!1,error:null,filters:{status:"all",type:"all",symbol:""}},Ew=[{id:"ORD001",symbol:"RELIANCE",name:"Reliance Industries Ltd",type:"BUY",quantity:50,price:2520,orderPrice:2500,status:"executed",timestamp:new Date("2024-01-15T10:30:00").toISOString(),executedAt:new Date("2024-01-15T10:31:00").toISOString(),totalAmount:126e3},{id:"ORD002",symbol:"TCS",name:"Tata Consultancy Services",type:"SELL",quantity:20,price:3350,orderPrice:3400,status:"pending",timestamp:new Date("2024-01-15T11:15:00").toISOString(),executedAt:null,totalAmount:67e3}],ta=Ne("orders/fetchOrders",async(s,{rejectWithValue:e})=>{try{const t=await Ns.getOrders();return t.success?t.data:e(t.message)}catch{return Ew}}),Iw=Ne("orders/placeOrder",async(s,{rejectWithValue:e})=>{try{const t={id:`ORD${Date.now()}`,...s,status:"pending",timestamp:new Date().toISOString(),executedAt:null};try{const n=await Ns.placeOrder(t);if(n.success)return n.data}catch{console.warn("API failed, creating local order")}return t}catch(t){return e(t.message||"Failed to place order")}}),_w=Ne("orders/cancelOrder",async(s,{rejectWithValue:e})=>{try{try{if((await Ns.cancelOrder(s)).success)return s}catch{console.warn("API failed, cancelling local order")}return s}catch(t){return e(t.message||"Failed to cancel order")}}),Id=Gt({name:"orders",initialState:Tw,reducers:{clearError:s=>{s.error=null},setFilters:(s,e)=>{s.filters={...s.filters,...e.payload}},updateOrderStatus:(s,e)=>{const{orderId:t,status:n,executedAt:r,executedPrice:a}=e.payload,o=s.orders.find(l=>l.id===t);o&&(o.status=n,r&&(o.executedAt=r),a&&(o.price=a))}},extraReducers:s=>{s.addCase(ta.pending,e=>{e.isLoading=!0,e.error=null}).addCase(ta.fulfilled,(e,t)=>{e.isLoading=!1,e.orders=t.payload}).addCase(ta.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(Iw.fulfilled,(e,t)=>{e.orders.unshift(t.payload)}).addCase(_w.fulfilled,(e,t)=>{const n=t.payload,r=e.orders.find(a=>a.id===n);r&&(r.status="cancelled")})}}),{clearError:R1,setFilters:A1,updateOrderStatus:O1}=Id.actions,Lw=Id.reducer,Mw={articles:[],categories:["all","market","earnings","sector","policy"],activeCategory:"all",isLoading:!1,error:null,lastUpdated:null},Rw=[{id:"news001",title:"Reliance Industries Reports Strong Q3 Results, Beats Estimates",summary:"Reliance Industries posted a 12% increase in net profit for Q3, driven by strong performance in retail and digital services segments.",category:"earnings",source:"Economic Times",author:"Financial Reporter",publishedAt:new Date("2024-01-15T09:30:00").toISOString(),readTime:3,imageUrl:"/api/placeholder/400/200",tags:["RELIANCE","Earnings","Q3 Results"],sentiment:"positive",views:1250,likes:89,isBookmarked:!1,relatedStocks:["RELIANCE"]},{id:"news002",title:"IT Sector Outlook: TCS and Infosys Lead Digital Transformation Wave",summary:"Indian IT giants are capitalizing on global digital transformation trends, with strong order books and margin improvements.",category:"sector",source:"Business Standard",author:"Tech Analyst",publishedAt:new Date("2024-01-15T08:45:00").toISOString(),readTime:5,imageUrl:"/api/placeholder/400/200",tags:["TCS","INFY","IT Sector","Digital"],sentiment:"positive",views:980,likes:67,isBookmarked:!0,relatedStocks:["TCS","INFY","WIPRO"]}],sa=Ne("news/fetchNews",async({category:s="all",limit:e=20},{rejectWithValue:t})=>{try{const n=await Wa.getNews({category:s,limit:e});return n.success?n.data:t(n.message)}catch{return Rw}}),Aw=Ne("news/toggleBookmark",async(s,{getState:e,rejectWithValue:t})=>{try{const r=e().news.articles.find(o=>o.id===s);if(!r)return t("Article not found");const a={...r,isBookmarked:!r.isBookmarked};try{await Wa.toggleBookmark(s)}catch{console.warn("API failed, updating local bookmark")}return a}catch(n){return t(n.message||"Failed to toggle bookmark")}}),_d=Gt({name:"news",initialState:Mw,reducers:{clearError:s=>{s.error=null},setActiveCategory:(s,e)=>{s.activeCategory=e.payload},updateArticleViews:(s,e)=>{const t=e.payload,n=s.articles.find(r=>r.id===t);n&&(n.views+=1)}},extraReducers:s=>{s.addCase(sa.pending,e=>{e.isLoading=!0,e.error=null}).addCase(sa.fulfilled,(e,t)=>{e.isLoading=!1,e.articles=t.payload,e.lastUpdated=new Date().toISOString()}).addCase(sa.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(Aw.fulfilled,(e,t)=>{const n=t.payload,r=e.articles.findIndex(a=>a.id===n.id);r>=0&&(e.articles[r]=n)})}}),{clearError:F1,setActiveCategory:B1,updateArticleViews:D1}=_d.actions,Ow=_d.reducer,Fw={theme:localStorage.getItem("theme")||"light",notifications:[],modals:{buyStock:{isOpen:!1,data:null},sellStock:{isOpen:!1,data:null},addToWatchlist:{isOpen:!1,data:null},priceAlert:{isOpen:!1,data:null},tradeConfirmation:{isOpen:!1,data:null}},loading:{global:!1,portfolio:!1,trading:!1,watchlist:!1},toast:{isVisible:!1,message:"",type:"info",duration:3e3}},Ld=Gt({name:"ui",initialState:Fw,reducers:{setTheme:(s,e)=>{s.theme=e.payload,localStorage.setItem("theme",e.payload),document.documentElement.setAttribute("data-theme",e.payload)},toggleTheme:s=>{const e=s.theme==="light"?"dark":"light";s.theme=e,localStorage.setItem("theme",e),document.documentElement.setAttribute("data-theme",e)},openModal:(s,e)=>{const{modalName:t,data:n}=e.payload;s.modals[t]&&(s.modals[t].isOpen=!0,s.modals[t].data=n||null)},closeModal:(s,e)=>{const t=e.payload;s.modals[t]&&(s.modals[t].isOpen=!1,s.modals[t].data=null)},closeAllModals:s=>{Object.keys(s.modals).forEach(e=>{s.modals[e].isOpen=!1,s.modals[e].data=null})},setLoading:(s,e)=>{const{key:t,value:n}=e.payload;s.loading.hasOwnProperty(t)&&(s.loading[t]=n)},setGlobalLoading:(s,e)=>{s.loading.global=e.payload},showToast:(s,e)=>{const{message:t,type:n="info",duration:r=3e3}=e.payload;s.toast={isVisible:!0,message:t,type:n,duration:r}},hideToast:s=>{s.toast.isVisible=!1},showSuccessToast:(s,e)=>{s.toast={isVisible:!0,message:e.payload,type:"success",duration:3e3}},showErrorToast:(s,e)=>{s.toast={isVisible:!0,message:e.payload,type:"error",duration:5e3}},showWarningToast:(s,e)=>{s.toast={isVisible:!0,message:e.payload,type:"warning",duration:4e3}},showInfoToast:(s,e)=>{s.toast={isVisible:!0,message:e.payload,type:"info",duration:3e3}}}}),{setTheme:$1,toggleTheme:z1,openModal:U1,closeModal:W1,closeAllModals:V1,setLoading:H1,setGlobalLoading:Y1,showToast:q1,hideToast:G1,showSuccessToast:Q1,showErrorToast:K1,showWarningToast:J1,showInfoToast:X1}=Ld.actions,Bw=Ld.reducer,ia=Ne("stocks/fetchIndianStockQuote",async(s,{rejectWithValue:e})=>{var t,n;try{const r=await ki.getQuote(s);return{symbol:s,data:r}}catch(r){return e(((n=(t=r.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to fetch stock quote")}}),na=Ne("stocks/fetchIndianMarketMovers",async(s,{rejectWithValue:e})=>{var t,n;try{return await ki.getMarketMovers()}catch(r){return e(((n=(t=r.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to fetch market movers")}}),ra=Ne("stocks/fetchNiftyData",async(s,{rejectWithValue:e})=>{var t,n;try{return await ki.getQuote("^NSEI")}catch(r){return e(((n=(t=r.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to fetch Nifty data")}}),aa=Ne("stocks/fetchSensexData",async(s,{rejectWithValue:e})=>{var t,n;try{return await ki.getQuote("^BSESN")}catch(r){return e(((n=(t=r.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to fetch Sensex data")}}),oa=Ne("stocks/fetchBatchStockQuotes",async(s,{rejectWithValue:e})=>{var t,n;try{return await ki.getBatchQuotes(s)}catch(r){return e(((n=(t=r.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to fetch batch quotes")}}),Dw={nifty:{data:null,loading:!1,error:null,lastUpdated:null},sensex:{data:null,loading:!1,error:null,lastUpdated:null},quotes:{},topGainers:[],topLosers:[],mostActive:[],realTimeUpdates:!0,updateInterval:3e4,lastGlobalUpdate:null,isLoading:!1,error:null,priceChanges:{},marketStatus:{isOpen:!1,nextOpen:null,nextClose:null,timezone:"Asia/Kolkata"}},Md=Gt({name:"stocks",initialState:Dw,reducers:{updateStockPrice:(s,e)=>{const{symbol:t,price:n,change:r,changePercent:a,volume:o,timestamp:l}=e.payload;s.quotes[t]&&s.quotes[t].price!==n&&(s.priceChanges[t]={oldPrice:s.quotes[t].price,newPrice:n,direction:n>s.quotes[t].price?"up":"down",timestamp:Date.now()}),s.quotes[t]={...s.quotes[t],price:n,change:r,changePercent:a,volume:o,lastUpdated:l||Date.now()}},updateBatchPrices:(s,e)=>{const t=e.payload,n=Date.now();t.forEach(r=>{const{symbol:a,price:o,change:l,changePercent:c,volume:h}=r;s.quotes[a]&&s.quotes[a].price!==o&&(s.priceChanges[a]={oldPrice:s.quotes[a].price,newPrice:o,direction:o>s.quotes[a].price?"up":"down",timestamp:n}),s.quotes[a]={...s.quotes[a],price:o,change:l,changePercent:c,volume:h,lastUpdated:n}}),s.lastGlobalUpdate=n},clearPriceChanges:s=>{s.priceChanges={}},toggleRealTimeUpdates:s=>{s.realTimeUpdates=!s.realTimeUpdates},setUpdateInterval:(s,e)=>{s.updateInterval=e.payload},updateMarketStatus:(s,e)=>{s.marketStatus={...s.marketStatus,...e.payload}},clearError:s=>{s.error=null,s.nifty.error=null,s.sensex.error=null}},extraReducers:s=>{s.addCase(ia.pending,e=>{e.isLoading=!0,e.error=null}).addCase(ia.fulfilled,(e,t)=>{e.isLoading=!1;const{symbol:n,data:r}=t.payload;e.quotes[n]={...r,lastUpdated:Date.now()}}).addCase(ia.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}),s.addCase(na.pending,e=>{e.isLoading=!0}).addCase(na.fulfilled,(e,t)=>{e.isLoading=!1;const{gainers:n,losers:r,mostActive:a}=t.payload;e.topGainers=n||[],e.topLosers=r||[],e.mostActive=a||[],e.lastGlobalUpdate=Date.now()}).addCase(na.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}),s.addCase(ra.pending,e=>{e.nifty.loading=!0,e.nifty.error=null}).addCase(ra.fulfilled,(e,t)=>{e.nifty.loading=!1,e.nifty.data=t.payload,e.nifty.lastUpdated=Date.now()}).addCase(ra.rejected,(e,t)=>{e.nifty.loading=!1,e.nifty.error=t.payload}),s.addCase(aa.pending,e=>{e.sensex.loading=!0,e.sensex.error=null}).addCase(aa.fulfilled,(e,t)=>{e.sensex.loading=!1,e.sensex.data=t.payload,e.sensex.lastUpdated=Date.now()}).addCase(aa.rejected,(e,t)=>{e.sensex.loading=!1,e.sensex.error=t.payload}),s.addCase(oa.pending,e=>{e.isLoading=!0}).addCase(oa.fulfilled,(e,t)=>{e.isLoading=!1,t.payload.forEach(r=>{e.quotes[r.symbol]={...r,lastUpdated:Date.now()}}),e.lastGlobalUpdate=Date.now()}).addCase(oa.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload})}}),{updateStockPrice:Z1,updateBatchPrices:ej,clearPriceChanges:tj,toggleRealTimeUpdates:sj,setUpdateInterval:ij,updateMarketStatus:nj,clearError:rj}=Md.actions,$w=Md.reducer,zw={key:"tradebro",storage:jd,whitelist:["auth","portfolio","trading","watchlist","orders"],blacklist:["ui","news","stocks"]},Uw=rd({auth:fw,portfolio:gw,trading:ww,watchlist:Pw,orders:Lw,news:Ow,ui:Bw,stocks:$w}),Ww=qb(zw,Uw),Rd=mb({reducer:Ww,middleware:s=>s({serializableCheck:{ignoredActions:["persist/PERSIST","persist/REHYDRATE"]}}),devTools:!1}),Vw=Zb(Rd),Hw=v.createContext(),Yw=({children:s})=>{const{isAuthenticated:e,getToken:t}=Bt(),[n,r]=v.useState({balance:1e4,transactions:[],lastLoginReward:null,totalInvested:0,totalGains:0,portfolioValue:0}),[a,o]=v.useState(!1),[l,c]=v.useState(null),h=g=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2,maximumFractionDigits:2}).format(g),d=async()=>{if(e){o(!0),c(null);try{const g=t(),f=await fetch("http://localhost:5001/api/virtual-money/account",{headers:{Authorization:`Bearer ${g}`,"Content-Type":"application/json"}});if(f.ok){const y=await f.json();r(y.data)}else throw new Error("Failed to fetch virtual money data")}catch(g){c(g.message),console.error("Error fetching virtual money:",g)}finally{o(!1)}}},m=async(g,f,y)=>{if(!e)return{success:!1,message:"Not authenticated"};o(!0),c(null);try{const S=t(),k=await fetch("http://localhost:5001/api/virtual-money/buy",{method:"POST",headers:{Authorization:`Bearer ${S}`,"Content-Type":"application/json"},body:JSON.stringify({stockSymbol:g,quantity:f,price:y})}),C=await k.json();if(k.ok)return r(C.data),{success:!0,message:C.message};throw new Error(C.message||"Failed to buy stock")}catch(S){return c(S.message),{success:!1,message:S.message}}finally{o(!1)}},x=async(g,f,y)=>{if(!e)return{success:!1,message:"Not authenticated"};o(!0),c(null);try{const S=t(),k=await fetch("http://localhost:5001/api/virtual-money/sell",{method:"POST",headers:{Authorization:`Bearer ${S}`,"Content-Type":"application/json"},body:JSON.stringify({stockSymbol:g,quantity:f,price:y})}),C=await k.json();if(k.ok)return r(C.data),{success:!0,message:C.message};throw new Error(C.message||"Failed to sell stock")}catch(S){return c(S.message),{success:!1,message:S.message}}finally{o(!1)}},b=async()=>{if(!e)return{success:!1,message:"Not authenticated"};o(!0),c(null);try{const g=t(),f=await fetch("http://localhost:5001/api/virtual-money/login-reward",{method:"POST",headers:{Authorization:`Bearer ${g}`,"Content-Type":"application/json"}}),y=await f.json();if(f.ok)return r(y.data),{success:!0,message:y.message,reward:y.reward};throw new Error(y.message||"Failed to claim reward")}catch(g){return c(g.message),{success:!1,message:g.message}}finally{o(!1)}};v.useEffect(()=>{e&&d()},[e]),v.useEffect(()=>{const g=f=>{console.log("🔄 Balance update received in VirtualMoneyContext:",f.detail),d()};return window.addEventListener("balanceUpdated",g),()=>{window.removeEventListener("balanceUpdated",g)}},[d]);const p={virtualMoney:n,loading:a,error:l,formatCurrency:h,fetchVirtualMoney:d,buyStock:m,sellStock:x,claimLoginReward:b,balance:n.balance,formattedBalance:h(n.balance),transactions:n.transactions||[],canClaimReward:n.lastLoginReward?new Date-new Date(n.lastLoginReward)>24*60*60*1e3:!0};return i.jsx(Hw.Provider,{value:p,children:s})},qw=v.createContext(),Gw=({children:s})=>{const[e,t]=v.useState(()=>localStorage.getItem("tradebro-theme")||"light");v.useEffect(()=>{const l=document.documentElement;l.classList.remove("light-theme","dark-theme"),l.classList.add(`${e}-theme`),localStorage.setItem("tradebro-theme",e),l.setAttribute("data-theme",e)},[e]);const o={theme:e,toggleTheme:()=>{t(l=>l==="light"?"dark":"light")},setLightTheme:()=>t("light"),setDarkTheme:()=>t("dark"),isLight:e==="light",isDark:e==="dark"};return i.jsx(qw.Provider,{value:o,children:s})};xc(document.getElementById("root")).render(i.jsx(v.StrictMode,{children:i.jsx(Km,{store:Rd,children:i.jsx(Nc,{loading:i.jsx("div",{children:"Loading..."}),persistor:Vw,children:i.jsx(Sm,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:i.jsx(Gw,{children:i.jsx(Rf,{children:i.jsx(gg,{children:i.jsx(Sh,{children:i.jsx(Hy,{children:i.jsx(Pg,{children:i.jsx(Yw,{children:i.jsx(zx,{})})})})})})})})})})})}));export{vt as F,t1 as a,We as b,Ue as c,ri as d,i as j};
